(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function u_(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const lt={},pa=[],Us=()=>{},TN=()=>!1,Wd=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),h_=n=>n.startsWith("onUpdate:"),qt=Object.assign,d_=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},SN=Object.prototype.hasOwnProperty,nt=(n,e)=>SN.call(n,e),we=Array.isArray,ma=n=>tu(n)==="[object Map]",qd=n=>tu(n)==="[object Set]",zb=n=>tu(n)==="[object Date]",Pe=n=>typeof n=="function",At=n=>typeof n=="string",Ss=n=>typeof n=="symbol",it=n=>n!==null&&typeof n=="object",BS=n=>(it(n)||Pe(n))&&Pe(n.then)&&Pe(n.catch),$S=Object.prototype.toString,tu=n=>$S.call(n),IN=n=>tu(n).slice(8,-1),US=n=>tu(n)==="[object Object]",f_=n=>At(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Ql=u_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Kd=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},CN=/-(\w)/g,hs=Kd(n=>n.replace(CN,(e,t)=>t?t.toUpperCase():"")),kN=/\B([A-Z])/g,$o=Kd(n=>n.replace(kN,"-$1").toLowerCase()),Gd=Kd(n=>n.charAt(0).toUpperCase()+n.slice(1)),Pp=Kd(n=>n?`on${Gd(n)}`:""),ii=(n,e)=>!Object.is(n,e),_h=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},jS=(n,e,t,s=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:s,value:t})},Mm=n=>{const e=parseFloat(n);return isNaN(e)?n:e},AN=n=>{const e=At(n)?Number(n):NaN;return isNaN(e)?n:e};let Hb;const Qd=()=>Hb||(Hb=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Jd(n){if(we(n)){const e={};for(let t=0;t<n.length;t++){const s=n[t],r=At(s)?NN(s):Jd(s);if(r)for(const i in r)e[i]=r[i]}return e}else if(At(n)||it(n))return n}const RN=/;(?![^(]*\))/g,PN=/:([^]+)/,xN=/\/\*[^]*?\*\//g;function NN(n){const e={};return n.replace(xN,"").split(RN).forEach(t=>{if(t){const s=t.split(PN);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function is(n){let e="";if(At(n))e=n;else if(we(n))for(let t=0;t<n.length;t++){const s=is(n[t]);s&&(e+=s+" ")}else if(it(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const ON="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",MN=u_(ON);function zS(n){return!!n||n===""}function DN(n,e){if(n.length!==e.length)return!1;let t=!0;for(let s=0;t&&s<n.length;s++)t=Yd(n[s],e[s]);return t}function Yd(n,e){if(n===e)return!0;let t=zb(n),s=zb(e);if(t||s)return t&&s?n.getTime()===e.getTime():!1;if(t=Ss(n),s=Ss(e),t||s)return n===e;if(t=we(n),s=we(e),t||s)return t&&s?DN(n,e):!1;if(t=it(n),s=it(e),t||s){if(!t||!s)return!1;const r=Object.keys(n).length,i=Object.keys(e).length;if(r!==i)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Yd(n[o],e[o]))return!1}}return String(n)===String(e)}function HS(n,e){return n.findIndex(t=>Yd(t,e))}const WS=n=>!!(n&&n.__v_isRef===!0),De=n=>At(n)?n:n==null?"":we(n)||it(n)&&(n.toString===$S||!Pe(n.toString))?WS(n)?De(n.value):JSON.stringify(n,qS,2):String(n),qS=(n,e)=>WS(e)?qS(n,e.value):ma(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[s,r],i)=>(t[xp(s,i)+" =>"]=r,t),{})}:qd(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>xp(t))}:Ss(e)?xp(e):it(e)&&!we(e)&&!US(e)?String(e):e,xp=(n,e="")=>{var t;return Ss(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let In;class KS{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=In,!e&&In&&(this.index=(In.scopes||(In.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=In;try{return In=this,e()}finally{In=t}}}on(){In=this}off(){In=this.parent}stop(e){if(this._active){this._active=!1;let t,s;for(t=0,s=this.effects.length;t<s;t++)this.effects[t].stop();for(this.effects.length=0,t=0,s=this.cleanups.length;t<s;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function p_(n){return new KS(n)}function Xd(){return In}function m_(n,e=!1){In&&In.cleanups.push(n)}let dt;const Np=new WeakSet;class GS{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,In&&In.active&&In.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Np.has(this)&&(Np.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||JS(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Wb(this),YS(this);const e=dt,t=ws;dt=this,ws=!0;try{return this.fn()}finally{XS(this),dt=e,ws=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)y_(e);this.deps=this.depsTail=void 0,Wb(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Np.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Dm(this)&&this.run()}get dirty(){return Dm(this)}}let QS=0,Jl,Yl;function JS(n,e=!1){if(n.flags|=8,e){n.next=Yl,Yl=n;return}n.next=Jl,Jl=n}function g_(){QS++}function __(){if(--QS>0)return;if(Yl){let e=Yl;for(Yl=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;Jl;){let e=Jl;for(Jl=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){n||(n=s)}e=t}}if(n)throw n}function YS(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function XS(n){let e,t=n.depsTail,s=t;for(;s;){const r=s.prevDep;s.version===-1?(s===t&&(t=r),y_(s),LN(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=r}n.deps=e,n.depsTail=t}function Dm(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(ZS(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function ZS(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===yc))return;n.globalVersion=yc;const e=n.dep;if(n.flags|=2,e.version>0&&!n.isSSR&&n.deps&&!Dm(n)){n.flags&=-3;return}const t=dt,s=ws;dt=n,ws=!0;try{YS(n);const r=n.fn(n._value);(e.version===0||ii(r,n._value))&&(n._value=r,e.version++)}catch(r){throw e.version++,r}finally{dt=t,ws=s,XS(n),n.flags&=-3}}function y_(n,e=!1){const{dep:t,prevSub:s,nextSub:r}=n;if(s&&(s.nextSub=r,n.prevSub=void 0),r&&(r.prevSub=s,n.nextSub=void 0),t.subs===n&&(t.subs=s,!s&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)y_(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function LN(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let ws=!0;const eI=[];function Ni(){eI.push(ws),ws=!1}function Oi(){const n=eI.pop();ws=n===void 0?!0:n}function Wb(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=dt;dt=void 0;try{e()}finally{dt=t}}}let yc=0;class VN{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Zd{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!dt||!ws||dt===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==dt)t=this.activeLink=new VN(dt,this),dt.deps?(t.prevDep=dt.depsTail,dt.depsTail.nextDep=t,dt.depsTail=t):dt.deps=dt.depsTail=t,tI(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const s=t.nextDep;s.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=s),t.prevDep=dt.depsTail,t.nextDep=void 0,dt.depsTail.nextDep=t,dt.depsTail=t,dt.deps===t&&(dt.deps=s)}return t}trigger(e){this.version++,yc++,this.notify(e)}notify(e){g_();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{__()}}}function tI(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)tI(s)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const Bh=new WeakMap,mo=Symbol(""),Lm=Symbol(""),vc=Symbol("");function fn(n,e,t){if(ws&&dt){let s=Bh.get(n);s||Bh.set(n,s=new Map);let r=s.get(t);r||(s.set(t,r=new Zd),r.map=s,r.key=t),r.track()}}function dr(n,e,t,s,r,i){const o=Bh.get(n);if(!o){yc++;return}const a=l=>{l&&l.trigger()};if(g_(),e==="clear")o.forEach(a);else{const l=we(n),c=l&&f_(t);if(l&&t==="length"){const u=Number(s);o.forEach((h,f)=>{(f==="length"||f===vc||!Ss(f)&&f>=u)&&a(h)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),c&&a(o.get(vc)),e){case"add":l?c&&a(o.get("length")):(a(o.get(mo)),ma(n)&&a(o.get(Lm)));break;case"delete":l||(a(o.get(mo)),ma(n)&&a(o.get(Lm)));break;case"set":ma(n)&&a(o.get(mo));break}}__()}function FN(n,e){const t=Bh.get(n);return t&&t.get(e)}function Jo(n){const e=Ge(n);return e===n?e:(fn(e,"iterate",vc),cs(n)?e:e.map(pn))}function ef(n){return fn(n=Ge(n),"iterate",vc),n}const BN={__proto__:null,[Symbol.iterator](){return Op(this,Symbol.iterator,pn)},concat(...n){return Jo(this).concat(...n.map(e=>we(e)?Jo(e):e))},entries(){return Op(this,"entries",n=>(n[1]=pn(n[1]),n))},every(n,e){return or(this,"every",n,e,void 0,arguments)},filter(n,e){return or(this,"filter",n,e,t=>t.map(pn),arguments)},find(n,e){return or(this,"find",n,e,pn,arguments)},findIndex(n,e){return or(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return or(this,"findLast",n,e,pn,arguments)},findLastIndex(n,e){return or(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return or(this,"forEach",n,e,void 0,arguments)},includes(...n){return Mp(this,"includes",n)},indexOf(...n){return Mp(this,"indexOf",n)},join(n){return Jo(this).join(n)},lastIndexOf(...n){return Mp(this,"lastIndexOf",n)},map(n,e){return or(this,"map",n,e,void 0,arguments)},pop(){return Tl(this,"pop")},push(...n){return Tl(this,"push",n)},reduce(n,...e){return qb(this,"reduce",n,e)},reduceRight(n,...e){return qb(this,"reduceRight",n,e)},shift(){return Tl(this,"shift")},some(n,e){return or(this,"some",n,e,void 0,arguments)},splice(...n){return Tl(this,"splice",n)},toReversed(){return Jo(this).toReversed()},toSorted(n){return Jo(this).toSorted(n)},toSpliced(...n){return Jo(this).toSpliced(...n)},unshift(...n){return Tl(this,"unshift",n)},values(){return Op(this,"values",pn)}};function Op(n,e,t){const s=ef(n),r=s[e]();return s!==n&&!cs(n)&&(r._next=r.next,r.next=()=>{const i=r._next();return i.value&&(i.value=t(i.value)),i}),r}const $N=Array.prototype;function or(n,e,t,s,r,i){const o=ef(n),a=o!==n&&!cs(n),l=o[e];if(l!==$N[e]){const h=l.apply(n,i);return a?pn(h):h}let c=t;o!==n&&(a?c=function(h,f){return t.call(this,pn(h),f,n)}:t.length>2&&(c=function(h,f){return t.call(this,h,f,n)}));const u=l.call(o,c,s);return a&&r?r(u):u}function qb(n,e,t,s){const r=ef(n);let i=t;return r!==n&&(cs(n)?t.length>3&&(i=function(o,a,l){return t.call(this,o,a,l,n)}):i=function(o,a,l){return t.call(this,o,pn(a),l,n)}),r[e](i,...s)}function Mp(n,e,t){const s=Ge(n);fn(s,"iterate",vc);const r=s[e](...t);return(r===-1||r===!1)&&w_(t[0])?(t[0]=Ge(t[0]),s[e](...t)):r}function Tl(n,e,t=[]){Ni(),g_();const s=Ge(n)[e].apply(n,t);return __(),Oi(),s}const UN=u_("__proto__,__v_isRef,__isVue"),nI=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Ss));function jN(n){Ss(n)||(n=String(n));const e=Ge(this);return fn(e,"has",n),e.hasOwnProperty(n)}class sI{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,s){if(t==="__v_skip")return e.__v_skip;const r=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!r;if(t==="__v_isReadonly")return r;if(t==="__v_isShallow")return i;if(t==="__v_raw")return s===(r?i?XN:aI:i?oI:iI).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=we(e);if(!r){let l;if(o&&(l=BN[t]))return l;if(t==="hasOwnProperty")return jN}const a=Reflect.get(e,t,ut(e)?e:s);return(Ss(t)?nI.has(t):UN(t))||(r||fn(e,"get",t),i)?a:ut(a)?o&&f_(t)?a:a.value:it(a)?r?cI(a):Ka(a):a}}class rI extends sI{constructor(e=!1){super(!1,e)}set(e,t,s,r){let i=e[t];if(!this._isShallow){const l=So(i);if(!cs(s)&&!So(s)&&(i=Ge(i),s=Ge(s)),!we(e)&&ut(i)&&!ut(s))return l?!1:(i.value=s,!0)}const o=we(e)&&f_(t)?Number(t)<e.length:nt(e,t),a=Reflect.set(e,t,s,ut(e)?e:r);return e===Ge(r)&&(o?ii(s,i)&&dr(e,"set",t,s):dr(e,"add",t,s)),a}deleteProperty(e,t){const s=nt(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&s&&dr(e,"delete",t,void 0),r}has(e,t){const s=Reflect.has(e,t);return(!Ss(t)||!nI.has(t))&&fn(e,"has",t),s}ownKeys(e){return fn(e,"iterate",we(e)?"length":mo),Reflect.ownKeys(e)}}class zN extends sI{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const HN=new rI,WN=new zN,qN=new rI(!0);const Vm=n=>n,Hu=n=>Reflect.getPrototypeOf(n);function KN(n,e,t){return function(...s){const r=this.__v_raw,i=Ge(r),o=ma(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=r[n](...s),u=t?Vm:e?Fm:pn;return!e&&fn(i,"iterate",l?Lm:mo),{next(){const{value:h,done:f}=c.next();return f?{value:h,done:f}:{value:a?[u(h[0]),u(h[1])]:u(h),done:f}},[Symbol.iterator](){return this}}}}function Wu(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function GN(n,e){const t={get(r){const i=this.__v_raw,o=Ge(i),a=Ge(r);n||(ii(r,a)&&fn(o,"get",r),fn(o,"get",a));const{has:l}=Hu(o),c=e?Vm:n?Fm:pn;if(l.call(o,r))return c(i.get(r));if(l.call(o,a))return c(i.get(a));i!==o&&i.get(r)},get size(){const r=this.__v_raw;return!n&&fn(Ge(r),"iterate",mo),Reflect.get(r,"size",r)},has(r){const i=this.__v_raw,o=Ge(i),a=Ge(r);return n||(ii(r,a)&&fn(o,"has",r),fn(o,"has",a)),r===a?i.has(r):i.has(r)||i.has(a)},forEach(r,i){const o=this,a=o.__v_raw,l=Ge(a),c=e?Vm:n?Fm:pn;return!n&&fn(l,"iterate",mo),a.forEach((u,h)=>r.call(i,c(u),c(h),o))}};return qt(t,n?{add:Wu("add"),set:Wu("set"),delete:Wu("delete"),clear:Wu("clear")}:{add(r){!e&&!cs(r)&&!So(r)&&(r=Ge(r));const i=Ge(this);return Hu(i).has.call(i,r)||(i.add(r),dr(i,"add",r,r)),this},set(r,i){!e&&!cs(i)&&!So(i)&&(i=Ge(i));const o=Ge(this),{has:a,get:l}=Hu(o);let c=a.call(o,r);c||(r=Ge(r),c=a.call(o,r));const u=l.call(o,r);return o.set(r,i),c?ii(i,u)&&dr(o,"set",r,i):dr(o,"add",r,i),this},delete(r){const i=Ge(this),{has:o,get:a}=Hu(i);let l=o.call(i,r);l||(r=Ge(r),l=o.call(i,r)),a&&a.call(i,r);const c=i.delete(r);return l&&dr(i,"delete",r,void 0),c},clear(){const r=Ge(this),i=r.size!==0,o=r.clear();return i&&dr(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=KN(r,n,e)}),t}function v_(n,e){const t=GN(n,e);return(s,r,i)=>r==="__v_isReactive"?!n:r==="__v_isReadonly"?n:r==="__v_raw"?s:Reflect.get(nt(t,r)&&r in s?t:s,r,i)}const QN={get:v_(!1,!1)},JN={get:v_(!1,!0)},YN={get:v_(!0,!1)};const iI=new WeakMap,oI=new WeakMap,aI=new WeakMap,XN=new WeakMap;function ZN(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function eO(n){return n.__v_skip||!Object.isExtensible(n)?0:ZN(IN(n))}function Ka(n){return So(n)?n:b_(n,!1,HN,QN,iI)}function lI(n){return b_(n,!1,qN,JN,oI)}function cI(n){return b_(n,!0,WN,YN,aI)}function b_(n,e,t,s,r){if(!it(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=r.get(n);if(i)return i;const o=eO(n);if(o===0)return n;const a=new Proxy(n,o===2?s:t);return r.set(n,a),a}function yr(n){return So(n)?yr(n.__v_raw):!!(n&&n.__v_isReactive)}function So(n){return!!(n&&n.__v_isReadonly)}function cs(n){return!!(n&&n.__v_isShallow)}function w_(n){return n?!!n.__v_raw:!1}function Ge(n){const e=n&&n.__v_raw;return e?Ge(e):n}function tf(n){return!nt(n,"__v_skip")&&Object.isExtensible(n)&&jS(n,"__v_skip",!0),n}const pn=n=>it(n)?Ka(n):n,Fm=n=>it(n)?cI(n):n;function ut(n){return n?n.__v_isRef===!0:!1}function G(n){return uI(n,!1)}function nf(n){return uI(n,!0)}function uI(n,e){return ut(n)?n:new tO(n,e)}class tO{constructor(e,t){this.dep=new Zd,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Ge(e),this._value=t?e:pn(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,s=this.__v_isShallow||cs(e)||So(e);e=s?e:Ge(e),ii(e,t)&&(this._rawValue=e,this._value=s?e:pn(e),this.dep.trigger())}}function Y(n){return ut(n)?n.value:n}function dn(n){return Pe(n)?n():Y(n)}const nO={get:(n,e,t)=>e==="__v_raw"?n:Y(Reflect.get(n,e,t)),set:(n,e,t,s)=>{const r=n[e];return ut(r)&&!ut(t)?(r.value=t,!0):Reflect.set(n,e,t,s)}};function hI(n){return yr(n)?n:new Proxy(n,nO)}class sO{constructor(e){this.__v_isRef=!0,this._value=void 0;const t=this.dep=new Zd,{get:s,set:r}=e(t.track.bind(t),t.trigger.bind(t));this._get=s,this._set=r}get value(){return this._value=this._get()}set value(e){this._set(e)}}function rO(n){return new sO(n)}function iO(n){const e=we(n)?new Array(n.length):{};for(const t in n)e[t]=dI(n,t);return e}class oO{constructor(e,t,s){this._object=e,this._key=t,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return FN(Ge(this._object),this._key)}}class aO{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function lO(n,e,t){return ut(n)?n:Pe(n)?new aO(n):it(n)&&arguments.length>1?dI(n,e,t):G(n)}function dI(n,e,t){const s=n[e];return ut(s)?s:new oO(n,e,t)}class cO{constructor(e,t,s){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Zd(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=yc-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&dt!==this)return JS(this,!0),!0}get value(){const e=this.dep.track();return ZS(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function uO(n,e,t=!1){let s,r;return Pe(n)?s=n:(s=n.get,r=n.set),new cO(s,r,t)}const qu={},$h=new WeakMap;let eo;function hO(n,e=!1,t=eo){if(t){let s=$h.get(t);s||$h.set(t,s=[]),s.push(n)}}function dO(n,e,t=lt){const{immediate:s,deep:r,once:i,scheduler:o,augmentJob:a,call:l}=t,c=D=>r?D:cs(D)||r===!1||r===0?fr(D,1):fr(D);let u,h,f,p,m=!1,_=!1;if(ut(n)?(h=()=>n.value,m=cs(n)):yr(n)?(h=()=>c(n),m=!0):we(n)?(_=!0,m=n.some(D=>yr(D)||cs(D)),h=()=>n.map(D=>{if(ut(D))return D.value;if(yr(D))return c(D);if(Pe(D))return l?l(D,2):D()})):Pe(n)?e?h=l?()=>l(n,2):n:h=()=>{if(f){Ni();try{f()}finally{Oi()}}const D=eo;eo=u;try{return l?l(n,3,[p]):n(p)}finally{eo=D}}:h=Us,e&&r){const D=h,B=r===!0?1/0:r;h=()=>fr(D(),B)}const v=Xd(),I=()=>{u.stop(),v&&v.active&&d_(v.effects,u)};if(i&&e){const D=e;e=(...B)=>{D(...B),I()}}let O=_?new Array(n.length).fill(qu):qu;const P=D=>{if(!(!(u.flags&1)||!u.dirty&&!D))if(e){const B=u.run();if(r||m||(_?B.some((M,A)=>ii(M,O[A])):ii(B,O))){f&&f();const M=eo;eo=u;try{const A=[B,O===qu?void 0:_&&O[0]===qu?[]:O,p];l?l(e,3,A):e(...A),O=B}finally{eo=M}}}else u.run()};return a&&a(P),u=new GS(h),u.scheduler=o?()=>o(P,!1):P,p=D=>hO(D,!1,u),f=u.onStop=()=>{const D=$h.get(u);if(D){if(l)l(D,4);else for(const B of D)B();$h.delete(u)}},e?s?P(!0):O=u.run():o?o(P.bind(null,!0),!0):u.run(),I.pause=u.pause.bind(u),I.resume=u.resume.bind(u),I.stop=I,I}function fr(n,e=1/0,t){if(e<=0||!it(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,ut(n))fr(n.value,e,t);else if(we(n))for(let s=0;s<n.length;s++)fr(n[s],e,t);else if(qd(n)||ma(n))n.forEach(s=>{fr(s,e,t)});else if(US(n)){for(const s in n)fr(n[s],e,t);for(const s of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,s)&&fr(n[s],e,t)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function nu(n,e,t,s){try{return s?n(...s):n()}catch(r){sf(r,e,t)}}function Is(n,e,t,s){if(Pe(n)){const r=nu(n,e,t,s);return r&&BS(r)&&r.catch(i=>{sf(i,e,t)}),r}if(we(n)){const r=[];for(let i=0;i<n.length;i++)r.push(Is(n[i],e,t,s));return r}}function sf(n,e,t,s=!0){const r=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||lt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const u=a.ec;if(u){for(let h=0;h<u.length;h++)if(u[h](n,l,c)===!1)return}a=a.parent}if(i){Ni(),nu(i,null,10,[n,l,c]),Oi();return}}fO(n,t,r,s,o)}function fO(n,e,t,s=!0,r=!1){if(r)throw n;console.error(n)}const kn=[];let Ms=-1;const ga=[];let zr=null,na=0;const fI=Promise.resolve();let Uh=null;function Mi(n){const e=Uh||fI;return n?e.then(this?n.bind(this):n):e}function pO(n){let e=Ms+1,t=kn.length;for(;e<t;){const s=e+t>>>1,r=kn[s],i=bc(r);i<n||i===n&&r.flags&2?e=s+1:t=s}return e}function E_(n){if(!(n.flags&1)){const e=bc(n),t=kn[kn.length-1];!t||!(n.flags&2)&&e>=bc(t)?kn.push(n):kn.splice(pO(e),0,n),n.flags|=1,pI()}}function pI(){Uh||(Uh=fI.then(gI))}function mO(n){we(n)?ga.push(...n):zr&&n.id===-1?zr.splice(na+1,0,n):n.flags&1||(ga.push(n),n.flags|=1),pI()}function Kb(n,e,t=Ms+1){for(;t<kn.length;t++){const s=kn[t];if(s&&s.flags&2){if(n&&s.id!==n.uid)continue;kn.splice(t,1),t--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function mI(n){if(ga.length){const e=[...new Set(ga)].sort((t,s)=>bc(t)-bc(s));if(ga.length=0,zr){zr.push(...e);return}for(zr=e,na=0;na<zr.length;na++){const t=zr[na];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}zr=null,na=0}}const bc=n=>n.id==null?n.flags&2?-1:1/0:n.id;function gI(n){try{for(Ms=0;Ms<kn.length;Ms++){const e=kn[Ms];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),nu(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ms<kn.length;Ms++){const e=kn[Ms];e&&(e.flags&=-2)}Ms=-1,kn.length=0,mI(),Uh=null,(kn.length||ga.length)&&gI()}}let Vt=null,_I=null;function jh(n){const e=Vt;return Vt=n,_I=n&&n.type.__scopeId||null,e}function Z(n,e=Vt,t){if(!e||n._n)return n;const s=(...r)=>{s._d&&rw(-1);const i=jh(e);let o;try{o=n(...r)}finally{jh(i),s._d&&rw(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function nn(n,e){if(Vt===null)return n;const t=uf(Vt),s=n.dirs||(n.dirs=[]);for(let r=0;r<e.length;r++){let[i,o,a,l=lt]=e[r];i&&(Pe(i)&&(i={mounted:i,updated:i}),i.deep&&fr(o),s.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function Ji(n,e,t,s){const r=n.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let l=a.dir[s];l&&(Ni(),Is(l,t,8,[n.el,a,n,e]),Oi())}}const gO=Symbol("_vte"),yI=n=>n.__isTeleport,Hr=Symbol("_leaveCb"),Ku=Symbol("_enterCb");function _O(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Xs(()=>{n.isMounted=!0}),af(()=>{n.isUnmounting=!0}),n}const ss=[Function,Array],vI={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ss,onEnter:ss,onAfterEnter:ss,onEnterCancelled:ss,onBeforeLeave:ss,onLeave:ss,onAfterLeave:ss,onLeaveCancelled:ss,onBeforeAppear:ss,onAppear:ss,onAfterAppear:ss,onAppearCancelled:ss},bI=n=>{const e=n.subTree;return e.component?bI(e.component):e},yO={name:"BaseTransition",props:vI,setup(n,{slots:e}){const t=su(),s=_O();return()=>{const r=e.default&&TI(e.default(),!0);if(!r||!r.length)return;const i=wI(r),o=Ge(n),{mode:a}=o;if(s.isLeaving)return Dp(i);const l=Gb(i);if(!l)return Dp(i);let c=Bm(l,o,s,t,h=>c=h);l.type!==An&&wc(l,c);let u=t.subTree&&Gb(t.subTree);if(u&&u.type!==An&&!ro(l,u)&&bI(t).type!==An){let h=Bm(u,o,s,t);if(wc(u,h),a==="out-in"&&l.type!==An)return s.isLeaving=!0,h.afterLeave=()=>{s.isLeaving=!1,t.job.flags&8||t.update(),delete h.afterLeave,u=void 0},Dp(i);a==="in-out"&&l.type!==An?h.delayLeave=(f,p,m)=>{const _=EI(s,u);_[String(u.key)]=u,f[Hr]=()=>{p(),f[Hr]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{m(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return i}}};function wI(n){let e=n[0];if(n.length>1){for(const t of n)if(t.type!==An){e=t;break}}return e}const vO=yO;function EI(n,e){const{leavingVNodes:t}=n;let s=t.get(e.type);return s||(s=Object.create(null),t.set(e.type,s)),s}function Bm(n,e,t,s,r){const{appear:i,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:h,onBeforeLeave:f,onLeave:p,onAfterLeave:m,onLeaveCancelled:_,onBeforeAppear:v,onAppear:I,onAfterAppear:O,onAppearCancelled:P}=e,D=String(n.key),B=EI(t,n),M=(E,C)=>{E&&Is(E,s,9,C)},A=(E,C)=>{const x=C[1];M(E,C),we(E)?E.every(k=>k.length<=1)&&x():E.length<=1&&x()},T={mode:o,persisted:a,beforeEnter(E){let C=l;if(!t.isMounted)if(i)C=v||l;else return;E[Hr]&&E[Hr](!0);const x=B[D];x&&ro(n,x)&&x.el[Hr]&&x.el[Hr](),M(C,[E])},enter(E){let C=c,x=u,k=h;if(!t.isMounted)if(i)C=I||c,x=O||u,k=P||h;else return;let b=!1;const ye=E[Ku]=Ve=>{b||(b=!0,Ve?M(k,[E]):M(x,[E]),T.delayedLeave&&T.delayedLeave(),E[Ku]=void 0)};C?A(C,[E,ye]):ye()},leave(E,C){const x=String(n.key);if(E[Ku]&&E[Ku](!0),t.isUnmounting)return C();M(f,[E]);let k=!1;const b=E[Hr]=ye=>{k||(k=!0,C(),ye?M(_,[E]):M(m,[E]),E[Hr]=void 0,B[x]===n&&delete B[x])};B[x]=n,p?A(p,[E,b]):b()},clone(E){const C=Bm(E,e,t,s,r);return r&&r(C),C}};return T}function Dp(n){if(rf(n))return n=_i(n),n.children=null,n}function Gb(n){if(!rf(n))return yI(n.type)&&n.children?wI(n.children):n;const{shapeFlag:e,children:t}=n;if(t){if(e&16)return t[0];if(e&32&&Pe(t.default))return t.default()}}function wc(n,e){n.shapeFlag&6&&n.component?(n.transition=e,wc(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function TI(n,e=!1,t){let s=[],r=0;for(let i=0;i<n.length;i++){let o=n[i];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:i);o.type===rt?(o.patchFlag&128&&r++,s=s.concat(TI(o.children,e,a))):(e||o.type!==An)&&s.push(a!=null?_i(o,{key:a}):o)}if(r>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}/*! #__NO_SIDE_EFFECTS__ */function T_(n,e){return Pe(n)?qt({name:n.name},e,{setup:n}):n}function SI(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function zh(n,e,t,s,r=!1){if(we(n)){n.forEach((m,_)=>zh(m,e&&(we(e)?e[_]:e),t,s,r));return}if(_a(s)&&!r){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&zh(n,e,t,s.component.subTree);return}const i=s.shapeFlag&4?uf(s.component):s.el,o=r?null:i,{i:a,r:l}=n,c=e&&e.r,u=a.refs===lt?a.refs={}:a.refs,h=a.setupState,f=Ge(h),p=h===lt?()=>!1:m=>nt(f,m);if(c!=null&&c!==l&&(At(c)?(u[c]=null,p(c)&&(h[c]=null)):ut(c)&&(c.value=null)),Pe(l))nu(l,a,12,[o,u]);else{const m=At(l),_=ut(l);if(m||_){const v=()=>{if(n.f){const I=m?p(l)?h[l]:u[l]:l.value;r?we(I)&&d_(I,i):we(I)?I.includes(i)||I.push(i):m?(u[l]=[i],p(l)&&(h[l]=u[l])):(l.value=[i],n.k&&(u[n.k]=l.value))}else m?(u[l]=o,p(l)&&(h[l]=o)):_&&(l.value=o,n.k&&(u[n.k]=o))};o?(v.id=-1,Kn(v,t)):v()}}}Qd().requestIdleCallback;Qd().cancelIdleCallback;const _a=n=>!!n.type.__asyncLoader,rf=n=>n.type.__isKeepAlive;function bO(n,e){II(n,"a",e)}function wO(n,e){II(n,"da",e)}function II(n,e,t=zt){const s=n.__wdc||(n.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return n()});if(of(e,s,t),t){let r=t.parent;for(;r&&r.parent;)rf(r.parent.vnode)&&EO(s,e,t,r),r=r.parent}}function EO(n,e,t,s){const r=of(e,n,s,!0);S_(()=>{d_(s[e],r)},t)}function of(n,e,t=zt,s=!1){if(t){const r=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{Ni();const a=ru(t),l=Is(e,t,n,o);return a(),Oi(),l});return s?r.unshift(i):r.push(i),i}}const Pr=n=>(e,t=zt)=>{(!Sc||n==="sp")&&of(n,(...s)=>e(...s),t)},TO=Pr("bm"),Xs=Pr("m"),SO=Pr("bu"),IO=Pr("u"),af=Pr("bum"),S_=Pr("um"),I_=Pr("sp"),CO=Pr("rtg"),kO=Pr("rtc");function AO(n,e=zt){of("ec",n,e)}const RO="components";function C_(n,e){return xO(RO,n,!0,e)||n}const PO=Symbol.for("v-ndc");function xO(n,e,t=!0,s=!1){const r=Vt||zt;if(r){const i=r.type;{const a=vM(i,!1);if(a&&(a===e||a===hs(e)||a===Gd(hs(e))))return i}const o=Qb(r[n]||i[n],e)||Qb(r.appContext[n],e);return!o&&s?i:o}}function Qb(n,e){return n&&(n[e]||n[hs(e)]||n[Gd(hs(e))])}function Io(n,e,t,s){let r;const i=t,o=we(n);if(o||At(n)){const a=o&&yr(n);let l=!1;a&&(l=!cs(n),n=ef(n)),r=new Array(n.length);for(let c=0,u=n.length;c<u;c++)r[c]=e(l?pn(n[c]):n[c],c,void 0,i)}else if(typeof n=="number"){r=new Array(n);for(let a=0;a<n;a++)r[a]=e(a+1,a,void 0,i)}else if(it(n))if(n[Symbol.iterator])r=Array.from(n,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(n);r=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];r[l]=e(n[u],u,l,i)}}else r=[];return r}function so(n,e,t={},s,r){if(Vt.ce||Vt.parent&&_a(Vt.parent)&&Vt.parent.ce)return $(),bt(rt,null,[F("slot",t,s)],64);let i=n[e];i&&i._c&&(i._d=!1),$();const o=i&&CI(i(t)),a=t.key||o&&o.key,l=bt(rt,{key:(a&&!Ss(a)?a:`_${e}`)+""},o||[],o&&n._===1?64:-2);return i&&i._c&&(i._d=!0),l}function CI(n){return n.some(e=>Tc(e)?!(e.type===An||e.type===rt&&!CI(e.children)):!0)?n:null}const $m=n=>n?KI(n)?uf(n):$m(n.parent):null,Xl=qt(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>$m(n.parent),$root:n=>$m(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>AI(n),$forceUpdate:n=>n.f||(n.f=()=>{E_(n.update)}),$nextTick:n=>n.n||(n.n=Mi.bind(n.proxy)),$watch:n=>eM.bind(n)}),Lp=(n,e)=>n!==lt&&!n.__isScriptSetup&&nt(n,e),NO={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return s[e];case 2:return r[e];case 4:return t[e];case 3:return i[e]}else{if(Lp(s,e))return o[e]=1,s[e];if(r!==lt&&nt(r,e))return o[e]=2,r[e];if((c=n.propsOptions[0])&&nt(c,e))return o[e]=3,i[e];if(t!==lt&&nt(t,e))return o[e]=4,t[e];Um&&(o[e]=0)}}const u=Xl[e];let h,f;if(u)return e==="$attrs"&&fn(n.attrs,"get",""),u(n);if((h=a.__cssModules)&&(h=h[e]))return h;if(t!==lt&&nt(t,e))return o[e]=4,t[e];if(f=l.config.globalProperties,nt(f,e))return f[e]},set({_:n},e,t){const{data:s,setupState:r,ctx:i}=n;return Lp(r,e)?(r[e]=t,!0):s!==lt&&nt(s,e)?(s[e]=t,!0):nt(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:s,appContext:r,propsOptions:i}},o){let a;return!!t[o]||n!==lt&&nt(n,o)||Lp(e,o)||(a=i[0])&&nt(a,o)||nt(s,o)||nt(Xl,o)||nt(r.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:nt(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function Jb(n){return we(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Um=!0;function OO(n){const e=AI(n),t=n.proxy,s=n.ctx;Um=!1,e.beforeCreate&&Yb(e.beforeCreate,n,"bc");const{data:r,computed:i,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:f,beforeUpdate:p,updated:m,activated:_,deactivated:v,beforeDestroy:I,beforeUnmount:O,destroyed:P,unmounted:D,render:B,renderTracked:M,renderTriggered:A,errorCaptured:T,serverPrefetch:E,expose:C,inheritAttrs:x,components:k,directives:b,filters:ye}=e;if(c&&MO(c,s,null),o)for(const j in o){const te=o[j];Pe(te)&&(s[j]=te.bind(t))}if(r){const j=r.call(t,t);it(j)&&(n.data=Ka(j))}if(Um=!0,i)for(const j in i){const te=i[j],Re=Pe(te)?te.bind(t,t):Pe(te.get)?te.get.bind(t,t):Us,Qe=!Pe(te)&&Pe(te.set)?te.set.bind(t):Us,ht=et({get:Re,set:Qe});Object.defineProperty(s,j,{enumerable:!0,configurable:!0,get:()=>ht.value,set:pt=>ht.value=pt})}if(a)for(const j in a)kI(a[j],s,t,j);if(l){const j=Pe(l)?l.call(t):l;Reflect.ownKeys(j).forEach(te=>{Zl(te,j[te])})}u&&Yb(u,n,"c");function We(j,te){we(te)?te.forEach(Re=>j(Re.bind(t))):te&&j(te.bind(t))}if(We(TO,h),We(Xs,f),We(SO,p),We(IO,m),We(bO,_),We(wO,v),We(AO,T),We(kO,M),We(CO,A),We(af,O),We(S_,D),We(I_,E),we(C))if(C.length){const j=n.exposed||(n.exposed={});C.forEach(te=>{Object.defineProperty(j,te,{get:()=>t[te],set:Re=>t[te]=Re})})}else n.exposed||(n.exposed={});B&&n.render===Us&&(n.render=B),x!=null&&(n.inheritAttrs=x),k&&(n.components=k),b&&(n.directives=b),E&&SI(n)}function MO(n,e,t=Us){we(n)&&(n=jm(n));for(const s in n){const r=n[s];let i;it(r)?"default"in r?i=xn(r.from||s,r.default,!0):i=xn(r.from||s):i=xn(r),ut(i)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[s]=i}}function Yb(n,e,t){Is(we(n)?n.map(s=>s.bind(e.proxy)):n.bind(e.proxy),e,t)}function kI(n,e,t,s){let r=s.includes(".")?UI(t,s):()=>t[s];if(At(n)){const i=e[n];Pe(i)&&js(r,i)}else if(Pe(n))js(r,n.bind(t));else if(it(n))if(we(n))n.forEach(i=>kI(i,e,t,s));else{const i=Pe(n.handler)?n.handler.bind(t):e[n.handler];Pe(i)&&js(r,i,n)}}function AI(n){const e=n.type,{mixins:t,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let l;return a?l=a:!r.length&&!t&&!s?l=e:(l={},r.length&&r.forEach(c=>Hh(l,c,o,!0)),Hh(l,e,o)),it(e)&&i.set(e,l),l}function Hh(n,e,t,s=!1){const{mixins:r,extends:i}=e;i&&Hh(n,i,t,!0),r&&r.forEach(o=>Hh(n,o,t,!0));for(const o in e)if(!(s&&o==="expose")){const a=DO[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const DO={data:Xb,props:Zb,emits:Zb,methods:Vl,computed:Vl,beforeCreate:Sn,created:Sn,beforeMount:Sn,mounted:Sn,beforeUpdate:Sn,updated:Sn,beforeDestroy:Sn,beforeUnmount:Sn,destroyed:Sn,unmounted:Sn,activated:Sn,deactivated:Sn,errorCaptured:Sn,serverPrefetch:Sn,components:Vl,directives:Vl,watch:VO,provide:Xb,inject:LO};function Xb(n,e){return e?n?function(){return qt(Pe(n)?n.call(this,this):n,Pe(e)?e.call(this,this):e)}:e:n}function LO(n,e){return Vl(jm(n),jm(e))}function jm(n){if(we(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Sn(n,e){return n?[...new Set([].concat(n,e))]:e}function Vl(n,e){return n?qt(Object.create(null),n,e):e}function Zb(n,e){return n?we(n)&&we(e)?[...new Set([...n,...e])]:qt(Object.create(null),Jb(n),Jb(e??{})):e}function VO(n,e){if(!n)return e;if(!e)return n;const t=qt(Object.create(null),n);for(const s in e)t[s]=Sn(n[s],e[s]);return t}function RI(){return{app:null,config:{isNativeTag:TN,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let FO=0;function BO(n,e){return function(s,r=null){Pe(s)||(s=qt({},s)),r!=null&&!it(r)&&(r=null);const i=RI(),o=new WeakSet,a=[];let l=!1;const c=i.app={_uid:FO++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:wM,get config(){return i.config},set config(u){},use(u,...h){return o.has(u)||(u&&Pe(u.install)?(o.add(u),u.install(c,...h)):Pe(u)&&(o.add(u),u(c,...h))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,h){return h?(i.components[u]=h,c):i.components[u]},directive(u,h){return h?(i.directives[u]=h,c):i.directives[u]},mount(u,h,f){if(!l){const p=c._ceVNode||F(s,r);return p.appContext=i,f===!0?f="svg":f===!1&&(f=void 0),n(p,u,f),l=!0,c._container=u,u.__vue_app__=c,uf(p.component)}},onUnmount(u){a.push(u)},unmount(){l&&(Is(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(u,h){return i.provides[u]=h,c},runWithContext(u){const h=go;go=c;try{return u()}finally{go=h}}};return c}}let go=null;function Zl(n,e){if(zt){let t=zt.provides;const s=zt.parent&&zt.parent.provides;s===t&&(t=zt.provides=Object.create(s)),t[n]=e}}function xn(n,e,t=!1){const s=zt||Vt;if(s||go){const r=go?go._context.provides:s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(r&&n in r)return r[n];if(arguments.length>1)return t&&Pe(e)?e.call(s&&s.proxy):e}}function $O(){return!!(zt||Vt||go)}const PI={},xI=()=>Object.create(PI),NI=n=>Object.getPrototypeOf(n)===PI;function UO(n,e,t,s=!1){const r={},i=xI();n.propsDefaults=Object.create(null),OI(n,e,r,i);for(const o in n.propsOptions[0])o in r||(r[o]=void 0);t?n.props=s?r:lI(r):n.type.props?n.props=r:n.props=i,n.attrs=i}function jO(n,e,t,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=n,a=Ge(r),[l]=n.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=n.vnode.dynamicProps;for(let h=0;h<u.length;h++){let f=u[h];if(lf(n.emitsOptions,f))continue;const p=e[f];if(l)if(nt(i,f))p!==i[f]&&(i[f]=p,c=!0);else{const m=hs(f);r[m]=zm(l,a,m,p,n,!1)}else p!==i[f]&&(i[f]=p,c=!0)}}}else{OI(n,e,r,i)&&(c=!0);let u;for(const h in a)(!e||!nt(e,h)&&((u=$o(h))===h||!nt(e,u)))&&(l?t&&(t[h]!==void 0||t[u]!==void 0)&&(r[h]=zm(l,a,h,void 0,n,!0)):delete r[h]);if(i!==a)for(const h in i)(!e||!nt(e,h))&&(delete i[h],c=!0)}c&&dr(n.attrs,"set","")}function OI(n,e,t,s){const[r,i]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(Ql(l))continue;const c=e[l];let u;r&&nt(r,u=hs(l))?!i||!i.includes(u)?t[u]=c:(a||(a={}))[u]=c:lf(n.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(i){const l=Ge(t),c=a||lt;for(let u=0;u<i.length;u++){const h=i[u];t[h]=zm(r,l,h,c[h],n,!nt(c,h))}}return o}function zm(n,e,t,s,r,i){const o=n[t];if(o!=null){const a=nt(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Pe(l)){const{propsDefaults:c}=r;if(t in c)s=c[t];else{const u=ru(r);s=c[t]=l.call(null,e),u()}}else s=l;r.ce&&r.ce._setProp(t,s)}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===$o(t))&&(s=!0))}return s}const zO=new WeakMap;function MI(n,e,t=!1){const s=t?zO:e.propsCache,r=s.get(n);if(r)return r;const i=n.props,o={},a=[];let l=!1;if(!Pe(n)){const u=h=>{l=!0;const[f,p]=MI(h,e,!0);qt(o,f),p&&a.push(...p)};!t&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!i&&!l)return it(n)&&s.set(n,pa),pa;if(we(i))for(let u=0;u<i.length;u++){const h=hs(i[u]);ew(h)&&(o[h]=lt)}else if(i)for(const u in i){const h=hs(u);if(ew(h)){const f=i[u],p=o[h]=we(f)||Pe(f)?{type:f}:qt({},f),m=p.type;let _=!1,v=!0;if(we(m))for(let I=0;I<m.length;++I){const O=m[I],P=Pe(O)&&O.name;if(P==="Boolean"){_=!0;break}else P==="String"&&(v=!1)}else _=Pe(m)&&m.name==="Boolean";p[0]=_,p[1]=v,(_||nt(p,"default"))&&a.push(h)}}const c=[o,a];return it(n)&&s.set(n,c),c}function ew(n){return n[0]!=="$"&&!Ql(n)}const DI=n=>n[0]==="_"||n==="$stable",k_=n=>we(n)?n.map(Vs):[Vs(n)],HO=(n,e,t)=>{if(e._n)return e;const s=Z((...r)=>k_(e(...r)),t);return s._c=!1,s},LI=(n,e,t)=>{const s=n._ctx;for(const r in n){if(DI(r))continue;const i=n[r];if(Pe(i))e[r]=HO(r,i,s);else if(i!=null){const o=k_(i);e[r]=()=>o}}},VI=(n,e)=>{const t=k_(e);n.slots.default=()=>t},FI=(n,e,t)=>{for(const s in e)(t||s!=="_")&&(n[s]=e[s])},WO=(n,e,t)=>{const s=n.slots=xI();if(n.vnode.shapeFlag&32){const r=e._;r?(FI(s,e,t),t&&jS(s,"_",r,!0)):LI(e,s)}else e&&VI(n,e)},qO=(n,e,t)=>{const{vnode:s,slots:r}=n;let i=!0,o=lt;if(s.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:FI(r,e,t):(i=!e.$stable,LI(e,r)),o=e}else e&&(VI(n,e),o={default:1});if(i)for(const a in r)!DI(a)&&o[a]==null&&delete r[a]},Kn=aM;function KO(n){return GO(n)}function GO(n,e){const t=Qd();t.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:f,setScopeId:p=Us,insertStaticContent:m}=n,_=(R,N,L,H=null,J=null,K=null,le=void 0,ie=null,re=!!N.dynamicChildren)=>{if(R===N)return;R&&!ro(R,N)&&(H=z(R),pt(R,J,K,!0),R=null),N.patchFlag===-2&&(re=!1,N.dynamicChildren=null);const{type:ee,ref:Te,shapeFlag:ue}=N;switch(ee){case cf:v(R,N,L,H);break;case An:I(R,N,L,H);break;case yh:R==null&&O(N,L,H,le);break;case rt:k(R,N,L,H,J,K,le,ie,re);break;default:ue&1?B(R,N,L,H,J,K,le,ie,re):ue&6?b(R,N,L,H,J,K,le,ie,re):(ue&64||ue&128)&&ee.process(R,N,L,H,J,K,le,ie,re,_e)}Te!=null&&J&&zh(Te,R&&R.ref,K,N||R,!N)},v=(R,N,L,H)=>{if(R==null)s(N.el=a(N.children),L,H);else{const J=N.el=R.el;N.children!==R.children&&c(J,N.children)}},I=(R,N,L,H)=>{R==null?s(N.el=l(N.children||""),L,H):N.el=R.el},O=(R,N,L,H)=>{[R.el,R.anchor]=m(R.children,N,L,H,R.el,R.anchor)},P=({el:R,anchor:N},L,H)=>{let J;for(;R&&R!==N;)J=f(R),s(R,L,H),R=J;s(N,L,H)},D=({el:R,anchor:N})=>{let L;for(;R&&R!==N;)L=f(R),r(R),R=L;r(N)},B=(R,N,L,H,J,K,le,ie,re)=>{N.type==="svg"?le="svg":N.type==="math"&&(le="mathml"),R==null?M(N,L,H,J,K,le,ie,re):E(R,N,J,K,le,ie,re)},M=(R,N,L,H,J,K,le,ie)=>{let re,ee;const{props:Te,shapeFlag:ue,transition:ve,dirs:Ae}=R;if(re=R.el=o(R.type,K,Te&&Te.is,Te),ue&8?u(re,R.children):ue&16&&T(R.children,re,null,H,J,Vp(R,K),le,ie),Ae&&Ji(R,null,H,"created"),A(re,R,R.scopeId,le,H),Te){for(const Me in Te)Me!=="value"&&!Ql(Me)&&i(re,Me,null,Te[Me],K,H);"value"in Te&&i(re,"value",null,Te.value,K),(ee=Te.onVnodeBeforeMount)&&Os(ee,H,R)}Ae&&Ji(R,null,H,"beforeMount");const Se=QO(J,ve);Se&&ve.beforeEnter(re),s(re,N,L),((ee=Te&&Te.onVnodeMounted)||Se||Ae)&&Kn(()=>{ee&&Os(ee,H,R),Se&&ve.enter(re),Ae&&Ji(R,null,H,"mounted")},J)},A=(R,N,L,H,J)=>{if(L&&p(R,L),H)for(let K=0;K<H.length;K++)p(R,H[K]);if(J){let K=J.subTree;if(N===K||zI(K.type)&&(K.ssContent===N||K.ssFallback===N)){const le=J.vnode;A(R,le,le.scopeId,le.slotScopeIds,J.parent)}}},T=(R,N,L,H,J,K,le,ie,re=0)=>{for(let ee=re;ee<R.length;ee++){const Te=R[ee]=ie?Wr(R[ee]):Vs(R[ee]);_(null,Te,N,L,H,J,K,le,ie)}},E=(R,N,L,H,J,K,le)=>{const ie=N.el=R.el;let{patchFlag:re,dynamicChildren:ee,dirs:Te}=N;re|=R.patchFlag&16;const ue=R.props||lt,ve=N.props||lt;let Ae;if(L&&Yi(L,!1),(Ae=ve.onVnodeBeforeUpdate)&&Os(Ae,L,N,R),Te&&Ji(N,R,L,"beforeUpdate"),L&&Yi(L,!0),(ue.innerHTML&&ve.innerHTML==null||ue.textContent&&ve.textContent==null)&&u(ie,""),ee?C(R.dynamicChildren,ee,ie,L,H,Vp(N,J),K):le||te(R,N,ie,null,L,H,Vp(N,J),K,!1),re>0){if(re&16)x(ie,ue,ve,L,J);else if(re&2&&ue.class!==ve.class&&i(ie,"class",null,ve.class,J),re&4&&i(ie,"style",ue.style,ve.style,J),re&8){const Se=N.dynamicProps;for(let Me=0;Me<Se.length;Me++){const qe=Se[Me],rn=ue[qe],Gt=ve[qe];(Gt!==rn||qe==="value")&&i(ie,qe,rn,Gt,J,L)}}re&1&&R.children!==N.children&&u(ie,N.children)}else!le&&ee==null&&x(ie,ue,ve,L,J);((Ae=ve.onVnodeUpdated)||Te)&&Kn(()=>{Ae&&Os(Ae,L,N,R),Te&&Ji(N,R,L,"updated")},H)},C=(R,N,L,H,J,K,le)=>{for(let ie=0;ie<N.length;ie++){const re=R[ie],ee=N[ie],Te=re.el&&(re.type===rt||!ro(re,ee)||re.shapeFlag&70)?h(re.el):L;_(re,ee,Te,null,H,J,K,le,!0)}},x=(R,N,L,H,J)=>{if(N!==L){if(N!==lt)for(const K in N)!Ql(K)&&!(K in L)&&i(R,K,N[K],null,J,H);for(const K in L){if(Ql(K))continue;const le=L[K],ie=N[K];le!==ie&&K!=="value"&&i(R,K,ie,le,J,H)}"value"in L&&i(R,"value",N.value,L.value,J)}},k=(R,N,L,H,J,K,le,ie,re)=>{const ee=N.el=R?R.el:a(""),Te=N.anchor=R?R.anchor:a("");let{patchFlag:ue,dynamicChildren:ve,slotScopeIds:Ae}=N;Ae&&(ie=ie?ie.concat(Ae):Ae),R==null?(s(ee,L,H),s(Te,L,H),T(N.children||[],L,Te,J,K,le,ie,re)):ue>0&&ue&64&&ve&&R.dynamicChildren?(C(R.dynamicChildren,ve,L,J,K,le,ie),(N.key!=null||J&&N===J.subTree)&&BI(R,N,!0)):te(R,N,L,Te,J,K,le,ie,re)},b=(R,N,L,H,J,K,le,ie,re)=>{N.slotScopeIds=ie,R==null?N.shapeFlag&512?J.ctx.activate(N,L,H,le,re):ye(N,L,H,J,K,le,re):Ve(R,N,re)},ye=(R,N,L,H,J,K,le)=>{const ie=R.component=pM(R,H,J);if(rf(R)&&(ie.ctx.renderer=_e),mM(ie,!1,le),ie.asyncDep){if(J&&J.registerDep(ie,We,le),!R.el){const re=ie.subTree=F(An);I(null,re,N,L)}}else We(ie,R,N,L,J,K,le)},Ve=(R,N,L)=>{const H=N.component=R.component;if(iM(R,N,L))if(H.asyncDep&&!H.asyncResolved){j(H,N,L);return}else H.next=N,H.update();else N.el=R.el,H.vnode=N},We=(R,N,L,H,J,K,le)=>{const ie=()=>{if(R.isMounted){let{next:ue,bu:ve,u:Ae,parent:Se,vnode:Me}=R;{const on=$I(R);if(on){ue&&(ue.el=Me.el,j(R,ue,le)),on.asyncDep.then(()=>{R.isUnmounted||ie()});return}}let qe=ue,rn;Yi(R,!1),ue?(ue.el=Me.el,j(R,ue,le)):ue=Me,ve&&_h(ve),(rn=ue.props&&ue.props.onVnodeBeforeUpdate)&&Os(rn,Se,ue,Me),Yi(R,!0);const Gt=nw(R),ts=R.subTree;R.subTree=Gt,_(ts,Gt,h(ts.el),z(ts),R,J,K),ue.el=Gt.el,qe===null&&oM(R,Gt.el),Ae&&Kn(Ae,J),(rn=ue.props&&ue.props.onVnodeUpdated)&&Kn(()=>Os(rn,Se,ue,Me),J)}else{let ue;const{el:ve,props:Ae}=N,{bm:Se,m:Me,parent:qe,root:rn,type:Gt}=R,ts=_a(N);Yi(R,!1),Se&&_h(Se),!ts&&(ue=Ae&&Ae.onVnodeBeforeMount)&&Os(ue,qe,N),Yi(R,!0);{rn.ce&&rn.ce._injectChildStyle(Gt);const on=R.subTree=nw(R);_(null,on,L,H,R,J,K),N.el=on.el}if(Me&&Kn(Me,J),!ts&&(ue=Ae&&Ae.onVnodeMounted)){const on=N;Kn(()=>Os(ue,qe,on),J)}(N.shapeFlag&256||qe&&_a(qe.vnode)&&qe.vnode.shapeFlag&256)&&R.a&&Kn(R.a,J),R.isMounted=!0,N=L=H=null}};R.scope.on();const re=R.effect=new GS(ie);R.scope.off();const ee=R.update=re.run.bind(re),Te=R.job=re.runIfDirty.bind(re);Te.i=R,Te.id=R.uid,re.scheduler=()=>E_(Te),Yi(R,!0),ee()},j=(R,N,L)=>{N.component=R;const H=R.vnode.props;R.vnode=N,R.next=null,jO(R,N.props,H,L),qO(R,N.children,L),Ni(),Kb(R),Oi()},te=(R,N,L,H,J,K,le,ie,re=!1)=>{const ee=R&&R.children,Te=R?R.shapeFlag:0,ue=N.children,{patchFlag:ve,shapeFlag:Ae}=N;if(ve>0){if(ve&128){Qe(ee,ue,L,H,J,K,le,ie,re);return}else if(ve&256){Re(ee,ue,L,H,J,K,le,ie,re);return}}Ae&8?(Te&16&&Fn(ee,J,K),ue!==ee&&u(L,ue)):Te&16?Ae&16?Qe(ee,ue,L,H,J,K,le,ie,re):Fn(ee,J,K,!0):(Te&8&&u(L,""),Ae&16&&T(ue,L,H,J,K,le,ie,re))},Re=(R,N,L,H,J,K,le,ie,re)=>{R=R||pa,N=N||pa;const ee=R.length,Te=N.length,ue=Math.min(ee,Te);let ve;for(ve=0;ve<ue;ve++){const Ae=N[ve]=re?Wr(N[ve]):Vs(N[ve]);_(R[ve],Ae,L,null,J,K,le,ie,re)}ee>Te?Fn(R,J,K,!0,!1,ue):T(N,L,H,J,K,le,ie,re,ue)},Qe=(R,N,L,H,J,K,le,ie,re)=>{let ee=0;const Te=N.length;let ue=R.length-1,ve=Te-1;for(;ee<=ue&&ee<=ve;){const Ae=R[ee],Se=N[ee]=re?Wr(N[ee]):Vs(N[ee]);if(ro(Ae,Se))_(Ae,Se,L,null,J,K,le,ie,re);else break;ee++}for(;ee<=ue&&ee<=ve;){const Ae=R[ue],Se=N[ve]=re?Wr(N[ve]):Vs(N[ve]);if(ro(Ae,Se))_(Ae,Se,L,null,J,K,le,ie,re);else break;ue--,ve--}if(ee>ue){if(ee<=ve){const Ae=ve+1,Se=Ae<Te?N[Ae].el:H;for(;ee<=ve;)_(null,N[ee]=re?Wr(N[ee]):Vs(N[ee]),L,Se,J,K,le,ie,re),ee++}}else if(ee>ve)for(;ee<=ue;)pt(R[ee],J,K,!0),ee++;else{const Ae=ee,Se=ee,Me=new Map;for(ee=Se;ee<=ve;ee++){const Qt=N[ee]=re?Wr(N[ee]):Vs(N[ee]);Qt.key!=null&&Me.set(Qt.key,ee)}let qe,rn=0;const Gt=ve-Se+1;let ts=!1,on=0;const Mr=new Array(Gt);for(ee=0;ee<Gt;ee++)Mr[ee]=0;for(ee=Ae;ee<=ue;ee++){const Qt=R[ee];if(rn>=Gt){pt(Qt,J,K,!0);continue}let ns;if(Qt.key!=null)ns=Me.get(Qt.key);else for(qe=Se;qe<=ve;qe++)if(Mr[qe-Se]===0&&ro(Qt,N[qe])){ns=qe;break}ns===void 0?pt(Qt,J,K,!0):(Mr[ns-Se]=ee+1,ns>=on?on=ns:ts=!0,_(Qt,N[ns],L,null,J,K,le,ie,re),rn++)}const ul=ts?JO(Mr):pa;for(qe=ul.length-1,ee=Gt-1;ee>=0;ee--){const Qt=Se+ee,ns=N[Qt],Au=Qt+1<Te?N[Qt+1].el:H;Mr[ee]===0?_(null,ns,L,Au,J,K,le,ie,re):ts&&(qe<0||ee!==ul[qe]?ht(ns,L,Au,2):qe--)}}},ht=(R,N,L,H,J=null)=>{const{el:K,type:le,transition:ie,children:re,shapeFlag:ee}=R;if(ee&6){ht(R.component.subTree,N,L,H);return}if(ee&128){R.suspense.move(N,L,H);return}if(ee&64){le.move(R,N,L,_e);return}if(le===rt){s(K,N,L);for(let ue=0;ue<re.length;ue++)ht(re[ue],N,L,H);s(R.anchor,N,L);return}if(le===yh){P(R,N,L);return}if(H!==2&&ee&1&&ie)if(H===0)ie.beforeEnter(K),s(K,N,L),Kn(()=>ie.enter(K),J);else{const{leave:ue,delayLeave:ve,afterLeave:Ae}=ie,Se=()=>s(K,N,L),Me=()=>{ue(K,()=>{Se(),Ae&&Ae()})};ve?ve(K,Se,Me):Me()}else s(K,N,L)},pt=(R,N,L,H=!1,J=!1)=>{const{type:K,props:le,ref:ie,children:re,dynamicChildren:ee,shapeFlag:Te,patchFlag:ue,dirs:ve,cacheIndex:Ae}=R;if(ue===-2&&(J=!1),ie!=null&&zh(ie,null,L,R,!0),Ae!=null&&(N.renderCache[Ae]=void 0),Te&256){N.ctx.deactivate(R);return}const Se=Te&1&&ve,Me=!_a(R);let qe;if(Me&&(qe=le&&le.onVnodeBeforeUnmount)&&Os(qe,N,R),Te&6)Ns(R.component,L,H);else{if(Te&128){R.suspense.unmount(L,H);return}Se&&Ji(R,null,N,"beforeUnmount"),Te&64?R.type.remove(R,N,L,_e,H):ee&&!ee.hasOnce&&(K!==rt||ue>0&&ue&64)?Fn(ee,N,L,!1,!0):(K===rt&&ue&384||!J&&Te&16)&&Fn(re,N,L),H&&vt(R)}(Me&&(qe=le&&le.onVnodeUnmounted)||Se)&&Kn(()=>{qe&&Os(qe,N,R),Se&&Ji(R,null,N,"unmounted")},L)},vt=R=>{const{type:N,el:L,anchor:H,transition:J}=R;if(N===rt){Or(L,H);return}if(N===yh){D(R);return}const K=()=>{r(L),J&&!J.persisted&&J.afterLeave&&J.afterLeave()};if(R.shapeFlag&1&&J&&!J.persisted){const{leave:le,delayLeave:ie}=J,re=()=>le(L,K);ie?ie(R.el,K,re):re()}else K()},Or=(R,N)=>{let L;for(;R!==N;)L=f(R),r(R),R=L;r(N)},Ns=(R,N,L)=>{const{bum:H,scope:J,job:K,subTree:le,um:ie,m:re,a:ee}=R;tw(re),tw(ee),H&&_h(H),J.stop(),K&&(K.flags|=8,pt(le,R,N,L)),ie&&Kn(ie,N),Kn(()=>{R.isUnmounted=!0},N),N&&N.pendingBranch&&!N.isUnmounted&&R.asyncDep&&!R.asyncResolved&&R.suspenseId===N.pendingId&&(N.deps--,N.deps===0&&N.resolve())},Fn=(R,N,L,H=!1,J=!1,K=0)=>{for(let le=K;le<R.length;le++)pt(R[le],N,L,H,J)},z=R=>{if(R.shapeFlag&6)return z(R.component.subTree);if(R.shapeFlag&128)return R.suspense.next();const N=f(R.anchor||R.el),L=N&&N[gO];return L?f(L):N};let fe=!1;const ce=(R,N,L)=>{R==null?N._vnode&&pt(N._vnode,null,null,!0):_(N._vnode||null,R,N,null,null,null,L),N._vnode=R,fe||(fe=!0,Kb(),mI(),fe=!1)},_e={p:_,um:pt,m:ht,r:vt,mt:ye,mc:T,pc:te,pbc:C,n:z,o:n};return{render:ce,hydrate:void 0,createApp:BO(ce)}}function Vp({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Yi({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function QO(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function BI(n,e,t=!1){const s=n.children,r=e.children;if(we(s)&&we(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=Wr(r[i]),a.el=o.el),!t&&a.patchFlag!==-2&&BI(o,a)),a.type===cf&&(a.el=o.el)}}function JO(n){const e=n.slice(),t=[0];let s,r,i,o,a;const l=n.length;for(s=0;s<l;s++){const c=n[s];if(c!==0){if(r=t[t.length-1],n[r]<c){e[s]=r,t.push(s);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<c?i=a+1:o=a;c<n[t[i]]&&(i>0&&(e[s]=t[i-1]),t[i]=s)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function $I(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:$I(e)}function tw(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const YO=Symbol.for("v-scx"),XO=()=>xn(YO);function ZO(n,e){return A_(n,null,e)}function js(n,e,t){return A_(n,e,t)}function A_(n,e,t=lt){const{immediate:s,deep:r,flush:i,once:o}=t,a=qt({},t),l=e&&s||!e&&i!=="post";let c;if(Sc){if(i==="sync"){const p=XO();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=Us,p.resume=Us,p.pause=Us,p}}const u=zt;a.call=(p,m,_)=>Is(p,u,m,_);let h=!1;i==="post"?a.scheduler=p=>{Kn(p,u&&u.suspense)}:i!=="sync"&&(h=!0,a.scheduler=(p,m)=>{m?p():E_(p)}),a.augmentJob=p=>{e&&(p.flags|=4),h&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const f=dO(n,e,a);return Sc&&(c?c.push(f):l&&f()),f}function eM(n,e,t){const s=this.proxy,r=At(n)?n.includes(".")?UI(s,n):()=>s[n]:n.bind(s,s);let i;Pe(e)?i=e:(i=e.handler,t=e);const o=ru(this),a=A_(r,i.bind(s),t);return o(),a}function UI(n,e){const t=e.split(".");return()=>{let s=n;for(let r=0;r<t.length&&s;r++)s=s[t[r]];return s}}const tM=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${hs(e)}Modifiers`]||n[`${$o(e)}Modifiers`];function nM(n,e,...t){if(n.isUnmounted)return;const s=n.vnode.props||lt;let r=t;const i=e.startsWith("update:"),o=i&&tM(s,e.slice(7));o&&(o.trim&&(r=t.map(u=>At(u)?u.trim():u)),o.number&&(r=t.map(Mm)));let a,l=s[a=Pp(e)]||s[a=Pp(hs(e))];!l&&i&&(l=s[a=Pp($o(e))]),l&&Is(l,n,6,r);const c=s[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Is(c,n,6,r)}}function jI(n,e,t=!1){const s=e.emitsCache,r=s.get(n);if(r!==void 0)return r;const i=n.emits;let o={},a=!1;if(!Pe(n)){const l=c=>{const u=jI(c,e,!0);u&&(a=!0,qt(o,u))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?(it(n)&&s.set(n,null),null):(we(i)?i.forEach(l=>o[l]=null):qt(o,i),it(n)&&s.set(n,o),o)}function lf(n,e){return!n||!Wd(e)?!1:(e=e.slice(2).replace(/Once$/,""),nt(n,e[0].toLowerCase()+e.slice(1))||nt(n,$o(e))||nt(n,e))}function nw(n){const{type:e,vnode:t,proxy:s,withProxy:r,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:h,data:f,setupState:p,ctx:m,inheritAttrs:_}=n,v=jh(n);let I,O;try{if(t.shapeFlag&4){const D=r||s,B=D;I=Vs(c.call(B,D,u,h,p,f,m)),O=a}else{const D=e;I=Vs(D.length>1?D(h,{attrs:a,slots:o,emit:l}):D(h,null)),O=e.props?a:sM(a)}}catch(D){ec.length=0,sf(D,n,1),I=F(An)}let P=I;if(O&&_!==!1){const D=Object.keys(O),{shapeFlag:B}=P;D.length&&B&7&&(i&&D.some(h_)&&(O=rM(O,i)),P=_i(P,O,!1,!0))}return t.dirs&&(P=_i(P,null,!1,!0),P.dirs=P.dirs?P.dirs.concat(t.dirs):t.dirs),t.transition&&wc(P,t.transition),I=P,jh(v),I}const sM=n=>{let e;for(const t in n)(t==="class"||t==="style"||Wd(t))&&((e||(e={}))[t]=n[t]);return e},rM=(n,e)=>{const t={};for(const s in n)(!h_(s)||!(s.slice(9)in e))&&(t[s]=n[s]);return t};function iM(n,e,t){const{props:s,children:r,component:i}=n,{props:o,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return s?sw(s,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const f=u[h];if(o[f]!==s[f]&&!lf(c,f))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?sw(s,o,c):!0:!!o;return!1}function sw(n,e,t){const s=Object.keys(e);if(s.length!==Object.keys(n).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==n[i]&&!lf(t,i))return!0}return!1}function oM({vnode:n,parent:e},t){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===n&&(s.el=n.el),s===n)(n=e.vnode).el=t,e=e.parent;else break}}const zI=n=>n.__isSuspense;function aM(n,e){e&&e.pendingBranch?we(n)?e.effects.push(...n):e.effects.push(n):mO(n)}const rt=Symbol.for("v-fgt"),cf=Symbol.for("v-txt"),An=Symbol.for("v-cmt"),yh=Symbol.for("v-stc"),ec=[];let Jn=null;function $(n=!1){ec.push(Jn=n?null:[])}function lM(){ec.pop(),Jn=ec[ec.length-1]||null}let Ec=1;function rw(n,e=!1){Ec+=n,n<0&&Jn&&e&&(Jn.hasOnce=!0)}function HI(n){return n.dynamicChildren=Ec>0?Jn||pa:null,lM(),Ec>0&&Jn&&Jn.push(n),n}function W(n,e,t,s,r,i){return HI(w(n,e,t,s,r,i,!0))}function bt(n,e,t,s,r){return HI(F(n,e,t,s,r,!0))}function Tc(n){return n?n.__v_isVNode===!0:!1}function ro(n,e){return n.type===e.type&&n.key===e.key}const WI=({key:n})=>n??null,vh=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?At(n)||ut(n)||Pe(n)?{i:Vt,r:n,k:e,f:!!t}:n:null);function w(n,e=null,t=null,s=0,r=null,i=n===rt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&WI(e),ref:e&&vh(e),scopeId:_I,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Vt};return a?(R_(l,t),i&128&&n.normalize(l)):t&&(l.shapeFlag|=At(t)?8:16),Ec>0&&!o&&Jn&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Jn.push(l),l}const F=cM;function cM(n,e=null,t=null,s=0,r=null,i=!1){if((!n||n===PO)&&(n=An),Tc(n)){const a=_i(n,e,!0);return t&&R_(a,t),Ec>0&&!i&&Jn&&(a.shapeFlag&6?Jn[Jn.indexOf(n)]=a:Jn.push(a)),a.patchFlag=-2,a}if(bM(n)&&(n=n.__vccOpts),e){e=uM(e);let{class:a,style:l}=e;a&&!At(a)&&(e.class=is(a)),it(l)&&(w_(l)&&!we(l)&&(l=qt({},l)),e.style=Jd(l))}const o=At(n)?1:zI(n)?128:yI(n)?64:it(n)?4:Pe(n)?2:0;return w(n,e,t,s,r,o,i,!0)}function uM(n){return n?w_(n)||NI(n)?qt({},n):n:null}function _i(n,e,t=!1,s=!1){const{props:r,ref:i,patchFlag:o,children:a,transition:l}=n,c=e?qI(r||{},e):r,u={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&WI(c),ref:e&&e.ref?t&&i?we(i)?i.concat(vh(e)):[i,vh(e)]:vh(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==rt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&_i(n.ssContent),ssFallback:n.ssFallback&&_i(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&s&&wc(u,l.clone(u)),u}function ne(n=" ",e=0){return F(cf,null,n,e)}function hM(n,e){const t=F(yh,null,n);return t.staticCount=e,t}function de(n="",e=!1){return e?($(),bt(An,null,n)):F(An,null,n)}function Vs(n){return n==null||typeof n=="boolean"?F(An):we(n)?F(rt,null,n.slice()):Tc(n)?Wr(n):F(cf,null,String(n))}function Wr(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:_i(n)}function R_(n,e){let t=0;const{shapeFlag:s}=n;if(e==null)e=null;else if(we(e))t=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),R_(n,r()),r._c&&(r._d=!0));return}else{t=32;const r=e._;!r&&!NI(e)?e._ctx=Vt:r===3&&Vt&&(Vt.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Pe(e)?(e={default:e,_ctx:Vt},t=32):(e=String(e),s&64?(t=16,e=[ne(e)]):t=8);n.children=e,n.shapeFlag|=t}function qI(...n){const e={};for(let t=0;t<n.length;t++){const s=n[t];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=is([e.class,s.class]));else if(r==="style")e.style=Jd([e.style,s.style]);else if(Wd(r)){const i=e[r],o=s[r];o&&i!==o&&!(we(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function Os(n,e,t,s=null){Is(n,e,7,[t,s])}const dM=RI();let fM=0;function pM(n,e,t){const s=n.type,r=(e?e.appContext:n.appContext)||dM,i={uid:fM++,vnode:n,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new KS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:MI(s,r),emitsOptions:jI(s,r),emit:null,emitted:null,propsDefaults:lt,inheritAttrs:s.inheritAttrs,ctx:lt,data:lt,props:lt,attrs:lt,slots:lt,refs:lt,setupState:lt,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=nM.bind(null,i),n.ce&&n.ce(i),i}let zt=null;const su=()=>zt||Vt;let Wh,Hm;{const n=Qd(),e=(t,s)=>{let r;return(r=n[t])||(r=n[t]=[]),r.push(s),i=>{r.length>1?r.forEach(o=>o(i)):r[0](i)}};Wh=e("__VUE_INSTANCE_SETTERS__",t=>zt=t),Hm=e("__VUE_SSR_SETTERS__",t=>Sc=t)}const ru=n=>{const e=zt;return Wh(n),n.scope.on(),()=>{n.scope.off(),Wh(e)}},iw=()=>{zt&&zt.scope.off(),Wh(null)};function KI(n){return n.vnode.shapeFlag&4}let Sc=!1;function mM(n,e=!1,t=!1){e&&Hm(e);const{props:s,children:r}=n.vnode,i=KI(n);UO(n,s,i,e),WO(n,r,t);const o=i?gM(n,e):void 0;return e&&Hm(!1),o}function gM(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,NO);const{setup:s}=t;if(s){Ni();const r=n.setupContext=s.length>1?yM(n):null,i=ru(n),o=nu(s,n,0,[n.props,r]),a=BS(o);if(Oi(),i(),(a||n.sp)&&!_a(n)&&SI(n),a){if(o.then(iw,iw),e)return o.then(l=>{ow(n,l)}).catch(l=>{sf(l,n,0)});n.asyncDep=o}else ow(n,o)}else GI(n)}function ow(n,e,t){Pe(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:it(e)&&(n.setupState=hI(e)),GI(n)}function GI(n,e,t){const s=n.type;n.render||(n.render=s.render||Us);{const r=ru(n);Ni();try{OO(n)}finally{Oi(),r()}}}const _M={get(n,e){return fn(n,"get",""),n[e]}};function yM(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,_M),slots:n.slots,emit:n.emit,expose:e}}function uf(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(hI(tf(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Xl)return Xl[t](n)},has(e,t){return t in e||t in Xl}})):n.proxy}function vM(n,e=!0){return Pe(n)?n.displayName||n.name:n.name||e&&n.__name}function bM(n){return Pe(n)&&"__vccOpts"in n}const et=(n,e)=>uO(n,e,Sc);function hf(n,e,t){const s=arguments.length;return s===2?it(e)&&!we(e)?Tc(e)?F(n,null,[e]):F(n,e):F(n,null,e):(s>3?t=Array.prototype.slice.call(arguments,2):s===3&&Tc(t)&&(t=[t]),F(n,e,t))}const wM="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Wm;const aw=typeof window<"u"&&window.trustedTypes;if(aw)try{Wm=aw.createPolicy("vue",{createHTML:n=>n})}catch{}const QI=Wm?n=>Wm.createHTML(n):n=>n,EM="http://www.w3.org/2000/svg",TM="http://www.w3.org/1998/Math/MathML",ur=typeof document<"u"?document:null,lw=ur&&ur.createElement("template"),SM={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,s)=>{const r=e==="svg"?ur.createElementNS(EM,n):e==="mathml"?ur.createElementNS(TM,n):t?ur.createElement(n,{is:t}):ur.createElement(n);return n==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:n=>ur.createTextNode(n),createComment:n=>ur.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>ur.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,s,r,i){const o=t?t.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),t),!(r===i||!(r=r.nextSibling)););else{lw.innerHTML=QI(s==="svg"?`<svg>${n}</svg>`:s==="mathml"?`<math>${n}</math>`:n);const a=lw.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Fr="transition",Sl="animation",Ic=Symbol("_vtc"),JI={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},IM=qt({},vI,JI),CM=n=>(n.displayName="Transition",n.props=IM,n),iu=CM((n,{slots:e})=>hf(vO,kM(n),e)),Xi=(n,e=[])=>{we(n)?n.forEach(t=>t(...e)):n&&n(...e)},cw=n=>n?we(n)?n.some(e=>e.length>1):n.length>1:!1;function kM(n){const e={};for(const k in n)k in JI||(e[k]=n[k]);if(n.css===!1)return e;const{name:t="v",type:s,duration:r,enterFromClass:i=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=i,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:h=`${t}-leave-from`,leaveActiveClass:f=`${t}-leave-active`,leaveToClass:p=`${t}-leave-to`}=n,m=AM(r),_=m&&m[0],v=m&&m[1],{onBeforeEnter:I,onEnter:O,onEnterCancelled:P,onLeave:D,onLeaveCancelled:B,onBeforeAppear:M=I,onAppear:A=O,onAppearCancelled:T=P}=e,E=(k,b,ye,Ve)=>{k._enterCancelled=Ve,Zi(k,b?u:a),Zi(k,b?c:o),ye&&ye()},C=(k,b)=>{k._isLeaving=!1,Zi(k,h),Zi(k,p),Zi(k,f),b&&b()},x=k=>(b,ye)=>{const Ve=k?A:O,We=()=>E(b,k,ye);Xi(Ve,[b,We]),uw(()=>{Zi(b,k?l:i),ar(b,k?u:a),cw(Ve)||hw(b,s,_,We)})};return qt(e,{onBeforeEnter(k){Xi(I,[k]),ar(k,i),ar(k,o)},onBeforeAppear(k){Xi(M,[k]),ar(k,l),ar(k,c)},onEnter:x(!1),onAppear:x(!0),onLeave(k,b){k._isLeaving=!0;const ye=()=>C(k,b);ar(k,h),k._enterCancelled?(ar(k,f),pw()):(pw(),ar(k,f)),uw(()=>{k._isLeaving&&(Zi(k,h),ar(k,p),cw(D)||hw(k,s,v,ye))}),Xi(D,[k,ye])},onEnterCancelled(k){E(k,!1,void 0,!0),Xi(P,[k])},onAppearCancelled(k){E(k,!0,void 0,!0),Xi(T,[k])},onLeaveCancelled(k){C(k),Xi(B,[k])}})}function AM(n){if(n==null)return null;if(it(n))return[Fp(n.enter),Fp(n.leave)];{const e=Fp(n);return[e,e]}}function Fp(n){return AN(n)}function ar(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[Ic]||(n[Ic]=new Set)).add(e)}function Zi(n,e){e.split(/\s+/).forEach(s=>s&&n.classList.remove(s));const t=n[Ic];t&&(t.delete(e),t.size||(n[Ic]=void 0))}function uw(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let RM=0;function hw(n,e,t,s){const r=n._endId=++RM,i=()=>{r===n._endId&&s()};if(t!=null)return setTimeout(i,t);const{type:o,timeout:a,propCount:l}=PM(n,e);if(!o)return s();const c=o+"end";let u=0;const h=()=>{n.removeEventListener(c,f),i()},f=p=>{p.target===n&&++u>=l&&h()};setTimeout(()=>{u<l&&h()},a+1),n.addEventListener(c,f)}function PM(n,e){const t=window.getComputedStyle(n),s=m=>(t[m]||"").split(", "),r=s(`${Fr}Delay`),i=s(`${Fr}Duration`),o=dw(r,i),a=s(`${Sl}Delay`),l=s(`${Sl}Duration`),c=dw(a,l);let u=null,h=0,f=0;e===Fr?o>0&&(u=Fr,h=o,f=i.length):e===Sl?c>0&&(u=Sl,h=c,f=l.length):(h=Math.max(o,c),u=h>0?o>c?Fr:Sl:null,f=u?u===Fr?i.length:l.length:0);const p=u===Fr&&/\b(transform|all)(,|$)/.test(s(`${Fr}Property`).toString());return{type:u,timeout:h,propCount:f,hasTransform:p}}function dw(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,s)=>fw(t)+fw(n[s])))}function fw(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function pw(){return document.body.offsetHeight}function xM(n,e,t){const s=n[Ic];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const qh=Symbol("_vod"),YI=Symbol("_vsh"),NM={beforeMount(n,{value:e},{transition:t}){n[qh]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):Il(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:s}){!e!=!t&&(s?e?(s.beforeEnter(n),Il(n,!0),s.enter(n)):s.leave(n,()=>{Il(n,!1)}):Il(n,e))},beforeUnmount(n,{value:e}){Il(n,e)}};function Il(n,e){n.style.display=e?n[qh]:"none",n[YI]=!e}const OM=Symbol(""),MM=/(^|;)\s*display\s*:/;function DM(n,e,t){const s=n.style,r=At(t);let i=!1;if(t&&!r){if(e)if(At(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&bh(s,a,"")}else for(const o in e)t[o]==null&&bh(s,o,"");for(const o in t)o==="display"&&(i=!0),bh(s,o,t[o])}else if(r){if(e!==t){const o=s[OM];o&&(t+=";"+o),s.cssText=t,i=MM.test(t)}}else e&&n.removeAttribute("style");qh in n&&(n[qh]=i?s.display:"",n[YI]&&(s.display="none"))}const mw=/\s*!important$/;function bh(n,e,t){if(we(t))t.forEach(s=>bh(n,e,s));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const s=LM(n,e);mw.test(t)?n.setProperty($o(s),t.replace(mw,""),"important"):n[s]=t}}const gw=["Webkit","Moz","ms"],Bp={};function LM(n,e){const t=Bp[e];if(t)return t;let s=hs(e);if(s!=="filter"&&s in n)return Bp[e]=s;s=Gd(s);for(let r=0;r<gw.length;r++){const i=gw[r]+s;if(i in n)return Bp[e]=i}return e}const _w="http://www.w3.org/1999/xlink";function yw(n,e,t,s,r,i=MN(e)){s&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(_w,e.slice(6,e.length)):n.setAttributeNS(_w,e,t):t==null||i&&!zS(t)?n.removeAttribute(e):n.setAttribute(e,i?"":Ss(t)?String(t):t)}function vw(n,e,t,s,r){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?QI(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=zS(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(r||e)}function io(n,e,t,s){n.addEventListener(e,t,s)}function VM(n,e,t,s){n.removeEventListener(e,t,s)}const bw=Symbol("_vei");function FM(n,e,t,s,r=null){const i=n[bw]||(n[bw]={}),o=i[e];if(s&&o)o.value=s;else{const[a,l]=BM(e);if(s){const c=i[e]=jM(s,r);io(n,a,c,l)}else o&&(VM(n,a,o,l),i[e]=void 0)}}const ww=/(?:Once|Passive|Capture)$/;function BM(n){let e;if(ww.test(n)){e={};let s;for(;s=n.match(ww);)n=n.slice(0,n.length-s[0].length),e[s[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):$o(n.slice(2)),e]}let $p=0;const $M=Promise.resolve(),UM=()=>$p||($M.then(()=>$p=0),$p=Date.now());function jM(n,e){const t=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=t.attached)return;Is(zM(s,t.value),e,5,[s])};return t.value=n,t.attached=UM(),t}function zM(n,e){if(we(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const Ew=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,HM=(n,e,t,s,r,i)=>{const o=r==="svg";e==="class"?xM(n,s,o):e==="style"?DM(n,t,s):Wd(e)?h_(e)||FM(n,e,t,s,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):WM(n,e,s,o))?(vw(n,e,s),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&yw(n,e,s,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!At(s))?vw(n,hs(e),s,i,e):(e==="true-value"?n._trueValue=s:e==="false-value"&&(n._falseValue=s),yw(n,e,s,o))};function WM(n,e,t,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in n&&Ew(e)&&Pe(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=n.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Ew(e)&&At(t)?!1:e in n}const Kh=n=>{const e=n.props["onUpdate:modelValue"]||!1;return we(e)?t=>_h(e,t):e};function qM(n){n.target.composing=!0}function Tw(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ya=Symbol("_assign"),Un={created(n,{modifiers:{lazy:e,trim:t,number:s}},r){n[ya]=Kh(r);const i=s||r.props&&r.props.type==="number";io(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=Mm(a)),n[ya](a)}),t&&io(n,"change",()=>{n.value=n.value.trim()}),e||(io(n,"compositionstart",qM),io(n,"compositionend",Tw),io(n,"change",Tw))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:s,trim:r,number:i}},o){if(n[ya]=Kh(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?Mm(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(s&&e===t||r&&n.value.trim()===l)||(n.value=l))}},Sw={deep:!0,created(n,e,t){n[ya]=Kh(t),io(n,"change",()=>{const s=n._modelValue,r=KM(n),i=n.checked,o=n[ya];if(we(s)){const a=HS(s,r),l=a!==-1;if(i&&!l)o(s.concat(r));else if(!i&&l){const c=[...s];c.splice(a,1),o(c)}}else if(qd(s)){const a=new Set(s);i?a.add(r):a.delete(r),o(a)}else o(XI(n,i))})},mounted:Iw,beforeUpdate(n,e,t){n[ya]=Kh(t),Iw(n,e,t)}};function Iw(n,{value:e,oldValue:t},s){n._modelValue=e;let r;if(we(e))r=HS(e,s.props.value)>-1;else if(qd(e))r=e.has(s.props.value);else{if(e===t)return;r=Yd(e,XI(n,!0))}n.checked!==r&&(n.checked=r)}function KM(n){return"_value"in n?n._value:n.value}function XI(n,e){const t=e?"_trueValue":"_falseValue";return t in n?n[t]:e}const GM=["ctrl","shift","alt","meta"],QM={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>GM.some(t=>n[`${t}Key`]&&!e.includes(t))},Sr=(n,e)=>{const t=n._withMods||(n._withMods={}),s=e.join(".");return t[s]||(t[s]=(r,...i)=>{for(let o=0;o<e.length;o++){const a=QM[e[o]];if(a&&a(r,e))return}return n(r,...i)})},JM=qt({patchProp:HM},SM);let Cw;function YM(){return Cw||(Cw=KO(JM))}const XM=(...n)=>{const e=YM().createApp(...n),{mount:t}=e;return e.mount=s=>{const r=eD(s);if(!r)return;const i=e._component;!Pe(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=t(r,!1,ZM(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function ZM(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function eD(n){return At(n)?document.querySelector(n):n}/*!
 * pinia v3.0.2
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let ZI;const df=n=>ZI=n,eC=Symbol();function qm(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var tc;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(tc||(tc={}));function tD(){const n=p_(!0),e=n.run(()=>G({}));let t=[],s=[];const r=tf({install(i){df(r),r._a=i,i.provide(eC,r),i.config.globalProperties.$pinia=r,s.forEach(o=>t.push(o)),s=[]},use(i){return this._a?t.push(i):s.push(i),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return r}const tC=()=>{};function kw(n,e,t,s=tC){n.push(e);const r=()=>{const i=n.indexOf(e);i>-1&&(n.splice(i,1),s())};return!t&&Xd()&&m_(r),r}function Yo(n,...e){n.slice().forEach(t=>{t(...e)})}const nD=n=>n(),Aw=Symbol(),Up=Symbol();function Km(n,e){n instanceof Map&&e instanceof Map?e.forEach((t,s)=>n.set(s,t)):n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const s=e[t],r=n[t];qm(r)&&qm(s)&&n.hasOwnProperty(t)&&!ut(s)&&!yr(s)?n[t]=Km(r,s):n[t]=s}return n}const sD=Symbol();function rD(n){return!qm(n)||!Object.prototype.hasOwnProperty.call(n,sD)}const{assign:Ur}=Object;function iD(n){return!!(ut(n)&&n.effect)}function oD(n,e,t,s){const{state:r,actions:i,getters:o}=e,a=t.state.value[n];let l;function c(){a||(t.state.value[n]=r?r():{});const u=iO(t.state.value[n]);return Ur(u,i,Object.keys(o||{}).reduce((h,f)=>(h[f]=tf(et(()=>{df(t);const p=t._s.get(n);return o[f].call(p,p)})),h),{}))}return l=nC(n,c,e,t,s,!0),l}function nC(n,e,t={},s,r,i){let o;const a=Ur({actions:{}},t),l={deep:!0};let c,u,h=[],f=[],p;const m=s.state.value[n];!i&&!m&&(s.state.value[n]={}),G({});let _;function v(T){let E;c=u=!1,typeof T=="function"?(T(s.state.value[n]),E={type:tc.patchFunction,storeId:n,events:p}):(Km(s.state.value[n],T),E={type:tc.patchObject,payload:T,storeId:n,events:p});const C=_=Symbol();Mi().then(()=>{_===C&&(c=!0)}),u=!0,Yo(h,E,s.state.value[n])}const I=i?function(){const{state:E}=t,C=E?E():{};this.$patch(x=>{Ur(x,C)})}:tC;function O(){o.stop(),h=[],f=[],s._s.delete(n)}const P=(T,E="")=>{if(Aw in T)return T[Up]=E,T;const C=function(){df(s);const x=Array.from(arguments),k=[],b=[];function ye(j){k.push(j)}function Ve(j){b.push(j)}Yo(f,{args:x,name:C[Up],store:B,after:ye,onError:Ve});let We;try{We=T.apply(this&&this.$id===n?this:B,x)}catch(j){throw Yo(b,j),j}return We instanceof Promise?We.then(j=>(Yo(k,j),j)).catch(j=>(Yo(b,j),Promise.reject(j))):(Yo(k,We),We)};return C[Aw]=!0,C[Up]=E,C},D={_p:s,$id:n,$onAction:kw.bind(null,f),$patch:v,$reset:I,$subscribe(T,E={}){const C=kw(h,T,E.detached,()=>x()),x=o.run(()=>js(()=>s.state.value[n],k=>{(E.flush==="sync"?u:c)&&T({storeId:n,type:tc.direct,events:p},k)},Ur({},l,E)));return C},$dispose:O},B=Ka(D);s._s.set(n,B);const A=(s._a&&s._a.runWithContext||nD)(()=>s._e.run(()=>(o=p_()).run(()=>e({action:P}))));for(const T in A){const E=A[T];if(ut(E)&&!iD(E)||yr(E))i||(m&&rD(E)&&(ut(E)?E.value=m[T]:Km(E,m[T])),s.state.value[n][T]=E);else if(typeof E=="function"){const C=P(E,T);A[T]=C,a.actions[T]=E}}return Ur(B,A),Ur(Ge(B),A),Object.defineProperty(B,"$state",{get:()=>s.state.value[n],set:T=>{v(E=>{Ur(E,T)})}}),s._p.forEach(T=>{Ur(B,o.run(()=>T({store:B,app:s._a,pinia:s,options:a})))}),m&&i&&t.hydrate&&t.hydrate(B.$state,m),c=!0,u=!0,B}/*! #__NO_SIDE_EFFECTS__ */function ou(n,e,t){let s;const r=typeof e=="function";s=r?t:e;function i(o,a){const l=$O();return o=o||(l?xn(eC,null):null),o&&df(o),o=ZI,o._s.has(n)||(r?nC(n,e,s,o):oD(n,s,o)),o._s.get(n)}return i.$id=n,i}function ff(n){const e=Ge(n),t={};for(const s in e){const r=e[s];r.effect?t[s]=et({get:()=>n[s],set(i){n[s]=i}}):(ut(r)||yr(r))&&(t[s]=lO(n,s))}return t}const aD=()=>{};var Rw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se=function(n,e){if(!n)throw Ga(e)},Ga=function(n){return new Error("Firebase Database ("+sC.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},lD=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],o=n[t++],a=n[t++],l=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},pf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(f=64)),s.push(t[u],t[h],t[f],t[p])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(rC(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):lD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const c=r<n.length?t[n.charAt(r)]:64;++r;const h=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||a==null||c==null||h==null)throw new cD;const f=i<<2|a>>4;if(s.push(f),c!==64){const p=a<<4&240|c>>2;if(s.push(p),h!==64){const m=c<<6&192|h;s.push(m)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class cD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const iC=function(n){const e=rC(n);return pf.encodeByteArray(e,!0)},Gh=function(n){return iC(n).replace(/\./g,"")},Qh=function(n){try{return pf.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uD(n){return oC(void 0,n)}function oC(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!hD(t)||(n[t]=oC(n[t],e[t]));return n}function hD(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fD=()=>dD().__FIREBASE_DEFAULTS__,pD=()=>{if(typeof process>"u"||typeof Rw>"u")return;const n=Rw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},mD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Qh(n[1]);return e&&JSON.parse(e)},mf=()=>{try{return aD()||fD()||pD()||mD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},aC=n=>{var e,t;return(t=(e=mf())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},gf=n=>{const e=aC(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},lC=()=>{var n;return(n=mf())===null||n===void 0?void 0:n.config},cC=n=>{var e;return(e=mf())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Gh(JSON.stringify(t)),Gh(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function x_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vn())}function gD(){var n;const e=(n=mf())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _D(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yD(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function uC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vD(){const n=vn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function bD(){return sC.NODE_ADMIN===!0}function wD(){return!gD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function hC(){try{return typeof indexedDB=="object"}catch{return!1}}function ED(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD="FirebaseError";class Zs extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=TD,Object.setPrototypeOf(this,Zs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qa.prototype.create)}}class Qa{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?SD(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Zs(r,a,s)}}function SD(n,e){return n.replace(ID,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const ID=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cc(n){return JSON.parse(n)}function Dt(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=function(n){let e={},t={},s={},r="";try{const i=n.split(".");e=Cc(Qh(i[0])||""),t=Cc(Qh(i[1])||""),r=i[2],s=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:s,signature:r}},CD=function(n){const e=dC(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},kD=function(n){const e=dC(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function ka(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Gm(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Jh(n,e,t){const s={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(s[r]=e.call(t,n[r],r,n));return s}function yi(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],o=e[r];if(Pw(i)&&Pw(o)){if(!yi(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function Pw(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Fl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function Bl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const s=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)s[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)s[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){const f=s[h-3]^s[h-8]^s[h-14]^s[h-16];s[h]=(f<<1|f>>>31)&4294967295}let r=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let h=0;h<80;h++){h<40?h<20?(c=a^i&(o^a),u=1518500249):(c=i^o^a,u=1859775393):h<60?(c=i&o|a&(i|o),u=2400959708):(c=i^o^a,u=3395469782);const f=(r<<5|r>>>27)+c+l+u+s[h]&4294967295;l=a,a=o,o=(i<<30|i>>>2)&4294967295,i=r,r=f}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const s=t-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<t;){if(o===0)for(;r<=s;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[r]>>i&255,++s;return e}}function RD(n,e){const t=new PD(n,e);return t.subscribe.bind(t)}class PD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let r;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");xD(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:s},r.next===void 0&&(r.next=jp),r.error===void 0&&(r.error=jp),r.complete===void 0&&(r.complete=jp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xD(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function jp(){}function N_(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);if(r>=55296&&r<=56319){const i=r-55296;s++,se(s<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(s)-56320;r=65536+(i<<10)+o}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},_f=function(n){let e=0;for(let t=0;t<n.length;t++){const s=n.charCodeAt(t);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(n){return n&&n._delegate?n._delegate:n}class ds{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new Ca;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(DD(e))try{this.getOrInitializeService({instanceIdentifier:to})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=to){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=to){return this.instances.has(e)}getOptions(e=to){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,t){var s;const r=this.normalizeInstanceIdentifier(t),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:MD(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=to){return this.component?this.component.multipleInstances?e:to:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function MD(n){return n===to?void 0:n}function DD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new OD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ze||(ze={}));const VD={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},FD=ze.INFO,BD={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},$D=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=BD[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class au{constructor(e){this.name=e,this._logLevel=FD,this._logHandler=$D,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?VD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...e),this._logHandler(this,ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...e),this._logHandler(this,ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ze.INFO,...e),this._logHandler(this,ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ze.WARN,...e),this._logHandler(this,ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...e),this._logHandler(this,ze.ERROR,...e)}}const UD=(n,e)=>e.some(t=>n instanceof t);let xw,Nw;function jD(){return xw||(xw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function zD(){return Nw||(Nw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const fC=new WeakMap,Qm=new WeakMap,pC=new WeakMap,zp=new WeakMap,O_=new WeakMap;function HD(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(oi(n.result)),r()},o=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&fC.set(t,n)}).catch(()=>{}),O_.set(e,n),e}function WD(n){if(Qm.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Qm.set(n,e)}let Jm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Qm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||pC.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return oi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function qD(n){Jm=n(Jm)}function KD(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Hp(this),e,...t);return pC.set(s,e.sort?e.sort():[e]),oi(s)}:zD().includes(n)?function(...e){return n.apply(Hp(this),e),oi(fC.get(this))}:function(...e){return oi(n.apply(Hp(this),e))}}function GD(n){return typeof n=="function"?KD(n):(n instanceof IDBTransaction&&WD(n),UD(n,jD())?new Proxy(n,Jm):n)}function oi(n){if(n instanceof IDBRequest)return HD(n);if(zp.has(n))return zp.get(n);const e=GD(n);return e!==n&&(zp.set(n,e),O_.set(e,n)),e}const Hp=n=>O_.get(n);function QD(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(n,e),a=oi(o);return s&&o.addEventListener("upgradeneeded",l=>{s(oi(o.result),l.oldVersion,l.newVersion,oi(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const JD=["get","getKey","getAll","getAllKeys","count"],YD=["put","add","delete","clear"],Wp=new Map;function Ow(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Wp.get(e))return Wp.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=YD.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||JD.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),r&&l.done]))[0]};return Wp.set(e,i),i}qD(n=>({...n,get:(e,t,s)=>Ow(e,t)||n.get(e,t,s),has:(e,t)=>!!Ow(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ZD(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function ZD(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ym="@firebase/app",Mw="0.11.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir=new au("@firebase/app"),eL="@firebase/app-compat",tL="@firebase/analytics-compat",nL="@firebase/analytics",sL="@firebase/app-check-compat",rL="@firebase/app-check",iL="@firebase/auth",oL="@firebase/auth-compat",aL="@firebase/database",lL="@firebase/data-connect",cL="@firebase/database-compat",uL="@firebase/functions",hL="@firebase/functions-compat",dL="@firebase/installations",fL="@firebase/installations-compat",pL="@firebase/messaging",mL="@firebase/messaging-compat",gL="@firebase/performance",_L="@firebase/performance-compat",yL="@firebase/remote-config",vL="@firebase/remote-config-compat",bL="@firebase/storage",wL="@firebase/storage-compat",EL="@firebase/firestore",TL="@firebase/vertexai",SL="@firebase/firestore-compat",IL="firebase",CL="11.6.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xm="[DEFAULT]",kL={[Ym]:"fire-core",[eL]:"fire-core-compat",[nL]:"fire-analytics",[tL]:"fire-analytics-compat",[rL]:"fire-app-check",[sL]:"fire-app-check-compat",[iL]:"fire-auth",[oL]:"fire-auth-compat",[aL]:"fire-rtdb",[lL]:"fire-data-connect",[cL]:"fire-rtdb-compat",[uL]:"fire-fn",[hL]:"fire-fn-compat",[dL]:"fire-iid",[fL]:"fire-iid-compat",[pL]:"fire-fcm",[mL]:"fire-fcm-compat",[gL]:"fire-perf",[_L]:"fire-perf-compat",[yL]:"fire-rc",[vL]:"fire-rc-compat",[bL]:"fire-gcs",[wL]:"fire-gcs-compat",[EL]:"fire-fst",[SL]:"fire-fst-compat",[TL]:"fire-vertex","fire-js":"fire-js",[IL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh=new Map,AL=new Map,Zm=new Map;function Dw(n,e){try{n.container.addComponent(e)}catch(t){Ir.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Cs(n){const e=n.name;if(Zm.has(e))return Ir.debug(`There were multiple attempts to register component ${e}.`),!1;Zm.set(e,n);for(const t of Yh.values())Dw(t,n);for(const t of AL.values())Dw(t,n);return!0}function Ya(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Rn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ai=new Qa("app","Firebase",RL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ds("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ai.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di=CL;function mC(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Xm,automaticDataCollectionEnabled:!1},e),r=s.name;if(typeof r!="string"||!r)throw ai.create("bad-app-name",{appName:String(r)});if(t||(t=lC()),!t)throw ai.create("no-options");const i=Yh.get(r);if(i){if(yi(t,i.options)&&yi(s,i.config))return i;throw ai.create("duplicate-app",{appName:r})}const o=new LD(r);for(const l of Zm.values())o.addComponent(l);const a=new PL(t,s,o);return Yh.set(r,a),a}function Xa(n=Xm){const e=Yh.get(n);if(!e&&n===Xm&&lC())return mC();if(!e)throw ai.create("no-app",{appName:n});return e}function Nn(n,e,t){var s;let r=(s=kL[n])!==null&&s!==void 0?s:n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ir.warn(a.join(" "));return}Cs(new ds(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xL="firebase-heartbeat-database",NL=1,kc="firebase-heartbeat-store";let qp=null;function gC(){return qp||(qp=QD(xL,NL,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(kc)}catch(t){console.warn(t)}}}}).catch(n=>{throw ai.create("idb-open",{originalErrorMessage:n.message})})),qp}async function OL(n){try{const t=(await gC()).transaction(kc),s=await t.objectStore(kc).get(_C(n));return await t.done,s}catch(e){if(e instanceof Zs)Ir.warn(e.message);else{const t=ai.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ir.warn(t.message)}}}async function Lw(n,e){try{const s=(await gC()).transaction(kc,"readwrite");await s.objectStore(kc).put(e,_C(n)),await s.done}catch(t){if(t instanceof Zs)Ir.warn(t.message);else{const s=ai.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ir.warn(s.message)}}}function _C(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML=1024,DL=30;class LL{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new FL(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Vw();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>DL){const o=BL(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Ir.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Vw(),{heartbeatsToSend:s,unsentEntries:r}=VL(this._heartbeatsCache.heartbeats),i=Gh(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Ir.warn(t),""}}}function Vw(){return new Date().toISOString().substring(0,10)}function VL(n,e=ML){const t=[];let s=n.slice();for(const r of n){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Fw(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Fw(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class FL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return hC()?ED().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await OL(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return Lw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return Lw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Fw(n){return Gh(JSON.stringify({version:2,heartbeats:n})).length}function BL(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $L(n){Cs(new ds("platform-logger",e=>new XD(e),"PRIVATE")),Cs(new ds("heartbeat",e=>new LL(e),"PRIVATE")),Nn(Ym,Mw,n),Nn(Ym,Mw,"esm2017"),Nn("fire-js","")}$L("");function M_(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t}function yC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const UL=yC,vC=new Qa("auth","Firebase",yC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xh=new au("@firebase/auth");function jL(n,...e){Xh.logLevel<=ze.WARN&&Xh.warn(`Auth (${Di}): ${n}`,...e)}function wh(n,...e){Xh.logLevel<=ze.ERROR&&Xh.error(`Auth (${Di}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(n,...e){throw D_(n,...e)}function zs(n,...e){return D_(n,...e)}function bC(n,e,t){const s=Object.assign(Object.assign({},UL()),{[e]:t});return new Qa("auth","Firebase",s).create(e,{appName:n.name})}function vr(n){return bC(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function D_(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return vC.create(n,...e)}function Ie(n,e,...t){if(!n)throw D_(e,...t)}function pr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw wh(e),new Error(e)}function Cr(n,e){n||pr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function zL(){return Bw()==="http:"||Bw()==="https:"}function Bw(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zL()||yD()||"connection"in navigator)?navigator.onLine:!0}function WL(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Cr(t>e,"Short delay should be less than long delay!"),this.isMobile=x_()||uC()}get(){return HL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(n,e){Cr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;pr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;pr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;pr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],GL=new lu(3e4,6e4);function Li(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Vi(n,e,t,s,r={}){return EC(n,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=Ja(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},i);return _D()||(c.referrerPolicy="no-referrer"),wC.fetch()(await TC(n,n.config.apiHost,t,a),c)})}async function EC(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},qL),e);try{const r=new JL(n),i=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Gu(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gu(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Gu(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Gu(n,"user-disabled",o);const u=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw bC(n,u,c);ks(n,u)}}catch(r){if(r instanceof Zs)throw r;ks(n,"network-request-failed",{message:String(r)})}}async function cu(n,e,t,s,r={}){const i=await Vi(n,e,t,s,r);return"mfaPendingCredential"in i&&ks(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function TC(n,e,t,s){const r=`${e}${t}?${s}`,i=n,o=i.config.emulator?L_(n.config,r):`${n.config.apiScheme}://${r}`;return KL.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function QL(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class JL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(zs(this.auth,"network-request-failed")),GL.get())})}}function Gu(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const r=zs(n,e,s);return r.customData._tokenResponse=t,r}function $w(n){return n!==void 0&&n.enterprise!==void 0}class YL{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return QL(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function XL(n,e){return Vi(n,"GET","/v2/recaptchaConfig",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZL(n,e){return Vi(n,"POST","/v1/accounts:delete",e)}async function Zh(n,e){return Vi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function e2(n,e=!1){const t=Ze(n),s=await t.getIdToken(e),r=V_(s);Ie(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:nc(Kp(r.auth_time)),issuedAtTime:nc(Kp(r.iat)),expirationTime:nc(Kp(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Kp(n){return Number(n)*1e3}function V_(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return wh("JWT malformed, contained fewer than 3 sections"),null;try{const r=Qh(t);return r?JSON.parse(r):(wh("Failed to decode base64 JWT payload"),null)}catch(r){return wh("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function Uw(n){const e=V_(n);return Ie(e,"internal-error"),Ie(typeof e.exp<"u","internal-error"),Ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ac(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof Zs&&t2(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function t2({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=nc(this.lastLoginAt),this.creationTime=nc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ed(n){var e;const t=n.auth,s=await n.getIdToken(),r=await Ac(n,Zh(t,{idToken:s}));Ie(r==null?void 0:r.users.length,t,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?SC(i.providerUserInfo):[],a=r2(n.providerData,o),l=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new tg(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function s2(n){const e=Ze(n);await ed(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function r2(n,e){return[...n.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function SC(n){return n.map(e=>{var{providerId:t}=e,s=M_(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i2(n,e){const t=await EC(n,{},async()=>{const s=Ja({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=n.config,o=await TC(n,r,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",wC.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function o2(n,e){return Vi(n,"POST","/v2/accounts:revokeToken",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ie(e.idToken,"internal-error"),Ie(typeof e.idToken<"u","internal-error"),Ie(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Uw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ie(e.length!==0,"internal-error");const t=Uw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:r,expiresIn:i}=await i2(e,t);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:r,expirationTime:i}=t,o=new va;return s&&(Ie(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(Ie(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(Ie(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new va,this.toJSON())}_performRefresh(){return pr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Br(n,e){Ie(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ys{constructor(e){var{uid:t,auth:s,stsTokenManager:r}=e,i=M_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new n2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new tg(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Ac(this,this.stsTokenManager.getToken(this.auth,e));return Ie(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return e2(this,e)}reload(){return s2(this)}_assign(e){this!==e&&(Ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ys(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await ed(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rn(this.auth.app))return Promise.reject(vr(this.auth));const e=await this.getIdToken();return await Ac(this,ZL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,r,i,o,a,l,c,u;const h=(s=t.displayName)!==null&&s!==void 0?s:void 0,f=(r=t.email)!==null&&r!==void 0?r:void 0,p=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,m=(o=t.photoURL)!==null&&o!==void 0?o:void 0,_=(a=t.tenantId)!==null&&a!==void 0?a:void 0,v=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,I=(c=t.createdAt)!==null&&c!==void 0?c:void 0,O=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:P,emailVerified:D,isAnonymous:B,providerData:M,stsTokenManager:A}=t;Ie(P&&A,e,"internal-error");const T=va.fromJSON(this.name,A);Ie(typeof P=="string",e,"internal-error"),Br(h,e.name),Br(f,e.name),Ie(typeof D=="boolean",e,"internal-error"),Ie(typeof B=="boolean",e,"internal-error"),Br(p,e.name),Br(m,e.name),Br(_,e.name),Br(v,e.name),Br(I,e.name),Br(O,e.name);const E=new ys({uid:P,auth:e,email:f,emailVerified:D,displayName:h,isAnonymous:B,photoURL:m,phoneNumber:p,tenantId:_,stsTokenManager:T,createdAt:I,lastLoginAt:O});return M&&Array.isArray(M)&&(E.providerData=M.map(C=>Object.assign({},C))),v&&(E._redirectEventId=v),E}static async _fromIdTokenResponse(e,t,s=!1){const r=new va;r.updateFromServerResponse(t);const i=new ys({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await ed(i),i}static async _fromGetAccountInfoResponse(e,t,s){const r=t.users[0];Ie(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?SC(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(i!=null&&i.length),a=new va;a.updateFromIdToken(s);const l=new ys({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new tg(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw=new Map;function mr(n){Cr(n instanceof Function,"Expected a class definition");let e=jw.get(n);return e?(Cr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,jw.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}IC.type="NONE";const zw=IC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eh(n,e,t){return`firebase:${n}:${e}:${t}`}class ba{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=Eh(this.userKey,r.apiKey,i),this.fullPersistenceKey=Eh("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Zh(this.auth,{idToken:e}).catch(()=>{});return t?ys._fromGetAccountInfoResponse(this.auth,t,e):null}return ys._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new ba(mr(zw),e,s);const r=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=r[0]||mr(zw);const o=Eh(s,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const f=await Zh(e,{idToken:u}).catch(()=>{});if(!f)break;h=await ys._fromGetAccountInfoResponse(e,f,u)}else h=ys._fromJSON(e,u);c!==i&&(a=h),i=c;break}}catch{}const l=r.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new ba(i,e,s):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new ba(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xC(e))return"Blackberry";if(NC(e))return"Webos";if(kC(e))return"Safari";if((e.includes("chrome/")||AC(e))&&!e.includes("edge/"))return"Chrome";if(PC(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function CC(n=vn()){return/firefox\//i.test(n)}function kC(n=vn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function AC(n=vn()){return/crios\//i.test(n)}function RC(n=vn()){return/iemobile/i.test(n)}function PC(n=vn()){return/android/i.test(n)}function xC(n=vn()){return/blackberry/i.test(n)}function NC(n=vn()){return/webos/i.test(n)}function F_(n=vn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function a2(n=vn()){var e;return F_(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function l2(){return vD()&&document.documentMode===10}function OC(n=vn()){return F_(n)||PC(n)||NC(n)||xC(n)||/windows phone/i.test(n)||RC(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MC(n,e=[]){let t;switch(n){case"Browser":t=Hw(vn());break;case"Worker":t=`${Hw(vn())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Di}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});s.onAbort=t,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u2(n,e={}){return Vi(n,"GET","/v2/passwordPolicy",Li(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2=6;class d2{constructor(e){var t,s,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:h2,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,r,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(s=l.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,t,s,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ww(this),this.idTokenSubscription=new Ww(this),this.beforeStateQueue=new c2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=mr(t)),this._initializationPromise=this.queue(async()=>{var s,r,i;if(!this._deleted&&(this.persistenceManager=await ba.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Zh(this,{idToken:e}),s=await ys._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Rn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ed(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=WL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rn(this.app))return Promise.reject(vr(this));const t=e?Ze(e):null;return t&&Ie(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rn(this.app)?Promise.reject(vr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rn(this.app)?Promise.reject(vr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(mr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await u2(this),t=new d2(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qa("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await o2(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&mr(e)||this._popupRedirectResolver;Ie(t,this,"argument-error"),this.redirectPersistenceManager=await ba.create(this,[mr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,r){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ie(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,s,r);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=MC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(Rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&jL(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Uo(n){return Ze(n)}class Ww{constructor(e){this.auth=e,this.observer=null,this.addObserver=RD(t=>this.observer=t)}get next(){return Ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function p2(n){yf=n}function DC(n){return yf.loadJS(n)}function m2(){return yf.recaptchaEnterpriseScript}function g2(){return yf.gapiScript}function _2(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class y2{constructor(){this.enterprise=new v2}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class v2{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const b2="recaptcha-enterprise",LC="NO_RECAPTCHA";class w2{constructor(e){this.type=b2,this.auth=Uo(e)}async verify(e="verify",t=!1){async function s(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{XL(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new YL(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function r(i,o,a){const l=window.grecaptcha;$w(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(LC)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new y2().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{s(this.auth).then(a=>{if(!t&&$w(window.grecaptcha))r(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=m2();l.length!==0&&(l+=a),DC(l).then(()=>{r(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function qw(n,e,t,s=!1,r=!1){const i=new w2(n);let o;if(r)o=LC;else try{o=await i.verify(t)}catch{o=await i.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return s?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Kw(n,e,t,s,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await qw(n,e,t,t==="getOobCode");return s(n,o)}else return s(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await qw(n,e,t,t==="getOobCode");return s(n,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(n,e){const t=Ya(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),i=t.getOptions();if(yi(i,e??{}))return r;ks(r,"already-initialized")}return t.initialize({options:e})}function E2(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(mr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function T2(n,e,t){const s=Uo(n);Ie(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=FC(e),{host:o,port:a}=S2(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){Ie(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Ie(yi(c,s.config.emulator)&&yi(u,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=c,s.emulatorConfig=u,s.settings.appVerificationDisabledForTesting=!0,I2()}function FC(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function S2(n){const e=FC(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:Gw(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:Gw(o)}}}function Gw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function I2(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return pr("not implemented")}_getIdTokenResponse(e){return pr("not implemented")}_linkToIdToken(e,t){return pr("not implemented")}_getReauthenticationResolver(e){return pr("not implemented")}}async function C2(n,e){return Vi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k2(n,e){return cu(n,"POST","/v1/accounts:signInWithPassword",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A2(n,e){return cu(n,"POST","/v1/accounts:signInWithEmailLink",Li(n,e))}async function R2(n,e){return cu(n,"POST","/v1/accounts:signInWithEmailLink",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc extends B_{constructor(e,t,s,r=null){super("password",s),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Rc(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Rc(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kw(e,t,"signInWithPassword",k2);case"emailLink":return A2(e,{email:this._email,oobCode:this._password});default:ks(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kw(e,s,"signUpPassword",C2);case"emailLink":return R2(e,{idToken:t,email:this._email,oobCode:this._password});default:ks(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wa(n,e){return cu(n,"POST","/v1/accounts:signInWithIdp",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2="http://localhost";class Co extends B_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Co(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ks("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=t,i=M_(t,["providerId","signInMethod"]);if(!s||!r)return null;const o=new Co(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return wa(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,wa(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,wa(e,t)}buildRequest(){const e={requestUri:P2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ja(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function N2(n){const e=Fl(Bl(n)).link,t=e?Fl(Bl(e)).deep_link_id:null,s=Fl(Bl(n)).deep_link_id;return(s?Fl(Bl(s)).link:null)||s||t||e||n}class $_{constructor(e){var t,s,r,i,o,a;const l=Fl(Bl(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,u=(s=l.oobCode)!==null&&s!==void 0?s:null,h=x2((r=l.mode)!==null&&r!==void 0?r:null);Ie(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.lang)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=N2(e);try{return new $_(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(){this.providerId=Za.PROVIDER_ID}static credential(e,t){return Rc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=$_.parseLink(t);return Ie(s,"argument-error"),Rc._fromEmailAndCode(e,s.code,s.tenantId)}}Za.PROVIDER_ID="password";Za.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Za.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu extends BC{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr extends uu{constructor(){super("facebook.com")}static credential(e){return Co._fromParams({providerId:Qr.PROVIDER_ID,signInMethod:Qr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qr.credentialFromTaggedObject(e)}static credentialFromError(e){return Qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qr.credential(e.oauthAccessToken)}catch{return null}}}Qr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends uu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Co._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Jr.credential(t,s)}catch{return null}}}Jr.GOOGLE_SIGN_IN_METHOD="google.com";Jr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr extends uu{constructor(){super("github.com")}static credential(e){return Co._fromParams({providerId:Yr.PROVIDER_ID,signInMethod:Yr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yr.credentialFromTaggedObject(e)}static credentialFromError(e){return Yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yr.credential(e.oauthAccessToken)}catch{return null}}}Yr.GITHUB_SIGN_IN_METHOD="github.com";Yr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends uu{constructor(){super("twitter.com")}static credential(e,t){return Co._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xr.credentialFromTaggedObject(e)}static credentialFromError(e){return Xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Xr.credential(t,s)}catch{return null}}}Xr.TWITTER_SIGN_IN_METHOD="twitter.com";Xr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,r=!1){const i=await ys._fromIdTokenResponse(e,s,r),o=Qw(s);return new ko({user:i,providerId:o,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const r=Qw(s);return new ko({user:e,providerId:r,_tokenResponse:s,operationType:t})}}function Qw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends Zs{constructor(e,t,s,r){var i;super(t.code,t.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,td.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,r){return new td(e,t,s,r)}}function $C(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?td._fromErrorAndOperation(n,i,e,s):i})}async function O2(n,e,t=!1){const s=await Ac(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ko._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M2(n,e,t=!1){const{auth:s}=n;if(Rn(s.app))return Promise.reject(vr(s));const r="reauthenticate";try{const i=await Ac(n,$C(s,r,e,n),t);Ie(i.idToken,s,"internal-error");const o=V_(i.idToken);Ie(o,s,"internal-error");const{sub:a}=o;return Ie(n.uid===a,s,"user-mismatch"),ko._forOperation(n,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ks(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UC(n,e,t=!1){if(Rn(n.app))return Promise.reject(vr(n));const s="signIn",r=await $C(n,s,e),i=await ko._fromIdTokenResponse(n,s,r);return t||await n._updateCurrentUser(i.user),i}async function D2(n,e){return UC(Uo(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L2(n,e){return cu(n,"POST","/v1/accounts:signInWithCustomToken",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V2(n,e){if(Rn(n.app))return Promise.reject(vr(n));const t=Uo(n),s=await L2(t,{token:e,returnSecureToken:!0}),r=await ko._fromIdTokenResponse(t,"signIn",s);return await t._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F2(n){const e=Uo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function B2(n,e,t){return Rn(n.app)?Promise.reject(vr(n)):D2(Ze(n),Za.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&F2(n),s})}function jC(n,e,t,s){return Ze(n).onIdTokenChanged(e,t,s)}function $2(n,e,t){return Ze(n).beforeAuthStateChanged(e,t)}function Jw(n,e,t,s){return Ze(n).onAuthStateChanged(e,t,s)}const nd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(nd,"1"),this.storage.removeItem(nd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2=1e3,j2=10;class HC extends zC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=OC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),r=this.localCache[t];s!==r&&e(t,r,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(s);!t&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);l2()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,j2):r()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},U2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}HC.type="LOCAL";const WC=HC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC extends zC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}qC.type="SESSION";const U_=qC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z2(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const s=new vf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await z2(a);t.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j_(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=j_("",20);r.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(f.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hs(){return window}function W2(n){Hs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(){return typeof Hs().WorkerGlobalScope<"u"&&typeof Hs().importScripts=="function"}async function q2(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function K2(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function G2(){return KC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC="firebaseLocalStorageDb",Q2=1,sd="firebaseLocalStorage",QC="fbase_key";class hu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function bf(n,e){return n.transaction([sd],e?"readwrite":"readonly").objectStore(sd)}function J2(){const n=indexedDB.deleteDatabase(GC);return new hu(n).toPromise()}function ng(){const n=indexedDB.open(GC,Q2);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(sd,{keyPath:QC})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(sd)?e(s):(s.close(),await J2(),e(await ng()))})})}async function Yw(n,e,t){const s=bf(n,!0).put({[QC]:e,value:t});return new hu(s).toPromise()}async function Y2(n,e){const t=bf(n,!1).get(e),s=await new hu(t).toPromise();return s===void 0?null:s.value}function Xw(n,e){const t=bf(n,!0).delete(e);return new hu(t).toPromise()}const X2=800,Z2=3;class JC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ng(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>Z2)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vf._getInstance(G2()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await q2(),!this.activeServiceWorker)return;this.sender=new H2(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||K2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ng();return await Yw(e,nd,"1"),await Xw(e,nd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Yw(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>Y2(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Xw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=bf(r,!1).getAll();return new hu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),X2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}JC.type="LOCAL";const YC=JC;new lu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eV(n,e){return e?mr(e):(Ie(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_ extends B_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return wa(e,this._buildIdpRequest())}_linkToIdToken(e,t){return wa(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return wa(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function tV(n){return UC(n.auth,new z_(n),n.bypassAuthState)}function nV(n){const{auth:e,user:t}=n;return Ie(t,e,"internal-error"),M2(t,new z_(n),n.bypassAuthState)}async function sV(n){const{auth:e,user:t}=n;return Ie(t,e,"internal-error"),O2(t,new z_(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,t,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tV;case"linkViaPopup":case"linkViaRedirect":return sV;case"reauthViaPopup":case"reauthViaRedirect":return nV;default:ks(this.auth,"internal-error")}}resolve(e){Cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV=new lu(2e3,1e4);class ua extends XC{constructor(e,t,s,r,i){super(e,t,r,i),this.provider=s,this.authWindow=null,this.pollId=null,ua.currentPopupAction&&ua.currentPopupAction.cancel(),ua.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ie(e,this.auth,"internal-error"),e}async onExecution(){Cr(this.filter.length===1,"Popup operations only handle one event");const e=j_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(zs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(zs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ua.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rV.get())};e()}}ua.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iV="pendingRedirect",Th=new Map;class oV extends XC{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Th.get(this.auth._key());if(!e){try{const s=await aV(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Th.set(this.auth._key(),e)}return this.bypassAuthState||Th.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aV(n,e){const t=uV(e),s=cV(n);if(!await s._isAvailable())return!1;const r=await s._get(t)==="true";return await s._remove(t),r}function lV(n,e){Th.set(n._key(),e)}function cV(n){return mr(n._redirectPersistence)}function uV(n){return Eh(iV,n.config.apiKey,n.name)}async function hV(n,e,t=!1){if(Rn(n.app))return Promise.reject(vr(n));const s=Uo(n),r=eV(s,e),o=await new oV(s,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dV=10*60*1e3;class fV{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pV(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!ZC(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(zs(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=dV&&this.cachedEventUids.clear(),this.cachedEventUids.has(Zw(e))}saveEventToCache(e){this.cachedEventUids.add(Zw(e)),this.lastProcessedEventTime=Date.now()}}function Zw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ZC({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function pV(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ZC(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mV(n,e={}){return Vi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_V=/^https?/;async function yV(n){if(n.config.emulator)return;const{authorizedDomains:e}=await mV(n);for(const t of e)try{if(vV(t))return}catch{}ks(n,"unauthorized-domain")}function vV(n){const e=eg(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===s}if(!_V.test(t))return!1;if(gV.test(n))return s===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bV=new lu(3e4,6e4);function eE(){const n=Hs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function wV(n){return new Promise((e,t)=>{var s,r,i;function o(){eE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{eE(),t(zs(n,"network-request-failed"))},timeout:bV.get()})}if(!((r=(s=Hs().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=Hs().gapi)===null||i===void 0)&&i.load)o();else{const a=_2("iframefcb");return Hs()[a]=()=>{gapi.load?o():t(zs(n,"network-request-failed"))},DC(`${g2()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Sh=null,e})}let Sh=null;function EV(n){return Sh=Sh||wV(n),Sh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TV=new lu(5e3,15e3),SV="__/auth/iframe",IV="emulator/auth/iframe",CV={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kV=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function AV(n){const e=n.config;Ie(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?L_(e,IV):`https://${n.config.authDomain}/${SV}`,s={apiKey:e.apiKey,appName:n.name,v:Di},r=kV.get(n.config.apiHost);r&&(s.eid=r);const i=n._getFrameworks();return i.length&&(s.fw=i.join(",")),`${t}?${Ja(s).slice(1)}`}async function RV(n){const e=await EV(n),t=Hs().gapi;return Ie(t,n,"internal-error"),e.open({where:document.body,url:AV(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:CV,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=zs(n,"network-request-failed"),a=Hs().setTimeout(()=>{i(o)},TV.get());function l(){Hs().clearTimeout(a),r(s)}s.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},xV=500,NV=600,OV="_blank",MV="http://localhost";class tE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function DV(n,e,t,s=xV,r=NV){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l=Object.assign(Object.assign({},PV),{width:s.toString(),height:r.toString(),top:i,left:o}),c=vn().toLowerCase();t&&(a=AC(c)?OV:t),CC(c)&&(e=e||MV,l.scrollbars="yes");const u=Object.entries(l).reduce((f,[p,m])=>`${f}${p}=${m},`,"");if(a2(c)&&a!=="_self")return LV(e||"",a),new tE(null);const h=window.open(e||"",a,u);Ie(h,n,"popup-blocked");try{h.focus()}catch{}return new tE(h)}function LV(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VV="__/auth/handler",FV="emulator/auth/handler",BV=encodeURIComponent("fac");async function nE(n,e,t,s,r,i){Ie(n.config.authDomain,n,"auth-domain-config-required"),Ie(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Di,eventId:r};if(e instanceof BC){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Gm(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof uu){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${BV}=${encodeURIComponent(l)}`:"";return`${$V(n)}?${Ja(a).slice(1)}${c}`}function $V({config:n}){return n.emulator?L_(n,FV):`https://${n.authDomain}/${VV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp="webStorageSupport";class UV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=U_,this._completeRedirectFn=hV,this._overrideRedirectResult=lV}async _openPopup(e,t,s,r){var i;Cr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await nE(e,t,s,eg(),r);return DV(e,o,j_())}async _openRedirect(e,t,s,r){await this._originValidation(e);const i=await nE(e,t,s,eg(),r);return W2(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:i}=this.eventManagers[t];return r?Promise.resolve(r):(Cr(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await RV(e),s=new fV(e);return t.register("authEvent",r=>(Ie(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Gp,{type:Gp},r=>{var i;const o=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[Gp];o!==void 0&&t(!!o),ks(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=yV(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return OC()||kC()||F_()}}const ek=UV;var sE="@firebase/auth",rE="1.10.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zV(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HV(n){Cs(new ds("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;Ie(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:MC(n)},c=new f2(s,r,i,l);return E2(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Cs(new ds("auth-internal",e=>{const t=Uo(e.getProvider("auth").getImmediate());return(s=>new jV(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Nn(sE,rE,zV(n)),Nn(sE,rE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WV=5*60,qV=cC("authIdTokenMaxAge")||WV;let iE=null;const KV=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>qV)return;const r=t==null?void 0:t.token;iE!==r&&(iE=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function tk(n=Xa()){const e=Ya(n,"auth");if(e.isInitialized())return e.getImmediate();const t=VC(n,{popupRedirectResolver:ek,persistence:[YC,WC,U_]}),s=cC("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=KV(i.toString());$2(t,o,()=>o(t.currentUser)),jC(t,a=>o(a))}}const r=aC("auth");return r&&T2(t,`http://${r}`),t}function GV(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}p2({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=r=>{const i=zs("internal-error");i.customData=r,t(i)},s.type="text/javascript",s.charset="UTF-8",GV().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HV("Browser");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QV=new Map,JV={activated:!1,tokenObservers:[]};function As(n){return QV.get(n)||Object.assign({},JV)}const oE={RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e,t,s,r,i){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=s,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new Ca,this.pending.promise.catch(t=>{}),await XV(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new Ca,this.pending.promise.catch(t=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}function XV(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZV={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},rd=new Qa("appCheck","AppCheck",ZV);function nk(n){if(!As(n).activated)throw rd.create("use-before-activation",{appName:n.name})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eF="firebase-app-check-database",tF=1,sg="firebase-app-check-store";let Qu=null;function nF(){return Qu||(Qu=new Promise((n,e)=>{try{const t=indexedDB.open(eF,tF);t.onsuccess=s=>{n(s.target.result)},t.onerror=s=>{var r;e(rd.create("storage-open",{originalErrorMessage:(r=s.target.error)===null||r===void 0?void 0:r.message}))},t.onupgradeneeded=s=>{const r=s.target.result;switch(s.oldVersion){case 0:r.createObjectStore(sg,{keyPath:"compositeKey"})}}}catch(t){e(rd.create("storage-open",{originalErrorMessage:t==null?void 0:t.message}))}}),Qu)}function sF(n,e){return rF(iF(n),e)}async function rF(n,e){const s=(await nF()).transaction(sg,"readwrite"),i=s.objectStore(sg).put({compositeKey:n,value:e});return new Promise((o,a)=>{i.onsuccess=l=>{o()},s.onerror=l=>{var c;a(rd.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})}function iF(n){return`${n.options.appId}-${n.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rg=new au("@firebase/app-check");function aE(n,e){return hC()?sF(n,e).catch(t=>{rg.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF={error:"UNKNOWN_ERROR"};function aF(n){return pf.encodeString(JSON.stringify(n),!1)}async function ig(n,e=!1,t=!1){const s=n.app;nk(s);const r=As(s);let i=r.token,o;if(i&&!$l(i)&&(r.token=void 0,i=void 0),!i){const c=await r.cachedTokenPromise;c&&($l(c)?i=c:await aE(s,void 0))}if(!e&&i&&$l(i))return{token:i.token};let a=!1;try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),a=!0),i=await As(s).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"||c.code==="appCheck/initial-throttle"?rg.warn(c.message):t&&rg.error(c),o=c}let l;return i?o?$l(i)?l={token:i.token,internalError:o}:l=cE(o):(l={token:i.token},r.token=i,await aE(s,i)):l=cE(o),a&&hF(s,l),l}async function lF(n){const e=n.app;nk(e);const{provider:t}=As(e);{const{token:s}=await t.getToken();return{token:s}}}function cF(n,e,t,s){const{app:r}=n,i=As(r),o={next:t,error:s,type:e};if(i.tokenObservers=[...i.tokenObservers,o],i.token&&$l(i.token)){const a=i.token;Promise.resolve().then(()=>{t({token:a.token}),lE(n)}).catch(()=>{})}i.cachedTokenPromise.then(()=>lE(n))}function sk(n,e){const t=As(n),s=t.tokenObservers.filter(r=>r.next!==e);s.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=s}function lE(n){const{app:e}=n,t=As(e);let s=t.tokenRefresher;s||(s=uF(n),t.tokenRefresher=s),!s.isRunning()&&t.isTokenAutoRefreshEnabled&&s.start()}function uF(n){const{app:e}=n;return new YV(async()=>{const t=As(e);let s;if(t.token?s=await ig(n,!0):s=await ig(n),s.error)throw s.error;if(s.internalError)throw s.internalError},()=>!0,()=>{const t=As(e);if(t.token){let s=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5;const r=t.token.expireTimeMillis-5*60*1e3;return s=Math.min(s,r),Math.max(0,s-Date.now())}else return 0},oE.RETRIAL_MIN_WAIT,oE.RETRIAL_MAX_WAIT)}function hF(n,e){const t=As(n).tokenObservers;for(const s of t)try{s.type==="EXTERNAL"&&e.error!=null?s.error(e.error):s.next(e)}catch{}}function $l(n){return n.expireTimeMillis-Date.now()>0}function cE(n){return{token:aF(oF),error:n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dF{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=As(this.app);for(const t of e)sk(this.app,t.next);return Promise.resolve()}}function fF(n,e){return new dF(n,e)}function pF(n){return{getToken:e=>ig(n,e),getLimitedUseToken:()=>lF(n),addTokenListener:e=>cF(n,"INTERNAL",e),removeTokenListener:e=>sk(n.app,e)}}const mF="@firebase/app-check",gF="0.8.13",_F="app-check",uE="app-check-internal";function yF(){Cs(new ds(_F,n=>{const e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return fF(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(uE).initialize()})),Cs(new ds(uE,n=>{const e=n.getProvider("app-check").getImmediate();return pF(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Nn(mF,gF)}yF();var vF="firebase",bF="11.6.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nn(vF,bF,"app");const rk=Symbol("firebaseApp");function Fi(n){return su()&&xn(rk,null)||Xa(n)}const Pt=()=>{},wF=typeof window<"u";function H_(n,e){return e.split(".").reduce((t,s)=>t&&t[s],n)}function EF(n,e,t){const s=(""+e).split("."),r=s.pop(),i=s.reduce((o,a)=>o&&o[a],n);if(i!=null)return Array.isArray(i)?i.splice(Number(r),1,t):i[r]=t}function Bi(n){return!!n&&typeof n=="object"}const TF=Object.prototype;function SF(n){return Bi(n)&&Object.getPrototypeOf(n)===TF}function W_(n){return Bi(n)&&n.type==="document"}function IF(n){return Bi(n)&&n.type==="collection"}function CF(n){return W_(n)||IF(n)}function kF(n){return Bi(n)&&n.type==="query"}function AF(n){return Bi(n)&&"ref"in n}function RF(n){return Bi(n)&&typeof n.bucket=="string"}function PF(n,e){let t;return()=>{if(!t)return t=!0,n(e())}}const xF=Symbol.for("v-scx");function ik(){return!!xn(xF,0)}const Ju=new WeakMap;function NF(n,e){if(!Ju.has(n)){const t=p_(!0);Ju.set(n,t);const{unmount:s}=e;e.unmount=()=>{s.call(e),t.stop(),Ju.delete(n)}}return Ju.get(n)}const ok=new WeakMap;function OF(n){return ok.get(Fi(n))}const Yu=new WeakMap;function MF(n){const e=Fi(n);if(!Yu.has(e)){let t;const r=[new Promise(i=>{t=i}),i=>{Yu.set(e,i),t(i.value)}];Yu.set(e,r)}return Yu.get(e)}function DF(n,e){jC(e,t=>{const s=MF();n.value=t,Array.isArray(s)&&s[1](n)})}var hE={};const dE="@firebase/database",fE="1.0.14";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ak="";function LF(n){ak=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Dt(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Cc(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return er(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new VF(e)}}catch{}return new FF},lo=lk("localStorage"),BF=lk("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea=new au("@firebase/database"),$F=function(){let n=1;return function(){return n++}}(),ck=function(n){const e=ND(n),t=new AD;t.update(e);const s=t.digest();return pf.encodeByteArray(s)},du=function(...n){let e="";for(let t=0;t<n.length;t++){const s=n[t];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=du.apply(null,s):typeof s=="object"?e+=Dt(s):e+=s,e+=" "}return e};let sc=null,pE=!0;const UF=function(n,e){se(!0,"Can't turn on custom loggers persistently."),Ea.logLevel=ze.VERBOSE,sc=Ea.log.bind(Ea)},mn=function(...n){if(pE===!0&&(pE=!1,sc===null&&BF.get("logging_enabled")===!0&&UF()),sc){const e=du.apply(null,n);sc(e)}},fu=function(n){return function(...e){mn(n,...e)}},og=function(...n){const e="FIREBASE INTERNAL ERROR: "+du(...n);Ea.error(e)},kr=function(...n){const e=`FIREBASE FATAL ERROR: ${du(...n)}`;throw Ea.error(e),new Error(e)},jn=function(...n){const e="FIREBASE WARNING: "+du(...n);Ea.warn(e)},jF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&jn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},q_=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},zF=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ao="[MIN_NAME]",vi="[MAX_NAME]",el=function(n,e){if(n===e)return 0;if(n===Ao||e===vi)return-1;if(e===Ao||n===vi)return 1;{const t=mE(n),s=mE(e);return t!==null?s!==null?t-s===0?n.length-e.length:t-s:-1:s!==null?1:n<e?-1:1}},HF=function(n,e){return n===e?0:n<e?-1:1},Cl=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Dt(e))},K_=function(n){if(typeof n!="object"||n===null)return Dt(n);const e=[];for(const s in n)e.push(s);e.sort();let t="{";for(let s=0;s<e.length;s++)s!==0&&(t+=","),t+=Dt(e[s]),t+=":",t+=K_(n[e[s]]);return t+="}",t},uk=function(n,e){const t=n.length;if(t<=e)return[n];const s=[];for(let r=0;r<t;r+=e)r+e>t?s.push(n.substring(r,t)):s.push(n.substring(r,r+e));return s};function Hn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const hk=function(n){se(!q_(n),"Invalid JSON number");const e=11,t=52,s=(1<<e-1)-1;let r,i,o,a,l;n===0?(i=0,o=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),s),i=a+s,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(i=0,o=Math.round(n/Math.pow(2,1-s-t))));const c=[];for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(i%2?1:0),i=Math.floor(i/2);c.push(r?1:0),c.reverse();const u=c.join("");let h="";for(l=0;l<64;l+=8){let f=parseInt(u.substr(l,8),2).toString(16);f.length===1&&(f="0"+f),h=h+f}return h.toLowerCase()},WF=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},qF=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function KF(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const s=new Error(n+" at "+e._path.toString()+": "+t);return s.code=n.toUpperCase(),s}const GF=new RegExp("^-?(0*)\\d{1,10}$"),QF=-2147483648,JF=2147483647,mE=function(n){if(GF.test(n)){const e=Number(n);if(e>=QF&&e<=JF)return e}return null},tl=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw jn("Exception was thrown by user callback.",t),e},Math.floor(0))}},YF=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},rc=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Rn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){jn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e,t,s){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(mn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',jn(e)}}class Ih{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Ih.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_="5",dk="v",fk="s",pk="r",mk="f",gk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,_k="ls",yk="p",ag="ac",vk="websocket",bk="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(e,t,s,r,i=!1,o="",a=!1,l=!1,c=null){this.secure=t,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=lo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&lo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function eB(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Ek(n,e,t){se(typeof e=="string","typeof type must == string"),se(typeof t=="object","typeof params must == object");let s;if(e===vk)s=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===bk)s=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);eB(n)&&(t.ns=n.namespace);const r=[];return Hn(t,(i,o)=>{r.push(i+"="+o)}),s+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tB{constructor(){this.counters_={}}incrementCounter(e,t=1){er(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return uD(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp={},Jp={};function Q_(n){const e=n.toString();return Qp[e]||(Qp[e]=new tB),Qp[e]}function nB(n,e){const t=n.toString();return Jp[t]||(Jp[t]=e()),Jp[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sB{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&tl(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE="start",rB="close",iB="pLPCommand",oB="pRTLPCB",Tk="id",Sk="pw",Ik="ser",aB="cb",lB="seg",cB="ts",uB="d",hB="dframe",Ck=1870,kk=30,dB=Ck-kk,fB=25e3,pB=3e4;class ha{constructor(e,t,s,r,i,o,a){this.connId=e,this.repoInfo=t,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=fu(e),this.stats_=Q_(t),this.urlFn=l=>(this.appCheckToken&&(l[ag]=this.appCheckToken),Ek(t,bk,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new sB(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(pB)),zF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new J_((...i)=>{const[o,a,l,c,u]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===gE)this.id=a,this.password=l;else if(o===rB)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[gE]="t",s[Ik]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[aB]=this.scriptTagHolder.uniqueCallbackIdentifier),s[dk]=G_,this.transportSessionId&&(s[fk]=this.transportSessionId),this.lastSessionId&&(s[_k]=this.lastSessionId),this.applicationId&&(s[yk]=this.applicationId),this.appCheckToken&&(s[ag]=this.appCheckToken),typeof location<"u"&&location.hostname&&gk.test(location.hostname)&&(s[pk]=mk);const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ha.forceAllow_=!0}static forceDisallow(){ha.forceDisallow_=!0}static isAvailable(){return ha.forceAllow_?!0:!ha.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!WF()&&!qF()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Dt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=iC(t),r=uk(s,dB);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const s={};s[hB]="t",s[Tk]=e,s[Sk]=t,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Dt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class J_{constructor(e,t,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=$F(),window[iB+this.uniqueCallbackIdentifier]=e,window[oB+this.uniqueCallbackIdentifier]=t,this.myIFrame=J_.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){mn("frame writing exception"),a.stack&&mn(a.stack),mn(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||mn("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Tk]=this.myID,e[Sk]=this.myPW,e[Ik]=this.currentSerial;let t=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+kk+s.length<=Ck;){const o=this.pendingSegs.shift();s=s+"&"+lB+r+"="+o.seg+"&"+cB+r+"="+o.ts+"&"+uB+r+"="+o.d,r++}return t=t+s,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,s){this.pendingSegs.push({seg:e,ts:t,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const s=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(s,Math.floor(fB)),i=()=>{clearTimeout(r),s()};this.addTag(e,i)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),t())},s.onerror=()=>{mn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mB=16384,gB=45e3;let id=null;typeof MozWebSocket<"u"?id=MozWebSocket:typeof WebSocket<"u"&&(id=WebSocket);class gs{constructor(e,t,s,r,i,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=fu(this.connId),this.stats_=Q_(t),this.connURL=gs.connectionURL_(t,o,a,r,s),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,s,r,i){const o={};return o[dk]=G_,typeof location<"u"&&location.hostname&&gk.test(location.hostname)&&(o[pk]=mk),t&&(o[fk]=t),s&&(o[_k]=s),r&&(o[ag]=r),i&&(o[yk]=i),Ek(e,vk,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,lo.set("previous_websocket_failure",!0);try{let s;bD(),this.mySock=new id(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){gs.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(t);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&id!==null&&!gs.forceDisallow_}static previouslyFailed(){return lo.isInMemoryStorage||lo.get("previous_websocket_failure")===!0}markConnectionHealthy(){lo.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const s=Cc(t);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(se(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const s=this.extractFrameCount_(t);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const t=Dt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=uk(t,mB);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(gB))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}gs.responsesRequiredToBeHealthy=2;gs.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{static get ALL_TRANSPORTS(){return[ha,gs]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=gs&&gs.isAvailable();let s=t&&!gs.previouslyFailed();if(e.webSocketOnly&&(t||jn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[gs];else{const r=this.transports_=[];for(const i of Pc.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i);Pc.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Pc.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _B=6e4,yB=5e3,vB=10*1024,bB=100*1024,Yp="t",_E="d",wB="s",yE="r",EB="e",vE="o",bE="a",wE="n",EE="p",TB="h";class SB{constructor(e,t,s,r,i,o,a,l,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=fu("c:"+this.id+":"),this.transportManager_=new Pc(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,s)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=rc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>bB?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>vB?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Yp in e){const t=e[Yp];t===bE?this.upgradeIfSecondaryHealthy_():t===yE?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===vE&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Cl("t",e),s=Cl("d",e);if(t==="c")this.onSecondaryControl_(s);else if(t==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:EE,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:bE,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:wE,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Cl("t",e),s=Cl("d",e);t==="c"?this.onControl_(s):t==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Cl(Yp,e);if(_E in e){const s=e[_E];if(t===TB){const r=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===wE){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===wB?this.onConnectionShutdown_(s):t===yE?this.onReset_(s):t===EB?og("Server Error: "+s):t===vE?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):og("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),G_!==s&&jn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,s),rc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(_B))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):rc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(yB))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:EE,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(lo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{put(e,t,s,r){}merge(e,t,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,s){}onDisconnectMerge(e,t,s){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rk=class{constructor(e){this.allowedEvents_=e,this.listeners_={},se(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,t)}}on(e,t,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:s});const r=this.getInitialEvent(e);r&&t.apply(s,r)}off(e,t,s){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===t&&(!s||s===r[i].context)){r.splice(i,1);return}}validateEventType_(e){se(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od extends Rk{static getInstance(){return new od}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!x_()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return se(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TE=32,SE=768;class ot{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Xe(){return new ot("")}function $e(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function bi(n){return n.pieces_.length-n.pieceNum_}function ft(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ot(n.pieces_,e)}function Pk(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function IB(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function xk(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Nk(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ot(e,0)}function Lt(n,e){const t=[];for(let s=n.pieceNum_;s<n.pieces_.length;s++)t.push(n.pieces_[s]);if(e instanceof ot)for(let s=e.pieceNum_;s<e.pieces_.length;s++)t.push(e.pieces_[s]);else{const s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&t.push(s[r])}return new ot(t,0)}function Ue(n){return n.pieceNum_>=n.pieces_.length}function Pn(n,e){const t=$e(n),s=$e(e);if(t===null)return e;if(t===s)return Pn(ft(n),ft(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Y_(n,e){if(bi(n)!==bi(e))return!1;for(let t=n.pieceNum_,s=e.pieceNum_;t<=n.pieces_.length;t++,s++)if(n.pieces_[t]!==e.pieces_[s])return!1;return!0}function vs(n,e){let t=n.pieceNum_,s=e.pieceNum_;if(bi(n)>bi(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[s])return!1;++t,++s}return!0}class CB{constructor(e,t){this.errorPrefix_=t,this.parts_=xk(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=_f(this.parts_[s]);Ok(this)}}function kB(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=_f(e),Ok(n)}function AB(n){const e=n.parts_.pop();n.byteLength_-=_f(e),n.parts_.length>0&&(n.byteLength_-=1)}function Ok(n){if(n.byteLength_>SE)throw new Error(n.errorPrefix_+"has a key path longer than "+SE+" bytes ("+n.byteLength_+").");if(n.parts_.length>TE)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+TE+") or object contains a cycle "+no(n))}function no(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_ extends Rk{static getInstance(){return new X_}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return se(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kl=1e3,RB=60*5*1e3,IE=30*1e3,PB=1.3,xB=3e4,NB="server_kill",CE=3;class br extends Ak{constructor(e,t,s,r,i,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=br.nextPersistentConnectionId_++,this.log_=fu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=kl,this.maxReconnectDelay_=RB,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");X_.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&od.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,s){const r=++this.requestNumber_,i={r,a:e,b:t};this.log_(Dt(i)),se(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const t=new Ca,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),t.promise}listen(e,t,s,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),se(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),se(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:t,query:e,tag:s};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(s)})}sendListen_(e){const t=e.query,s=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+s+" for "+r);const i={p:s},o="q";e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const l=a.d,c=a.s;br.warnOnListenWarnings_(l,t),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(s,r),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&er(e,"w")){const s=ka(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();jn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||kD(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=IE)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=CD(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(t,s,r=>{const i=r.s,o=r.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,s=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,s)})}unlisten(e,t){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),se(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,t)}sendUnlisten_(e,t,s,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e},o="n";r&&(i.q=s,i.t=r),this.sendRequest(o,i)}onDisconnectPut(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:s})}onDisconnectMerge(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:s})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,s,r){const i={p:t,d:s};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,t,s,r){this.putInternal("p",e,t,s,r)}merge(e,t,s,r){this.putInternal("m",e,t,s,r)}putInternal(e,t,s,r,i){this.initConnection_();const o={p:t,d:s};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,s,i=>{this.log_(t+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(i.s,i.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,s=>{if(s.s!=="ok"){const i=s.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Dt(e));const t=e.r,s=this.requestCBHash_[t];s&&(delete this.requestCBHash_[t],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):og("Unrecognized action received from server: "+Dt(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){se(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=kl,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=kl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>xB&&(this.reconnectDelay_=kl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*PB)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+br.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,s())},c=function(h){se(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,f]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?mn("getToken() completed but was canceled"):(mn("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,a=new SB(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,s,p=>{jn(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(NB)},i))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&jn(h),l())}}}interrupt(e){mn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){mn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Gm(this.interruptReasons_)&&(this.reconnectDelay_=kl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let s;t?s=t.map(i=>K_(i)).join("$"):s="default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const s=new ot(e).toString();let r;if(this.listens.has(s)){const i=this.listens.get(s);r=i.get(t),i.delete(t),i.size===0&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,t){mn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=CE&&(this.reconnectDelay_=IE,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){mn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=CE&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+ak.replace(/\./g,"-")]=1,x_()?e["framework.cordova"]=1:uC()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=od.getInstance().currentlyOnline();return Gm(this.interruptReasons_)&&e}}br.nextPersistentConnectionId_=0;br.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new je(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const s=new je(Ao,e),r=new je(Ao,t);return this.compare(s,r)!==0}minPost(){return je.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xu;class Mk extends wf{static get __EMPTY_NODE(){return Xu}static set __EMPTY_NODE(e){Xu=e}compare(e,t){return el(e.name,t.name)}isDefinedOn(e){throw Ga("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return je.MIN}maxPost(){return new je(vi,Xu)}makePost(e,t){return se(typeof e=="string","KeyIndex indexValue must always be a string."),new je(e,Xu)}toString(){return".key"}}const _o=new Mk;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zu=class{constructor(e,t,s,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?s(e.key,t):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Gn=class Ul{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??Ul.RED,this.left=r??Fs.EMPTY_NODE,this.right=i??Fs.EMPTY_NODE}copy(e,t,s,r,i){return new Ul(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return i<0?r=r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r=r.copy(null,t,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Fs.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let s,r;if(s=this,t(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),t(e,s.key)===0){if(s.right.isEmpty())return Fs.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ul.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ul.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};Gn.RED=!0;Gn.BLACK=!1;class OB{copy(e,t,s,r,i){return this}insert(e,t,s){return new Gn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}let Fs=class Ch{constructor(e,t=Ch.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Ch(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Gn.BLACK,null,null))}remove(e){return new Ch(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Gn.BLACK,null,null))}get(e){let t,s=this.root_;for(;!s.isEmpty();){if(t=this.comparator_(e,s.key),t===0)return s.value;t<0?s=s.left:t>0&&(s=s.right)}return null}getPredecessorKey(e){let t,s=this.root_,r=null;for(;!s.isEmpty();)if(t=this.comparator_(e,s.key),t===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else t<0?s=s.left:t>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Zu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Zu(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Zu(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Zu(this.root_,null,this.comparator_,!0,e)}};Fs.EMPTY_NODE=new OB;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MB(n,e){return el(n.name,e.name)}function Z_(n,e){return el(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lg;function DB(n){lg=n}const Dk=function(n){return typeof n=="number"?"number:"+hk(n):"string:"+n},Lk=function(n){if(n.isLeafNode()){const e=n.val();se(typeof e=="string"||typeof e=="number"||typeof e=="object"&&er(e,".sv"),"Priority must be a string or number.")}else se(n===lg||n.isEmpty(),"priority of unexpected type.");se(n===lg||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kE;class Bt{static set __childrenNodeConstructor(e){kE=e}static get __childrenNodeConstructor(){return kE}constructor(e,t=Bt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,se(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Lk(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Bt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Bt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ue(e)?this:$e(e)===".priority"?this.priorityNode_:Bt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:Bt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const s=$e(e);return s===null?t:t.isEmpty()&&s!==".priority"?this:(se(s!==".priority"||bi(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,Bt.__childrenNodeConstructor.EMPTY_NODE.updateChild(ft(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Dk(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=hk(this.value_):e+=this.value_,this.lazyHash_=ck(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Bt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Bt.__childrenNodeConstructor?-1:(se(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,s=typeof this.value_,r=Bt.VALUE_TYPE_ORDER.indexOf(t),i=Bt.VALUE_TYPE_ORDER.indexOf(s);return se(r>=0,"Unknown leaf type: "+t),se(i>=0,"Unknown leaf type: "+s),r===i?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}Bt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vk,Fk;function LB(n){Vk=n}function VB(n){Fk=n}class FB extends wf{compare(e,t){const s=e.node.getPriority(),r=t.node.getPriority(),i=s.compareTo(r);return i===0?el(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return je.MIN}maxPost(){return new je(vi,new Bt("[PRIORITY-POST]",Fk))}makePost(e,t){const s=Vk(e);return new je(t,new Bt("[PRIORITY-POST]",s))}toString(){return".priority"}}const wt=new FB;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BB=Math.log(2);class $B{constructor(e){const t=i=>parseInt(Math.log(i)/BB,10),s=i=>parseInt(Array(i+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ad=function(n,e,t,s){n.sort(e);const r=function(l,c){const u=c-l;let h,f;if(u===0)return null;if(u===1)return h=n[l],f=t?t(h):h,new Gn(f,h.node,Gn.BLACK,null,null);{const p=parseInt(u/2,10)+l,m=r(l,p),_=r(p+1,c);return h=n[p],f=t?t(h):h,new Gn(f,h.node,Gn.BLACK,m,_)}},i=function(l){let c=null,u=null,h=n.length;const f=function(m,_){const v=h-m,I=h;h-=m;const O=r(v+1,I),P=n[v],D=t?t(P):P;p(new Gn(D,P.node,_,null,O))},p=function(m){c?(c.left=m,c=m):(u=m,c=m)};for(let m=0;m<l.count;++m){const _=l.nextBitIsOne(),v=Math.pow(2,l.count-(m+1));_?f(v,Gn.BLACK):(f(v,Gn.BLACK),f(v,Gn.RED))}return u},o=new $B(n.length),a=i(o);return new Fs(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xp;const Xo={};class gr{static get Default(){return se(Xo&&wt,"ChildrenNode.ts has not been loaded"),Xp=Xp||new gr({".priority":Xo},{".priority":wt}),Xp}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=ka(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Fs?t:null}hasIndex(e){return er(this.indexSet_,e.toString())}addIndex(e,t){se(e!==_o,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const i=t.getIterator(je.Wrap);let o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),s.push(o),o=i.getNext();let a;r?a=ad(s,e.getCompare()):a=Xo;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=a,new gr(u,c)}addToIndexes(e,t){const s=Jh(this.indexes_,(r,i)=>{const o=ka(this.indexSet_,i);if(se(o,"Missing index implementation for "+i),r===Xo)if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(je.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),ad(a,o.getCompare())}else return Xo;else{const a=t.get(e.name);let l=r;return a&&(l=l.remove(new je(e.name,a))),l.insert(e,e.node)}});return new gr(s,this.indexSet_)}removeFromIndexes(e,t){const s=Jh(this.indexes_,r=>{if(r===Xo)return r;{const i=t.get(e.name);return i?r.remove(new je(e.name,i)):r}});return new gr(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Al;class Ce{static get EMPTY_NODE(){return Al||(Al=new Ce(new Fs(Z_),null,gr.Default))}constructor(e,t,s){this.children_=e,this.priorityNode_=t,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Lk(this.priorityNode_),this.children_.isEmpty()&&se(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Al}updatePriority(e){return this.children_.isEmpty()?this:new Ce(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Al:t}}getChild(e){const t=$e(e);return t===null?this:this.getImmediateChild(t).getChild(ft(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(se(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const s=new je(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(s,this.children_));const o=r.isEmpty()?Al:this.priorityNode_;return new Ce(r,o,i)}}updateChild(e,t){const s=$e(e);if(s===null)return t;{se($e(e)!==".priority"||bi(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(ft(e),t);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let s=0,r=0,i=!0;if(this.forEachChild(wt,(o,a)=>{t[o]=a.val(e),s++,i&&Ce.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1}),!e&&i&&r<2*s){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Dk(this.getPriority().val())+":"),this.forEachChild(wt,(t,s)=>{const r=s.hash();r!==""&&(e+=":"+t+":"+r)}),this.lazyHash_=e===""?"":ck(e)}return this.lazyHash_}getPredecessorChildName(e,t,s){const r=this.resolveIndex_(s);if(r){const i=r.getPredecessorKey(new je(e,t));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const s=t.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new je(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const s=t.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new je(t,this.children_.get(t)):null}forEachChild(e,t){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>t(r.name,r.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,je.Wrap);let i=r.peek();for(;i!=null&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,je.Wrap);let i=r.peek();for(;i!=null&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===pu?-1:0}withIndex(e){if(e===_o||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Ce(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===_o||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const s=this.getIterator(wt),r=t.getIterator(wt);let i=s.getNext(),o=r.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=s.getNext(),o=r.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===_o?null:this.indexMap_.get(e.toString())}}Ce.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class UB extends Ce{constructor(){super(new Fs(Z_),Ce.EMPTY_NODE,gr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ce.EMPTY_NODE}isEmpty(){return!1}}const pu=new UB;Object.defineProperties(je,{MIN:{value:new je(Ao,Ce.EMPTY_NODE)},MAX:{value:new je(vi,pu)}});Mk.__EMPTY_NODE=Ce.EMPTY_NODE;Bt.__childrenNodeConstructor=Ce;DB(pu);VB(pu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jB=!0;function Ut(n,e=null){if(n===null)return Ce.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),se(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new Bt(t,Ut(e))}if(!(n instanceof Array)&&jB){const t=[];let s=!1;if(Hn(n,(o,a)=>{if(o.substring(0,1)!=="."){const l=Ut(a);l.isEmpty()||(s=s||!l.getPriority().isEmpty(),t.push(new je(o,l)))}}),t.length===0)return Ce.EMPTY_NODE;const i=ad(t,MB,o=>o.name,Z_);if(s){const o=ad(t,wt.getCompare());return new Ce(i,Ut(e),new gr({".priority":o},{".priority":wt}))}else return new Ce(i,Ut(e),gr.Default)}else{let t=Ce.EMPTY_NODE;return Hn(n,(s,r)=>{if(er(n,s)&&s.substring(0,1)!=="."){const i=Ut(r);(i.isLeafNode()||!i.isEmpty())&&(t=t.updateImmediateChild(s,i))}}),t.updatePriority(Ut(e))}}LB(Ut);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey extends wf{constructor(e){super(),this.indexPath_=e,se(!Ue(e)&&$e(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const s=this.extractChild(e.node),r=this.extractChild(t.node),i=s.compareTo(r);return i===0?el(e.name,t.name):i}makePost(e,t){const s=Ut(e),r=Ce.EMPTY_NODE.updateChild(this.indexPath_,s);return new je(t,r)}maxPost(){const e=Ce.EMPTY_NODE.updateChild(this.indexPath_,pu);return new je(vi,e)}toString(){return xk(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB extends wf{compare(e,t){const s=e.node.compareTo(t.node);return s===0?el(e.name,t.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return je.MIN}maxPost(){return je.MAX}makePost(e,t){const s=Ut(e);return new je(t,s)}toString(){return".value"}}const Bk=new zB;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $k(n){return{type:"value",snapshotNode:n}}function Aa(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function xc(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Nc(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function HB(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e){this.index_=e}updateChild(e,t,s,r,i,o){se(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(r).equals(s.getChild(r))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(t)?o.trackChildChange(xc(t,a)):se(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Aa(t,s)):o.trackChildChange(Nc(t,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(t,s).withIndex(this.index_)}updateFullNode(e,t,s){return s!=null&&(e.isLeafNode()||e.forEachChild(wt,(r,i)=>{t.hasChild(r)||s.trackChildChange(xc(r,i))}),t.isLeafNode()||t.forEachChild(wt,(r,i)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(i)||s.trackChildChange(Nc(r,i,o))}else s.trackChildChange(Aa(r,i))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ce.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e){this.indexedFilter_=new ty(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Oc.getStartPost_(e),this.endPost_=Oc.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&s}updateChild(e,t,s,r,i,o){return this.matches(new je(t,s))||(s=Ce.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,s,r,i,o)}updateFullNode(e,t,s){t.isLeafNode()&&(t=Ce.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(Ce.EMPTY_NODE);const i=this;return t.forEachChild(wt,(o,a)=>{i.matches(new je(o,a))||(r=r.updateImmediateChild(o,Ce.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,s)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WB{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=t=>{const s=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new Oc(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,s,r,i,o){return this.rangedFilter_.matches(new je(t,s))||(s=Ce.EMPTY_NODE),e.getImmediateChild(t).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,s,r,i,o):this.fullLimitUpdateChild_(e,t,s,i,o)}updateFullNode(e,t,s){let r;if(t.isLeafNode()||t.isEmpty())r=Ce.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){r=Ce.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=t.withIndex(this.index_),r=r.updatePriority(Ce.EMPTY_NODE);let i;this.reverse_?i=r.getReverseIterator(this.index_):i=r.getIterator(this.index_);let o=0;for(;i.hasNext();){const a=i.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,Ce.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,s)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,s,r,i){let o;if(this.reverse_){const h=this.index_.getCompare();o=(f,p)=>h(p,f)}else o=this.index_.getCompare();const a=e;se(a.numChildren()===this.limit_,"");const l=new je(t,s),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(t)){const h=a.getImmediateChild(t);let f=r.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===t||a.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);const p=f==null?1:o(f,l);if(u&&!s.isEmpty()&&p>=0)return i!=null&&i.trackChildChange(Nc(t,s,h)),a.updateImmediateChild(t,s);{i!=null&&i.trackChildChange(xc(t,h));const _=a.updateImmediateChild(t,Ce.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(i!=null&&i.trackChildChange(Aa(f.name,f.node)),_.updateImmediateChild(f.name,f.node)):_}}else return s.isEmpty()?e:u&&o(c,l)>=0?(i!=null&&(i.trackChildChange(xc(c.name,c.node)),i.trackChildChange(Aa(t,s))),a.updateImmediateChild(t,s).updateImmediateChild(c.name,Ce.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=wt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return se(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return se(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ao}hasEnd(){return this.endSet_}getIndexEndValue(){return se(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return se(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:vi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return se(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===wt}copy(){const e=new ny;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function qB(n){return n.loadsAllData()?new ty(n.getIndex()):n.hasLimit()?new WB(n):new Oc(n)}function KB(n,e){const t=n.copy();return t.index_=e,t}function AE(n){const e={};if(n.isDefault())return e;let t;if(n.index_===wt?t="$priority":n.index_===Bk?t="$value":n.index_===_o?t="$key":(se(n.index_ instanceof ey,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Dt(t),n.startSet_){const s=n.startAfterSet_?"startAfter":"startAt";e[s]=Dt(n.indexStartValue_),n.startNameSet_&&(e[s]+=","+Dt(n.indexStartName_))}if(n.endSet_){const s=n.endBeforeSet_?"endBefore":"endAt";e[s]=Dt(n.indexEndValue_),n.endNameSet_&&(e[s]+=","+Dt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function RE(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==wt&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld extends Ak{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(se(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=fu("p:rest:"),this.listens_={}}listen(e,t,s,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=ld.getListenId_(e,s),a={};this.listens_[o]=a;const l=AE(e._queryParams);this.restRequest_(i+".json",l,(c,u)=>{let h=u;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(i,h,!1,s),ka(this.listens_,o)===a){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",r(f,null)}})}unlisten(e,t){const s=ld.getListenId_(e,t);delete this.listens_[s]}get(e){const t=AE(e._queryParams),s=e._path.toString(),r=new Ca;return this.restRequest_(s+".json",t,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(s,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},s){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ja(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Cc(a.responseText)}catch{jn("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,l)}else a.status!==401&&a.status!==404&&jn("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GB{constructor(){this.rootNode_=Ce.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(){return{value:null,children:new Map}}function Uk(n,e,t){if(Ue(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const s=$e(e);n.children.has(s)||n.children.set(s,cd());const r=n.children.get(s);e=ft(e),Uk(r,e,t)}}function cg(n,e,t){n.value!==null?t(e,n.value):QB(n,(s,r)=>{const i=new ot(e.toString()+"/"+s);cg(r,i,t)})}function QB(n,e){n.children.forEach((t,s)=>{e(s,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JB{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Hn(this.last_,(s,r)=>{t[s]=t[s]-r}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PE=10*1e3,YB=30*1e3,XB=5*60*1e3;class ZB{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new JB(e);const s=PE+(YB-PE)*Math.random();rc(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),t={};let s=!1;Hn(e,(r,i)=>{i>0&&er(this.statsToReport_,r)&&(t[r]=i,s=!0)}),s&&this.server_.reportStats(t),rc(this.reportStats_.bind(this),Math.floor(Math.random()*2*XB))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bs;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(bs||(bs={}));function jk(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function sy(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ry(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e,t,s){this.path=e,this.affectedTree=t,this.revert=s,this.type=bs.ACK_USER_WRITE,this.source=jk()}operationForChild(e){if(Ue(this.path)){if(this.affectedTree.value!=null)return se(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new ot(e));return new ud(Xe(),t,this.revert)}}else return se($e(this.path)===e,"operationForChild called for unrelated child."),new ud(ft(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e,t){this.source=e,this.path=t,this.type=bs.LISTEN_COMPLETE}operationForChild(e){return Ue(this.path)?new Mc(this.source,Xe()):new Mc(this.source,ft(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e,t,s){this.source=e,this.path=t,this.snap=s,this.type=bs.OVERWRITE}operationForChild(e){return Ue(this.path)?new Ro(this.source,Xe(),this.snap.getImmediateChild(e)):new Ro(this.source,ft(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,t,s){this.source=e,this.path=t,this.children=s,this.type=bs.MERGE}operationForChild(e){if(Ue(this.path)){const t=this.children.subtree(new ot(e));return t.isEmpty()?null:t.value?new Ro(this.source,Xe(),t.value):new Dc(this.source,Xe(),t)}else return se($e(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Dc(this.source,ft(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,t,s){this.node_=e,this.fullyInitialized_=t,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ue(e))return this.isFullyInitialized()&&!this.filtered_;const t=$e(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e${constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function t$(n,e,t,s){const r=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(HB(o.childName,o.snapshotNode))}),Rl(n,r,"child_removed",e,s,t),Rl(n,r,"child_added",e,s,t),Rl(n,r,"child_moved",i,s,t),Rl(n,r,"child_changed",e,s,t),Rl(n,r,"value",e,s,t),r}function Rl(n,e,t,s,r,i){const o=s.filter(a=>a.type===t);o.sort((a,l)=>s$(n,a,l)),o.forEach(a=>{const l=n$(n,a,i);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function n$(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function s$(n,e,t){if(e.childName==null||t.childName==null)throw Ga("Should only compare child_ events.");const s=new je(e.childName,e.snapshotNode),r=new je(t.childName,t.snapshotNode);return n.index_.compare(s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ef(n,e){return{eventCache:n,serverCache:e}}function ic(n,e,t,s){return Ef(new wi(e,t,s),n.serverCache)}function zk(n,e,t,s){return Ef(n.eventCache,new wi(e,t,s))}function hd(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Po(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zp;const r$=()=>(Zp||(Zp=new Fs(HF)),Zp);class gt{static fromObject(e){let t=new gt(null);return Hn(e,(s,r)=>{t=t.set(new ot(s),r)}),t}constructor(e,t=r$()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Xe(),value:this.value};if(Ue(e))return null;{const s=$e(e),r=this.children.get(s);if(r!==null){const i=r.findRootMostMatchingPathAndValue(ft(e),t);return i!=null?{path:Lt(new ot(s),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ue(e))return this;{const t=$e(e),s=this.children.get(t);return s!==null?s.subtree(ft(e)):new gt(null)}}set(e,t){if(Ue(e))return new gt(t,this.children);{const s=$e(e),i=(this.children.get(s)||new gt(null)).set(ft(e),t),o=this.children.insert(s,i);return new gt(this.value,o)}}remove(e){if(Ue(e))return this.children.isEmpty()?new gt(null):new gt(null,this.children);{const t=$e(e),s=this.children.get(t);if(s){const r=s.remove(ft(e));let i;return r.isEmpty()?i=this.children.remove(t):i=this.children.insert(t,r),this.value===null&&i.isEmpty()?new gt(null):new gt(this.value,i)}else return this}}get(e){if(Ue(e))return this.value;{const t=$e(e),s=this.children.get(t);return s?s.get(ft(e)):null}}setTree(e,t){if(Ue(e))return t;{const s=$e(e),i=(this.children.get(s)||new gt(null)).setTree(ft(e),t);let o;return i.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,i),new gt(this.value,o)}}fold(e){return this.fold_(Xe(),e)}fold_(e,t){const s={};return this.children.inorderTraversal((r,i)=>{s[r]=i.fold_(Lt(e,r),t)}),t(e,this.value,s)}findOnPath(e,t){return this.findOnPath_(e,Xe(),t)}findOnPath_(e,t,s){const r=this.value?s(t,this.value):!1;if(r)return r;if(Ue(e))return null;{const i=$e(e),o=this.children.get(i);return o?o.findOnPath_(ft(e),Lt(t,i),s):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Xe(),t)}foreachOnPath_(e,t,s){if(Ue(e))return this;{this.value&&s(t,this.value);const r=$e(e),i=this.children.get(r);return i?i.foreachOnPath_(ft(e),Lt(t,r),s):new gt(null)}}foreach(e){this.foreach_(Xe(),e)}foreach_(e,t){this.children.inorderTraversal((s,r)=>{r.foreach_(Lt(e,s),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,s)=>{s.value&&e(t,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e){this.writeTree_=e}static empty(){return new Es(new gt(null))}}function oc(n,e,t){if(Ue(e))return new Es(new gt(t));{const s=n.writeTree_.findRootMostValueAndPath(e);if(s!=null){const r=s.path;let i=s.value;const o=Pn(r,e);return i=i.updateChild(o,t),new Es(n.writeTree_.set(r,i))}else{const r=new gt(t),i=n.writeTree_.setTree(e,r);return new Es(i)}}}function xE(n,e,t){let s=n;return Hn(t,(r,i)=>{s=oc(s,Lt(e,r),i)}),s}function NE(n,e){if(Ue(e))return Es.empty();{const t=n.writeTree_.setTree(e,new gt(null));return new Es(t)}}function ug(n,e){return jo(n,e)!=null}function jo(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Pn(t.path,e)):null}function OE(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(wt,(s,r)=>{e.push(new je(s,r))}):n.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new je(s,r.value))}),e}function li(n,e){if(Ue(e))return n;{const t=jo(n,e);return t!=null?new Es(new gt(t)):new Es(n.writeTree_.subtree(e))}}function hg(n){return n.writeTree_.isEmpty()}function Ra(n,e){return Hk(Xe(),n.writeTree_,e)}function Hk(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let s=null;return e.children.inorderTraversal((r,i)=>{r===".priority"?(se(i.value!==null,"Priority writes must always be leaf nodes"),s=i.value):t=Hk(Lt(n,r),i,t)}),!t.getChild(n).isEmpty()&&s!==null&&(t=t.updateChild(Lt(n,".priority"),s)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tf(n,e){return Gk(e,n)}function i$(n,e,t,s,r){se(s>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:s,visible:r}),r&&(n.visibleWrites=oc(n.visibleWrites,e,t)),n.lastWriteId=s}function o$(n,e){for(let t=0;t<n.allWrites.length;t++){const s=n.allWrites[t];if(s.writeId===e)return s}return null}function a$(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);se(t>=0,"removeWrite called with nonexistent writeId.");const s=n.allWrites[t];n.allWrites.splice(t,1);let r=s.visible,i=!1,o=n.allWrites.length-1;for(;r&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&l$(a,s.path)?r=!1:vs(s.path,a.path)&&(i=!0)),o--}if(r){if(i)return c$(n),!0;if(s.snap)n.visibleWrites=NE(n.visibleWrites,s.path);else{const a=s.children;Hn(a,l=>{n.visibleWrites=NE(n.visibleWrites,Lt(s.path,l))})}return!0}else return!1}function l$(n,e){if(n.snap)return vs(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&vs(Lt(n.path,t),e))return!0;return!1}function c$(n){n.visibleWrites=Wk(n.allWrites,u$,Xe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function u$(n){return n.visible}function Wk(n,e,t){let s=Es.empty();for(let r=0;r<n.length;++r){const i=n[r];if(e(i)){const o=i.path;let a;if(i.snap)vs(t,o)?(a=Pn(t,o),s=oc(s,a,i.snap)):vs(o,t)&&(a=Pn(o,t),s=oc(s,Xe(),i.snap.getChild(a)));else if(i.children){if(vs(t,o))a=Pn(t,o),s=xE(s,a,i.children);else if(vs(o,t))if(a=Pn(o,t),Ue(a))s=xE(s,Xe(),i.children);else{const l=ka(i.children,$e(a));if(l){const c=l.getChild(ft(a));s=oc(s,Xe(),c)}}}else throw Ga("WriteRecord should have .snap or .children")}}return s}function qk(n,e,t,s,r){if(!s&&!r){const i=jo(n.visibleWrites,e);if(i!=null)return i;{const o=li(n.visibleWrites,e);if(hg(o))return t;if(t==null&&!ug(o,Xe()))return null;{const a=t||Ce.EMPTY_NODE;return Ra(o,a)}}}else{const i=li(n.visibleWrites,e);if(!r&&hg(i))return t;if(!r&&t==null&&!ug(i,Xe()))return null;{const o=function(c){return(c.visible||r)&&(!s||!~s.indexOf(c.writeId))&&(vs(c.path,e)||vs(e,c.path))},a=Wk(n.allWrites,o,e),l=t||Ce.EMPTY_NODE;return Ra(a,l)}}}function h$(n,e,t){let s=Ce.EMPTY_NODE;const r=jo(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(wt,(i,o)=>{s=s.updateImmediateChild(i,o)}),s;if(t){const i=li(n.visibleWrites,e);return t.forEachChild(wt,(o,a)=>{const l=Ra(li(i,new ot(o)),a);s=s.updateImmediateChild(o,l)}),OE(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const i=li(n.visibleWrites,e);return OE(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function d$(n,e,t,s,r){se(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=Lt(e,t);if(ug(n.visibleWrites,i))return null;{const o=li(n.visibleWrites,i);return hg(o)?r.getChild(t):Ra(o,r.getChild(t))}}function f$(n,e,t,s){const r=Lt(e,t),i=jo(n.visibleWrites,r);if(i!=null)return i;if(s.isCompleteForChild(t)){const o=li(n.visibleWrites,r);return Ra(o,s.getNode().getImmediateChild(t))}else return null}function p$(n,e){return jo(n.visibleWrites,e)}function m$(n,e,t,s,r,i,o){let a;const l=li(n.visibleWrites,e),c=jo(l,Xe());if(c!=null)a=c;else if(t!=null)a=Ra(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),f=i?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let p=f.getNext();for(;p&&u.length<r;)h(p,s)!==0&&u.push(p),p=f.getNext();return u}else return[]}function g$(){return{visibleWrites:Es.empty(),allWrites:[],lastWriteId:-1}}function dd(n,e,t,s){return qk(n.writeTree,n.treePath,e,t,s)}function iy(n,e){return h$(n.writeTree,n.treePath,e)}function ME(n,e,t,s){return d$(n.writeTree,n.treePath,e,t,s)}function fd(n,e){return p$(n.writeTree,Lt(n.treePath,e))}function _$(n,e,t,s,r,i){return m$(n.writeTree,n.treePath,e,t,s,r,i)}function oy(n,e,t){return f$(n.writeTree,n.treePath,e,t)}function Kk(n,e){return Gk(Lt(n.treePath,e),n.writeTree)}function Gk(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y${constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,s=e.childName;se(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),se(s!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const i=r.type;if(t==="child_added"&&i==="child_removed")this.changeMap.set(s,Nc(s,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&i==="child_added")this.changeMap.delete(s);else if(t==="child_removed"&&i==="child_changed")this.changeMap.set(s,xc(s,r.oldSnap));else if(t==="child_changed"&&i==="child_added")this.changeMap.set(s,Aa(s,e.snapshotNode));else if(t==="child_changed"&&i==="child_changed")this.changeMap.set(s,Nc(s,e.snapshotNode,r.oldSnap));else throw Ga("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v${getCompleteChild(e){return null}getChildAfterChild(e,t,s){return null}}const Qk=new v$;class ay{constructor(e,t,s=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=s}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new wi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return oy(this.writes_,e,s)}}getChildAfterChild(e,t,s){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Po(this.viewCache_),i=_$(this.writes_,r,t,1,s,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b$(n){return{filter:n}}function w$(n,e){se(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),se(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function E$(n,e,t,s,r){const i=new y$;let o,a;if(t.type===bs.OVERWRITE){const c=t;c.source.fromUser?o=dg(n,e,c.path,c.snap,s,r,i):(se(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!Ue(c.path),o=pd(n,e,c.path,c.snap,s,r,a,i))}else if(t.type===bs.MERGE){const c=t;c.source.fromUser?o=S$(n,e,c.path,c.children,s,r,i):(se(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=fg(n,e,c.path,c.children,s,r,a,i))}else if(t.type===bs.ACK_USER_WRITE){const c=t;c.revert?o=k$(n,e,c.path,s,r,i):o=I$(n,e,c.path,c.affectedTree,s,r,i)}else if(t.type===bs.LISTEN_COMPLETE)o=C$(n,e,t.path,s,i);else throw Ga("Unknown operation type: "+t.type);const l=i.getChanges();return T$(e,o,l),{viewCache:o,changes:l}}function T$(n,e,t){const s=e.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),i=hd(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!s.getNode().equals(i)||!s.getNode().getPriority().equals(i.getPriority()))&&t.push($k(hd(e)))}}function Jk(n,e,t,s,r,i){const o=e.eventCache;if(fd(s,t)!=null)return e;{let a,l;if(Ue(t))if(se(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Po(e),u=c instanceof Ce?c:Ce.EMPTY_NODE,h=iy(s,u);a=n.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{const c=dd(s,Po(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,i)}else{const c=$e(t);if(c===".priority"){se(bi(t)===1,"Can't have a priority with additional path components");const u=o.getNode();l=e.serverCache.getNode();const h=ME(s,t,u,l);h!=null?a=n.filter.updatePriority(u,h):a=o.getNode()}else{const u=ft(t);let h;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const f=ME(s,t,o.getNode(),l);f!=null?h=o.getNode().getImmediateChild(c).updateChild(u,f):h=o.getNode().getImmediateChild(c)}else h=oy(s,c,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),c,h,u,r,i):a=o.getNode()}}return ic(e,a,o.isFullyInitialized()||Ue(t),n.filter.filtersNodes())}}function pd(n,e,t,s,r,i,o,a){const l=e.serverCache;let c;const u=o?n.filter:n.filter.getIndexedFilter();if(Ue(t))c=u.updateFullNode(l.getNode(),s,null);else if(u.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(t,s);c=u.updateFullNode(l.getNode(),p,null)}else{const p=$e(t);if(!l.isCompleteForPath(t)&&bi(t)>1)return e;const m=ft(t),v=l.getNode().getImmediateChild(p).updateChild(m,s);p===".priority"?c=u.updatePriority(l.getNode(),v):c=u.updateChild(l.getNode(),p,v,m,Qk,null)}const h=zk(e,c,l.isFullyInitialized()||Ue(t),u.filtersNodes()),f=new ay(r,h,i);return Jk(n,h,t,r,f,a)}function dg(n,e,t,s,r,i,o){const a=e.eventCache;let l,c;const u=new ay(r,e,i);if(Ue(t))c=n.filter.updateFullNode(e.eventCache.getNode(),s,o),l=ic(e,c,!0,n.filter.filtersNodes());else{const h=$e(t);if(h===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),s),l=ic(e,c,a.isFullyInitialized(),a.isFiltered());else{const f=ft(t),p=a.getNode().getImmediateChild(h);let m;if(Ue(f))m=s;else{const _=u.getCompleteChild(h);_!=null?Pk(f)===".priority"&&_.getChild(Nk(f)).isEmpty()?m=_:m=_.updateChild(f,s):m=Ce.EMPTY_NODE}if(p.equals(m))l=e;else{const _=n.filter.updateChild(a.getNode(),h,m,f,u,o);l=ic(e,_,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function DE(n,e){return n.eventCache.isCompleteForChild(e)}function S$(n,e,t,s,r,i,o){let a=e;return s.foreach((l,c)=>{const u=Lt(t,l);DE(e,$e(u))&&(a=dg(n,a,u,c,r,i,o))}),s.foreach((l,c)=>{const u=Lt(t,l);DE(e,$e(u))||(a=dg(n,a,u,c,r,i,o))}),a}function LE(n,e,t){return t.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function fg(n,e,t,s,r,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;Ue(t)?c=s:c=new gt(null).setTree(t,s);const u=e.serverCache.getNode();return c.children.inorderTraversal((h,f)=>{if(u.hasChild(h)){const p=e.serverCache.getNode().getImmediateChild(h),m=LE(n,p,f);l=pd(n,l,new ot(h),m,r,i,o,a)}}),c.children.inorderTraversal((h,f)=>{const p=!e.serverCache.isCompleteForChild(h)&&f.value===null;if(!u.hasChild(h)&&!p){const m=e.serverCache.getNode().getImmediateChild(h),_=LE(n,m,f);l=pd(n,l,new ot(h),_,r,i,o,a)}}),l}function I$(n,e,t,s,r,i,o){if(fd(r,t)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(s.value!=null){if(Ue(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return pd(n,e,t,l.getNode().getChild(t),r,i,a,o);if(Ue(t)){let c=new gt(null);return l.getNode().forEachChild(_o,(u,h)=>{c=c.set(new ot(u),h)}),fg(n,e,t,c,r,i,a,o)}else return e}else{let c=new gt(null);return s.foreach((u,h)=>{const f=Lt(t,u);l.isCompleteForPath(f)&&(c=c.set(u,l.getNode().getChild(f)))}),fg(n,e,t,c,r,i,a,o)}}function C$(n,e,t,s,r){const i=e.serverCache,o=zk(e,i.getNode(),i.isFullyInitialized()||Ue(t),i.isFiltered());return Jk(n,o,t,s,Qk,r)}function k$(n,e,t,s,r,i){let o;if(fd(s,t)!=null)return e;{const a=new ay(s,e,r),l=e.eventCache.getNode();let c;if(Ue(t)||$e(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=dd(s,Po(e));else{const h=e.serverCache.getNode();se(h instanceof Ce,"serverChildren would be complete if leaf node"),u=iy(s,h)}u=u,c=n.filter.updateFullNode(l,u,i)}else{const u=$e(t);let h=oy(s,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=l.getImmediateChild(u)),h!=null?c=n.filter.updateChild(l,u,h,ft(t),a,i):e.eventCache.getNode().hasChild(u)?c=n.filter.updateChild(l,u,Ce.EMPTY_NODE,ft(t),a,i):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=dd(s,Po(e)),o.isLeafNode()&&(c=n.filter.updateFullNode(c,o,i)))}return o=e.serverCache.isFullyInitialized()||fd(s,Xe())!=null,ic(e,c,o,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A${constructor(e,t){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,r=new ty(s.getIndex()),i=qB(s);this.processor_=b$(i);const o=t.serverCache,a=t.eventCache,l=r.updateFullNode(Ce.EMPTY_NODE,o.getNode(),null),c=i.updateFullNode(Ce.EMPTY_NODE,a.getNode(),null),u=new wi(l,o.isFullyInitialized(),r.filtersNodes()),h=new wi(c,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Ef(h,u),this.eventGenerator_=new e$(this.query_)}get query(){return this.query_}}function R$(n){return n.viewCache_.serverCache.getNode()}function P$(n){return hd(n.viewCache_)}function x$(n,e){const t=Po(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ue(e)&&!t.getImmediateChild($e(e)).isEmpty())?t.getChild(e):null}function VE(n){return n.eventRegistrations_.length===0}function N$(n,e){n.eventRegistrations_.push(e)}function FE(n,e,t){const s=[];if(t){se(e==null,"A cancel should cancel all event registrations.");const r=n.query._path;n.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(t,r);o&&s.push(o)})}if(e){let r=[];for(let i=0;i<n.eventRegistrations_.length;++i){const o=n.eventRegistrations_[i];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(i+1));break}}n.eventRegistrations_=r}else n.eventRegistrations_=[];return s}function BE(n,e,t,s){e.type===bs.MERGE&&e.source.queryId!==null&&(se(Po(n.viewCache_),"We should always have a full cache before handling merges"),se(hd(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,i=E$(n.processor_,r,e,t,s);return w$(n.processor_,i.viewCache),se(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=i.viewCache,Yk(n,i.changes,i.viewCache.eventCache.getNode(),null)}function O$(n,e){const t=n.viewCache_.eventCache,s=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(wt,(i,o)=>{s.push(Aa(i,o))}),t.isFullyInitialized()&&s.push($k(t.getNode())),Yk(n,s,t.getNode(),e)}function Yk(n,e,t,s){const r=s?[s]:n.eventRegistrations_;return t$(n.eventGenerator_,e,t,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let md;class Xk{constructor(){this.views=new Map}}function M$(n){se(!md,"__referenceConstructor has already been defined"),md=n}function D$(){return se(md,"Reference.ts has not been loaded"),md}function L$(n){return n.views.size===0}function ly(n,e,t,s){const r=e.source.queryId;if(r!==null){const i=n.views.get(r);return se(i!=null,"SyncTree gave us an op for an invalid query."),BE(i,e,t,s)}else{let i=[];for(const o of n.views.values())i=i.concat(BE(o,e,t,s));return i}}function Zk(n,e,t,s,r){const i=e._queryIdentifier,o=n.views.get(i);if(!o){let a=dd(t,r?s:null),l=!1;a?l=!0:s instanceof Ce?(a=iy(t,s),l=!1):(a=Ce.EMPTY_NODE,l=!1);const c=Ef(new wi(a,l,!1),new wi(s,r,!1));return new A$(e,c)}return o}function V$(n,e,t,s,r,i){const o=Zk(n,e,s,r,i);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),N$(o,t),O$(o,t)}function F$(n,e,t,s){const r=e._queryIdentifier,i=[];let o=[];const a=Ei(n);if(r==="default")for(const[l,c]of n.views.entries())o=o.concat(FE(c,t,s)),VE(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||i.push(c.query));else{const l=n.views.get(r);l&&(o=o.concat(FE(l,t,s)),VE(l)&&(n.views.delete(r),l.query._queryParams.loadsAllData()||i.push(l.query)))}return a&&!Ei(n)&&i.push(new(D$())(e._repo,e._path)),{removed:i,events:o}}function e1(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function ci(n,e){let t=null;for(const s of n.views.values())t=t||x$(s,e);return t}function t1(n,e){if(e._queryParams.loadsAllData())return Sf(n);{const s=e._queryIdentifier;return n.views.get(s)}}function n1(n,e){return t1(n,e)!=null}function Ei(n){return Sf(n)!=null}function Sf(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gd;function B$(n){se(!gd,"__referenceConstructor has already been defined"),gd=n}function $$(){return se(gd,"Reference.ts has not been loaded"),gd}let U$=1;class $E{constructor(e){this.listenProvider_=e,this.syncPointTree_=new gt(null),this.pendingWriteTree_=g$(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function s1(n,e,t,s,r){return i$(n.pendingWriteTree_,e,t,s,r),r?gu(n,new Ro(jk(),e,t)):[]}function co(n,e,t=!1){const s=o$(n.pendingWriteTree_,e);if(a$(n.pendingWriteTree_,e)){let i=new gt(null);return s.snap!=null?i=i.set(Xe(),!0):Hn(s.children,o=>{i=i.set(new ot(o),!0)}),gu(n,new ud(s.path,i,t))}else return[]}function mu(n,e,t){return gu(n,new Ro(sy(),e,t))}function j$(n,e,t){const s=gt.fromObject(t);return gu(n,new Dc(sy(),e,s))}function z$(n,e){return gu(n,new Mc(sy(),e))}function H$(n,e,t){const s=uy(n,t);if(s){const r=hy(s),i=r.path,o=r.queryId,a=Pn(i,e),l=new Mc(ry(o),a);return dy(n,i,l)}else return[]}function _d(n,e,t,s,r=!1){const i=e._path,o=n.syncPointTree_.get(i);let a=[];if(o&&(e._queryIdentifier==="default"||n1(o,e))){const l=F$(o,e,t,s);L$(o)&&(n.syncPointTree_=n.syncPointTree_.remove(i));const c=l.removed;if(a=l.events,!r){const u=c.findIndex(f=>f._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(i,(f,p)=>Ei(p));if(u&&!h){const f=n.syncPointTree_.subtree(i);if(!f.isEmpty()){const p=K$(f);for(let m=0;m<p.length;++m){const _=p[m],v=_.query,I=a1(n,_);n.listenProvider_.startListening(ac(v),Lc(n,v),I.hashFn,I.onComplete)}}}!h&&c.length>0&&!s&&(u?n.listenProvider_.stopListening(ac(e),null):c.forEach(f=>{const p=n.queryToTagMap.get(If(f));n.listenProvider_.stopListening(ac(f),p)}))}G$(n,c)}return a}function r1(n,e,t,s){const r=uy(n,s);if(r!=null){const i=hy(r),o=i.path,a=i.queryId,l=Pn(o,e),c=new Ro(ry(a),l,t);return dy(n,o,c)}else return[]}function W$(n,e,t,s){const r=uy(n,s);if(r){const i=hy(r),o=i.path,a=i.queryId,l=Pn(o,e),c=gt.fromObject(t),u=new Dc(ry(a),l,c);return dy(n,o,u)}else return[]}function pg(n,e,t,s=!1){const r=e._path;let i=null,o=!1;n.syncPointTree_.foreachOnPath(r,(f,p)=>{const m=Pn(f,r);i=i||ci(p,m),o=o||Ei(p)});let a=n.syncPointTree_.get(r);a?(o=o||Ei(a),i=i||ci(a,Xe())):(a=new Xk,n.syncPointTree_=n.syncPointTree_.set(r,a));let l;i!=null?l=!0:(l=!1,i=Ce.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((p,m)=>{const _=ci(m,Xe());_&&(i=i.updateImmediateChild(p,_))}));const c=n1(a,e);if(!c&&!e._queryParams.loadsAllData()){const f=If(e);se(!n.queryToTagMap.has(f),"View does not exist, but we have a tag");const p=Q$();n.queryToTagMap.set(f,p),n.tagToQueryMap.set(p,f)}const u=Tf(n.pendingWriteTree_,r);let h=V$(a,e,t,u,i,l);if(!c&&!o&&!s){const f=t1(a,e);h=h.concat(J$(n,e,f))}return h}function cy(n,e,t){const r=n.pendingWriteTree_,i=n.syncPointTree_.findOnPath(e,(o,a)=>{const l=Pn(o,e),c=ci(a,l);if(c)return c});return qk(r,e,i,t,!0)}function q$(n,e){const t=e._path;let s=null;n.syncPointTree_.foreachOnPath(t,(c,u)=>{const h=Pn(c,t);s=s||ci(u,h)});let r=n.syncPointTree_.get(t);r?s=s||ci(r,Xe()):(r=new Xk,n.syncPointTree_=n.syncPointTree_.set(t,r));const i=s!=null,o=i?new wi(s,!0,!1):null,a=Tf(n.pendingWriteTree_,e._path),l=Zk(r,e,a,i?o.getNode():Ce.EMPTY_NODE,i);return P$(l)}function gu(n,e){return i1(e,n.syncPointTree_,null,Tf(n.pendingWriteTree_,Xe()))}function i1(n,e,t,s){if(Ue(n.path))return o1(n,e,t,s);{const r=e.get(Xe());t==null&&r!=null&&(t=ci(r,Xe()));let i=[];const o=$e(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){const c=t?t.getImmediateChild(o):null,u=Kk(s,o);i=i.concat(i1(a,l,c,u))}return r&&(i=i.concat(ly(r,n,s,t))),i}}function o1(n,e,t,s){const r=e.get(Xe());t==null&&r!=null&&(t=ci(r,Xe()));let i=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,c=Kk(s,o),u=n.operationForChild(o);u&&(i=i.concat(o1(u,a,l,c)))}),r&&(i=i.concat(ly(r,n,s,t))),i}function a1(n,e){const t=e.query,s=Lc(n,t);return{hashFn:()=>(R$(e)||Ce.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return s?H$(n,t._path,s):z$(n,t._path);{const i=KF(r,t);return _d(n,t,null,i)}}}}function Lc(n,e){const t=If(e);return n.queryToTagMap.get(t)}function If(n){return n._path.toString()+"$"+n._queryIdentifier}function uy(n,e){return n.tagToQueryMap.get(e)}function hy(n){const e=n.indexOf("$");return se(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ot(n.substr(0,e))}}function dy(n,e,t){const s=n.syncPointTree_.get(e);se(s,"Missing sync point for query tag that we're tracking");const r=Tf(n.pendingWriteTree_,e);return ly(s,t,r,null)}function K$(n){return n.fold((e,t,s)=>{if(t&&Ei(t))return[Sf(t)];{let r=[];return t&&(r=e1(t)),Hn(s,(i,o)=>{r=r.concat(o)}),r}})}function ac(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new($$())(n._repo,n._path):n}function G$(n,e){for(let t=0;t<e.length;++t){const s=e[t];if(!s._queryParams.loadsAllData()){const r=If(s),i=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(i)}}}function Q$(){return U$++}function J$(n,e,t){const s=e._path,r=Lc(n,e),i=a1(n,t),o=n.listenProvider_.startListening(ac(e),r,i.hashFn,i.onComplete),a=n.syncPointTree_.subtree(s);if(r)se(!Ei(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,h)=>{if(!Ue(c)&&u&&Ei(u))return[Sf(u).query];{let f=[];return u&&(f=f.concat(e1(u).map(p=>p.query))),Hn(h,(p,m)=>{f=f.concat(m)}),f}});for(let c=0;c<l.length;++c){const u=l[c];n.listenProvider_.stopListening(ac(u),Lc(n,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new fy(t)}node(){return this.node_}}class py{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Lt(this.path_,e);return new py(this.syncTree_,t)}node(){return cy(this.syncTree_,this.path_)}}const Y$=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},UE=function(n,e,t){if(!n||typeof n!="object")return n;if(se(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return X$(n[".sv"],e,t);if(typeof n[".sv"]=="object")return Z$(n[".sv"],e);se(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},X$=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:se(!1,"Unexpected server value: "+n)}},Z$=function(n,e,t){n.hasOwnProperty("increment")||se(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const s=n.increment;typeof s!="number"&&se(!1,"Unexpected increment value: "+s);const r=e.node();if(se(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return typeof o!="number"?s:o+s},eU=function(n,e,t,s){return my(e,new py(t,n),s)},l1=function(n,e,t){return my(n,new fy(e),t)};function my(n,e,t){const s=n.getPriority().val(),r=UE(s,e.getImmediateChild(".priority"),t);let i;if(n.isLeafNode()){const o=n,a=UE(o.getValue(),e,t);return a!==o.getValue()||r!==o.getPriority().val()?new Bt(a,Ut(r)):n}else{const o=n;return i=o,r!==o.getPriority().val()&&(i=i.updatePriority(new Bt(r))),o.forEachChild(wt,(a,l)=>{const c=my(l,e.getImmediateChild(a),t);c!==l&&(i=i.updateImmediateChild(a,c))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(e="",t=null,s={children:{},childCount:0}){this.name=e,this.parent=t,this.node=s}}function _y(n,e){let t=e instanceof ot?e:new ot(e),s=n,r=$e(t);for(;r!==null;){const i=ka(s.node.children,r)||{children:{},childCount:0};s=new gy(r,s,i),t=ft(t),r=$e(t)}return s}function nl(n){return n.node.value}function c1(n,e){n.node.value=e,mg(n)}function u1(n){return n.node.childCount>0}function tU(n){return nl(n)===void 0&&!u1(n)}function Cf(n,e){Hn(n.node.children,(t,s)=>{e(new gy(t,n,s))})}function h1(n,e,t,s){t&&e(n),Cf(n,r=>{h1(r,e,!0)})}function nU(n,e,t){let s=n.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function _u(n){return new ot(n.parent===null?n.name:_u(n.parent)+"/"+n.name)}function mg(n){n.parent!==null&&sU(n.parent,n.name,n)}function sU(n,e,t){const s=tU(t),r=er(n.node.children,e);s&&r?(delete n.node.children[e],n.node.childCount--,mg(n)):!s&&!r&&(n.node.children[e]=t.node,n.node.childCount++,mg(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rU=/[\[\].#$\/\u0000-\u001F\u007F]/,iU=/[\[\].#$\u0000-\u001F\u007F]/,em=10*1024*1024,d1=function(n){return typeof n=="string"&&n.length!==0&&!rU.test(n)},f1=function(n){return typeof n=="string"&&n.length!==0&&!iU.test(n)},oU=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),f1(n)},jE=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!q_(n)||n&&typeof n=="object"&&er(n,".sv")},p1=function(n,e,t,s){s&&e===void 0||yy(N_(n,"value"),e,t)},yy=function(n,e,t){const s=t instanceof ot?new CB(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+no(s));if(typeof e=="function")throw new Error(n+"contains a function "+no(s)+" with contents = "+e.toString());if(q_(e))throw new Error(n+"contains "+e.toString()+" "+no(s));if(typeof e=="string"&&e.length>em/3&&_f(e)>em)throw new Error(n+"contains a string greater than "+em+" utf8 bytes "+no(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,i=!1;if(Hn(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!d1(o)))throw new Error(n+" contains an invalid key ("+o+") "+no(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);kB(s,o),yy(n,a,s),AB(s)}),r&&i)throw new Error(n+' contains ".value" child '+no(s)+" in addition to actual children.")}},vy=function(n,e,t,s){if(!f1(t))throw new Error(N_(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},aU=function(n,e,t,s){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),vy(n,e,t)},m1=function(n,e){if($e(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},lU=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!d1(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!oU(t))throw new Error(N_(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cU{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function by(n,e){let t=null;for(let s=0;s<e.length;s++){const r=e[s],i=r.getPath();t!==null&&!Y_(i,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:i}),t.events.push(r)}t&&n.eventLists_.push(t)}function g1(n,e,t){by(n,t),_1(n,s=>Y_(s,e))}function Ks(n,e,t){by(n,t),_1(n,s=>vs(s,e)||vs(e,s))}function _1(n,e){n.recursionDepth_++;let t=!0;for(let s=0;s<n.eventLists_.length;s++){const r=n.eventLists_[s];if(r){const i=r.path;e(i)?(uU(n.eventLists_[s]),n.eventLists_[s]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function uU(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const s=t.getEventRunner();sc&&mn("event: "+t.toString()),tl(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hU="repo_interrupt",dU=25;class fU{constructor(e,t,s,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new cU,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=cd(),this.transactionQueueTree_=new gy,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function pU(n,e,t){if(n.stats_=Q_(n.repoInfo_),n.forceRestClient_||YF())n.server_=new ld(n.repoInfo_,(s,r,i,o)=>{zE(n,s,r,i,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>HE(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Dt(t)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}n.persistentConnection_=new br(n.repoInfo_,e,(s,r,i,o)=>{zE(n,s,r,i,o)},s=>{HE(n,s)},s=>{mU(n,s)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(s=>{n.server_.refreshAuthToken(s)}),n.appCheckProvider_.addTokenChangeListener(s=>{n.server_.refreshAppCheckToken(s.token)}),n.statsReporter_=nB(n.repoInfo_,()=>new ZB(n.stats_,n.server_)),n.infoData_=new GB,n.infoSyncTree_=new $E({startListening:(s,r,i,o)=>{let a=[];const l=n.infoData_.getNode(s._path);return l.isEmpty()||(a=mu(n.infoSyncTree_,s._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Ey(n,"connected",!1),n.serverSyncTree_=new $E({startListening:(s,r,i,o)=>(n.server_.listen(s,i,r,(a,l)=>{const c=o(a,l);Ks(n.eventQueue_,s._path,c)}),[]),stopListening:(s,r)=>{n.server_.unlisten(s,r)}})}function y1(n){const t=n.infoData_.getNode(new ot(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function wy(n){return Y$({timestamp:y1(n)})}function zE(n,e,t,s,r){n.dataUpdateCount++;const i=new ot(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(s){const l=Jh(t,c=>Ut(c));o=W$(n.serverSyncTree_,i,l,r)}else{const l=Ut(t);o=r1(n.serverSyncTree_,i,l,r)}else if(s){const l=Jh(t,c=>Ut(c));o=j$(n.serverSyncTree_,i,l)}else{const l=Ut(t);o=mu(n.serverSyncTree_,i,l)}let a=i;o.length>0&&(a=Af(n,i)),Ks(n.eventQueue_,a,o)}function HE(n,e){Ey(n,"connected",e),e===!1&&yU(n)}function mU(n,e){Hn(e,(t,s)=>{Ey(n,t,s)})}function Ey(n,e,t){const s=new ot("/.info/"+e),r=Ut(t);n.infoData_.updateSnapshot(s,r);const i=mu(n.infoSyncTree_,s,r);Ks(n.eventQueue_,s,i)}function v1(n){return n.nextWriteId_++}function gU(n,e,t){const s=q$(n.serverSyncTree_,e);return s!=null?Promise.resolve(s):n.server_.get(e).then(r=>{const i=Ut(r).withIndex(e._queryParams.getIndex());pg(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=mu(n.serverSyncTree_,e._path,i);else{const a=Lc(n.serverSyncTree_,e);o=r1(n.serverSyncTree_,e._path,i,a)}return Ks(n.eventQueue_,e._path,o),_d(n.serverSyncTree_,e,t,null,!0),i},r=>(kf(n,"get for query "+Dt(e)+" failed: "+r),Promise.reject(new Error(r))))}function _U(n,e,t,s,r){kf(n,"set",{path:e.toString(),value:t,priority:s});const i=wy(n),o=Ut(t,s),a=cy(n.serverSyncTree_,e),l=l1(o,a,i),c=v1(n),u=s1(n.serverSyncTree_,e,l,c,!0);by(n.eventQueue_,u),n.server_.put(e.toString(),o.val(!0),(f,p)=>{const m=f==="ok";m||jn("set at "+e+" failed: "+f);const _=co(n.serverSyncTree_,c,!m);Ks(n.eventQueue_,e,_),wU(n,r,f,p)});const h=S1(n,e);Af(n,h),Ks(n.eventQueue_,h,[])}function yU(n){kf(n,"onDisconnectEvents");const e=wy(n),t=cd();cg(n.onDisconnect_,Xe(),(r,i)=>{const o=eU(r,i,n.serverSyncTree_,e);Uk(t,r,o)});let s=[];cg(t,Xe(),(r,i)=>{s=s.concat(mu(n.serverSyncTree_,r,i));const o=S1(n,r);Af(n,o)}),n.onDisconnect_=cd(),Ks(n.eventQueue_,Xe(),s)}function vU(n,e,t){let s;$e(e._path)===".info"?s=pg(n.infoSyncTree_,e,t):s=pg(n.serverSyncTree_,e,t),g1(n.eventQueue_,e._path,s)}function WE(n,e,t){let s;$e(e._path)===".info"?s=_d(n.infoSyncTree_,e,t):s=_d(n.serverSyncTree_,e,t),g1(n.eventQueue_,e._path,s)}function bU(n){n.persistentConnection_&&n.persistentConnection_.interrupt(hU)}function kf(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),mn(t,...e)}function wU(n,e,t,s){e&&tl(()=>{if(t==="ok")e(null);else{const r=(t||"error").toUpperCase();let i=r;s&&(i+=": "+s);const o=new Error(i);o.code=r,e(o)}})}function b1(n,e,t){return cy(n.serverSyncTree_,e,t)||Ce.EMPTY_NODE}function Ty(n,e=n.transactionQueueTree_){if(e||Rf(n,e),nl(e)){const t=E1(n,e);se(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&EU(n,_u(e),t)}else u1(e)&&Cf(e,t=>{Ty(n,t)})}function EU(n,e,t){const s=t.map(c=>c.currentWriteId),r=b1(n,e,s);let i=r;const o=r.hash();for(let c=0;c<t.length;c++){const u=t[c];se(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=Pn(e,u.path);i=i.updateChild(h,u.currentOutputSnapshotRaw)}const a=i.val(!0),l=e;n.server_.put(l.toString(),a,c=>{kf(n,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const h=[];for(let f=0;f<t.length;f++)t[f].status=2,u=u.concat(co(n.serverSyncTree_,t[f].currentWriteId)),t[f].onComplete&&h.push(()=>t[f].onComplete(null,!0,t[f].currentOutputSnapshotResolved)),t[f].unwatcher();Rf(n,_y(n.transactionQueueTree_,e)),Ty(n,n.transactionQueueTree_),Ks(n.eventQueue_,e,u);for(let f=0;f<h.length;f++)tl(h[f])}else{if(c==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{jn("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=c}Af(n,e)}},o)}function Af(n,e){const t=w1(n,e),s=_u(t),r=E1(n,t);return TU(n,r,s),s}function TU(n,e,t){if(e.length===0)return;const s=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=Pn(t,l.path);let u=!1,h;if(se(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,h=l.abortReason,r=r.concat(co(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=dU)u=!0,h="maxretry",r=r.concat(co(n.serverSyncTree_,l.currentWriteId,!0));else{const f=b1(n,l.path,o);l.currentInputSnapshot=f;const p=e[a].update(f.val());if(p!==void 0){yy("transaction failed: Data returned ",p,l.path);let m=Ut(p);typeof p=="object"&&p!=null&&er(p,".priority")||(m=m.updatePriority(f.getPriority()));const v=l.currentWriteId,I=wy(n),O=l1(m,f,I);l.currentOutputSnapshotRaw=m,l.currentOutputSnapshotResolved=O,l.currentWriteId=v1(n),o.splice(o.indexOf(v),1),r=r.concat(s1(n.serverSyncTree_,l.path,O,l.currentWriteId,l.applyLocally)),r=r.concat(co(n.serverSyncTree_,v,!0))}else u=!0,h="nodata",r=r.concat(co(n.serverSyncTree_,l.currentWriteId,!0))}Ks(n.eventQueue_,t,r),r=[],u&&(e[a].status=2,function(f){setTimeout(f,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(h),!1,null))))}Rf(n,n.transactionQueueTree_);for(let a=0;a<s.length;a++)tl(s[a]);Ty(n,n.transactionQueueTree_)}function w1(n,e){let t,s=n.transactionQueueTree_;for(t=$e(e);t!==null&&nl(s)===void 0;)s=_y(s,t),e=ft(e),t=$e(e);return s}function E1(n,e){const t=[];return T1(n,e,t),t.sort((s,r)=>s.order-r.order),t}function T1(n,e,t){const s=nl(e);if(s)for(let r=0;r<s.length;r++)t.push(s[r]);Cf(e,r=>{T1(n,r,t)})}function Rf(n,e){const t=nl(e);if(t){let s=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[s]=t[r],s++);t.length=s,c1(e,t.length>0?t:void 0)}Cf(e,s=>{Rf(n,s)})}function S1(n,e){const t=_u(w1(n,e)),s=_y(n.transactionQueueTree_,e);return nU(s,r=>{tm(n,r)}),tm(n,s),h1(s,r=>{tm(n,r)}),t}function tm(n,e){const t=nl(e);if(t){const s=[];let r=[],i=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(se(i===o-1,"All SENT items should be at beginning of queue."),i=o,t[o].status=3,t[o].abortReason="set"):(se(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(co(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&s.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?c1(e,void 0):t.length=i+1,Ks(n.eventQueue_,_u(e),r);for(let o=0;o<s.length;o++)tl(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SU(n){let e="";const t=n.split("/");for(let s=0;s<t.length;s++)if(t[s].length>0){let r=t[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function IU(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const s=t.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):jn(`Invalid query segment '${t}' in query '${n}'`)}return e}const qE=function(n,e){const t=CU(n),s=t.namespace;t.domain==="firebase.com"&&kr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&t.domain!=="localhost"&&kr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||jF();const r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new wk(t.host,t.secure,s,r,e,"",s!==t.subdomain),path:new ot(t.pathString)}},CU=function(n){let e="",t="",s="",r="",i="",o=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");u===-1&&(u=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(u,h)),u<h&&(r=SU(n.substring(u,h)));const f=IU(n.substring(Math.min(n.length,h)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if(p.toLowerCase()==="localhost")t="localhost";else if(p.split(".").length<=2)t=p;else{const m=e.indexOf(".");s=e.substring(0,m).toLowerCase(),t=e.substring(m+1),i=s}"ns"in f&&(i=f.ns)}return{host:e,port:l,domain:t,subdomain:s,secure:o,scheme:a,pathString:r,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",kU=function(){let n=0;const e=[];return function(t){const s=t===n;n=t;let r;const i=new Array(8);for(r=7;r>=0;r--)i[r]=KE.charAt(t%64),t=Math.floor(t/64);se(t===0,"Cannot push at time == 0");let o=i.join("");if(s){for(r=11;r>=0&&e[r]===63;r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)o+=KE.charAt(e[r]);return se(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(e,t,s,r){this.eventType=e,this.eventRegistration=t,this.snapshot=s,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Dt(this.snapshot.exportVal())}}class C1{constructor(e,t,s){this.eventRegistration=e,this.error=t,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return se(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,t,s,r){this._repo=e,this._path=t,this._queryParams=s,this._orderByCalled=r}get key(){return Ue(this._path)?null:Pk(this._path)}get ref(){return new tr(this._repo,this._path)}get _queryIdentifier(){const e=RE(this._queryParams),t=K_(e);return t==="{}"?"default":t}get _queryObject(){return RE(this._queryParams)}isEqual(e){if(e=Ze(e),!(e instanceof Pf))return!1;const t=this._repo===e._repo,s=Y_(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+IB(this._path)}}function AU(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function RU(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===_o){const s="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Ao)throw new Error(s);if(typeof e!="string")throw new Error(r)}if(n.hasEnd()){if(n.getIndexEndName()!==vi)throw new Error(s);if(typeof t!="string")throw new Error(r)}}else if(n.getIndex()===wt){if(e!=null&&!jE(e)||t!=null&&!jE(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(se(n.getIndex()instanceof ey||n.getIndex()===Bk,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class tr extends Pf{constructor(e,t){super(e,t,new ny,!1)}get parent(){const e=Nk(this._path);return e===null?null:new tr(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Pa{constructor(e,t,s){this._node=e,this.ref=t,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new ot(e),s=xa(this.ref,e);return new Pa(this._node.getChild(t),s,wt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,r)=>e(new Pa(r,xa(this.ref,s),wt)))}hasChild(e){const t=new ot(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Sy(n,e){return n=Ze(n),n._checkNotDeleted("ref"),e!==void 0?xa(n._root,e):n._root}function xa(n,e){return n=Ze(n),$e(n._path)===null?aU("child","path",e):vy("child","path",e),new tr(n._repo,Lt(n._path,e))}function PU(n,e){n=Ze(n),m1("push",n._path),p1("push",e,n._path,!0);const t=y1(n._repo),s=kU(t),r=xa(n,s),i=xa(n,s);let o;return e!=null?o=xU(i,e).then(()=>i):o=Promise.resolve(i),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}function xU(n,e){n=Ze(n),m1("set",n._path),p1("set",e,n._path,!1);const t=new Ca;return _U(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function A1(n){n=Ze(n);const e=new k1(()=>{}),t=new xf(e);return gU(n._repo,n,t).then(s=>new Pa(s,new tr(n._repo,n._path),n._queryParams.getIndex()))}class xf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const s=t._queryParams.getIndex();return new I1("value",this,new Pa(e.snapshotNode,new tr(t._repo,t._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new C1(this,e,t):null}matches(e){return e instanceof xf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Iy{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new C1(this,e,t):null}createEvent(e,t){se(e.childName!=null,"Child events should have a childName.");const s=xa(new tr(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new I1(e.type,this,new Pa(e.snapshotNode,s,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Iy?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function yu(n,e,t,s,r){let i;if(typeof s=="object"&&(i=void 0,r=s),typeof s=="function"&&(i=s),r&&r.onlyOnce){const l=t,c=(u,h)=>{WE(n._repo,n,a),l(u,h)};c.userCallback=t.userCallback,c.context=t.context,t=c}const o=new k1(t,i||void 0),a=e==="value"?new xf(o):new Iy(e,o);return vU(n._repo,n,a),()=>WE(n._repo,n,a)}function R1(n,e,t,s){return yu(n,"value",e,t,s)}function NU(n,e,t,s){return yu(n,"child_added",e,t,s)}function OU(n,e,t,s){return yu(n,"child_changed",e,t,s)}function MU(n,e,t,s){return yu(n,"child_moved",e,t,s)}function DU(n,e,t,s){return yu(n,"child_removed",e,t,s)}let LU=class{};class VU extends LU{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){AU(e,"orderByChild");const t=new ot(this._path);if(Ue(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const s=new ey(t),r=KB(e._queryParams,s);return RU(r),new Pf(e._repo,e._path,r,!0)}}function FU(n){return vy("orderByChild","path",n),new VU(n)}function BU(n,...e){let t=Ze(n);for(const s of e)t=s._apply(t);return t}M$(tr);B$(tr);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $U="FIREBASE_DATABASE_EMULATOR_HOST",gg={};let UU=!1;function jU(n,e,t,s){n.repoInfo_=new wk(e,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),s&&(n.authTokenProvider_=s)}function zU(n,e,t,s,r){let i=s||n.options.databaseURL;i===void 0&&(n.options.projectId||kr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),mn("Using default host for project ",n.options.projectId),i=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=qE(i,r),a=o.repoInfo,l;typeof process<"u"&&hE&&(l=hE[$U]),l?(i=`http://${l}?ns=${a.namespace}`,o=qE(i,r),a=o.repoInfo):o.repoInfo.secure;const c=new ZF(n.name,n.options,e);lU("Invalid Firebase Database URL",o),Ue(o.path)||kr("Database URL must point to the root of a Firebase Database (not including a child path).");const u=WU(a,n,c,new XF(n,t));return new qU(u,n)}function HU(n,e){const t=gg[e];(!t||t[n.key]!==n)&&kr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),bU(n),delete t[n.key]}function WU(n,e,t,s){let r=gg[e.name];r||(r={},gg[e.name]=r);let i=r[n.toURLString()];return i&&kr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new fU(n,UU,t,s),r[n.toURLString()]=i,i}class qU{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(pU(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new tr(this._repo,Xe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(HU(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&kr("Cannot call "+e+" on a deleted database.")}}function Cy(n=Xa(),e){const t=Ya(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const s=gf("database");s&&KU(t,...s)}return t}function KU(n,e,t,s={}){n=Ze(n),n._checkNotDeleted("useEmulator");const r=`${e}:${t}`,i=n._repoInternal;if(n._instanceStarted){if(r===n._repoInternal.repoInfo_.host&&yi(s,i.repoInfo_.emulatorOptions))return;kr("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&kr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Ih(Ih.OWNER);else if(s.mockUserToken){const a=typeof s.mockUserToken=="string"?s.mockUserToken:P_(s.mockUserToken,n.app.options.projectId);o=new Ih(a)}jU(i,r,s,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GU(n){LF(Di),Cs(new ds("database",(e,{instanceIdentifier:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return zU(s,r,i,t)},"PUBLIC").setMultipleInstances(!0)),Nn(dE,fE,n),Nn(dE,fE,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QU={".sv":"timestamp"};function JU(){return QU}br.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};br.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};GU();var GE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ui,P1;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,T){function E(){}E.prototype=T.prototype,A.D=T.prototype,A.prototype=new E,A.prototype.constructor=A,A.C=function(C,x,k){for(var b=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)b[ye-2]=arguments[ye];return T.prototype[x].apply(C,b)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(A,T,E){E||(E=0);var C=Array(16);if(typeof T=="string")for(var x=0;16>x;++x)C[x]=T.charCodeAt(E++)|T.charCodeAt(E++)<<8|T.charCodeAt(E++)<<16|T.charCodeAt(E++)<<24;else for(x=0;16>x;++x)C[x]=T[E++]|T[E++]<<8|T[E++]<<16|T[E++]<<24;T=A.g[0],E=A.g[1],x=A.g[2];var k=A.g[3],b=T+(k^E&(x^k))+C[0]+3614090360&4294967295;T=E+(b<<7&4294967295|b>>>25),b=k+(x^T&(E^x))+C[1]+3905402710&4294967295,k=T+(b<<12&4294967295|b>>>20),b=x+(E^k&(T^E))+C[2]+606105819&4294967295,x=k+(b<<17&4294967295|b>>>15),b=E+(T^x&(k^T))+C[3]+3250441966&4294967295,E=x+(b<<22&4294967295|b>>>10),b=T+(k^E&(x^k))+C[4]+4118548399&4294967295,T=E+(b<<7&4294967295|b>>>25),b=k+(x^T&(E^x))+C[5]+1200080426&4294967295,k=T+(b<<12&4294967295|b>>>20),b=x+(E^k&(T^E))+C[6]+2821735955&4294967295,x=k+(b<<17&4294967295|b>>>15),b=E+(T^x&(k^T))+C[7]+4249261313&4294967295,E=x+(b<<22&4294967295|b>>>10),b=T+(k^E&(x^k))+C[8]+1770035416&4294967295,T=E+(b<<7&4294967295|b>>>25),b=k+(x^T&(E^x))+C[9]+2336552879&4294967295,k=T+(b<<12&4294967295|b>>>20),b=x+(E^k&(T^E))+C[10]+4294925233&4294967295,x=k+(b<<17&4294967295|b>>>15),b=E+(T^x&(k^T))+C[11]+2304563134&4294967295,E=x+(b<<22&4294967295|b>>>10),b=T+(k^E&(x^k))+C[12]+1804603682&4294967295,T=E+(b<<7&4294967295|b>>>25),b=k+(x^T&(E^x))+C[13]+4254626195&4294967295,k=T+(b<<12&4294967295|b>>>20),b=x+(E^k&(T^E))+C[14]+2792965006&4294967295,x=k+(b<<17&4294967295|b>>>15),b=E+(T^x&(k^T))+C[15]+1236535329&4294967295,E=x+(b<<22&4294967295|b>>>10),b=T+(x^k&(E^x))+C[1]+4129170786&4294967295,T=E+(b<<5&4294967295|b>>>27),b=k+(E^x&(T^E))+C[6]+3225465664&4294967295,k=T+(b<<9&4294967295|b>>>23),b=x+(T^E&(k^T))+C[11]+643717713&4294967295,x=k+(b<<14&4294967295|b>>>18),b=E+(k^T&(x^k))+C[0]+3921069994&4294967295,E=x+(b<<20&4294967295|b>>>12),b=T+(x^k&(E^x))+C[5]+3593408605&4294967295,T=E+(b<<5&4294967295|b>>>27),b=k+(E^x&(T^E))+C[10]+38016083&4294967295,k=T+(b<<9&4294967295|b>>>23),b=x+(T^E&(k^T))+C[15]+3634488961&4294967295,x=k+(b<<14&4294967295|b>>>18),b=E+(k^T&(x^k))+C[4]+3889429448&4294967295,E=x+(b<<20&4294967295|b>>>12),b=T+(x^k&(E^x))+C[9]+568446438&4294967295,T=E+(b<<5&4294967295|b>>>27),b=k+(E^x&(T^E))+C[14]+3275163606&4294967295,k=T+(b<<9&4294967295|b>>>23),b=x+(T^E&(k^T))+C[3]+4107603335&4294967295,x=k+(b<<14&4294967295|b>>>18),b=E+(k^T&(x^k))+C[8]+1163531501&4294967295,E=x+(b<<20&4294967295|b>>>12),b=T+(x^k&(E^x))+C[13]+2850285829&4294967295,T=E+(b<<5&4294967295|b>>>27),b=k+(E^x&(T^E))+C[2]+4243563512&4294967295,k=T+(b<<9&4294967295|b>>>23),b=x+(T^E&(k^T))+C[7]+1735328473&4294967295,x=k+(b<<14&4294967295|b>>>18),b=E+(k^T&(x^k))+C[12]+2368359562&4294967295,E=x+(b<<20&4294967295|b>>>12),b=T+(E^x^k)+C[5]+4294588738&4294967295,T=E+(b<<4&4294967295|b>>>28),b=k+(T^E^x)+C[8]+2272392833&4294967295,k=T+(b<<11&4294967295|b>>>21),b=x+(k^T^E)+C[11]+1839030562&4294967295,x=k+(b<<16&4294967295|b>>>16),b=E+(x^k^T)+C[14]+4259657740&4294967295,E=x+(b<<23&4294967295|b>>>9),b=T+(E^x^k)+C[1]+2763975236&4294967295,T=E+(b<<4&4294967295|b>>>28),b=k+(T^E^x)+C[4]+1272893353&4294967295,k=T+(b<<11&4294967295|b>>>21),b=x+(k^T^E)+C[7]+4139469664&4294967295,x=k+(b<<16&4294967295|b>>>16),b=E+(x^k^T)+C[10]+3200236656&4294967295,E=x+(b<<23&4294967295|b>>>9),b=T+(E^x^k)+C[13]+681279174&4294967295,T=E+(b<<4&4294967295|b>>>28),b=k+(T^E^x)+C[0]+3936430074&4294967295,k=T+(b<<11&4294967295|b>>>21),b=x+(k^T^E)+C[3]+3572445317&4294967295,x=k+(b<<16&4294967295|b>>>16),b=E+(x^k^T)+C[6]+76029189&4294967295,E=x+(b<<23&4294967295|b>>>9),b=T+(E^x^k)+C[9]+3654602809&4294967295,T=E+(b<<4&4294967295|b>>>28),b=k+(T^E^x)+C[12]+3873151461&4294967295,k=T+(b<<11&4294967295|b>>>21),b=x+(k^T^E)+C[15]+530742520&4294967295,x=k+(b<<16&4294967295|b>>>16),b=E+(x^k^T)+C[2]+3299628645&4294967295,E=x+(b<<23&4294967295|b>>>9),b=T+(x^(E|~k))+C[0]+4096336452&4294967295,T=E+(b<<6&4294967295|b>>>26),b=k+(E^(T|~x))+C[7]+1126891415&4294967295,k=T+(b<<10&4294967295|b>>>22),b=x+(T^(k|~E))+C[14]+2878612391&4294967295,x=k+(b<<15&4294967295|b>>>17),b=E+(k^(x|~T))+C[5]+4237533241&4294967295,E=x+(b<<21&4294967295|b>>>11),b=T+(x^(E|~k))+C[12]+1700485571&4294967295,T=E+(b<<6&4294967295|b>>>26),b=k+(E^(T|~x))+C[3]+2399980690&4294967295,k=T+(b<<10&4294967295|b>>>22),b=x+(T^(k|~E))+C[10]+4293915773&4294967295,x=k+(b<<15&4294967295|b>>>17),b=E+(k^(x|~T))+C[1]+2240044497&4294967295,E=x+(b<<21&4294967295|b>>>11),b=T+(x^(E|~k))+C[8]+1873313359&4294967295,T=E+(b<<6&4294967295|b>>>26),b=k+(E^(T|~x))+C[15]+4264355552&4294967295,k=T+(b<<10&4294967295|b>>>22),b=x+(T^(k|~E))+C[6]+2734768916&4294967295,x=k+(b<<15&4294967295|b>>>17),b=E+(k^(x|~T))+C[13]+1309151649&4294967295,E=x+(b<<21&4294967295|b>>>11),b=T+(x^(E|~k))+C[4]+4149444226&4294967295,T=E+(b<<6&4294967295|b>>>26),b=k+(E^(T|~x))+C[11]+3174756917&4294967295,k=T+(b<<10&4294967295|b>>>22),b=x+(T^(k|~E))+C[2]+718787259&4294967295,x=k+(b<<15&4294967295|b>>>17),b=E+(k^(x|~T))+C[9]+3951481745&4294967295,A.g[0]=A.g[0]+T&4294967295,A.g[1]=A.g[1]+(x+(b<<21&4294967295|b>>>11))&4294967295,A.g[2]=A.g[2]+x&4294967295,A.g[3]=A.g[3]+k&4294967295}s.prototype.u=function(A,T){T===void 0&&(T=A.length);for(var E=T-this.blockSize,C=this.B,x=this.h,k=0;k<T;){if(x==0)for(;k<=E;)r(this,A,k),k+=this.blockSize;if(typeof A=="string"){for(;k<T;)if(C[x++]=A.charCodeAt(k++),x==this.blockSize){r(this,C),x=0;break}}else for(;k<T;)if(C[x++]=A[k++],x==this.blockSize){r(this,C),x=0;break}}this.h=x,this.o+=T},s.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var T=1;T<A.length-8;++T)A[T]=0;var E=8*this.o;for(T=A.length-8;T<A.length;++T)A[T]=E&255,E/=256;for(this.u(A),A=Array(16),T=E=0;4>T;++T)for(var C=0;32>C;C+=8)A[E++]=this.g[T]>>>C&255;return A};function i(A,T){var E=a;return Object.prototype.hasOwnProperty.call(E,A)?E[A]:E[A]=T(A)}function o(A,T){this.h=T;for(var E=[],C=!0,x=A.length-1;0<=x;x--){var k=A[x]|0;C&&k==T||(E[x]=k,C=!1)}this.g=E}var a={};function l(A){return-128<=A&&128>A?i(A,function(T){return new o([T|0],0>T?-1:0)}):new o([A|0],0>A?-1:0)}function c(A){if(isNaN(A)||!isFinite(A))return h;if(0>A)return v(c(-A));for(var T=[],E=1,C=0;A>=E;C++)T[C]=A/E|0,E*=4294967296;return new o(T,0)}function u(A,T){if(A.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(A.charAt(0)=="-")return v(u(A.substring(1),T));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=c(Math.pow(T,8)),C=h,x=0;x<A.length;x+=8){var k=Math.min(8,A.length-x),b=parseInt(A.substring(x,x+k),T);8>k?(k=c(Math.pow(T,k)),C=C.j(k).add(c(b))):(C=C.j(E),C=C.add(c(b)))}return C}var h=l(0),f=l(1),p=l(16777216);n=o.prototype,n.m=function(){if(_(this))return-v(this).m();for(var A=0,T=1,E=0;E<this.g.length;E++){var C=this.i(E);A+=(0<=C?C:4294967296+C)*T,T*=4294967296}return A},n.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(m(this))return"0";if(_(this))return"-"+v(this).toString(A);for(var T=c(Math.pow(A,6)),E=this,C="";;){var x=D(E,T).g;E=I(E,x.j(T));var k=((0<E.g.length?E.g[0]:E.h)>>>0).toString(A);if(E=x,m(E))return k+C;for(;6>k.length;)k="0"+k;C=k+C}},n.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function m(A){if(A.h!=0)return!1;for(var T=0;T<A.g.length;T++)if(A.g[T]!=0)return!1;return!0}function _(A){return A.h==-1}n.l=function(A){return A=I(this,A),_(A)?-1:m(A)?0:1};function v(A){for(var T=A.g.length,E=[],C=0;C<T;C++)E[C]=~A.g[C];return new o(E,~A.h).add(f)}n.abs=function(){return _(this)?v(this):this},n.add=function(A){for(var T=Math.max(this.g.length,A.g.length),E=[],C=0,x=0;x<=T;x++){var k=C+(this.i(x)&65535)+(A.i(x)&65535),b=(k>>>16)+(this.i(x)>>>16)+(A.i(x)>>>16);C=b>>>16,k&=65535,b&=65535,E[x]=b<<16|k}return new o(E,E[E.length-1]&-2147483648?-1:0)};function I(A,T){return A.add(v(T))}n.j=function(A){if(m(this)||m(A))return h;if(_(this))return _(A)?v(this).j(v(A)):v(v(this).j(A));if(_(A))return v(this.j(v(A)));if(0>this.l(p)&&0>A.l(p))return c(this.m()*A.m());for(var T=this.g.length+A.g.length,E=[],C=0;C<2*T;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var x=0;x<A.g.length;x++){var k=this.i(C)>>>16,b=this.i(C)&65535,ye=A.i(x)>>>16,Ve=A.i(x)&65535;E[2*C+2*x]+=b*Ve,O(E,2*C+2*x),E[2*C+2*x+1]+=k*Ve,O(E,2*C+2*x+1),E[2*C+2*x+1]+=b*ye,O(E,2*C+2*x+1),E[2*C+2*x+2]+=k*ye,O(E,2*C+2*x+2)}for(C=0;C<T;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=T;C<2*T;C++)E[C]=0;return new o(E,0)};function O(A,T){for(;(A[T]&65535)!=A[T];)A[T+1]+=A[T]>>>16,A[T]&=65535,T++}function P(A,T){this.g=A,this.h=T}function D(A,T){if(m(T))throw Error("division by zero");if(m(A))return new P(h,h);if(_(A))return T=D(v(A),T),new P(v(T.g),v(T.h));if(_(T))return T=D(A,v(T)),new P(v(T.g),T.h);if(30<A.g.length){if(_(A)||_(T))throw Error("slowDivide_ only works with positive integers.");for(var E=f,C=T;0>=C.l(A);)E=B(E),C=B(C);var x=M(E,1),k=M(C,1);for(C=M(C,2),E=M(E,2);!m(C);){var b=k.add(C);0>=b.l(A)&&(x=x.add(E),k=b),C=M(C,1),E=M(E,1)}return T=I(A,x.j(T)),new P(x,T)}for(x=h;0<=A.l(T);){for(E=Math.max(1,Math.floor(A.m()/T.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),k=c(E),b=k.j(T);_(b)||0<b.l(A);)E-=C,k=c(E),b=k.j(T);m(k)&&(k=f),x=x.add(k),A=I(A,b)}return new P(x,A)}n.A=function(A){return D(this,A).h},n.and=function(A){for(var T=Math.max(this.g.length,A.g.length),E=[],C=0;C<T;C++)E[C]=this.i(C)&A.i(C);return new o(E,this.h&A.h)},n.or=function(A){for(var T=Math.max(this.g.length,A.g.length),E=[],C=0;C<T;C++)E[C]=this.i(C)|A.i(C);return new o(E,this.h|A.h)},n.xor=function(A){for(var T=Math.max(this.g.length,A.g.length),E=[],C=0;C<T;C++)E[C]=this.i(C)^A.i(C);return new o(E,this.h^A.h)};function B(A){for(var T=A.g.length+1,E=[],C=0;C<T;C++)E[C]=A.i(C)<<1|A.i(C-1)>>>31;return new o(E,A.h)}function M(A,T){var E=T>>5;T%=32;for(var C=A.g.length-E,x=[],k=0;k<C;k++)x[k]=0<T?A.i(k+E)>>>T|A.i(k+E+1)<<32-T:A.i(k+E);return new o(x,A.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,P1=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,ui=o}).apply(typeof GE<"u"?GE:typeof self<"u"?self:typeof window<"u"?window:{});var eh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var x1,jl,N1,kh,_g,O1,M1,D1;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,g,y){return d==Array.prototype||d==Object.prototype||(d[g]=y.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof eh=="object"&&eh];for(var g=0;g<d.length;++g){var y=d[g];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var s=t(this);function r(d,g){if(g)e:{var y=s;d=d.split(".");for(var S=0;S<d.length-1;S++){var V=d[S];if(!(V in y))break e;y=y[V]}d=d[d.length-1],S=y[d],g=g(S),g!=S&&g!=null&&e(y,d,{configurable:!0,writable:!0,value:g})}}function i(d,g){d instanceof String&&(d+="");var y=0,S=!1,V={next:function(){if(!S&&y<d.length){var U=y++;return{value:g(U,d[U]),done:!1}}return S=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}r("Array.prototype.values",function(d){return d||function(){return i(this,function(g,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(d){var g=typeof d;return g=g!="object"?g:d?Array.isArray(d)?"array":g:"null",g=="array"||g=="object"&&typeof d.length=="number"}function c(d){var g=typeof d;return g=="object"&&d!=null||g=="function"}function u(d,g,y){return d.call.apply(d.bind,arguments)}function h(d,g,y){if(!d)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,S),d.apply(g,V)}}return function(){return d.apply(g,arguments)}}function f(d,g,y){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,f.apply(null,arguments)}function p(d,g){var y=Array.prototype.slice.call(arguments,1);return function(){var S=y.slice();return S.push.apply(S,arguments),d.apply(this,S)}}function m(d,g){function y(){}y.prototype=g.prototype,d.aa=g.prototype,d.prototype=new y,d.prototype.constructor=d,d.Qb=function(S,V,U){for(var oe=Array(arguments.length-2),at=2;at<arguments.length;at++)oe[at-2]=arguments[at];return g.prototype[V].apply(S,oe)}}function _(d){const g=d.length;if(0<g){const y=Array(g);for(let S=0;S<g;S++)y[S]=d[S];return y}return[]}function v(d,g){for(let y=1;y<arguments.length;y++){const S=arguments[y];if(l(S)){const V=d.length||0,U=S.length||0;d.length=V+U;for(let oe=0;oe<U;oe++)d[V+oe]=S[oe]}else d.push(S)}}class I{constructor(g,y){this.i=g,this.j=y,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function O(d){return/^[\s\xa0]*$/.test(d)}function P(){var d=a.navigator;return d&&(d=d.userAgent)?d:""}function D(d){return D[" "](d),d}D[" "]=function(){};var B=P().indexOf("Gecko")!=-1&&!(P().toLowerCase().indexOf("webkit")!=-1&&P().indexOf("Edge")==-1)&&!(P().indexOf("Trident")!=-1||P().indexOf("MSIE")!=-1)&&P().indexOf("Edge")==-1;function M(d,g,y){for(const S in d)g.call(y,d[S],S,d)}function A(d,g){for(const y in d)g.call(void 0,d[y],y,d)}function T(d){const g={};for(const y in d)g[y]=d[y];return g}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(d,g){let y,S;for(let V=1;V<arguments.length;V++){S=arguments[V];for(y in S)d[y]=S[y];for(let U=0;U<E.length;U++)y=E[U],Object.prototype.hasOwnProperty.call(S,y)&&(d[y]=S[y])}}function x(d){var g=1;d=d.split(":");const y=[];for(;0<g&&d.length;)y.push(d.shift()),g--;return d.length&&y.push(d.join(":")),y}function k(d){a.setTimeout(()=>{throw d},0)}function b(){var d=Re;let g=null;return d.g&&(g=d.g,d.g=d.g.next,d.g||(d.h=null),g.next=null),g}class ye{constructor(){this.h=this.g=null}add(g,y){const S=Ve.get();S.set(g,y),this.h?this.h.next=S:this.g=S,this.h=S}}var Ve=new I(()=>new We,d=>d.reset());class We{constructor(){this.next=this.g=this.h=null}set(g,y){this.h=g,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let j,te=!1,Re=new ye,Qe=()=>{const d=a.Promise.resolve(void 0);j=()=>{d.then(ht)}};var ht=()=>{for(var d;d=b();){try{d.h.call(d.g)}catch(y){k(y)}var g=Ve;g.j(d),100>g.h&&(g.h++,d.next=g.g,g.g=d)}te=!1};function pt(){this.s=this.s,this.C=this.C}pt.prototype.s=!1,pt.prototype.ma=function(){this.s||(this.s=!0,this.N())},pt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function vt(d,g){this.type=d,this.g=this.target=g,this.defaultPrevented=!1}vt.prototype.h=function(){this.defaultPrevented=!0};var Or=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var d=!1,g=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const y=()=>{};a.addEventListener("test",y,g),a.removeEventListener("test",y,g)}catch{}return d}();function Ns(d,g){if(vt.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var y=this.type=d.type,S=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=g,g=d.relatedTarget){if(B){e:{try{D(g.nodeName);var V=!0;break e}catch{}V=!1}V||(g=null)}}else y=="mouseover"?g=d.fromElement:y=="mouseout"&&(g=d.toElement);this.relatedTarget=g,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:Fn[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&Ns.aa.h.call(this)}}m(Ns,vt);var Fn={2:"touch",3:"pen",4:"mouse"};Ns.prototype.h=function(){Ns.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var z="closure_listenable_"+(1e6*Math.random()|0),fe=0;function ce(d,g,y,S,V){this.listener=d,this.proxy=null,this.src=g,this.type=y,this.capture=!!S,this.ha=V,this.key=++fe,this.da=this.fa=!1}function _e(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Je(d){this.src=d,this.g={},this.h=0}Je.prototype.add=function(d,g,y,S,V){var U=d.toString();d=this.g[U],d||(d=this.g[U]=[],this.h++);var oe=N(d,g,S,V);return-1<oe?(g=d[oe],y||(g.fa=!1)):(g=new ce(g,this.src,U,!!S,V),g.fa=y,d.push(g)),g};function R(d,g){var y=g.type;if(y in d.g){var S=d.g[y],V=Array.prototype.indexOf.call(S,g,void 0),U;(U=0<=V)&&Array.prototype.splice.call(S,V,1),U&&(_e(g),d.g[y].length==0&&(delete d.g[y],d.h--))}}function N(d,g,y,S){for(var V=0;V<d.length;++V){var U=d[V];if(!U.da&&U.listener==g&&U.capture==!!y&&U.ha==S)return V}return-1}var L="closure_lm_"+(1e6*Math.random()|0),H={};function J(d,g,y,S,V){if(Array.isArray(g)){for(var U=0;U<g.length;U++)J(d,g[U],y,S,V);return null}return y=Ae(y),d&&d[z]?d.K(g,y,c(S)?!!S.capture:!1,V):K(d,g,y,!1,S,V)}function K(d,g,y,S,V,U){if(!g)throw Error("Invalid event type");var oe=c(V)?!!V.capture:!!V,at=ue(d);if(at||(d[L]=at=new Je(d)),y=at.add(g,y,S,oe,U),y.proxy)return y;if(S=le(),y.proxy=S,S.src=d,S.listener=y,d.addEventListener)Or||(V=oe),V===void 0&&(V=!1),d.addEventListener(g.toString(),S,V);else if(d.attachEvent)d.attachEvent(ee(g.toString()),S);else if(d.addListener&&d.removeListener)d.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return y}function le(){function d(y){return g.call(d.src,d.listener,y)}const g=Te;return d}function ie(d,g,y,S,V){if(Array.isArray(g))for(var U=0;U<g.length;U++)ie(d,g[U],y,S,V);else S=c(S)?!!S.capture:!!S,y=Ae(y),d&&d[z]?(d=d.i,g=String(g).toString(),g in d.g&&(U=d.g[g],y=N(U,y,S,V),-1<y&&(_e(U[y]),Array.prototype.splice.call(U,y,1),U.length==0&&(delete d.g[g],d.h--)))):d&&(d=ue(d))&&(g=d.g[g.toString()],d=-1,g&&(d=N(g,y,S,V)),(y=-1<d?g[d]:null)&&re(y))}function re(d){if(typeof d!="number"&&d&&!d.da){var g=d.src;if(g&&g[z])R(g.i,d);else{var y=d.type,S=d.proxy;g.removeEventListener?g.removeEventListener(y,S,d.capture):g.detachEvent?g.detachEvent(ee(y),S):g.addListener&&g.removeListener&&g.removeListener(S),(y=ue(g))?(R(y,d),y.h==0&&(y.src=null,g[L]=null)):_e(d)}}}function ee(d){return d in H?H[d]:H[d]="on"+d}function Te(d,g){if(d.da)d=!0;else{g=new Ns(g,this);var y=d.listener,S=d.ha||d.src;d.fa&&re(d),d=y.call(S,g)}return d}function ue(d){return d=d[L],d instanceof Je?d:null}var ve="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ae(d){return typeof d=="function"?d:(d[ve]||(d[ve]=function(g){return d.handleEvent(g)}),d[ve])}function Se(){pt.call(this),this.i=new Je(this),this.M=this,this.F=null}m(Se,pt),Se.prototype[z]=!0,Se.prototype.removeEventListener=function(d,g,y,S){ie(this,d,g,y,S)};function Me(d,g){var y,S=d.F;if(S)for(y=[];S;S=S.F)y.push(S);if(d=d.M,S=g.type||g,typeof g=="string")g=new vt(g,d);else if(g instanceof vt)g.target=g.target||d;else{var V=g;g=new vt(S,d),C(g,V)}if(V=!0,y)for(var U=y.length-1;0<=U;U--){var oe=g.g=y[U];V=qe(oe,S,!0,g)&&V}if(oe=g.g=d,V=qe(oe,S,!0,g)&&V,V=qe(oe,S,!1,g)&&V,y)for(U=0;U<y.length;U++)oe=g.g=y[U],V=qe(oe,S,!1,g)&&V}Se.prototype.N=function(){if(Se.aa.N.call(this),this.i){var d=this.i,g;for(g in d.g){for(var y=d.g[g],S=0;S<y.length;S++)_e(y[S]);delete d.g[g],d.h--}}this.F=null},Se.prototype.K=function(d,g,y,S){return this.i.add(String(d),g,!1,y,S)},Se.prototype.L=function(d,g,y,S){return this.i.add(String(d),g,!0,y,S)};function qe(d,g,y,S){if(g=d.i.g[String(g)],!g)return!0;g=g.concat();for(var V=!0,U=0;U<g.length;++U){var oe=g[U];if(oe&&!oe.da&&oe.capture==y){var at=oe.listener,Jt=oe.ha||oe.src;oe.fa&&R(d.i,oe),V=at.call(Jt,S)!==!1&&V}}return V&&!S.defaultPrevented}function rn(d,g,y){if(typeof d=="function")y&&(d=f(d,y));else if(d&&typeof d.handleEvent=="function")d=f(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(d,g||0)}function Gt(d){d.g=rn(()=>{d.g=null,d.i&&(d.i=!1,Gt(d))},d.l);const g=d.h;d.h=null,d.m.apply(null,g)}class ts extends pt{constructor(g,y){super(),this.m=g,this.l=y,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Gt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function on(d){pt.call(this),this.h=d,this.g={}}m(on,pt);var Mr=[];function ul(d){M(d.g,function(g,y){this.g.hasOwnProperty(y)&&re(g)},d),d.g={}}on.prototype.N=function(){on.aa.N.call(this),ul(this)},on.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qt=a.JSON.stringify,ns=a.JSON.parse,Au=class{stringify(d){return a.JSON.stringify(d,void 0)}parse(d){return a.JSON.parse(d,void 0)}};function mp(){}mp.prototype.h=null;function Xv(d){return d.h||(d.h=d.i())}function Zv(){}var hl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function gp(){vt.call(this,"d")}m(gp,vt);function _p(){vt.call(this,"c")}m(_p,vt);var qi={},eb=null;function Ru(){return eb=eb||new Se}qi.La="serverreachability";function tb(d){vt.call(this,qi.La,d)}m(tb,vt);function dl(d){const g=Ru();Me(g,new tb(g))}qi.STAT_EVENT="statevent";function nb(d,g){vt.call(this,qi.STAT_EVENT,d),this.stat=g}m(nb,vt);function En(d){const g=Ru();Me(g,new nb(g,d))}qi.Ma="timingevent";function sb(d,g){vt.call(this,qi.Ma,d),this.size=g}m(sb,vt);function fl(d,g){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){d()},g)}function pl(){this.g=!0}pl.prototype.xa=function(){this.g=!1};function eN(d,g,y,S,V,U){d.info(function(){if(d.g)if(U)for(var oe="",at=U.split("&"),Jt=0;Jt<at.length;Jt++){var Ye=at[Jt].split("=");if(1<Ye.length){var an=Ye[0];Ye=Ye[1];var ln=an.split("_");oe=2<=ln.length&&ln[1]=="type"?oe+(an+"="+Ye+"&"):oe+(an+"=redacted&")}}else oe=null;else oe=U;return"XMLHTTP REQ ("+S+") [attempt "+V+"]: "+g+`
`+y+`
`+oe})}function tN(d,g,y,S,V,U,oe){d.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+V+"]: "+g+`
`+y+`
`+U+" "+oe})}function qo(d,g,y,S){d.info(function(){return"XMLHTTP TEXT ("+g+"): "+sN(d,y)+(S?" "+S:"")})}function nN(d,g){d.info(function(){return"TIMEOUT: "+g})}pl.prototype.info=function(){};function sN(d,g){if(!d.g)return g;if(!g)return null;try{var y=JSON.parse(g);if(y){for(d=0;d<y.length;d++)if(Array.isArray(y[d])){var S=y[d];if(!(2>S.length)){var V=S[1];if(Array.isArray(V)&&!(1>V.length)){var U=V[0];if(U!="noop"&&U!="stop"&&U!="close")for(var oe=1;oe<V.length;oe++)V[oe]=""}}}}return Qt(y)}catch{return g}}var Pu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},rb={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},yp;function xu(){}m(xu,mp),xu.prototype.g=function(){return new XMLHttpRequest},xu.prototype.i=function(){return{}},yp=new xu;function Dr(d,g,y,S){this.j=d,this.i=g,this.l=y,this.R=S||1,this.U=new on(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ib}function ib(){this.i=null,this.g="",this.h=!1}var ob={},vp={};function bp(d,g,y){d.L=1,d.v=Du(rr(g)),d.m=y,d.P=!0,ab(d,null)}function ab(d,g){d.F=Date.now(),Nu(d),d.A=rr(d.v);var y=d.A,S=d.R;Array.isArray(S)||(S=[String(S)]),wb(y.i,"t",S),d.C=0,y=d.j.J,d.h=new ib,d.g=Bb(d.j,y?g:null,!d.m),0<d.O&&(d.M=new ts(f(d.Y,d,d.g),d.O)),g=d.U,y=d.g,S=d.ca;var V="readystatechange";Array.isArray(V)||(V&&(Mr[0]=V.toString()),V=Mr);for(var U=0;U<V.length;U++){var oe=J(y,V[U],S||g.handleEvent,!1,g.h||g);if(!oe)break;g.g[oe.key]=oe}g=d.H?T(d.H):{},d.m?(d.u||(d.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,g)):(d.u="GET",d.g.ea(d.A,d.u,null,g)),dl(),eN(d.i,d.u,d.A,d.l,d.R,d.m)}Dr.prototype.ca=function(d){d=d.target;const g=this.M;g&&ir(d)==3?g.j():this.Y(d)},Dr.prototype.Y=function(d){try{if(d==this.g)e:{const ln=ir(this.g);var g=this.g.Ba();const Qo=this.g.Z();if(!(3>ln)&&(ln!=3||this.g&&(this.h.h||this.g.oa()||Ab(this.g)))){this.J||ln!=4||g==7||(g==8||0>=Qo?dl(3):dl(2)),wp(this);var y=this.g.Z();this.X=y;t:if(lb(this)){var S=Ab(this.g);d="";var V=S.length,U=ir(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ki(this),ml(this);var oe="";break t}this.h.i=new a.TextDecoder}for(g=0;g<V;g++)this.h.h=!0,d+=this.h.i.decode(S[g],{stream:!(U&&g==V-1)});S.length=0,this.h.g+=d,this.C=0,oe=this.h.g}else oe=this.g.oa();if(this.o=y==200,tN(this.i,this.u,this.A,this.l,this.R,ln,y),this.o){if(this.T&&!this.K){t:{if(this.g){var at,Jt=this.g;if((at=Jt.g?Jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(at)){var Ye=at;break t}}Ye=null}if(y=Ye)qo(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ep(this,y);else{this.o=!1,this.s=3,En(12),Ki(this),ml(this);break e}}if(this.P){y=!0;let ms;for(;!this.J&&this.C<oe.length;)if(ms=rN(this,oe),ms==vp){ln==4&&(this.s=4,En(14),y=!1),qo(this.i,this.l,null,"[Incomplete Response]");break}else if(ms==ob){this.s=4,En(15),qo(this.i,this.l,oe,"[Invalid Chunk]"),y=!1;break}else qo(this.i,this.l,ms,null),Ep(this,ms);if(lb(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ln!=4||oe.length!=0||this.h.h||(this.s=1,En(16),y=!1),this.o=this.o&&y,!y)qo(this.i,this.l,oe,"[Invalid Chunked Response]"),Ki(this),ml(this);else if(0<oe.length&&!this.W){this.W=!0;var an=this.j;an.g==this&&an.ba&&!an.M&&(an.j.info("Great, no buffering proxy detected. Bytes received: "+oe.length),Ap(an),an.M=!0,En(11))}}else qo(this.i,this.l,oe,null),Ep(this,oe);ln==4&&Ki(this),this.o&&!this.J&&(ln==4?Db(this.j,this):(this.o=!1,Nu(this)))}else wN(this.g),y==400&&0<oe.indexOf("Unknown SID")?(this.s=3,En(12)):(this.s=0,En(13)),Ki(this),ml(this)}}}catch{}finally{}};function lb(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function rN(d,g){var y=d.C,S=g.indexOf(`
`,y);return S==-1?vp:(y=Number(g.substring(y,S)),isNaN(y)?ob:(S+=1,S+y>g.length?vp:(g=g.slice(S,S+y),d.C=S+y,g)))}Dr.prototype.cancel=function(){this.J=!0,Ki(this)};function Nu(d){d.S=Date.now()+d.I,cb(d,d.I)}function cb(d,g){if(d.B!=null)throw Error("WatchDog timer not null");d.B=fl(f(d.ba,d),g)}function wp(d){d.B&&(a.clearTimeout(d.B),d.B=null)}Dr.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(nN(this.i,this.A),this.L!=2&&(dl(),En(17)),Ki(this),this.s=2,ml(this)):cb(this,this.S-d)};function ml(d){d.j.G==0||d.J||Db(d.j,d)}function Ki(d){wp(d);var g=d.M;g&&typeof g.ma=="function"&&g.ma(),d.M=null,ul(d.U),d.g&&(g=d.g,d.g=null,g.abort(),g.ma())}function Ep(d,g){try{var y=d.j;if(y.G!=0&&(y.g==d||Tp(y.h,d))){if(!d.K&&Tp(y.h,d)&&y.G==3){try{var S=y.Da.g.parse(g)}catch{S=null}if(Array.isArray(S)&&S.length==3){var V=S;if(V[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<d.F)Uu(y),Bu(y);else break e;kp(y),En(18)}}else y.za=V[1],0<y.za-y.T&&37500>V[2]&&y.F&&y.v==0&&!y.C&&(y.C=fl(f(y.Za,y),6e3));if(1>=db(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else Qi(y,11)}else if((d.K||y.g==d)&&Uu(y),!O(g))for(V=y.Da.g.parse(g),g=0;g<V.length;g++){let Ye=V[g];if(y.T=Ye[0],Ye=Ye[1],y.G==2)if(Ye[0]=="c"){y.K=Ye[1],y.ia=Ye[2];const an=Ye[3];an!=null&&(y.la=an,y.j.info("VER="+y.la));const ln=Ye[4];ln!=null&&(y.Aa=ln,y.j.info("SVER="+y.Aa));const Qo=Ye[5];Qo!=null&&typeof Qo=="number"&&0<Qo&&(S=1.5*Qo,y.L=S,y.j.info("backChannelRequestTimeoutMs_="+S)),S=y;const ms=d.g;if(ms){const zu=ms.g?ms.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(zu){var U=S.h;U.g||zu.indexOf("spdy")==-1&&zu.indexOf("quic")==-1&&zu.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(Sp(U,U.h),U.h=null))}if(S.D){const Rp=ms.g?ms.g.getResponseHeader("X-HTTP-Session-Id"):null;Rp&&(S.ya=Rp,mt(S.I,S.D,Rp))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-d.F,y.j.info("Handshake RTT: "+y.R+"ms")),S=y;var oe=d;if(S.qa=Fb(S,S.J?S.ia:null,S.W),oe.K){fb(S.h,oe);var at=oe,Jt=S.L;Jt&&(at.I=Jt),at.B&&(wp(at),Nu(at)),S.g=oe}else Ob(S);0<y.i.length&&$u(y)}else Ye[0]!="stop"&&Ye[0]!="close"||Qi(y,7);else y.G==3&&(Ye[0]=="stop"||Ye[0]=="close"?Ye[0]=="stop"?Qi(y,7):Cp(y):Ye[0]!="noop"&&y.l&&y.l.ta(Ye),y.v=0)}}dl(4)}catch{}}var iN=class{constructor(d,g){this.g=d,this.map=g}};function ub(d){this.l=d||10,a.PerformanceNavigationTiming?(d=a.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function hb(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function db(d){return d.h?1:d.g?d.g.size:0}function Tp(d,g){return d.h?d.h==g:d.g?d.g.has(g):!1}function Sp(d,g){d.g?d.g.add(g):d.h=g}function fb(d,g){d.h&&d.h==g?d.h=null:d.g&&d.g.has(g)&&d.g.delete(g)}ub.prototype.cancel=function(){if(this.i=pb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function pb(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let g=d.i;for(const y of d.g.values())g=g.concat(y.D);return g}return _(d.i)}function oN(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var g=[],y=d.length,S=0;S<y;S++)g.push(d[S]);return g}g=[],y=0;for(S in d)g[y++]=d[S];return g}function aN(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var g=[];d=d.length;for(var y=0;y<d;y++)g.push(y);return g}g=[],y=0;for(const S in d)g[y++]=S;return g}}}function mb(d,g){if(d.forEach&&typeof d.forEach=="function")d.forEach(g,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,g,void 0);else for(var y=aN(d),S=oN(d),V=S.length,U=0;U<V;U++)g.call(void 0,S[U],y&&y[U],d)}var gb=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lN(d,g){if(d){d=d.split("&");for(var y=0;y<d.length;y++){var S=d[y].indexOf("="),V=null;if(0<=S){var U=d[y].substring(0,S);V=d[y].substring(S+1)}else U=d[y];g(U,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Gi(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Gi){this.h=d.h,Ou(this,d.j),this.o=d.o,this.g=d.g,Mu(this,d.s),this.l=d.l;var g=d.i,y=new yl;y.i=g.i,g.g&&(y.g=new Map(g.g),y.h=g.h),_b(this,y),this.m=d.m}else d&&(g=String(d).match(gb))?(this.h=!1,Ou(this,g[1]||"",!0),this.o=gl(g[2]||""),this.g=gl(g[3]||"",!0),Mu(this,g[4]),this.l=gl(g[5]||"",!0),_b(this,g[6]||"",!0),this.m=gl(g[7]||"")):(this.h=!1,this.i=new yl(null,this.h))}Gi.prototype.toString=function(){var d=[],g=this.j;g&&d.push(_l(g,yb,!0),":");var y=this.g;return(y||g=="file")&&(d.push("//"),(g=this.o)&&d.push(_l(g,yb,!0),"@"),d.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&d.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&d.push("/"),d.push(_l(y,y.charAt(0)=="/"?hN:uN,!0))),(y=this.i.toString())&&d.push("?",y),(y=this.m)&&d.push("#",_l(y,fN)),d.join("")};function rr(d){return new Gi(d)}function Ou(d,g,y){d.j=y?gl(g,!0):g,d.j&&(d.j=d.j.replace(/:$/,""))}function Mu(d,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);d.s=g}else d.s=null}function _b(d,g,y){g instanceof yl?(d.i=g,pN(d.i,d.h)):(y||(g=_l(g,dN)),d.i=new yl(g,d.h))}function mt(d,g,y){d.i.set(g,y)}function Du(d){return mt(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function gl(d,g){return d?g?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function _l(d,g,y){return typeof d=="string"?(d=encodeURI(d).replace(g,cN),y&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function cN(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var yb=/[#\/\?@]/g,uN=/[#\?:]/g,hN=/[#\?]/g,dN=/[#\?@]/g,fN=/#/g;function yl(d,g){this.h=this.g=null,this.i=d||null,this.j=!!g}function Lr(d){d.g||(d.g=new Map,d.h=0,d.i&&lN(d.i,function(g,y){d.add(decodeURIComponent(g.replace(/\+/g," ")),y)}))}n=yl.prototype,n.add=function(d,g){Lr(this),this.i=null,d=Ko(this,d);var y=this.g.get(d);return y||this.g.set(d,y=[]),y.push(g),this.h+=1,this};function vb(d,g){Lr(d),g=Ko(d,g),d.g.has(g)&&(d.i=null,d.h-=d.g.get(g).length,d.g.delete(g))}function bb(d,g){return Lr(d),g=Ko(d,g),d.g.has(g)}n.forEach=function(d,g){Lr(this),this.g.forEach(function(y,S){y.forEach(function(V){d.call(g,V,S,this)},this)},this)},n.na=function(){Lr(this);const d=Array.from(this.g.values()),g=Array.from(this.g.keys()),y=[];for(let S=0;S<g.length;S++){const V=d[S];for(let U=0;U<V.length;U++)y.push(g[S])}return y},n.V=function(d){Lr(this);let g=[];if(typeof d=="string")bb(this,d)&&(g=g.concat(this.g.get(Ko(this,d))));else{d=Array.from(this.g.values());for(let y=0;y<d.length;y++)g=g.concat(d[y])}return g},n.set=function(d,g){return Lr(this),this.i=null,d=Ko(this,d),bb(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[g]),this.h+=1,this},n.get=function(d,g){return d?(d=this.V(d),0<d.length?String(d[0]):g):g};function wb(d,g,y){vb(d,g),0<y.length&&(d.i=null,d.g.set(Ko(d,g),_(y)),d.h+=y.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],g=Array.from(this.g.keys());for(var y=0;y<g.length;y++){var S=g[y];const U=encodeURIComponent(String(S)),oe=this.V(S);for(S=0;S<oe.length;S++){var V=U;oe[S]!==""&&(V+="="+encodeURIComponent(String(oe[S]))),d.push(V)}}return this.i=d.join("&")};function Ko(d,g){return g=String(g),d.j&&(g=g.toLowerCase()),g}function pN(d,g){g&&!d.j&&(Lr(d),d.i=null,d.g.forEach(function(y,S){var V=S.toLowerCase();S!=V&&(vb(this,S),wb(this,V,y))},d)),d.j=g}function mN(d,g){const y=new pl;if(a.Image){const S=new Image;S.onload=p(Vr,y,"TestLoadImage: loaded",!0,g,S),S.onerror=p(Vr,y,"TestLoadImage: error",!1,g,S),S.onabort=p(Vr,y,"TestLoadImage: abort",!1,g,S),S.ontimeout=p(Vr,y,"TestLoadImage: timeout",!1,g,S),a.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=d}else g(!1)}function gN(d,g){const y=new pl,S=new AbortController,V=setTimeout(()=>{S.abort(),Vr(y,"TestPingServer: timeout",!1,g)},1e4);fetch(d,{signal:S.signal}).then(U=>{clearTimeout(V),U.ok?Vr(y,"TestPingServer: ok",!0,g):Vr(y,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(V),Vr(y,"TestPingServer: error",!1,g)})}function Vr(d,g,y,S,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),S(y)}catch{}}function _N(){this.g=new Au}function yN(d,g,y){const S=y||"";try{mb(d,function(V,U){let oe=V;c(V)&&(oe=Qt(V)),g.push(S+U+"="+encodeURIComponent(oe))})}catch(V){throw g.push(S+"type="+encodeURIComponent("_badmap")),V}}function Lu(d){this.l=d.Ub||null,this.j=d.eb||!1}m(Lu,mp),Lu.prototype.g=function(){return new Vu(this.l,this.j)},Lu.prototype.i=function(d){return function(){return d}}({});function Vu(d,g){Se.call(this),this.D=d,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(Vu,Se),n=Vu.prototype,n.open=function(d,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=g,this.readyState=1,bl(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(g.body=d),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,vl(this)),this.readyState=0},n.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,bl(this)),this.g&&(this.readyState=3,bl(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Eb(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Eb(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}n.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var g=d.value?d.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!d.done}))&&(this.response=this.responseText+=g)}d.done?vl(this):bl(this),this.readyState==3&&Eb(this)}},n.Ra=function(d){this.g&&(this.response=this.responseText=d,vl(this))},n.Qa=function(d){this.g&&(this.response=d,vl(this))},n.ga=function(){this.g&&vl(this)};function vl(d){d.readyState=4,d.l=null,d.j=null,d.v=null,bl(d)}n.setRequestHeader=function(d,g){this.u.append(d,g)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],g=this.h.entries();for(var y=g.next();!y.done;)y=y.value,d.push(y[0]+": "+y[1]),y=g.next();return d.join(`\r
`)};function bl(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Vu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Tb(d){let g="";return M(d,function(y,S){g+=S,g+=":",g+=y,g+=`\r
`}),g}function Ip(d,g,y){e:{for(S in y){var S=!1;break e}S=!0}S||(y=Tb(y),typeof d=="string"?y!=null&&encodeURIComponent(String(y)):mt(d,g,y))}function Tt(d){Se.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(Tt,Se);var vN=/^https?$/i,bN=["POST","PUT"];n=Tt.prototype,n.Ha=function(d){this.J=d},n.ea=function(d,g,y,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);g=g?g.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():yp.g(),this.v=this.o?Xv(this.o):Xv(yp),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(g,String(d),!0),this.B=!1}catch(U){Sb(this,U);return}if(d=y||"",y=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var V in S)y.set(V,S[V]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const U of S.keys())y.set(U,S.get(U));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(y.keys()).find(U=>U.toLowerCase()=="content-type"),V=a.FormData&&d instanceof a.FormData,!(0<=Array.prototype.indexOf.call(bN,g,void 0))||S||V||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,oe]of y)this.g.setRequestHeader(U,oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{kb(this),this.u=!0,this.g.send(d),this.u=!1}catch(U){Sb(this,U)}};function Sb(d,g){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=g,d.m=5,Ib(d),Fu(d)}function Ib(d){d.A||(d.A=!0,Me(d,"complete"),Me(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Me(this,"complete"),Me(this,"abort"),Fu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Fu(this,!0)),Tt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Cb(this):this.bb())},n.bb=function(){Cb(this)};function Cb(d){if(d.h&&typeof o<"u"&&(!d.v[1]||ir(d)!=4||d.Z()!=2)){if(d.u&&ir(d)==4)rn(d.Ea,0,d);else if(Me(d,"readystatechange"),ir(d)==4){d.h=!1;try{const oe=d.Z();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var y;if(!(y=g)){var S;if(S=oe===0){var V=String(d.D).match(gb)[1]||null;!V&&a.self&&a.self.location&&(V=a.self.location.protocol.slice(0,-1)),S=!vN.test(V?V.toLowerCase():"")}y=S}if(y)Me(d,"complete"),Me(d,"success");else{d.m=6;try{var U=2<ir(d)?d.g.statusText:""}catch{U=""}d.l=U+" ["+d.Z()+"]",Ib(d)}}finally{Fu(d)}}}}function Fu(d,g){if(d.g){kb(d);const y=d.g,S=d.v[0]?()=>{}:null;d.g=null,d.v=null,g||Me(d,"ready");try{y.onreadystatechange=S}catch{}}}function kb(d){d.I&&(a.clearTimeout(d.I),d.I=null)}n.isActive=function(){return!!this.g};function ir(d){return d.g?d.g.readyState:0}n.Z=function(){try{return 2<ir(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(d){if(this.g){var g=this.g.responseText;return d&&g.indexOf(d)==0&&(g=g.substring(d.length)),ns(g)}};function Ab(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function wN(d){const g={};d=(d.g&&2<=ir(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<d.length;S++){if(O(d[S]))continue;var y=x(d[S]);const V=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const U=g[V]||[];g[V]=U,U.push(y)}A(g,function(S){return S.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wl(d,g,y){return y&&y.internalChannelParams&&y.internalChannelParams[d]||g}function Rb(d){this.Aa=0,this.i=[],this.j=new pl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wl("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wl("baseRetryDelayMs",5e3,d),this.cb=wl("retryDelaySeedMs",1e4,d),this.Wa=wl("forwardChannelMaxRetries",2,d),this.wa=wl("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new ub(d&&d.concurrentRequestLimit),this.Da=new _N,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Rb.prototype,n.la=8,n.G=1,n.connect=function(d,g,y,S){En(0),this.W=d,this.H=g||{},y&&S!==void 0&&(this.H.OSID=y,this.H.OAID=S),this.F=this.X,this.I=Fb(this,null,this.W),$u(this)};function Cp(d){if(Pb(d),d.G==3){var g=d.U++,y=rr(d.I);if(mt(y,"SID",d.K),mt(y,"RID",g),mt(y,"TYPE","terminate"),El(d,y),g=new Dr(d,d.j,g),g.L=2,g.v=Du(rr(y)),y=!1,a.navigator&&a.navigator.sendBeacon)try{y=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!y&&a.Image&&(new Image().src=g.v,y=!0),y||(g.g=Bb(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Nu(g)}Vb(d)}function Bu(d){d.g&&(Ap(d),d.g.cancel(),d.g=null)}function Pb(d){Bu(d),d.u&&(a.clearTimeout(d.u),d.u=null),Uu(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&a.clearTimeout(d.s),d.s=null)}function $u(d){if(!hb(d.h)&&!d.s){d.s=!0;var g=d.Ga;j||Qe(),te||(j(),te=!0),Re.add(g,d),d.B=0}}function EN(d,g){return db(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=g.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=fl(f(d.Ga,d,g),Lb(d,d.B)),d.B++,!0)}n.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const V=new Dr(this,this.j,d);let U=this.o;if(this.S&&(U?(U=T(U),C(U,this.S)):U=this.S),this.m!==null||this.O||(V.H=U,U=null),this.P)e:{for(var g=0,y=0;y<this.i.length;y++){t:{var S=this.i[y];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(g+=S,4096<g){g=y;break e}if(g===4096||y===this.i.length-1){g=y+1;break e}}g=1e3}else g=1e3;g=Nb(this,V,g),y=rr(this.I),mt(y,"RID",d),mt(y,"CVER",22),this.D&&mt(y,"X-HTTP-Session-Id",this.D),El(this,y),U&&(this.O?g="headers="+encodeURIComponent(String(Tb(U)))+"&"+g:this.m&&Ip(y,this.m,U)),Sp(this.h,V),this.Ua&&mt(y,"TYPE","init"),this.P?(mt(y,"$req",g),mt(y,"SID","null"),V.T=!0,bp(V,y,null)):bp(V,y,g),this.G=2}}else this.G==3&&(d?xb(this,d):this.i.length==0||hb(this.h)||xb(this))};function xb(d,g){var y;g?y=g.l:y=d.U++;const S=rr(d.I);mt(S,"SID",d.K),mt(S,"RID",y),mt(S,"AID",d.T),El(d,S),d.m&&d.o&&Ip(S,d.m,d.o),y=new Dr(d,d.j,y,d.B+1),d.m===null&&(y.H=d.o),g&&(d.i=g.D.concat(d.i)),g=Nb(d,y,1e3),y.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Sp(d.h,y),bp(y,S,g)}function El(d,g){d.H&&M(d.H,function(y,S){mt(g,S,y)}),d.l&&mb({},function(y,S){mt(g,S,y)})}function Nb(d,g,y){y=Math.min(d.i.length,y);var S=d.l?f(d.l.Na,d.l,d):null;e:{var V=d.i;let U=-1;for(;;){const oe=["count="+y];U==-1?0<y?(U=V[0].g,oe.push("ofs="+U)):U=0:oe.push("ofs="+U);let at=!0;for(let Jt=0;Jt<y;Jt++){let Ye=V[Jt].g;const an=V[Jt].map;if(Ye-=U,0>Ye)U=Math.max(0,V[Jt].g-100),at=!1;else try{yN(an,oe,"req"+Ye+"_")}catch{S&&S(an)}}if(at){S=oe.join("&");break e}}}return d=d.i.splice(0,y),g.D=d,S}function Ob(d){if(!d.g&&!d.u){d.Y=1;var g=d.Fa;j||Qe(),te||(j(),te=!0),Re.add(g,d),d.v=0}}function kp(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=fl(f(d.Fa,d),Lb(d,d.v)),d.v++,!0)}n.Fa=function(){if(this.u=null,Mb(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=fl(f(this.ab,this),d)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,En(10),Bu(this),Mb(this))};function Ap(d){d.A!=null&&(a.clearTimeout(d.A),d.A=null)}function Mb(d){d.g=new Dr(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var g=rr(d.qa);mt(g,"RID","rpc"),mt(g,"SID",d.K),mt(g,"AID",d.T),mt(g,"CI",d.F?"0":"1"),!d.F&&d.ja&&mt(g,"TO",d.ja),mt(g,"TYPE","xmlhttp"),El(d,g),d.m&&d.o&&Ip(g,d.m,d.o),d.L&&(d.g.I=d.L);var y=d.g;d=d.ia,y.L=1,y.v=Du(rr(g)),y.m=null,y.P=!0,ab(y,d)}n.Za=function(){this.C!=null&&(this.C=null,Bu(this),kp(this),En(19))};function Uu(d){d.C!=null&&(a.clearTimeout(d.C),d.C=null)}function Db(d,g){var y=null;if(d.g==g){Uu(d),Ap(d),d.g=null;var S=2}else if(Tp(d.h,g))y=g.D,fb(d.h,g),S=1;else return;if(d.G!=0){if(g.o)if(S==1){y=g.m?g.m.length:0,g=Date.now()-g.F;var V=d.B;S=Ru(),Me(S,new sb(S,y)),$u(d)}else Ob(d);else if(V=g.s,V==3||V==0&&0<g.X||!(S==1&&EN(d,g)||S==2&&kp(d)))switch(y&&0<y.length&&(g=d.h,g.i=g.i.concat(y)),V){case 1:Qi(d,5);break;case 4:Qi(d,10);break;case 3:Qi(d,6);break;default:Qi(d,2)}}}function Lb(d,g){let y=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(y*=2),y*g}function Qi(d,g){if(d.j.info("Error code "+g),g==2){var y=f(d.fb,d),S=d.Xa;const V=!S;S=new Gi(S||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ou(S,"https"),Du(S),V?mN(S.toString(),y):gN(S.toString(),y)}else En(2);d.G=0,d.l&&d.l.sa(g),Vb(d),Pb(d)}n.fb=function(d){d?(this.j.info("Successfully pinged google.com"),En(2)):(this.j.info("Failed to ping google.com"),En(1))};function Vb(d){if(d.G=0,d.ka=[],d.l){const g=pb(d.h);(g.length!=0||d.i.length!=0)&&(v(d.ka,g),v(d.ka,d.i),d.h.i.length=0,_(d.i),d.i.length=0),d.l.ra()}}function Fb(d,g,y){var S=y instanceof Gi?rr(y):new Gi(y);if(S.g!="")g&&(S.g=g+"."+S.g),Mu(S,S.s);else{var V=a.location;S=V.protocol,g=g?g+"."+V.hostname:V.hostname,V=+V.port;var U=new Gi(null);S&&Ou(U,S),g&&(U.g=g),V&&Mu(U,V),y&&(U.l=y),S=U}return y=d.D,g=d.ya,y&&g&&mt(S,y,g),mt(S,"VER",d.la),El(d,S),S}function Bb(d,g,y){if(g&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=d.Ca&&!d.pa?new Tt(new Lu({eb:y})):new Tt(d.pa),g.Ha(d.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function $b(){}n=$b.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ju(){}ju.prototype.g=function(d,g){return new qn(d,g)};function qn(d,g){Se.call(this),this.g=new Rb(g),this.l=d,this.h=g&&g.messageUrlParams||null,d=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(d?d["X-WebChannel-Content-Type"]=g.messageContentType:d={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(d?d["X-WebChannel-Client-Profile"]=g.va:d={"X-WebChannel-Client-Profile":g.va}),this.g.S=d,(d=g&&g.Sb)&&!O(d)&&(this.g.m=d),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!O(g)&&(this.g.D=g,d=this.h,d!==null&&g in d&&(d=this.h,g in d&&delete d[g])),this.j=new Go(this)}m(qn,Se),qn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qn.prototype.close=function(){Cp(this.g)},qn.prototype.o=function(d){var g=this.g;if(typeof d=="string"){var y={};y.__data__=d,d=y}else this.u&&(y={},y.__data__=Qt(d),d=y);g.i.push(new iN(g.Ya++,d)),g.G==3&&$u(g)},qn.prototype.N=function(){this.g.l=null,delete this.j,Cp(this.g),delete this.g,qn.aa.N.call(this)};function Ub(d){gp.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var g=d.__sm__;if(g){e:{for(const y in g){d=y;break e}d=void 0}(this.i=d)&&(d=this.i,g=g!==null&&d in g?g[d]:void 0),this.data=g}else this.data=d}m(Ub,gp);function jb(){_p.call(this),this.status=1}m(jb,_p);function Go(d){this.g=d}m(Go,$b),Go.prototype.ua=function(){Me(this.g,"a")},Go.prototype.ta=function(d){Me(this.g,new Ub(d))},Go.prototype.sa=function(d){Me(this.g,new jb)},Go.prototype.ra=function(){Me(this.g,"b")},ju.prototype.createWebChannel=ju.prototype.g,qn.prototype.send=qn.prototype.o,qn.prototype.open=qn.prototype.m,qn.prototype.close=qn.prototype.close,D1=function(){return new ju},M1=function(){return Ru()},O1=qi,_g={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pu.NO_ERROR=0,Pu.TIMEOUT=8,Pu.HTTP_ERROR=6,kh=Pu,rb.COMPLETE="complete",N1=rb,Zv.EventType=hl,hl.OPEN="a",hl.CLOSE="b",hl.ERROR="c",hl.MESSAGE="d",Se.prototype.listen=Se.prototype.K,jl=Zv,Tt.prototype.listenOnce=Tt.prototype.L,Tt.prototype.getLastError=Tt.prototype.Ka,Tt.prototype.getLastErrorCode=Tt.prototype.Ba,Tt.prototype.getStatus=Tt.prototype.Z,Tt.prototype.getResponseJson=Tt.prototype.Oa,Tt.prototype.getResponseText=Tt.prototype.oa,Tt.prototype.send=Tt.prototype.ea,Tt.prototype.setWithCredentials=Tt.prototype.Ha,x1=Tt}).apply(typeof eh<"u"?eh:typeof self<"u"?self:typeof window<"u"?window:{});const QE="@firebase/firestore",JE="4.7.11";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}hn.UNAUTHENTICATED=new hn(null),hn.GOOGLE_CREDENTIALS=new hn("google-credentials-uid"),hn.FIRST_PARTY=new hn("first-party-uid"),hn.MOCK_USER=new hn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sl="11.6.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo=new au("@firebase/firestore");function sa(){return xo.logLevel}function pe(n,...e){if(xo.logLevel<=ze.DEBUG){const t=e.map(ky);xo.debug(`Firestore (${sl}): ${n}`,...t)}}function Ar(n,...e){if(xo.logLevel<=ze.ERROR){const t=e.map(ky);xo.error(`Firestore (${sl}): ${n}`,...t)}}function Na(n,...e){if(xo.logLevel<=ze.WARN){const t=e.map(ky);xo.warn(`Firestore (${sl}): ${n}`,...t)}}function ky(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ke(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,L1(n,s,t)}function L1(n,e,t){let s=`FIRESTORE (${sl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Ar(s),new Error(s)}function st(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||L1(e,r,s)}function Oe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends Zs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class YU{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(hn.UNAUTHENTICATED))}shutdown(){}}class XU{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ZU{constructor(e){this.t=e,this.currentUser=hn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){st(this.o===void 0,42304);let s=this.i;const r=l=>this.i!==s?(s=this.i,t(l)):Promise.resolve();let i=new wr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new wr,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new wr)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(st(typeof s.accessToken=="string",31837,{l:s}),new V1(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return st(e===null||typeof e=="string",2055,{h:e}),new hn(e)}}class e3{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=hn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class t3{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new e3(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(hn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class YE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class n3{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Rn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){st(this.o===void 0,3512);const s=i=>{i.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new YE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(st(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new YE(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=s3(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%62))}return s}}function Be(n,e){return n<e?-1:n>e?1:0}function yg(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),r=e.codePointAt(t);if(s!==r){if(s<128&&r<128)return Be(s,r);{const i=F1(),o=r3(i.encode(XE(n,t)),i.encode(XE(e,t)));return o!==0?o:Be(s,r)}}t+=s>65535?2:1}return Be(n.length,e.length)}function XE(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function r3(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Be(n[t],e[t]);return Be(n.length,e.length)}function Oa(n,e,t){return n.length===e.length&&n.every((s,r)=>t(s,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE=-62135596800,e0=1e6;class Ot{static now(){return Ot.fromMillis(Date.now())}static fromDate(e){return Ot.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*e0);return new Ot(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ZE)throw new me(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/e0}_compareTo(e){return this.seconds===e.seconds?Be(this.nanoseconds,e.nanoseconds):Be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-ZE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{static fromTimestamp(e){return new xe(e)}static min(){return new xe(new Ot(0,0))}static max(){return new xe(new Ot(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0="__name__";class Ls{constructor(e,t,s){t===void 0?t=0:t>e.length&&ke(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&ke(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Ls.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ls?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=Ls.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return Be(e.length,t.length)}static compareSegments(e,t){const s=Ls.isNumericId(e),r=Ls.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?Ls.extractNumericId(e).compare(Ls.extractNumericId(t)):yg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ui.fromString(e.substring(4,e.length-2))}}class _t extends Ls{construct(e,t,s){return new _t(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new me(q.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(r=>r.length>0))}return new _t(t)}static emptyPath(){return new _t([])}}const i3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tn extends Ls{construct(e,t,s){return new tn(e,t,s)}static isValidIdentifier(e){return i3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===t0}static keyField(){return new tn([t0])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new me(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new me(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new me(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new me(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tn(t)}static emptyPath(){return new tn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.path=e}static fromPath(e){return new be(_t.fromString(e))}static fromName(e){return new be(_t.fromString(e).popFirst(5))}static empty(){return new be(_t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&_t.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return _t.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new _t(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc=-1;function o3(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=xe.fromTimestamp(s===1e9?new Ot(t+1,0):new Ot(t,s));return new Ti(r,be.empty(),e)}function a3(n){return new Ti(n.readTime,n.key,Vc)}class Ti{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Ti(xe.min(),be.empty(),Vc)}static max(){return new Ti(xe.max(),be.empty(),Vc)}}function l3(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=be.comparator(n.documentKey,e.documentKey),t!==0?t:Be(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class u3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rl(n){if(n.code!==q.FAILED_PRECONDITION||n.message!==c3)throw n;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Q((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Q?t:Q.resolve(t)}catch(t){return Q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Q.reject(t)}static resolve(e){return new Q((t,s)=>{t(e)})}static reject(e){return new Q((t,s)=>{s(e)})}static waitFor(e){return new Q((t,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&t()},l=>s(l))}),o=!0,i===r&&t()})}static or(e){let t=Q.resolve(!1);for(const s of e)t=t.next(r=>r?Q.resolve(r):s());return t}static forEach(e,t){const s=[];return e.forEach((r,i)=>{s.push(t.call(this,r,i))}),this.waitFor(s)}static mapArray(e,t){return new Q((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(u=>{o[c]=u,++a,a===i&&s(o)},u=>r(u))}})}static doWhile(e,t){return new Q((s,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):s()};i()})}}function h3(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function il(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ue(s),this.ce=s=>t.writeSequenceNumber(s))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Nf.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay=-1;function Of(n){return n==null}function yd(n){return n===0&&1/n==-1/0}function d3(n){return typeof n=="number"&&Number.isInteger(n)&&!yd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1="";function f3(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=n0(e)),e=p3(n.get(t),e);return n0(e)}function p3(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const i=n.charAt(r);switch(i){case"\0":t+="";break;case $1:t+="";break;default:t+=i}}return t}function n0(n){return n+$1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s0(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function $i(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function U1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e,t){this.comparator=e,this.root=t||Xt.EMPTY}insert(e,t){return new Et(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Xt.BLACK,null,null))}remove(e){return new Et(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new th(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new th(this.root,e,this.comparator,!1)}getReverseIterator(){return new th(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new th(this.root,e,this.comparator,!0)}}class th{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xt{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??Xt.RED,this.left=r??Xt.EMPTY,this.right=i??Xt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new Xt(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Xt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Xt.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ke(27949);return e+(this.isRed()?0:1)}}Xt.EMPTY=null,Xt.RED=!0,Xt.BLACK=!1;Xt.EMPTY=new class{constructor(){this.size=0}get key(){throw ke(57766)}get value(){throw ke(16141)}get color(){throw ke(16727)}get left(){throw ke(29726)}get right(){throw ke(36894)}copy(e,t,s,r,i){return this}insert(e,t,s){return new Xt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.comparator=e,this.data=new Et(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new r0(this.data.getIterator())}getIteratorFrom(e){return new r0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Ft)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ft(this.comparator);return t.data=e,t}}class r0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.fields=e,e.sort(tn.comparator)}static empty(){return new Yn([])}unionWith(e){let t=new Ft(tn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Yn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Oa(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new j1("Invalid base64 string: "+i):i}}(e);return new sn(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new sn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}sn.EMPTY_BYTE_STRING=new sn("");const m3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Si(n){if(st(!!n,39018),typeof n=="string"){let e=0;const t=m3.exec(n);if(st(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:kt(n.seconds),nanos:kt(n.nanos)}}function kt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ii(n){return typeof n=="string"?sn.fromBase64String(n):sn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z1="server_timestamp",H1="__type__",W1="__previous_value__",q1="__local_write_time__";function Ry(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[H1])===null||t===void 0?void 0:t.stringValue)===z1}function Mf(n){const e=n.mapValue.fields[W1];return Ry(e)?Mf(e):e}function Fc(n){const e=Si(n.mapValue.fields[q1].timestampValue);return new Ot(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{constructor(e,t,s,r,i,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}const vd="(default)";class Bc{constructor(e,t){this.projectId=e,this.database=t||vd}static empty(){return new Bc("","")}get isDefaultDatabase(){return this.database===vd}isEqual(e){return e instanceof Bc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K1="__type__",_3="__max__",nh={mapValue:{}},G1="__vector__",bd="value";function Ci(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ry(n)?4:v3(n)?9007199254740991:y3(n)?10:11:ke(28295,{value:n})}function Gs(n,e){if(n===e)return!0;const t=Ci(n);if(t!==Ci(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Fc(n).isEqual(Fc(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=Si(r.timestampValue),a=Si(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,i){return Ii(r.bytesValue).isEqual(Ii(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return kt(r.geoPointValue.latitude)===kt(i.geoPointValue.latitude)&&kt(r.geoPointValue.longitude)===kt(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return kt(r.integerValue)===kt(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=kt(r.doubleValue),a=kt(i.doubleValue);return o===a?yd(o)===yd(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Oa(n.arrayValue.values||[],e.arrayValue.values||[],Gs);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},a=i.mapValue.fields||{};if(s0(o)!==s0(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Gs(o[l],a[l])))return!1;return!0}(n,e);default:return ke(52216,{left:n})}}function $c(n,e){return(n.values||[]).find(t=>Gs(t,e))!==void 0}function Ma(n,e){if(n===e)return 0;const t=Ci(n),s=Ci(e);if(t!==s)return Be(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Be(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=kt(i.integerValue||i.doubleValue),l=kt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return i0(n.timestampValue,e.timestampValue);case 4:return i0(Fc(n),Fc(e));case 5:return yg(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Ii(i),l=Ii(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=Be(a[c],l[c]);if(u!==0)return u}return Be(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Be(kt(i.latitude),kt(o.latitude));return a!==0?a:Be(kt(i.longitude),kt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return o0(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,c,u;const h=i.fields||{},f=o.fields||{},p=(a=h[bd])===null||a===void 0?void 0:a.arrayValue,m=(l=f[bd])===null||l===void 0?void 0:l.arrayValue,_=Be(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0);return _!==0?_:o0(p,m)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===nh.mapValue&&o===nh.mapValue)return 0;if(i===nh.mapValue)return 1;if(o===nh.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const f=yg(l[h],u[h]);if(f!==0)return f;const p=Ma(a[l[h]],c[u[h]]);if(p!==0)return p}return Be(l.length,u.length)}(n.mapValue,e.mapValue);default:throw ke(23264,{Pe:t})}}function i0(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Be(n,e);const t=Si(n),s=Si(e),r=Be(t.seconds,s.seconds);return r!==0?r:Be(t.nanos,s.nanos)}function o0(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const i=Ma(t[r],s[r]);if(i)return i}return Be(t.length,s.length)}function Da(n){return vg(n)}function vg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=Si(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ii(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return be.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=vg(i);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${vg(t.fields[o])}`;return r+"}"}(n.mapValue):ke(61005,{value:n})}function Ah(n){switch(Ci(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Mf(n);return e?16+Ah(e):16;case 5:return 2*n.stringValue.length;case 6:return Ii(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+Ah(i),0)}(n.arrayValue);case 10:case 11:return function(s){let r=0;return $i(s.fields,(i,o)=>{r+=i.length+Ah(o)}),r}(n.mapValue);default:throw ke(13486,{value:n})}}function a0(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function bg(n){return!!n&&"integerValue"in n}function Py(n){return!!n&&"arrayValue"in n}function l0(n){return!!n&&"nullValue"in n}function c0(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Rh(n){return!!n&&"mapValue"in n}function y3(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[K1])===null||t===void 0?void 0:t.stringValue)===G1}function lc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return $i(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=lc(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=lc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function v3(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===_3}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.value=e}static empty(){return new $n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Rh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=lc(t)}setAll(e){let t=tn.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,s,r),s={},r=[],t=a.popLast()}o?s[a.lastSegment()]=lc(o):r.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());Rh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Gs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];Rh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){$i(t,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new $n(lc(this.value))}}function Q1(n){const e=[];return $i(n.fields,(t,s)=>{const r=new tn([t]);if(Rh(s)){const i=Q1(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new Yn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e,t,s,r,i,o,a){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new gn(e,0,xe.min(),xe.min(),xe.min(),$n.empty(),0)}static newFoundDocument(e,t,s,r){return new gn(e,1,t,xe.min(),s,r,0)}static newNoDocument(e,t){return new gn(e,2,t,xe.min(),xe.min(),$n.empty(),0)}static newUnknownDocument(e,t){return new gn(e,3,t,xe.min(),xe.min(),$n.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$n.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$n.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof gn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new gn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t){this.position=e,this.inclusive=t}}function u0(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],o=n.position[r];if(i.field.isKeyField()?s=be.comparator(be.fromName(o.referenceValue),t.key):s=Ma(o,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function h0(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Gs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e,t="asc"){this.field=e,this.dir=t}}function b3(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{}class xt extends J1{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new E3(e,t,s):t==="array-contains"?new I3(e,s):t==="in"?new C3(e,s):t==="not-in"?new k3(e,s):t==="array-contains-any"?new A3(e,s):new xt(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new T3(e,s):new S3(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ma(t,this.value)):t!==null&&Ci(this.value)===Ci(t)&&this.matchesComparison(Ma(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Rs extends J1{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Rs(e,t)}matches(e){return Y1(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Y1(n){return n.op==="and"}function X1(n){return w3(n)&&Y1(n)}function w3(n){for(const e of n.filters)if(e instanceof Rs)return!1;return!0}function wg(n){if(n instanceof xt)return n.field.canonicalString()+n.op.toString()+Da(n.value);if(X1(n))return n.filters.map(e=>wg(e)).join(",");{const e=n.filters.map(t=>wg(t)).join(",");return`${n.op}(${e})`}}function Z1(n,e){return n instanceof xt?function(s,r){return r instanceof xt&&s.op===r.op&&s.field.isEqual(r.field)&&Gs(s.value,r.value)}(n,e):n instanceof Rs?function(s,r){return r instanceof Rs&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,a)=>i&&Z1(o,r.filters[a]),!0):!1}(n,e):void ke(19439)}function eA(n){return n instanceof xt?function(t){return`${t.field.canonicalString()} ${t.op} ${Da(t.value)}`}(n):n instanceof Rs?function(t){return t.op.toString()+" {"+t.getFilters().map(eA).join(" ,")+"}"}(n):"Filter"}class E3 extends xt{constructor(e,t,s){super(e,t,s),this.key=be.fromName(s.referenceValue)}matches(e){const t=be.comparator(e.key,this.key);return this.matchesComparison(t)}}class T3 extends xt{constructor(e,t){super(e,"in",t),this.keys=tA("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class S3 extends xt{constructor(e,t){super(e,"not-in",t),this.keys=tA("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function tA(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(s=>be.fromName(s.referenceValue))}class I3 extends xt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Py(t)&&$c(t.arrayValue,this.value)}}class C3 extends xt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&$c(this.value.arrayValue,t)}}class k3 extends xt{constructor(e,t){super(e,"not-in",t)}matches(e){if($c(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!$c(this.value.arrayValue,t)}}class A3 extends xt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Py(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>$c(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(e,t=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.Ie=null}}function d0(n,e=null,t=[],s=[],r=null,i=null,o=null){return new R3(n,e,t,s,r,i,o)}function xy(n){const e=Oe(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>wg(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),Of(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>Da(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>Da(s)).join(",")),e.Ie=t}return e.Ie}function Ny(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!b3(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Z1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!h0(n.startAt,e.startAt)&&h0(n.endAt,e.endAt)}function Eg(n){return be.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e,t=null,s=[],r=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function P3(n,e,t,s,r,i,o,a){return new ol(n,e,t,s,r,i,o,a)}function Df(n){return new ol(n)}function f0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function nA(n){return n.collectionGroup!==null}function cc(n){const e=Oe(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ft(tn.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new Uc(i,s))}),t.has(tn.keyField().canonicalString())||e.Ee.push(new Uc(tn.keyField(),s))}return e.Ee}function Ws(n){const e=Oe(n);return e.de||(e.de=x3(e,cc(n))),e.de}function x3(n,e){if(n.limitType==="F")return d0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new Uc(r.field,i)});const t=n.endAt?new wd(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new wd(n.startAt.position,n.startAt.inclusive):null;return d0(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Tg(n,e){const t=n.filters.concat([e]);return new ol(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Sg(n,e,t){return new ol(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Lf(n,e){return Ny(Ws(n),Ws(e))&&n.limitType===e.limitType}function sA(n){return`${xy(Ws(n))}|lt:${n.limitType}`}function ra(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(r=>eA(r)).join(", ")}]`),Of(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(r=>Da(r)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(r=>Da(r)).join(",")),`Target(${s})`}(Ws(n))}; limitType=${n.limitType})`}function Vf(n,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):be.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(n,e)&&function(s,r){for(const i of cc(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(n,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(n,e)&&function(s,r){return!(s.startAt&&!function(o,a,l){const c=u0(o,a,l);return o.inclusive?c<=0:c<0}(s.startAt,cc(s),r)||s.endAt&&!function(o,a,l){const c=u0(o,a,l);return o.inclusive?c>=0:c>0}(s.endAt,cc(s),r))}(n,e)}function N3(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function rA(n){return(e,t)=>{let s=!1;for(const r of cc(n)){const i=O3(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function O3(n,e,t){const s=n.field.isKeyField()?be.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Ma(l,c):ke(42886)}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return ke(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){$i(this.inner,(t,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return U1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M3=new Et(be.comparator);function Rr(){return M3}const iA=new Et(be.comparator);function zl(...n){let e=iA;for(const t of n)e=e.insert(t.key,t);return e}function oA(n){let e=iA;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function uo(){return uc()}function aA(){return uc()}function uc(){return new zo(n=>n.toString(),(n,e)=>n.isEqual(e))}const D3=new Et(be.comparator),L3=new Ft(be.comparator);function He(...n){let e=L3;for(const t of n)e=e.add(t);return e}const V3=new Ft(Be);function F3(){return V3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yd(e)?"-0":e}}function lA(n){return{integerValue:""+n}}function B3(n,e){return d3(e)?lA(e):Oy(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(){this._=void 0}}function $3(n,e,t){return n instanceof Ed?function(r,i){const o={fields:{[H1]:{stringValue:z1},[q1]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Ry(i)&&(i=Mf(i)),i&&(o.fields[W1]=i),{mapValue:o}}(t,e):n instanceof jc?uA(n,e):n instanceof zc?hA(n,e):function(r,i){const o=cA(r,i),a=p0(o)+p0(r.Re);return bg(o)&&bg(r.Re)?lA(a):Oy(r.serializer,a)}(n,e)}function U3(n,e,t){return n instanceof jc?uA(n,e):n instanceof zc?hA(n,e):t}function cA(n,e){return n instanceof Td?function(s){return bg(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class Ed extends Ff{}class jc extends Ff{constructor(e){super(),this.elements=e}}function uA(n,e){const t=dA(e);for(const s of n.elements)t.some(r=>Gs(r,s))||t.push(s);return{arrayValue:{values:t}}}class zc extends Ff{constructor(e){super(),this.elements=e}}function hA(n,e){let t=dA(e);for(const s of n.elements)t=t.filter(r=>!Gs(r,s));return{arrayValue:{values:t}}}class Td extends Ff{constructor(e,t){super(),this.serializer=e,this.Re=t}}function p0(n){return kt(n.integerValue||n.doubleValue)}function dA(n){return Py(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function j3(n,e){return n.field.isEqual(e.field)&&function(s,r){return s instanceof jc&&r instanceof jc||s instanceof zc&&r instanceof zc?Oa(s.elements,r.elements,Gs):s instanceof Td&&r instanceof Td?Gs(s.Re,r.Re):s instanceof Ed&&r instanceof Ed}(n.transform,e.transform)}class z3{constructor(e,t){this.version=e,this.transformResults=t}}class Ts{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ts}static exists(e){return new Ts(void 0,e)}static updateTime(e){return new Ts(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ph(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Bf{}function fA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new mA(n.key,Ts.none()):new vu(n.key,n.data,Ts.none());{const t=n.data,s=$n.empty();let r=new Ft(tn.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new Ui(n.key,s,new Yn(r.toArray()),Ts.none())}}function H3(n,e,t){n instanceof vu?function(r,i,o){const a=r.value.clone(),l=g0(r.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Ui?function(r,i,o){if(!Ph(r.precondition,i))return void i.convertToUnknownDocument(o.version);const a=g0(r.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(pA(r)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function hc(n,e,t,s){return n instanceof vu?function(i,o,a,l){if(!Ph(i.precondition,o))return a;const c=i.value.clone(),u=_0(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,s):n instanceof Ui?function(i,o,a,l){if(!Ph(i.precondition,o))return a;const c=_0(i.fieldTransforms,l,o),u=o.data;return u.setAll(pA(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(n,e,t,s):function(i,o,a){return Ph(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function W3(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=cA(s.transform,r||null);i!=null&&(t===null&&(t=$n.empty()),t.set(s.field,i))}return t||null}function m0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&Oa(s,r,(i,o)=>j3(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class vu extends Bf{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ui extends Bf{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function pA(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function g0(n,e,t){const s=new Map;st(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let r=0;r<t.length;r++){const i=n[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,U3(o,a,t[r]))}return s}function _0(n,e,t){const s=new Map;for(const r of n){const i=r.transform,o=t.data.field(r.field);s.set(r.field,$3(i,o,e))}return s}class mA extends Bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class q3 extends Bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&H3(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=hc(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=hc(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=aA();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(r.key)?null:a;const l=fA(o,a);l!==null&&s.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(xe.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),He())}isEqual(e){return this.batchId===e.batchId&&Oa(this.mutations,e.mutations,(t,s)=>m0(t,s))&&Oa(this.baseMutations,e.baseMutations,(t,s)=>m0(t,s))}}class My{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){st(e.mutations.length===s.length,58842,{fe:e.mutations.length,ge:s.length});let r=function(){return D3}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new My(e,t,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,Ke;function J3(n){switch(n){case q.OK:return ke(64938);case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0;default:return ke(15467,{code:n})}}function gA(n){if(n===void 0)return Ar("GRPC error has no .code"),q.UNKNOWN;switch(n){case Rt.OK:return q.OK;case Rt.CANCELLED:return q.CANCELLED;case Rt.UNKNOWN:return q.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return q.INTERNAL;case Rt.UNAVAILABLE:return q.UNAVAILABLE;case Rt.UNAUTHENTICATED:return q.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case Rt.NOT_FOUND:return q.NOT_FOUND;case Rt.ALREADY_EXISTS:return q.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return q.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case Rt.ABORTED:return q.ABORTED;case Rt.OUT_OF_RANGE:return q.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return q.UNIMPLEMENTED;case Rt.DATA_LOSS:return q.DATA_LOSS;default:return ke(39323,{code:n})}}(Ke=Rt||(Rt={}))[Ke.OK=0]="OK",Ke[Ke.CANCELLED=1]="CANCELLED",Ke[Ke.UNKNOWN=2]="UNKNOWN",Ke[Ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ke[Ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ke[Ke.NOT_FOUND=5]="NOT_FOUND",Ke[Ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ke[Ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ke[Ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ke[Ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ke[Ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ke[Ke.ABORTED=10]="ABORTED",Ke[Ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ke[Ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ke[Ke.INTERNAL=13]="INTERNAL",Ke[Ke.UNAVAILABLE=14]="UNAVAILABLE",Ke[Ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y3=new ui([4294967295,4294967295],0);function y0(n){const e=F1().encode(n),t=new P1;return t.update(e),new Uint8Array(t.digest())}function v0(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ui([t,s],0),new ui([r,i],0)]}class Dy{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Hl(`Invalid padding: ${t}`);if(s<0)throw new Hl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Hl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Hl(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=ui.fromNumber(this.pe)}we(e,t,s){let r=e.add(t.multiply(ui.fromNumber(s)));return r.compare(Y3)===1&&(r=new ui([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=y0(e),[s,r]=v0(t);for(let i=0;i<this.hashCount;i++){const o=this.we(s,r,i);if(!this.be(o))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Dy(i,r,t);return s.forEach(a=>o.insert(a)),o}insert(e){if(this.pe===0)return;const t=y0(e),[s,r]=v0(t);for(let i=0;i<this.hashCount;i++){const o=this.we(s,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Hl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,bu.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new $f(xe.min(),r,new Et(Be),Rr(),He())}}class bu{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new bu(s,t,He(),He(),He())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,t,s,r){this.De=e,this.removedTargetIds=t,this.key=s,this.ve=r}}class _A{constructor(e,t){this.targetId=e,this.Ce=t}}class yA{constructor(e,t,s=sn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class b0{constructor(){this.Fe=0,this.Me=w0(),this.xe=sn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=He(),t=He(),s=He();return this.Me.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:ke(38017,{changeType:i})}}),new bu(this.xe,this.Oe,e,t,s)}Qe(){this.Ne=!1,this.Me=w0()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,st(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class X3{constructor(e){this.ze=e,this.je=new Map,this.He=Rr(),this.Je=sh(),this.Ye=sh(),this.Ze=new Et(Be)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const s=this.rt(t);switch(e.state){case 0:this.it(t)&&s.ke(e.resumeToken);break;case 1:s.We(),s.Be||s.Qe(),s.ke(e.resumeToken);break;case 2:s.We(),s.Be||this.removeTarget(t);break;case 3:this.it(t)&&(s.Ge(),s.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),s.ke(e.resumeToken));break;default:ke(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((s,r)=>{this.it(r)&&t(r)})}ot(e){const t=e.targetId,s=e.Ce.count,r=this._t(t);if(r){const i=r.target;if(Eg(i))if(s===0){const o=new be(i.path);this.tt(t,o,gn.newNoDocument(o,xe.min()))}else st(s===1,20013,{expectedCount:s});else{const o=this.ut(t);if(o!==s){const a=this.ct(e),l=a?this.lt(a,e,o):1;if(l!==0){this.st(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,c)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let o,a;try{o=Ii(s).toUint8Array()}catch(l){if(l instanceof j1)return Na("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Dy(o,r,i)}catch(l){return Na(l instanceof Hl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.pe===0?null:a}lt(e,t,s){return t.Ce.count===s-this.Tt(e,t.targetId)?0:2}Tt(e,t){const s=this.ze.getRemoteKeysForTarget(t);let r=0;return s.forEach(i=>{const o=this.ze.Pt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.tt(t,i,null),r++)}),r}It(e){const t=new Map;this.je.forEach((i,o)=>{const a=this._t(o);if(a){if(i.current&&Eg(a.target)){const l=new be(a.target.path);this.Et(l).has(o)||this.dt(o,l)||this.tt(o,l,gn.newNoDocument(l,e))}i.Le&&(t.set(o,i.qe()),i.Qe())}});let s=He();this.Ye.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this._t(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(s=s.add(i))}),this.He.forEach((i,o)=>o.setReadTime(e));const r=new $f(e,t,this.Ze,this.He,s);return this.He=Rr(),this.Je=sh(),this.Ye=sh(),this.Ze=new Et(Be),r}et(e,t){if(!this.it(e))return;const s=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,s),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,s){if(!this.it(e))return;const r=this.rt(e);this.dt(e,t)?r.$e(t,1):r.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),s&&(this.He=this.He.insert(t,s))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new b0,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Ft(Be),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Ft(Be),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new b0),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function sh(){return new Et(be.comparator)}function w0(){return new Et(be.comparator)}const Z3={asc:"ASCENDING",desc:"DESCENDING"},e4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},t4={and:"AND",or:"OR"};class n4{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ig(n,e){return n.useProto3Json||Of(e)?e:{value:e}}function Sd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function s4(n,e){return Sd(n,e.toTimestamp())}function qs(n){return st(!!n,49232),xe.fromTimestamp(function(t){const s=Si(t);return new Ot(s.seconds,s.nanos)}(n))}function Ly(n,e){return Cg(n,e).canonicalString()}function Cg(n,e){const t=function(r){return new _t(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function bA(n){const e=_t.fromString(n);return st(IA(e),10190,{key:e.toString()}),e}function kg(n,e){return Ly(n.databaseId,e.path)}function nm(n,e){const t=bA(e);if(t.get(1)!==n.databaseId.projectId)throw new me(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new be(EA(t))}function wA(n,e){return Ly(n.databaseId,e)}function r4(n){const e=bA(n);return e.length===4?_t.emptyPath():EA(e)}function Ag(n){return new _t(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function EA(n){return st(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function E0(n,e,t){return{name:kg(n,e),fields:t.value.mapValue.fields}}function i4(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ke(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(st(u===void 0||typeof u=="string",58123),sn.fromBase64String(u||"")):(st(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),sn.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?q.UNKNOWN:gA(c.code);return new me(u,c.message||"")}(o);t=new yA(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=nm(n,s.document.name),i=qs(s.document.updateTime),o=s.document.createTime?qs(s.document.createTime):xe.min(),a=new $n({mapValue:{fields:s.document.fields}}),l=gn.newFoundDocument(r,i,o,a),c=s.targetIds||[],u=s.removedTargetIds||[];t=new xh(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=nm(n,s.document),i=s.readTime?qs(s.readTime):xe.min(),o=gn.newNoDocument(r,i),a=s.removedTargetIds||[];t=new xh([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=nm(n,s.document),i=s.removedTargetIds||[];t=new xh([],i,r,null)}else{if(!("filter"in e))return ke(11601,{Vt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new Q3(r,i),a=s.targetId;t=new _A(a,o)}}return t}function o4(n,e){let t;if(e instanceof vu)t={update:E0(n,e.key,e.value)};else if(e instanceof mA)t={delete:kg(n,e.key)};else if(e instanceof Ui)t={update:E0(n,e.key,e.data),updateMask:m4(e.fieldMask)};else{if(!(e instanceof q3))return ke(16599,{ft:e.type});t={verify:kg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const a=o.transform;if(a instanceof Ed)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof jc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof zc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Td)return{fieldPath:o.field.canonicalString(),increment:a.Re};throw ke(20930,{transform:o.transform})}(0,s))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:s4(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ke(27497)}(n,e.precondition)),t}function a4(n,e){return n&&n.length>0?(st(e!==void 0,14353),n.map(t=>function(r,i){let o=r.updateTime?qs(r.updateTime):qs(i);return o.isEqual(xe.min())&&(o=qs(i)),new z3(o,r.transformResults||[])}(t,e))):[]}function l4(n,e){return{documents:[wA(n,e.path)]}}function c4(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=wA(n,r);const i=function(c){if(c.length!==0)return SA(Rs.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(f){return{field:ia(f.field),direction:d4(f.dir)}}(u))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Ig(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{gt:t,parent:r}}function u4(n){let e=r4(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){st(s===1,65062);const u=t.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let i=[];t.where&&(i=function(h){const f=TA(h);return f instanceof Rs&&X1(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(f=>function(m){return new Uc(oa(m.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,Of(f)?null:f}(t.limit));let l=null;t.startAt&&(l=function(h){const f=!!h.before,p=h.values||[];return new wd(p,f)}(t.startAt));let c=null;return t.endAt&&(c=function(h){const f=!h.before,p=h.values||[];return new wd(p,f)}(t.endAt)),P3(e,r,o,i,a,"F",l,c)}function h4(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ke(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function TA(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=oa(t.unaryFilter.field);return xt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=oa(t.unaryFilter.field);return xt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=oa(t.unaryFilter.field);return xt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=oa(t.unaryFilter.field);return xt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ke(61313);default:return ke(60726)}}(n):n.fieldFilter!==void 0?function(t){return xt.create(oa(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ke(58110);default:return ke(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Rs.create(t.compositeFilter.filters.map(s=>TA(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ke(1026)}}(t.compositeFilter.op))}(n):ke(30097,{filter:n})}function d4(n){return Z3[n]}function f4(n){return e4[n]}function p4(n){return t4[n]}function ia(n){return{fieldPath:n.canonicalString()}}function oa(n){return tn.fromServerFormat(n.fieldPath)}function SA(n){return n instanceof xt?function(t){if(t.op==="=="){if(c0(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NAN"}};if(l0(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(c0(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NOT_NAN"}};if(l0(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ia(t.field),op:f4(t.op),value:t.value}}}(n):n instanceof Rs?function(t){const s=t.getFilters().map(r=>SA(r));return s.length===1?s[0]:{compositeFilter:{op:p4(t.op),filters:s}}}(n):ke(54877,{filter:n})}function m4(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function IA(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,t,s,r,i=xe.min(),o=xe.min(),a=sn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ti(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ti(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ti(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ti(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(e){this.wt=e}}function _4(n){const e=u4({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Sg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(){this.yn=new v4}addToCollectionParentIndex(e,t){return this.yn.add(t),Q.resolve()}getCollectionParents(e,t){return Q.resolve(this.yn.getEntries(t))}addFieldIndex(e,t){return Q.resolve()}deleteFieldIndex(e,t){return Q.resolve()}deleteAllFieldIndexes(e){return Q.resolve()}createTargetIndexes(e,t){return Q.resolve()}getDocumentsMatchingTarget(e,t){return Q.resolve(null)}getIndexType(e,t){return Q.resolve(0)}getFieldIndexes(e,t){return Q.resolve([])}getNextCollectionGroupToUpdate(e){return Q.resolve(null)}getMinOffset(e,t){return Q.resolve(Ti.min())}getMinOffsetFromCollectionGroup(e,t){return Q.resolve(Ti.min())}updateCollectionGroup(e,t,s){return Q.resolve()}updateIndexEntries(e,t){return Q.resolve()}}class v4{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new Ft(_t.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Ft(_t.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},CA=41943040;class Bn{static withCacheSize(e){return new Bn(e,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bn.DEFAULT_COLLECTION_PERCENTILE=10,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bn.DEFAULT=new Bn(CA,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bn.DISABLED=new Bn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e){this.nr=e}next(){return this.nr+=2,this.nr}static rr(){return new La(0)}static ir(){return new La(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0="LruGarbageCollector",b4=1048576;function I0([n,e],[t,s]){const r=Be(n,t);return r===0?Be(e,s):r}class w4{constructor(e){this.cr=e,this.buffer=new Ft(I0),this.lr=0}hr(){return++this.lr}Pr(e){const t=[e,this.hr()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();I0(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class E4{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Tr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ir(6e4)}stop(){this.Tr&&(this.Tr.cancel(),this.Tr=null)}get started(){return this.Tr!==null}Ir(e){pe(S0,`Garbage collection scheduled in ${e}ms`),this.Tr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Tr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){il(t)?pe(S0,"Ignoring IndexedDB error during garbage collection: ",t):await rl(t)}await this.Ir(3e5)})}}class T4{constructor(e,t){this.Er=e,this.params=t}calculateTargetCount(e,t){return this.Er.dr(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(t===0)return Q.resolve(Nf.le);const s=new w4(t);return this.Er.forEachTarget(e,r=>s.Pr(r.sequenceNumber)).next(()=>this.Er.Ar(e,r=>s.Pr(r))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.Er.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Er.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),Q.resolve(T0)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),T0):this.Rr(e,t))}getCacheSize(e){return this.Er.getCacheSize(e)}Rr(e,t){let s,r,i,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(s=h,a=Date.now(),this.removeTargets(e,s,t))).next(h=>(i=h,l=Date.now(),this.removeOrphanedDocuments(e,s))).next(h=>(c=Date.now(),sa()<=ze.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),Q.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:h})))}}function S4(n,e){return new T4(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(){this.changes=new zo(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,gn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?Q.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(s!==null&&hc(s.mutation,r,Yn.empty(),Ot.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,He()).next(()=>s))}getLocalViewOfDocuments(e,t,s=He()){const r=uo();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,s).next(i=>{let o=zl();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const s=uo();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,He()))}populateOverlays(e,t,s){const r=[];return s.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,s,r){let i=Rr();const o=uc(),a=function(){return uc()}();return t.forEach((l,c)=>{const u=s.get(c.key);r.has(c.key)&&(u===void 0||u.mutation instanceof Ui)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),hc(u.mutation,c,u.mutation.getFieldMask(),Ot.now())):o.set(c.key,Yn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),t.forEach((c,u)=>{var h;return a.set(c,new C4(u,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){const s=uc();let r=new Et((o,a)=>o-a),i=He();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let u=s.get(l)||Yn.empty();u=a.applyToLocalView(c,u),s.set(l,u);const h=(r.get(a.batchId)||He()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=aA();u.forEach(f=>{if(!i.has(f)){const p=fA(t.get(f),s.get(f));p!==null&&h.set(f,p),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return Q.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,r){return function(o){return be.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):nA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):Q.resolve(uo());let a=Vc,l=i;return o.next(c=>Q.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?Q.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{l=l.insert(u,f)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,He())).next(u=>({batchId:a,changes:oA(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new be(t)).next(s=>{let r=zl();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let o=zl();return this.indexManager.getCollectionParents(e,i).next(a=>Q.forEach(a,l=>{const c=function(h,f){return new ol(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,s,r).next(u=>{u.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r))).next(o=>{i.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,gn.newInvalidDocument(u)))});let a=zl();return o.forEach((l,c)=>{const u=i.get(l);u!==void 0&&hc(u.mutation,c,Yn.empty(),Ot.now()),Vf(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{constructor(e){this.serializer=e,this.Fr=new Map,this.Mr=new Map}getBundleMetadata(e,t){return Q.resolve(this.Fr.get(t))}saveBundleMetadata(e,t){return this.Fr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:qs(r.createTime)}}(t)),Q.resolve()}getNamedQuery(e,t){return Q.resolve(this.Mr.get(t))}saveNamedQuery(e,t){return this.Mr.set(t.name,function(r){return{name:r.name,query:_4(r.bundledQuery),readTime:qs(r.readTime)}}(t)),Q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(){this.overlays=new Et(be.comparator),this.Or=new Map}getOverlay(e,t){return Q.resolve(this.overlays.get(t))}getOverlays(e,t){const s=uo();return Q.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((r,i)=>{this.St(e,t,i)}),Q.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.Or.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.Or.delete(s)),Q.resolve()}getOverlaysForCollection(e,t,s){const r=uo(),i=t.length+1,o=new be(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>s&&r.set(l.getKey(),l)}return Q.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new Et((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>s){let u=i.get(c.largestBatchId);u===null&&(u=uo(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=uo(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=r)););return Q.resolve(a)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.Or.get(r.largestBatchId).delete(s.key);this.Or.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new G3(t,s));let i=this.Or.get(t);i===void 0&&(i=He(),this.Or.set(t,i)),this.Or.set(t,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(){this.sessionToken=sn.EMPTY_BYTE_STRING}getSessionToken(e){return Q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(){this.Nr=new Ft($t.Br),this.Lr=new Ft($t.kr)}isEmpty(){return this.Nr.isEmpty()}addReference(e,t){const s=new $t(e,t);this.Nr=this.Nr.add(s),this.Lr=this.Lr.add(s)}qr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.Qr(new $t(e,t))}$r(e,t){e.forEach(s=>this.removeReference(s,t))}Ur(e){const t=new be(new _t([])),s=new $t(t,e),r=new $t(t,e+1),i=[];return this.Lr.forEachInRange([s,r],o=>{this.Qr(o),i.push(o.key)}),i}Kr(){this.Nr.forEach(e=>this.Qr(e))}Qr(e){this.Nr=this.Nr.delete(e),this.Lr=this.Lr.delete(e)}Wr(e){const t=new be(new _t([])),s=new $t(t,e),r=new $t(t,e+1);let i=He();return this.Lr.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new $t(e,0),s=this.Nr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class $t{constructor(e,t){this.key=e,this.Gr=t}static Br(e,t){return be.comparator(e.key,t.key)||Be(e.Gr,t.Gr)}static kr(e,t){return Be(e.Gr,t.Gr)||be.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Jn=1,this.zr=new Ft($t.Br)}checkEmpty(e){return Q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.Jn;this.Jn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new K3(i,t,s,r);this.mutationQueue.push(o);for(const a of r)this.zr=this.zr.add(new $t(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Q.resolve(o)}lookupMutationBatch(e,t){return Q.resolve(this.jr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.Hr(s),i=r<0?0:r;return Q.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Q.resolve(this.mutationQueue.length===0?Ay:this.Jn-1)}getAllMutationBatches(e){return Q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new $t(t,0),r=new $t(t,Number.POSITIVE_INFINITY),i=[];return this.zr.forEachInRange([s,r],o=>{const a=this.jr(o.Gr);i.push(a)}),Q.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Ft(Be);return t.forEach(r=>{const i=new $t(r,0),o=new $t(r,Number.POSITIVE_INFINITY);this.zr.forEachInRange([i,o],a=>{s=s.add(a.Gr)})}),Q.resolve(this.Jr(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;be.isDocumentKey(i)||(i=i.child(""));const o=new $t(new be(i),0);let a=new Ft(Be);return this.zr.forEachWhile(l=>{const c=l.key.path;return!!s.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.Gr)),!0)},o),Q.resolve(this.Jr(a))}Jr(e){const t=[];return e.forEach(s=>{const r=this.jr(s);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){st(this.Yr(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.zr;return Q.forEach(t.mutations,r=>{const i=new $t(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.zr=s})}Xn(e){}containsKey(e,t){const s=new $t(t,0),r=this.zr.firstAfterOrEqual(s);return Q.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Q.resolve()}Yr(e,t){return this.Hr(e)}Hr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}jr(e){const t=this.Hr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e){this.Zr=e,this.docs=function(){return new Et(be.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,o=this.Zr(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return Q.resolve(s?s.document.mutableCopy():gn.newInvalidDocument(t))}getEntries(e,t){let s=Rr();return t.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():gn.newInvalidDocument(r))}),Q.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=Rr();const o=t.path,a=new be(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||l3(a3(u),s)<=0||(r.has(u.key)||Vf(t,u))&&(i=i.insert(u.key,u.mutableCopy()))}return Q.resolve(i)}getAllFromCollectionGroup(e,t,s,r){ke(9500)}Xr(e,t){return Q.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new O4(this)}getSize(e){return Q.resolve(this.size)}}class O4 extends I4{constructor(e){super(),this.vr=e}applyChanges(e){const t=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?t.push(this.vr.addEntry(e,r)):this.vr.removeEntry(s)}),Q.waitFor(t)}getFromCache(e,t){return this.vr.getEntry(e,t)}getAllFromCache(e,t){return this.vr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e){this.persistence=e,this.ei=new zo(t=>xy(t),Ny),this.lastRemoteSnapshotVersion=xe.min(),this.highestTargetId=0,this.ti=0,this.ni=new Vy,this.targetCount=0,this.ri=La.rr()}forEachTarget(e,t){return this.ei.forEach((s,r)=>t(r)),Q.resolve()}getLastRemoteSnapshotVersion(e){return Q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Q.resolve(this.ti)}allocateTargetId(e){return this.highestTargetId=this.ri.next(),Q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.ti&&(this.ti=t),Q.resolve()}ar(e){this.ei.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ri=new La(t),this.highestTargetId=t),e.sequenceNumber>this.ti&&(this.ti=e.sequenceNumber)}addTargetData(e,t){return this.ar(t),this.targetCount+=1,Q.resolve()}updateTargetData(e,t){return this.ar(t),Q.resolve()}removeTargetData(e,t){return this.ei.delete(t.target),this.ni.Ur(t.targetId),this.targetCount-=1,Q.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.ei.forEach((o,a)=>{a.sequenceNumber<=t&&s.get(a.targetId)===null&&(this.ei.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),Q.waitFor(i).next(()=>r)}getTargetCount(e){return Q.resolve(this.targetCount)}getTargetData(e,t){const s=this.ei.get(t)||null;return Q.resolve(s)}addMatchingKeys(e,t,s){return this.ni.qr(t,s),Q.resolve()}removeMatchingKeys(e,t,s){this.ni.$r(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),Q.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ni.Ur(t),Q.resolve()}getMatchingKeysForTargetId(e,t){const s=this.ni.Wr(t);return Q.resolve(s)}containsKey(e,t){return Q.resolve(this.ni.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e,t){this.ii={},this.overlays={},this.si=new Nf(0),this.oi=!1,this.oi=!0,this._i=new P4,this.referenceDelegate=e(this),this.ai=new M4(this),this.indexManager=new y4,this.remoteDocumentCache=function(r){return new N4(r)}(s=>this.referenceDelegate.ui(s)),this.serializer=new g4(t),this.ci=new A4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.oi=!1,Promise.resolve()}get started(){return this.oi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new R4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ii[e.toKey()];return s||(s=new x4(t,this.referenceDelegate),this.ii[e.toKey()]=s),s}getGlobalsCache(){return this._i}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.ci}runTransaction(e,t,s){pe("MemoryPersistence","Starting transaction:",e);const r=new D4(this.si.next());return this.referenceDelegate.li(),s(r).next(i=>this.referenceDelegate.hi(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Pi(e,t){return Q.or(Object.values(this.ii).map(s=>()=>s.containsKey(e,t)))}}class D4 extends u3{constructor(e){super(),this.currentSequenceNumber=e}}class Fy{constructor(e){this.persistence=e,this.Ti=new Vy,this.Ii=null}static Ei(e){return new Fy(e)}get di(){if(this.Ii)return this.Ii;throw ke(60996)}addReference(e,t,s){return this.Ti.addReference(s,t),this.di.delete(s.toString()),Q.resolve()}removeReference(e,t,s){return this.Ti.removeReference(s,t),this.di.add(s.toString()),Q.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Q.resolve()}removeTarget(e,t){this.Ti.Ur(t.targetId).forEach(r=>this.di.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.di.add(i.toString()))}).next(()=>s.removeTargetData(e,t))}li(){this.Ii=new Set}hi(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Q.forEach(this.di,s=>{const r=be.fromPath(s);return this.Ai(e,r).next(i=>{i||t.removeEntry(r,xe.min())})}).next(()=>(this.Ii=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ai(e,t).next(s=>{s?this.di.delete(t.toString()):this.di.add(t.toString())})}ui(e){return 0}Ai(e,t){return Q.or([()=>Q.resolve(this.Ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Pi(e,t)])}}class Id{constructor(e,t){this.persistence=e,this.Ri=new zo(s=>f3(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=S4(this,t)}static Ei(e,t){return new Id(e,t)}li(){}hi(e){return Q.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.Vr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}Vr(e){let t=0;return this.Ar(e,s=>{t++}).next(()=>t)}Ar(e,t){return Q.forEach(this.Ri,(s,r)=>this.gr(e,s,r).next(i=>i?Q.resolve():t(r)))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.Xr(e,o=>this.gr(e,o,t).next(a=>{a||(s++,i.removeEntry(o,xe.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,t){return this.Ri.set(t,e.currentSequenceNumber),Q.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.Ri.set(s,e.currentSequenceNumber),Q.resolve()}removeReference(e,t,s){return this.Ri.set(s,e.currentSequenceNumber),Q.resolve()}updateLimboDocument(e,t){return this.Ri.set(t,e.currentSequenceNumber),Q.resolve()}ui(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ah(e.data.value)),t}gr(e,t,s){return Q.or([()=>this.persistence.Pi(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.Ri.get(t);return Q.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.ls=s,this.hs=r}static Ps(e,t){let s=He(),r=He();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new By(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V4{constructor(){this.Ts=!1,this.Is=!1,this.Es=100,this.ds=function(){return wD()?8:h3(vn())>0?6:4}()}initialize(e,t){this.As=e,this.indexManager=t,this.Ts=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.Rs(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Vs(e,t,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new L4;return this.fs(e,t,o).next(a=>{if(i.result=a,this.Is)return this.gs(e,t,o,a.size)})}).next(()=>i.result)}gs(e,t,s,r){return s.documentReadCount<this.Es?(sa()<=ze.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",ra(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Es,"documents"),Q.resolve()):(sa()<=ze.DEBUG&&pe("QueryEngine","Query:",ra(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.ds*r?(sa()<=ze.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",ra(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ws(t))):Q.resolve())}Rs(e,t){if(f0(t))return Q.resolve(null);let s=Ws(t);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Sg(t,null,"F"),s=Ws(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=He(...i);return this.As.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(l=>{const c=this.ps(t,a);return this.ys(t,c,o,l.readTime)?this.Rs(e,Sg(t,null,"F")):this.ws(e,c,t,l)}))})))}Vs(e,t,s,r){return f0(t)||r.isEqual(xe.min())?Q.resolve(null):this.As.getDocuments(e,s).next(i=>{const o=this.ps(t,i);return this.ys(t,o,s,r)?Q.resolve(null):(sa()<=ze.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ra(t)),this.ws(e,o,t,o3(r,Vc)).next(a=>a))})}ps(e,t){let s=new Ft(rA(e));return t.forEach((r,i)=>{Vf(e,i)&&(s=s.add(i))}),s}ys(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}fs(e,t,s){return sa()<=ze.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",ra(t)),this.As.getDocumentsMatchingQuery(e,t,Ti.min(),s)}ws(e,t,s,r){return this.As.getDocumentsMatchingQuery(e,s,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y="LocalStore",F4=3e8;class B4{constructor(e,t,s,r){this.persistence=e,this.bs=t,this.serializer=r,this.Ss=new Et(Be),this.Ds=new zo(i=>xy(i),Ny),this.vs=new Map,this.Cs=e.getRemoteDocumentCache(),this.ai=e.getTargetCache(),this.ci=e.getBundleCache(),this.Fs(s)}Fs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new k4(this.Cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Cs.setIndexManager(this.indexManager),this.bs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ss))}}function $4(n,e,t,s){return new B4(n,e,t,s)}async function AA(n,e){const t=Oe(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,t.Fs(e),t.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let l=He();for(const c of r){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(s,l).next(c=>({Ms:c,removedBatchIds:o,addedBatchIds:a}))})})}function U4(n,e){const t=Oe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=t.Cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const h=c.batch,f=h.keys();let p=Q.resolve();return f.forEach(m=>{p=p.next(()=>u.getEntry(l,m)).next(_=>{const v=c.docVersions.get(m);st(v!==null,48541),_.version.compareTo(v)<0&&(h.applyToRemoteDocument(_,c),_.isValidDocument()&&(_.setReadTime(c.commitVersion),u.addEntry(_)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(t,s,e,i).next(()=>i.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(a){let l=He();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(s,r))})}function RA(n){const e=Oe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.ai.getLastRemoteSnapshotVersion(t))}function j4(n,e){const t=Oe(n),s=e.snapshotVersion;let r=t.Ss;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Cs.newChangeBuffer({trackRemovals:!0});r=t.Ss;const a=[];e.targetChanges.forEach((u,h)=>{const f=r.get(h);if(!f)return;a.push(t.ai.removeMatchingKeys(i,u.removedDocuments,h).next(()=>t.ai.addMatchingKeys(i,u.addedDocuments,h)));let p=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(sn.EMPTY_BYTE_STRING,xe.min()).withLastLimboFreeSnapshotVersion(xe.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,s)),r=r.insert(h,p),function(_,v,I){return _.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=F4?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(f,p,u)&&a.push(t.ai.updateTargetData(i,p))});let l=Rr(),c=He();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(z4(i,o,e.documentUpdates).next(u=>{l=u.xs,c=u.Os})),!s.isEqual(xe.min())){const u=t.ai.getLastRemoteSnapshotVersion(i).next(h=>t.ai.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(u)}return Q.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.Ss=r,i))}function z4(n,e,t){let s=He(),r=He();return t.forEach(i=>s=s.add(i)),e.getEntries(n,s).next(i=>{let o=Rr();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(xe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):pe($y,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{xs:o,Os:r}})}function H4(n,e){const t=Oe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=Ay),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function W4(n,e){const t=Oe(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return t.ai.getTargetData(s,e).next(i=>i?(r=i,Q.resolve(r)):t.ai.allocateTargetId(s).next(o=>(r=new ti(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.ai.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=t.Ss.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ss=t.Ss.insert(s.targetId,s),t.Ds.set(e,s.targetId)),s})}async function Rg(n,e,t){const s=Oe(n),r=s.Ss.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!il(o))throw o;pe($y,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ss=s.Ss.remove(e),s.Ds.delete(r.target)}function C0(n,e,t){const s=Oe(n);let r=xe.min(),i=He();return s.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const h=Oe(l),f=h.Ds.get(u);return f!==void 0?Q.resolve(h.Ss.get(f)):h.ai.getTargetData(c,u)}(s,o,Ws(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.ai.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>s.bs.getDocumentsMatchingQuery(o,e,t?r:xe.min(),t?i:He())).next(a=>(q4(s,N3(e),a),{documents:a,Ns:i})))}function q4(n,e,t){let s=n.vs.get(e)||xe.min();t.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),n.vs.set(e,s)}class k0{constructor(){this.activeTargetIds=F3()}$s(e){this.activeTargetIds=this.activeTargetIds.add(e)}Us(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Qs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class K4{constructor(){this.So=new k0,this.Do={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.So.$s(e),this.Do[e]||"not-current"}updateQueryState(e,t,s){this.Do[e]=t}removeLocalQueryTarget(e){this.So.Us(e)}isLocalQueryTarget(e){return this.So.activeTargetIds.has(e)}clearQueryState(e){delete this.Do[e]}getAllActiveQueryTargets(){return this.So.activeTargetIds}isActiveQueryTarget(e){return this.So.activeTargetIds.has(e)}start(){return this.So=new k0,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{vo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A0="ConnectivityMonitor";class R0{constructor(){this.Co=()=>this.Fo(),this.Mo=()=>this.xo(),this.Oo=[],this.No()}vo(e){this.Oo.push(e)}shutdown(){window.removeEventListener("online",this.Co),window.removeEventListener("offline",this.Mo)}No(){window.addEventListener("online",this.Co),window.addEventListener("offline",this.Mo)}Fo(){pe(A0,"Network connectivity changed: AVAILABLE");for(const e of this.Oo)e(0)}xo(){pe(A0,"Network connectivity changed: UNAVAILABLE");for(const e of this.Oo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rh=null;function Pg(){return rh===null?rh=function(){return 268435456+Math.round(2147483648*Math.random())}():rh++,"0x"+rh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sm="RestConnection",Q4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class J4{get Bo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Lo=t+"://"+e.host,this.ko=`projects/${s}/databases/${r}`,this.qo=this.databaseId.database===vd?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Qo(e,t,s,r,i){const o=Pg(),a=this.$o(e,t.toUriEncodedString());pe(sm,`Sending RPC '${e}' ${o}:`,a,s);const l={"google-cloud-resource-prefix":this.ko,"x-goog-request-params":this.qo};return this.Uo(l,r,i),this.Ko(e,a,l,s).then(c=>(pe(sm,`Received RPC '${e}' ${o}: `,c),c),c=>{throw Na(sm,`RPC '${e}' ${o} failed with error: `,c,"url: ",a,"request:",s),c})}Wo(e,t,s,r,i,o){return this.Qo(e,t,s,r,i)}Uo(e,t,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+sl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}$o(e,t){const s=Q4[e];return`${this.Lo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e){this.Go=e.Go,this.zo=e.zo}jo(e){this.Ho=e}Jo(e){this.Yo=e}Zo(e){this.Xo=e}onMessage(e){this.e_=e}close(){this.zo()}send(e){this.Go(e)}t_(){this.Ho()}n_(){this.Yo()}r_(e){this.Xo(e)}i_(e){this.e_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn="WebChannelConnection";class X4 extends J4{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ko(e,t,s,r){const i=Pg();return new Promise((o,a)=>{const l=new x1;l.setWithCredentials(!0),l.listenOnce(N1.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case kh.NO_ERROR:const u=l.getResponseJson();pe(cn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),o(u);break;case kh.TIMEOUT:pe(cn,`RPC '${e}' ${i} timed out`),a(new me(q.DEADLINE_EXCEEDED,"Request time out"));break;case kh.HTTP_ERROR:const h=l.getStatus();if(pe(cn,`RPC '${e}' ${i} failed with status:`,h,"response text:",l.getResponseText()),h>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const p=f==null?void 0:f.error;if(p&&p.status&&p.message){const m=function(v){const I=v.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(I)>=0?I:q.UNKNOWN}(p.status);a(new me(m,p.message))}else a(new me(q.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new me(q.UNAVAILABLE,"Connection failed."));break;default:ke(9055,{s_:e,streamId:i,o_:l.getLastErrorCode(),__:l.getLastError()})}}finally{pe(cn,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(r);pe(cn,`RPC '${e}' ${i} sending request:`,r),l.send(t,"POST",c,s,15)})}a_(e,t,s){const r=Pg(),i=[this.Lo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=D1(),a=M1(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Uo(l.initMessageHeaders,t,s),l.encodeInitMessageHeaders=!0;const u=i.join("");pe(cn,`Creating RPC '${e}' stream ${r}: ${u}`,l);const h=o.createWebChannel(u,l);let f=!1,p=!1;const m=new Y4({Go:v=>{p?pe(cn,`Not sending because RPC '${e}' stream ${r} is closed:`,v):(f||(pe(cn,`Opening RPC '${e}' stream ${r} transport.`),h.open(),f=!0),pe(cn,`RPC '${e}' stream ${r} sending:`,v),h.send(v))},zo:()=>h.close()}),_=(v,I,O)=>{v.listen(I,P=>{try{O(P)}catch(D){setTimeout(()=>{throw D},0)}})};return _(h,jl.EventType.OPEN,()=>{p||(pe(cn,`RPC '${e}' stream ${r} transport opened.`),m.t_())}),_(h,jl.EventType.CLOSE,()=>{p||(p=!0,pe(cn,`RPC '${e}' stream ${r} transport closed`),m.r_())}),_(h,jl.EventType.ERROR,v=>{p||(p=!0,Na(cn,`RPC '${e}' stream ${r} transport errored. Name:`,v.name,"Message:",v.message),m.r_(new me(q.UNAVAILABLE,"The operation could not be completed")))}),_(h,jl.EventType.MESSAGE,v=>{var I;if(!p){const O=v.data[0];st(!!O,16349);const P=O,D=(P==null?void 0:P.error)||((I=P[0])===null||I===void 0?void 0:I.error);if(D){pe(cn,`RPC '${e}' stream ${r} received error:`,D);const B=D.status;let M=function(E){const C=Rt[E];if(C!==void 0)return gA(C)}(B),A=D.message;M===void 0&&(M=q.INTERNAL,A="Unknown error status: "+B+" with message "+D.message),p=!0,m.r_(new me(M,A)),h.close()}else pe(cn,`RPC '${e}' stream ${r} received:`,O),m.i_(O)}}),_(a,O1.STAT_EVENT,v=>{v.stat===_g.PROXY?pe(cn,`RPC '${e}' stream ${r} detected buffering proxy`):v.stat===_g.NOPROXY&&pe(cn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{m.n_()},0),m}}function rm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uf(n){return new n4(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e,t,s=1e3,r=1.5,i=6e4){this.bi=e,this.timerId=t,this.u_=s,this.c_=r,this.l_=i,this.h_=0,this.P_=null,this.T_=Date.now(),this.reset()}reset(){this.h_=0}I_(){this.h_=this.l_}E_(e){this.cancel();const t=Math.floor(this.h_+this.d_()),s=Math.max(0,Date.now()-this.T_),r=Math.max(0,t-s);r>0&&pe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.h_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.P_=this.bi.enqueueAfterDelay(this.timerId,r,()=>(this.T_=Date.now(),e())),this.h_*=this.c_,this.h_<this.u_&&(this.h_=this.u_),this.h_>this.l_&&(this.h_=this.l_)}A_(){this.P_!==null&&(this.P_.skipDelay(),this.P_=null)}cancel(){this.P_!==null&&(this.P_.cancel(),this.P_=null)}d_(){return(Math.random()-.5)*this.h_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0="PersistentStream";class xA{constructor(e,t,s,r,i,o,a,l){this.bi=e,this.R_=s,this.V_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.m_=0,this.f_=null,this.g_=null,this.stream=null,this.p_=0,this.y_=new PA(e,t)}w_(){return this.state===1||this.state===5||this.b_()}b_(){return this.state===2||this.state===3}start(){this.p_=0,this.state!==4?this.auth():this.S_()}async stop(){this.w_()&&await this.close(0)}D_(){this.state=0,this.y_.reset()}v_(){this.b_()&&this.f_===null&&(this.f_=this.bi.enqueueAfterDelay(this.R_,6e4,()=>this.C_()))}F_(e){this.M_(),this.stream.send(e)}async C_(){if(this.b_())return this.close(0)}M_(){this.f_&&(this.f_.cancel(),this.f_=null)}x_(){this.g_&&(this.g_.cancel(),this.g_=null)}async close(e,t){this.M_(),this.x_(),this.y_.cancel(),this.m_++,e!==4?this.y_.reset():t&&t.code===q.RESOURCE_EXHAUSTED?(Ar(t.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.y_.I_()):t&&t.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.O_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zo(t)}O_(){}auth(){this.state=1;const e=this.N_(this.m_),t=this.m_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.m_===t&&this.B_(s,r)},s=>{e(()=>{const r=new me(q.UNKNOWN,"Fetching auth token failed: "+s.message);return this.L_(r)})})}B_(e,t){const s=this.N_(this.m_);this.stream=this.k_(e,t),this.stream.jo(()=>{s(()=>this.listener.jo())}),this.stream.Jo(()=>{s(()=>(this.state=2,this.g_=this.bi.enqueueAfterDelay(this.V_,1e4,()=>(this.b_()&&(this.state=3),Promise.resolve())),this.listener.Jo()))}),this.stream.Zo(r=>{s(()=>this.L_(r))}),this.stream.onMessage(r=>{s(()=>++this.p_==1?this.q_(r):this.onNext(r))})}S_(){this.state=5,this.y_.E_(async()=>{this.state=0,this.start()})}L_(e){return pe(P0,`close with error: ${e}`),this.stream=null,this.close(4,e)}N_(e){return t=>{this.bi.enqueueAndForget(()=>this.m_===e?t():(pe(P0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Z4 extends xA{constructor(e,t,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}k_(e,t){return this.connection.a_("Listen",e,t)}q_(e){return this.onNext(e)}onNext(e){this.y_.reset();const t=i4(this.serializer,e),s=function(i){if(!("targetChange"in i))return xe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?xe.min():o.readTime?qs(o.readTime):xe.min()}(e);return this.listener.Q_(t,s)}U_(e){const t={};t.database=Ag(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=Eg(l)?{documents:l4(i,l)}:{query:c4(i,l).gt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=vA(i,o.resumeToken);const c=Ig(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(xe.min())>0){a.readTime=Sd(i,o.snapshotVersion.toTimestamp());const c=Ig(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const s=h4(this.serializer,e);s&&(t.labels=s),this.F_(t)}K_(e){const t={};t.database=Ag(this.serializer),t.removeTarget=e,this.F_(t)}}class e6 extends xA{constructor(e,t,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}get W_(){return this.p_>0}start(){this.lastStreamToken=void 0,super.start()}O_(){this.W_&&this.G_([])}k_(e,t){return this.connection.a_("Write",e,t)}q_(e){return st(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,st(!e.writeResults||e.writeResults.length===0,55816),this.listener.z_()}onNext(e){st(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.y_.reset();const t=a4(e.writeResults,e.commitTime),s=qs(e.commitTime);return this.listener.j_(s,t)}H_(){const e={};e.database=Ag(this.serializer),this.F_(e)}G_(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>o4(this.serializer,s))};this.F_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{}class n6 extends t6{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.J_=!1}Y_(){if(this.J_)throw new me(q.FAILED_PRECONDITION,"The client has already been terminated.")}Qo(e,t,s,r){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Qo(e,Cg(t,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new me(q.UNKNOWN,i.toString())})}Wo(e,t,s,r,i){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Wo(e,Cg(t,s),r,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new me(q.UNKNOWN,o.toString())})}terminate(){this.J_=!0,this.connection.terminate()}}class s6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Z_=0,this.X_=null,this.ea=!0}ta(){this.Z_===0&&(this.na("Unknown"),this.X_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.X_=null,this.ra("Backend didn't respond within 10 seconds."),this.na("Offline"),Promise.resolve())))}ia(e){this.state==="Online"?this.na("Unknown"):(this.Z_++,this.Z_>=1&&(this.sa(),this.ra(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.na("Offline")))}set(e){this.sa(),this.Z_=0,e==="Online"&&(this.ea=!1),this.na(e)}na(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ea?(Ar(t),this.ea=!1):pe("OnlineStateTracker",t)}sa(){this.X_!==null&&(this.X_.cancel(),this.X_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No="RemoteStore";class r6{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.oa=[],this._a=new Map,this.aa=new Set,this.ua=[],this.ca=i,this.ca.vo(o=>{s.enqueueAndForget(async()=>{Ho(this)&&(pe(No,"Restarting streams for network reachability change."),await async function(l){const c=Oe(l);c.aa.add(4),await wu(c),c.la.set("Unknown"),c.aa.delete(4),await jf(c)}(this))})}),this.la=new s6(s,r)}}async function jf(n){if(Ho(n))for(const e of n.ua)await e(!0)}async function wu(n){for(const e of n.ua)await e(!1)}function NA(n,e){const t=Oe(n);t._a.has(e.targetId)||(t._a.set(e.targetId,e),Hy(t)?zy(t):al(t).b_()&&jy(t,e))}function Uy(n,e){const t=Oe(n),s=al(t);t._a.delete(e),s.b_()&&OA(t,e),t._a.size===0&&(s.b_()?s.v_():Ho(t)&&t.la.set("Unknown"))}function jy(n,e){if(n.ha.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}al(n).U_(e)}function OA(n,e){n.ha.Ke(e),al(n).K_(e)}function zy(n){n.ha=new X3({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n._a.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),al(n).start(),n.la.ta()}function Hy(n){return Ho(n)&&!al(n).w_()&&n._a.size>0}function Ho(n){return Oe(n).aa.size===0}function MA(n){n.ha=void 0}async function i6(n){n.la.set("Online")}async function o6(n){n._a.forEach((e,t)=>{jy(n,e)})}async function a6(n,e){MA(n),Hy(n)?(n.la.ia(e),zy(n)):n.la.set("Unknown")}async function l6(n,e,t){if(n.la.set("Online"),e instanceof yA&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const a of i.targetIds)r._a.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r._a.delete(a),r.ha.removeTarget(a))}(n,e)}catch(s){pe(No,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Cd(n,s)}else if(e instanceof xh?n.ha.Xe(e):e instanceof _A?n.ha.ot(e):n.ha.nt(e),!t.isEqual(xe.min()))try{const s=await RA(n.localStore);t.compareTo(s)>=0&&await function(i,o){const a=i.ha.It(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i._a.get(c);u&&i._a.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i._a.get(l);if(!u)return;i._a.set(l,u.withResumeToken(sn.EMPTY_BYTE_STRING,u.snapshotVersion)),OA(i,l);const h=new ti(u.target,l,c,u.sequenceNumber);jy(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(s){pe(No,"Failed to raise snapshot:",s),await Cd(n,s)}}async function Cd(n,e,t){if(!il(e))throw e;n.aa.add(1),await wu(n),n.la.set("Offline"),t||(t=()=>RA(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{pe(No,"Retrying IndexedDB access"),await t(),n.aa.delete(1),await jf(n)})}function DA(n,e){return e().catch(t=>Cd(n,t,e))}async function zf(n){const e=Oe(n),t=ki(e);let s=e.oa.length>0?e.oa[e.oa.length-1].batchId:Ay;for(;c6(e);)try{const r=await H4(e.localStore,s);if(r===null){e.oa.length===0&&t.v_();break}s=r.batchId,u6(e,r)}catch(r){await Cd(e,r)}LA(e)&&VA(e)}function c6(n){return Ho(n)&&n.oa.length<10}function u6(n,e){n.oa.push(e);const t=ki(n);t.b_()&&t.W_&&t.G_(e.mutations)}function LA(n){return Ho(n)&&!ki(n).w_()&&n.oa.length>0}function VA(n){ki(n).start()}async function h6(n){ki(n).H_()}async function d6(n){const e=ki(n);for(const t of n.oa)e.G_(t.mutations)}async function f6(n,e,t){const s=n.oa.shift(),r=My.from(s,e,t);await DA(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await zf(n)}async function p6(n,e){e&&ki(n).W_&&await async function(s,r){if(function(o){return J3(o)&&o!==q.ABORTED}(r.code)){const i=s.oa.shift();ki(s).D_(),await DA(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await zf(s)}}(n,e),LA(n)&&VA(n)}async function x0(n,e){const t=Oe(n);t.asyncQueue.verifyOperationInProgress(),pe(No,"RemoteStore received new credentials");const s=Ho(t);t.aa.add(3),await wu(t),s&&t.la.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.aa.delete(3),await jf(t)}async function m6(n,e){const t=Oe(n);e?(t.aa.delete(2),await jf(t)):e||(t.aa.add(2),await wu(t),t.la.set("Unknown"))}function al(n){return n.Pa||(n.Pa=function(t,s,r){const i=Oe(t);return i.Y_(),new Z4(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{jo:i6.bind(null,n),Jo:o6.bind(null,n),Zo:a6.bind(null,n),Q_:l6.bind(null,n)}),n.ua.push(async e=>{e?(n.Pa.D_(),Hy(n)?zy(n):n.la.set("Unknown")):(await n.Pa.stop(),MA(n))})),n.Pa}function ki(n){return n.Ta||(n.Ta=function(t,s,r){const i=Oe(t);return i.Y_(),new e6(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{jo:()=>Promise.resolve(),Jo:h6.bind(null,n),Zo:p6.bind(null,n),z_:d6.bind(null,n),j_:f6.bind(null,n)}),n.ua.push(async e=>{e?(n.Ta.D_(),await zf(n)):(await n.Ta.stop(),n.oa.length>0&&(pe(No,`Stopping write stream with ${n.oa.length} pending writes`),n.oa=[]))})),n.Ta}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new wr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const o=Date.now()+s,a=new Wy(e,t,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qy(n,e){if(Ar("AsyncQueue",`${e}: ${n}`),il(n))return new me(q.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{static emptySet(e){return new Ta(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||be.comparator(t.key,s.key):(t,s)=>be.comparator(t.key,s.key),this.keyedMap=zl(),this.sortedSet=new Et(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ta)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Ta;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(){this.Ia=new Et(be.comparator)}track(e){const t=e.doc.key,s=this.Ia.get(t);s?e.type!==0&&s.type===3?this.Ia=this.Ia.insert(t,e):e.type===3&&s.type!==1?this.Ia=this.Ia.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.Ia=this.Ia.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.Ia=this.Ia.remove(t):e.type===1&&s.type===2?this.Ia=this.Ia.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):ke(63341,{Vt:e,Ea:s}):this.Ia=this.Ia.insert(t,e)}da(){const e=[];return this.Ia.inorderTraversal((t,s)=>{e.push(s)}),e}}class Va{constructor(e,t,s,r,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,s,r,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Va(e,t,Ta.emptySet(t),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Lf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(){this.Aa=void 0,this.Ra=[]}Va(){return this.Ra.some(e=>e.ma())}}class _6{constructor(){this.queries=O0(),this.onlineState="Unknown",this.fa=new Set}terminate(){(function(t,s){const r=Oe(t),i=r.queries;r.queries=O0(),i.forEach((o,a)=>{for(const l of a.Ra)l.onError(s)})})(this,new me(q.ABORTED,"Firestore shutting down"))}}function O0(){return new zo(n=>sA(n),Lf)}async function Ky(n,e){const t=Oe(n);let s=3;const r=e.query;let i=t.queries.get(r);i?!i.Va()&&e.ma()&&(s=2):(i=new g6,s=e.ma()?0:1);try{switch(s){case 0:i.Aa=await t.onListen(r,!0);break;case 1:i.Aa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=qy(o,`Initialization of query '${ra(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,i),i.Ra.push(e),e.ga(t.onlineState),i.Aa&&e.pa(i.Aa)&&Qy(t)}async function Gy(n,e){const t=Oe(n),s=e.query;let r=3;const i=t.queries.get(s);if(i){const o=i.Ra.indexOf(e);o>=0&&(i.Ra.splice(o,1),i.Ra.length===0?r=e.ma()?0:1:!i.Va()&&e.ma()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function y6(n,e){const t=Oe(n);let s=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const a of o.Ra)a.pa(r)&&(s=!0);o.Aa=r}}s&&Qy(t)}function v6(n,e,t){const s=Oe(n),r=s.queries.get(e);if(r)for(const i of r.Ra)i.onError(t);s.queries.delete(e)}function Qy(n){n.fa.forEach(e=>{e.next()})}var xg,M0;(M0=xg||(xg={})).ya="default",M0.Cache="cache";class Jy{constructor(e,t,s){this.query=e,this.wa=t,this.ba=!1,this.Sa=null,this.onlineState="Unknown",this.options=s||{}}pa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Va(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ba?this.Da(e)&&(this.wa.next(e),t=!0):this.va(e,this.onlineState)&&(this.Ca(e),t=!0),this.Sa=e,t}onError(e){this.wa.error(e)}ga(e){this.onlineState=e;let t=!1;return this.Sa&&!this.ba&&this.va(this.Sa,e)&&(this.Ca(this.Sa),t=!0),t}va(e,t){if(!e.fromCache||!this.ma())return!0;const s=t!=="Offline";return(!this.options.Fa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Da(e){if(e.docChanges.length>0)return!0;const t=this.Sa&&this.Sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Ca(e){e=Va.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ba=!0,this.wa.next(e)}ma(){return this.options.source!==xg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e){this.key=e}}class BA{constructor(e){this.key=e}}class b6{constructor(e,t){this.query=e,this.qa=t,this.Qa=null,this.hasCachedResults=!1,this.current=!1,this.$a=He(),this.mutatedKeys=He(),this.Ua=rA(e),this.Ka=new Ta(this.Ua)}get Wa(){return this.qa}Ga(e,t){const s=t?t.za:new N0,r=t?t.Ka:this.Ka;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{const f=r.get(u),p=Vf(this.query,h)?h:null,m=!!f&&this.mutatedKeys.has(f.key),_=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let v=!1;f&&p?f.data.isEqual(p.data)?m!==_&&(s.track({type:3,doc:p}),v=!0):this.ja(f,p)||(s.track({type:2,doc:p}),v=!0,(l&&this.Ua(p,l)>0||c&&this.Ua(p,c)<0)&&(a=!0)):!f&&p?(s.track({type:0,doc:p}),v=!0):f&&!p&&(s.track({type:1,doc:f}),v=!0,(l||c)&&(a=!0)),v&&(p?(o=o.add(p),i=_?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),s.track({type:1,doc:u})}return{Ka:o,za:s,ys:a,mutatedKeys:i}}ja(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.Ka;this.Ka=e.Ka,this.mutatedKeys=e.mutatedKeys;const o=e.za.da();o.sort((u,h)=>function(p,m){const _=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ke(20277,{Vt:v})}};return _(p)-_(m)}(u.type,h.type)||this.Ua(u.doc,h.doc)),this.Ha(s),r=r!=null&&r;const a=t&&!r?this.Ja():[],l=this.$a.size===0&&this.current&&!r?1:0,c=l!==this.Qa;return this.Qa=l,o.length!==0||c?{snapshot:new Va(this.query,e.Ka,i,o,e.mutatedKeys,l===0,c,!1,!!s&&s.resumeToken.approximateByteSize()>0),Ya:a}:{Ya:a}}ga(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ka:this.Ka,za:new N0,mutatedKeys:this.mutatedKeys,ys:!1},!1)):{Ya:[]}}Za(e){return!this.qa.has(e)&&!!this.Ka.has(e)&&!this.Ka.get(e).hasLocalMutations}Ha(e){e&&(e.addedDocuments.forEach(t=>this.qa=this.qa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qa=this.qa.delete(t)),this.current=e.current)}Ja(){if(!this.current)return[];const e=this.$a;this.$a=He(),this.Ka.forEach(s=>{this.Za(s.key)&&(this.$a=this.$a.add(s.key))});const t=[];return e.forEach(s=>{this.$a.has(s)||t.push(new BA(s))}),this.$a.forEach(s=>{e.has(s)||t.push(new FA(s))}),t}Xa(e){this.qa=e.Ns,this.$a=He();const t=this.Ga(e.documents);return this.applyChanges(t,!0)}eu(){return Va.fromInitialDocuments(this.query,this.Ka,this.mutatedKeys,this.Qa===0,this.hasCachedResults)}}const Yy="SyncEngine";class w6{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class E6{constructor(e){this.key=e,this.tu=!1}}class T6{constructor(e,t,s,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.nu={},this.ru=new zo(a=>sA(a),Lf),this.iu=new Map,this.su=new Set,this.ou=new Et(be.comparator),this._u=new Map,this.au=new Vy,this.uu={},this.cu=new Map,this.lu=La.ir(),this.onlineState="Unknown",this.hu=void 0}get isPrimaryClient(){return this.hu===!0}}async function S6(n,e,t=!0){const s=WA(n);let r;const i=s.ru.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.eu()):r=await $A(s,e,t,!0),r}async function I6(n,e){const t=WA(n);await $A(t,e,!0,!1)}async function $A(n,e,t,s){const r=await W4(n.localStore,Ws(e)),i=r.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return s&&(a=await C6(n,e,i,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&NA(n.remoteStore,r),a}async function C6(n,e,t,s,r){n.Pu=(h,f,p)=>async function(_,v,I,O){let P=v.view.Ga(I);P.ys&&(P=await C0(_.localStore,v.query,!1).then(({documents:A})=>v.view.Ga(A,P)));const D=O&&O.targetChanges.get(v.targetId),B=O&&O.targetMismatches.get(v.targetId)!=null,M=v.view.applyChanges(P,_.isPrimaryClient,D,B);return L0(_,v.targetId,M.Ya),M.snapshot}(n,h,f,p);const i=await C0(n.localStore,e,!0),o=new b6(e,i.Ns),a=o.Ga(i.documents),l=bu.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),c=o.applyChanges(a,n.isPrimaryClient,l);L0(n,t,c.Ya);const u=new w6(e,t,o);return n.ru.set(e,u),n.iu.has(t)?n.iu.get(t).push(e):n.iu.set(t,[e]),c.snapshot}async function k6(n,e,t){const s=Oe(n),r=s.ru.get(e),i=s.iu.get(r.targetId);if(i.length>1)return s.iu.set(r.targetId,i.filter(o=>!Lf(o,e))),void s.ru.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await Rg(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),t&&Uy(s.remoteStore,r.targetId),Ng(s,r.targetId)}).catch(rl)):(Ng(s,r.targetId),await Rg(s.localStore,r.targetId,!0))}async function A6(n,e){const t=Oe(n),s=t.ru.get(e),r=t.iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Uy(t.remoteStore,s.targetId))}async function R6(n,e,t){const s=L6(n);try{const r=await function(o,a){const l=Oe(o),c=Ot.now(),u=a.reduce((p,m)=>p.add(m.key),He());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let m=Rr(),_=He();return l.Cs.getEntries(p,u).next(v=>{m=v,m.forEach((I,O)=>{O.isValidDocument()||(_=_.add(I))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,m)).next(v=>{h=v;const I=[];for(const O of a){const P=W3(O,h.get(O.key).overlayedDocument);P!=null&&I.push(new Ui(O.key,P,Q1(P.value.mapValue),Ts.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,I,a)}).next(v=>{f=v;const I=v.applyToLocalDocumentSet(h,_);return l.documentOverlayCache.saveOverlays(p,v.batchId,I)})}).then(()=>({batchId:f.batchId,changes:oA(h)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,a,l){let c=o.uu[o.currentUser.toKey()];c||(c=new Et(Be)),c=c.insert(a,l),o.uu[o.currentUser.toKey()]=c}(s,r.batchId,t),await Eu(s,r.changes),await zf(s.remoteStore)}catch(r){const i=qy(r,"Failed to persist write");t.reject(i)}}async function UA(n,e){const t=Oe(n);try{const s=await j4(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t._u.get(i);o&&(st(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.tu=!0:r.modifiedDocuments.size>0?st(o.tu,14607):r.removedDocuments.size>0&&(st(o.tu,42227),o.tu=!1))}),await Eu(t,s,e)}catch(s){await rl(s)}}function D0(n,e,t){const s=Oe(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.ru.forEach((i,o)=>{const a=o.view.ga(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const l=Oe(o);l.onlineState=a;let c=!1;l.queries.forEach((u,h)=>{for(const f of h.Ra)f.ga(a)&&(c=!0)}),c&&Qy(l)}(s.eventManager,e),r.length&&s.nu.Q_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function P6(n,e,t){const s=Oe(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s._u.get(e),i=r&&r.key;if(i){let o=new Et(be.comparator);o=o.insert(i,gn.newNoDocument(i,xe.min()));const a=He().add(i),l=new $f(xe.min(),new Map,new Et(Be),o,a);await UA(s,l),s.ou=s.ou.remove(i),s._u.delete(e),Xy(s)}else await Rg(s.localStore,e,!1).then(()=>Ng(s,e,t)).catch(rl)}async function x6(n,e){const t=Oe(n),s=e.batch.batchId;try{const r=await U4(t.localStore,e);zA(t,s,null),jA(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Eu(t,r)}catch(r){await rl(r)}}async function N6(n,e,t){const s=Oe(n);try{const r=await function(o,a){const l=Oe(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(st(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(s.localStore,e);zA(s,e,t),jA(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Eu(s,r)}catch(r){await rl(r)}}function jA(n,e){(n.cu.get(e)||[]).forEach(t=>{t.resolve()}),n.cu.delete(e)}function zA(n,e,t){const s=Oe(n);let r=s.uu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.uu[s.currentUser.toKey()]=r}}function Ng(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.iu.get(e))n.ru.delete(s),t&&n.nu.Tu(s,t);n.iu.delete(e),n.isPrimaryClient&&n.au.Ur(e).forEach(s=>{n.au.containsKey(s)||HA(n,s)})}function HA(n,e){n.su.delete(e.path.canonicalString());const t=n.ou.get(e);t!==null&&(Uy(n.remoteStore,t),n.ou=n.ou.remove(e),n._u.delete(t),Xy(n))}function L0(n,e,t){for(const s of t)s instanceof FA?(n.au.addReference(s.key,e),O6(n,s)):s instanceof BA?(pe(Yy,"Document no longer in limbo: "+s.key),n.au.removeReference(s.key,e),n.au.containsKey(s.key)||HA(n,s.key)):ke(19791,{Iu:s})}function O6(n,e){const t=e.key,s=t.path.canonicalString();n.ou.get(t)||n.su.has(s)||(pe(Yy,"New document in limbo: "+t),n.su.add(s),Xy(n))}function Xy(n){for(;n.su.size>0&&n.ou.size<n.maxConcurrentLimboResolutions;){const e=n.su.values().next().value;n.su.delete(e);const t=new be(_t.fromString(e)),s=n.lu.next();n._u.set(s,new E6(t)),n.ou=n.ou.insert(t,s),NA(n.remoteStore,new ti(Ws(Df(t.path)),s,"TargetPurposeLimboResolution",Nf.le))}}async function Eu(n,e,t){const s=Oe(n),r=[],i=[],o=[];s.ru.isEmpty()||(s.ru.forEach((a,l)=>{o.push(s.Pu(l,e,t).then(c=>{var u;if((c||t)&&s.isPrimaryClient){const h=c?!c.fromCache:(u=t==null?void 0:t.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;s.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){r.push(c);const h=By.Ps(l.targetId,c);i.push(h)}}))}),await Promise.all(o),s.nu.Q_(r),await async function(l,c){const u=Oe(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Q.forEach(c,f=>Q.forEach(f.ls,p=>u.persistence.referenceDelegate.addReference(h,f.targetId,p)).next(()=>Q.forEach(f.hs,p=>u.persistence.referenceDelegate.removeReference(h,f.targetId,p)))))}catch(h){if(!il(h))throw h;pe($y,"Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const p=u.Ss.get(f),m=p.snapshotVersion,_=p.withLastLimboFreeSnapshotVersion(m);u.Ss=u.Ss.insert(f,_)}}}(s.localStore,i))}async function M6(n,e){const t=Oe(n);if(!t.currentUser.isEqual(e)){pe(Yy,"User change. New user:",e.toKey());const s=await AA(t.localStore,e);t.currentUser=e,function(i,o){i.cu.forEach(a=>{a.forEach(l=>{l.reject(new me(q.CANCELLED,o))})}),i.cu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Eu(t,s.Ms)}}function D6(n,e){const t=Oe(n),s=t._u.get(e);if(s&&s.tu)return He().add(s.key);{let r=He();const i=t.iu.get(e);if(!i)return r;for(const o of i){const a=t.ru.get(o);r=r.unionWith(a.view.Wa)}return r}}function WA(n){const e=Oe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=UA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=D6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=P6.bind(null,e),e.nu.Q_=y6.bind(null,e.eventManager),e.nu.Tu=v6.bind(null,e.eventManager),e}function L6(n){const e=Oe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=x6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=N6.bind(null,e),e}class kd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Uf(e.databaseInfo.databaseId),this.sharedClientState=this.Au(e),this.persistence=this.Ru(e),await this.persistence.start(),this.localStore=this.Vu(e),this.gcScheduler=this.mu(e,this.localStore),this.indexBackfillerScheduler=this.fu(e,this.localStore)}mu(e,t){return null}fu(e,t){return null}Vu(e){return $4(this.persistence,new V4,e.initialUser,this.serializer)}Ru(e){return new kA(Fy.Ei,this.serializer)}Au(e){return new K4}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kd.provider={build:()=>new kd};class V6 extends kd{constructor(e){super(),this.cacheSizeBytes=e}mu(e,t){st(this.persistence.referenceDelegate instanceof Id,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new E4(s,e.asyncQueue,t)}Ru(e){const t=this.cacheSizeBytes!==void 0?Bn.withCacheSize(this.cacheSizeBytes):Bn.DEFAULT;return new kA(s=>Id.Ei(s,t),this.serializer)}}class Og{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>D0(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=M6.bind(null,this.syncEngine),await m6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new _6}()}createDatastore(e){const t=Uf(e.databaseInfo.databaseId),s=function(i){return new X4(i)}(e.databaseInfo);return function(i,o,a,l){return new n6(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,r,i,o,a){return new r6(s,r,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>D0(this.syncEngine,t,0),function(){return R0.C()?new R0:new G4}())}createSyncEngine(e,t){return function(r,i,o,a,l,c,u){const h=new T6(r,i,o,a,l,c);return u&&(h.hu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=Oe(r);pe(No,"RemoteStore shutting down."),i.aa.add(5),await wu(i),i.ca.shutdown(),i.la.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Og.provider={build:()=>new Og};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.pu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.pu(this.observer.error,e):Ar("Uncaught Error in snapshot listener:",e.toString()))}yu(){this.muted=!0}pu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ai="FirestoreClient";class F6{constructor(e,t,s,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=hn.UNAUTHENTICATED,this.clientId=B1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{pe(Ai,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(pe(Ai,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=qy(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function im(n,e){n.asyncQueue.verifyOperationInProgress(),pe(Ai,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async r=>{s.isEqual(r)||(await AA(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function V0(n,e){n.asyncQueue.verifyOperationInProgress();const t=await B6(n);pe(Ai,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(s=>x0(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,r)=>x0(e.remoteStore,r)),n._onlineComponents=e}async function B6(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){pe(Ai,"Using user provided OfflineComponentProvider");try{await im(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===q.FAILED_PRECONDITION||r.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Na("Error using user provided cache. Falling back to memory cache: "+t),await im(n,new kd)}}else pe(Ai,"Using default OfflineComponentProvider"),await im(n,new V6(void 0));return n._offlineComponents}async function qA(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(pe(Ai,"Using user provided OnlineComponentProvider"),await V0(n,n._uninitializedComponentsProvider._online)):(pe(Ai,"Using default OnlineComponentProvider"),await V0(n,new Og))),n._onlineComponents}function $6(n){return qA(n).then(e=>e.syncEngine)}async function Ad(n){const e=await qA(n),t=e.eventManager;return t.onListen=S6.bind(null,e.syncEngine),t.onUnlisten=k6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=I6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=A6.bind(null,e.syncEngine),t}function U6(n,e,t={}){const s=new wr;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new Zy({next:f=>{u.yu(),o.enqueueAndForget(()=>Gy(i,h));const p=f.docs.has(a);!p&&f.fromCache?c.reject(new me(q.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&l&&l.source==="server"?c.reject(new me(q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new Jy(Df(a.path),u,{includeMetadataChanges:!0,Fa:!0});return Ky(i,h)}(await Ad(n),n.asyncQueue,e,t,s)),s.promise}function j6(n,e,t={}){const s=new wr;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new Zy({next:f=>{u.yu(),o.enqueueAndForget(()=>Gy(i,h)),f.fromCache&&l.source==="server"?c.reject(new me(q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new Jy(a,u,{includeMetadataChanges:!0,Fa:!0});return Ky(i,h)}(await Ad(n),n.asyncQueue,e,t,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(n,e,t){if(!t)throw new me(q.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function z6(n,e,t,s){if(e===!0&&s===!0)throw new me(q.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function B0(n){if(!be.isDocumentKey(n))throw new me(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function $0(n){if(be.isDocumentKey(n))throw new me(q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Hf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ke(12329,{type:typeof n})}function Zn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Hf(n);throw new me(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QA="firestore.googleapis.com",U0=!0;class j0{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new me(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=QA,this.ssl=U0}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:U0;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=CA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<b4)throw new me(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}z6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=KA((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new me(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new me(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new me(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Wf{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new j0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new j0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new YU;switch(s.type){case"firstParty":return new t3(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new me(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=F0.get(t);s&&(pe("ComponentProvider","Removing Datastore"),F0.delete(t),s.terminate())}(this),Promise.resolve()}}function H6(n,e,t,s={}){var r;const i=(n=Zn(n,Wf))._getSettings(),o=Object.assign(Object.assign({},i),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;i.host!==QA&&i.host!==a&&Na("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},i),{host:a,ssl:!1,emulatorOptions:s});if(!yi(l,o)&&(n._setSettings(l),s.mockUserToken)){let c,u;if(typeof s.mockUserToken=="string")c=s.mockUserToken,u=hn.MOCK_USER;else{c=P_(s.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const h=s.mockUserToken.sub||s.mockUserToken.user_id;if(!h)throw new me(q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new hn(h)}n._authCredentials=new XU(new V1(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new ji(this.firestore,e,this._query)}}class yn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yn(this.firestore,e,this._key)}}class hi extends ji{constructor(e,t,s){super(e,t,Df(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yn(this.firestore,null,new be(e))}withConverter(e){return new hi(this.firestore,e,this._path)}}function ev(n,e,...t){if(n=Ze(n),GA("collection","path",e),n instanceof Wf){const s=_t.fromString(e,...t);return $0(s),new hi(n,null,s)}{if(!(n instanceof yn||n instanceof hi))throw new me(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(_t.fromString(e,...t));return $0(s),new hi(n.firestore,null,s)}}function Mg(n,e,...t){if(n=Ze(n),arguments.length===1&&(e=B1.newId()),GA("doc","path",e),n instanceof Wf){const s=_t.fromString(e,...t);return B0(s),new yn(n,null,new be(s))}{if(!(n instanceof yn||n instanceof hi))throw new me(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(_t.fromString(e,...t));return B0(s),new yn(n.firestore,n instanceof hi?n.converter:null,new be(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0="AsyncQueue";class H0{constructor(e=Promise.resolve()){this.Qu=[],this.$u=!1,this.Uu=[],this.Ku=null,this.Wu=!1,this.Gu=!1,this.zu=[],this.y_=new PA(this,"async_queue_retry"),this.ju=()=>{const s=rm();s&&pe(z0,"Visibility state changed to "+s.visibilityState),this.y_.A_()},this.Hu=e;const t=rm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.ju)}get isShuttingDown(){return this.$u}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ju(),this.Yu(e)}enterRestrictedMode(e){if(!this.$u){this.$u=!0,this.Gu=e||!1;const t=rm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.ju)}}enqueue(e){if(this.Ju(),this.$u)return new Promise(()=>{});const t=new wr;return this.Yu(()=>this.$u&&this.Gu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qu.push(e),this.Zu()))}async Zu(){if(this.Qu.length!==0){try{await this.Qu[0](),this.Qu.shift(),this.y_.reset()}catch(e){if(!il(e))throw e;pe(z0,"Operation failed with retryable error: "+e)}this.Qu.length>0&&this.y_.E_(()=>this.Zu())}}Yu(e){const t=this.Hu.then(()=>(this.Wu=!0,e().catch(s=>{throw this.Ku=s,this.Wu=!1,Ar("INTERNAL UNHANDLED ERROR: ",W0(s)),s}).then(s=>(this.Wu=!1,s))));return this.Hu=t,t}enqueueAfterDelay(e,t,s){this.Ju(),this.zu.indexOf(e)>-1&&(t=0);const r=Wy.createAndSchedule(this,e,t,s,i=>this.Xu(i));return this.Uu.push(r),r}Ju(){this.Ku&&ke(47125,{ec:W0(this.Ku)})}verifyOperationInProgress(){}async tc(){let e;do e=this.Hu,await e;while(e!==this.Hu)}nc(e){for(const t of this.Uu)if(t.timerId===e)return!0;return!1}rc(e){return this.tc().then(()=>{this.Uu.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.Uu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.tc()})}sc(e){this.zu.push(e)}Xu(e){const t=this.Uu.indexOf(e);this.Uu.splice(t,1)}}function W0(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(n){return function(t,s){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(n,["next","error","complete"])}class Ri extends Wf{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new H0,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new H0(e),this._firestoreClient=void 0,await e}}}function tv(n,e){const t=typeof n=="object"?n:Xa(),s=typeof n=="string"?n:vd,r=Ya(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=gf("firestore");i&&H6(r,...i)}return r}function qf(n){if(n._terminated)throw new me(q.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||W6(n),n._firestoreClient}function W6(n){var e,t,s;const r=n._freezeSettings(),i=function(a,l,c,u){return new g3(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,KA(u.experimentalLongPollingOptions),u.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=r.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new F6(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fa(sn.fromBase64String(e))}catch(t){throw new me(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Fa(sn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Be(this._lat,e._lat)||Be(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q6=/^__.*__$/;class K6{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Ui(e,this.data,this.fieldMask,t,this.fieldTransforms):new vu(e,this.data,t,this.fieldTransforms)}}class JA{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Ui(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function YA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ke(40011,{oc:n})}}class rv{constructor(e,t,s,r,i,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this._c(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get oc(){return this.settings.oc}ac(e){return new rv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}uc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.ac({path:s,cc:!1});return r.lc(e),r}hc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.ac({path:s,cc:!1});return r._c(),r}Pc(e){return this.ac({path:void 0,cc:!0})}Tc(e){return Rd(e,this.settings.methodName,this.settings.Ic||!1,this.path,this.settings.Ec)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}_c(){if(this.path)for(let e=0;e<this.path.length;e++)this.lc(this.path.get(e))}lc(e){if(e.length===0)throw this.Tc("Document fields must not be empty");if(YA(this.oc)&&q6.test(e))throw this.Tc('Document fields cannot begin and end with "__"')}}class G6{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Uf(e)}dc(e,t,s,r=!1){return new rv({oc:e,methodName:t,Ec:s,path:tn.emptyPath(),cc:!1,Ic:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qf(n){const e=n._freezeSettings(),t=Uf(n._databaseId);return new G6(n._databaseId,!!e.ignoreUndefinedProperties,t)}function XA(n,e,t,s,r,i={}){const o=n.dc(i.merge||i.mergeFields?2:0,e,t,r);iv("Data must be an object, but it was:",o,s);const a=ZA(s,o);let l,c;if(i.merge)l=new Yn(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const f=Dg(e,h,t);if(!o.contains(f))throw new me(q.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);tR(u,f)||u.push(f)}l=new Yn(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new K6(new $n(a),l,c)}class Jf extends nv{_toFieldTransform(e){if(e.oc!==2)throw e.oc===1?e.Tc(`${this._methodName}() can only appear at the top level of your update data`):e.Tc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jf}}function Q6(n,e,t,s){const r=n.dc(1,e,t);iv("Data must be an object, but it was:",r,s);const i=[],o=$n.empty();$i(s,(l,c)=>{const u=ov(e,l,t);c=Ze(c);const h=r.hc(u);if(c instanceof Jf)i.push(u);else{const f=Tu(c,h);f!=null&&(i.push(u),o.set(u,f))}});const a=new Yn(i);return new JA(o,a,r.fieldTransforms)}function J6(n,e,t,s,r,i){const o=n.dc(1,e,t),a=[Dg(e,s,t)],l=[r];if(i.length%2!=0)throw new me(q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(Dg(e,i[f])),l.push(i[f+1]);const c=[],u=$n.empty();for(let f=a.length-1;f>=0;--f)if(!tR(c,a[f])){const p=a[f];let m=l[f];m=Ze(m);const _=o.hc(p);if(m instanceof Jf)c.push(p);else{const v=Tu(m,_);v!=null&&(c.push(p),u.set(p,v))}}const h=new Yn(c);return new JA(u,h,o.fieldTransforms)}function Y6(n,e,t,s=!1){return Tu(t,n.dc(s?4:3,e))}function Tu(n,e){if(eR(n=Ze(n)))return iv("Unsupported field value:",e,n),ZA(n,e);if(n instanceof nv)return function(s,r){if(!YA(r.oc))throw r.Tc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Tc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.cc&&e.oc!==4)throw e.Tc("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const a of s){let l=Tu(a,r.Pc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(s,r){if((s=Ze(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return B3(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=Ot.fromDate(s);return{timestampValue:Sd(r.serializer,i)}}if(s instanceof Ot){const i=new Ot(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Sd(r.serializer,i)}}if(s instanceof Gf)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Fa)return{bytesValue:vA(r.serializer,s._byteString)};if(s instanceof yn){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Tc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ly(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof sv)return function(o,a){return{mapValue:{fields:{[K1]:{stringValue:G1},[bd]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Tc("VectorValues must only contain numeric values.");return Oy(a.serializer,c)})}}}}}}(s,r);throw r.Tc(`Unsupported field value: ${Hf(s)}`)}(n,e)}function ZA(n,e){const t={};return U1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$i(n,(s,r)=>{const i=Tu(r,e.uc(s));i!=null&&(t[s]=i)}),{mapValue:{fields:t}}}function eR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ot||n instanceof Gf||n instanceof Fa||n instanceof yn||n instanceof nv||n instanceof sv)}function iv(n,e,t){if(!eR(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){const s=Hf(t);throw s==="an object"?e.Tc(n+" a custom object"):e.Tc(n+" "+s)}}function Dg(n,e,t){if((e=Ze(e))instanceof Kf)return e._internalPath;if(typeof e=="string")return ov(n,e);throw Rd("Field path arguments must be of type string or ",n,!1,void 0,t)}const X6=new RegExp("[~\\*/\\[\\]]");function ov(n,e,t){if(e.search(X6)>=0)throw Rd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Kf(...e.split("."))._internalPath}catch{throw Rd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Rd(n,e,t,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${s}`),o&&(l+=` in document ${r}`),l+=")"),new me(q.INVALID_ARGUMENT,a+n+l)}function tR(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new yn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Z6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(av("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Z6 extends nR{data(){return super.data()}}function av(n,e){return typeof e=="string"?ov(n,e):e instanceof Kf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lv{}class rR extends lv{}function ej(n,e,...t){let s=[];e instanceof lv&&s.push(e),s=s.concat(t),function(i){const o=i.filter(l=>l instanceof uv).length,a=i.filter(l=>l instanceof cv).length;if(o>1||o>0&&a>0)throw new me(q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)n=r._apply(n);return n}class cv extends rR{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new cv(e,t,s)}_apply(e){const t=this._parse(e);return iR(e._query,t),new ji(e.firestore,e.converter,Tg(e._query,t))}_parse(e){const t=Qf(e.firestore);return function(i,o,a,l,c,u,h){let f;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new me(q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){G0(h,u);const m=[];for(const _ of h)m.push(K0(l,i,_));f={arrayValue:{values:m}}}else f=K0(l,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||G0(h,u),f=Y6(a,o,h,u==="in"||u==="not-in");return xt.create(c,u,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class uv extends lv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new uv(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return t.length===1?t[0]:Rs.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let o=r;const a=i.getFlattenedFilters();for(const l of a)iR(o,l),o=Tg(o,l)}(e._query,t),new ji(e.firestore,e.converter,Tg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class hv extends rR{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new hv(e,t)}_apply(e){const t=function(r,i,o){if(r.startAt!==null)throw new me(q.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new me(q.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Uc(i,o)}(e._query,this._field,this._direction);return new ji(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new ol(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function tj(n,e="asc"){const t=e,s=av("orderBy",n);return hv._create(s,t)}function K0(n,e,t){if(typeof(t=Ze(t))=="string"){if(t==="")throw new me(q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nA(e)&&t.indexOf("/")!==-1)throw new me(q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(_t.fromString(t));if(!be.isDocumentKey(s))throw new me(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return a0(n,new be(s))}if(t instanceof yn)return a0(n,t._key);throw new me(q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hf(t)}.`)}function G0(n,e){if(!Array.isArray(n)||n.length===0)throw new me(q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function iR(n,e){const t=function(r,i){for(const o of r)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new me(q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class nj{convertValue(e,t="none"){switch(Ci(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ii(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ke(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return $i(e,(r,i)=>{s[r]=this.convertValue(i,t)}),s}convertVectorValue(e){var t,s,r;const i=(r=(s=(t=e.fields)===null||t===void 0?void 0:t[bd].arrayValue)===null||s===void 0?void 0:s.values)===null||r===void 0?void 0:r.map(o=>kt(o.doubleValue));return new sv(i)}convertGeoPoint(e){return new Gf(kt(e.latitude),kt(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Mf(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Fc(e));default:return null}}convertTimestamp(e){const t=Si(e);return new Ot(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=_t.fromString(e);st(IA(s),9688,{name:e});const r=new Bc(s.get(1),s.get(3)),i=new be(s.popFirst(5));return r.isEqual(t)||Ar(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oR(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class aR extends nR{constructor(e,t,s,r,i,o){super(e,t,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Nh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(av("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}}class Nh extends aR{data(e={}){return super.data(e)}}class lR{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Wl(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new Nh(this._firestore,this._userDataWriter,s.key,s,new Wl(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const l=new Nh(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Wl(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Nh(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Wl(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:sj(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function sj(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ke(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(n){n=Zn(n,yn);const e=Zn(n.firestore,Ri);return U6(qf(e),n._key).then(t=>cR(e,n,t))}class fv extends nj{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,t)}}function rj(n){n=Zn(n,ji);const e=Zn(n.firestore,Ri),t=qf(e),s=new fv(e);return sR(n._query),j6(t,n._query).then(r=>new lR(e,s,n,r))}function ih(n,e,t){n=Zn(n,yn);const s=Zn(n.firestore,Ri),r=oR(n.converter,e,t);return mv(s,[XA(Qf(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Ts.none())])}function Q0(n,e,t,...s){n=Zn(n,yn);const r=Zn(n.firestore,Ri),i=Qf(r);let o;return o=typeof(e=Ze(e))=="string"||e instanceof Kf?J6(i,"updateDoc",n._key,e,t,s):Q6(i,"updateDoc",n._key,e),mv(r,[o.toMutation(n._key,Ts.exists(!0))])}function ij(n,e){const t=Zn(n.firestore,Ri),s=Mg(n),r=oR(n.converter,e);return mv(t,[XA(Qf(n.firestore),"addDoc",s._key,r,n.converter!==null,{}).toMutation(s._key,Ts.exists(!1))]).then(()=>s)}function pv(n,...e){var t,s,r;n=Ze(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||q0(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(q0(e[o])){const h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(s=h.error)===null||s===void 0?void 0:s.bind(h),e[o+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let l,c,u;if(n instanceof yn)c=Zn(n.firestore,Ri),u=Df(n._key.path),l={next:h=>{e[o]&&e[o](cR(c,n,h))},error:e[o+1],complete:e[o+2]};else{const h=Zn(n,ji);c=Zn(h.firestore,Ri),u=h._query;const f=new fv(c);l={next:p=>{e[o]&&e[o](new lR(c,f,h,p))},error:e[o+1],complete:e[o+2]},sR(n._query)}return function(f,p,m,_){const v=new Zy(_),I=new Jy(p,v,m);return f.asyncQueue.enqueueAndForget(async()=>Ky(await Ad(f),I)),()=>{v.yu(),f.asyncQueue.enqueueAndForget(async()=>Gy(await Ad(f),I))}}(qf(c),u,a,l)}function mv(n,e){return function(s,r){const i=new wr;return s.asyncQueue.enqueueAndForget(async()=>R6(await $6(s),r,i)),i.promise}(qf(n),e)}function cR(n,e,t){const s=t.docs.get(e._key),r=new fv(n);return new aR(n,r,e._key,s,new Wl(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){sl=r})(Di),Cs(new ds("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),a=new Ri(new ZU(s.getProvider("auth-internal")),new n3(o,s.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new me(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bc(c.options.projectId,u)}(o,r),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Nn(QE,JE,e),Nn(QE,JE,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR="firebasestorage.googleapis.com",hR="storageBucket",oj=2*60*1e3,aj=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct extends Zs{constructor(e,t,s=0){super(om(e),`Firebase Storage: ${t} (${om(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ct.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return om(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var It;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(It||(It={}));function om(n){return"storage/"+n}function gv(){const n="An unknown error occurred, please check the error payload for server response.";return new Ct(It.UNKNOWN,n)}function lj(n){return new Ct(It.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function cj(n){return new Ct(It.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function uj(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ct(It.UNAUTHENTICATED,n)}function hj(){return new Ct(It.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function dj(n){return new Ct(It.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function fj(){return new Ct(It.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function pj(){return new Ct(It.CANCELED,"User canceled the upload/download.")}function mj(n){return new Ct(It.INVALID_URL,"Invalid URL '"+n+"'.")}function gj(n){return new Ct(It.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function _j(){return new Ct(It.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+hR+"' property when initializing the app?")}function yj(){return new Ct(It.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function vj(){return new Ct(It.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function bj(n){return new Ct(It.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Lg(n){return new Ct(It.INVALID_ARGUMENT,n)}function dR(){return new Ct(It.APP_DELETED,"The Firebase app was deleted.")}function wj(n){return new Ct(It.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function dc(n,e){return new Ct(It.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Pl(n){throw new Ct(It.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Xn.makeFromUrl(e,t)}catch{return new Xn(e,"")}if(s.path==="")return s;throw gj(e)}static makeFromUrl(e,t){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function c(D){D.path_=decodeURIComponent(D.path)}const u="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${r}/o${f}`,"i"),m={bucket:1,path:3},_=t===uR?"(?:storage.googleapis.com|storage.cloud.google.com)":t,v="([^?#]*)",I=new RegExp(`^https?://${_}/${r}/${v}`,"i"),P=[{regex:a,indices:l,postModify:i},{regex:p,indices:m,postModify:c},{regex:I,indices:{bucket:1,path:2},postModify:c}];for(let D=0;D<P.length;D++){const B=P[D],M=B.regex.exec(e);if(M){const A=M[B.indices.bucket];let T=M[B.indices.path];T||(T=""),s=new Xn(A,T),B.postModify(s);break}}if(s==null)throw mj(e);return s}}class Ej{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tj(n,e,t){let s=1,r=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...v){c||(c=!0,e.apply(null,v))}function h(v){r=setTimeout(()=>{r=null,n(p,l())},v)}function f(){i&&clearTimeout(i)}function p(v,...I){if(c){f();return}if(v){f(),u.call(null,v,...I);return}if(l()||o){f(),u.call(null,v,...I);return}s<64&&(s*=2);let P;a===1?(a=2,P=0):P=(s+Math.random())*1e3,h(P)}let m=!1;function _(v){m||(m=!0,f(),!c&&(r!==null?(v||(a=2),clearTimeout(r),h(0)):v||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,_(!0)},t),_}function Sj(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ij(n){return n!==void 0}function Cj(n){return typeof n=="object"&&!Array.isArray(n)}function _v(n){return typeof n=="string"||n instanceof String}function J0(n){return yv()&&n instanceof Blob}function yv(){return typeof Blob<"u"}function Y0(n,e,t,s){if(s<e)throw Lg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw Lg(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vv(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function fR(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const r=e(s)+"="+e(n[s]);t=t+r+"&"}return t=t.slice(0,-1),t}var yo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(yo||(yo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kj(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e,t,s,r,i,o,a,l,c,u,h,f=!0){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,m)=>{this.resolve_=p,this.reject_=m,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new oh(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===yo.NO_ERROR,l=i.getStatus();if(!a||kj(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===yo.ABORT;s(!1,new oh(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;s(!0,new oh(c,i))})},t=(s,r)=>{const i=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());Ij(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=gv();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){const l=this.appDelete_?dR():pj();o(l)}else{const l=fj();o(l)}};this.canceled_?t(!1,new oh(!1,null,!0)):this.backoffId_=Tj(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Sj(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class oh{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function Rj(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Pj(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function xj(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Nj(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Oj(n,e,t,s,r,i,o=!0){const a=fR(n.urlParams),l=n.url+a,c=Object.assign({},n.headers);return xj(c,e),Rj(c,t),Pj(c,i),Nj(c,s),new Aj(l,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Dj(...n){const e=Mj();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(yv())return new Blob(n);throw new Ct(It.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Lj(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vj(n){if(typeof atob>"u")throw bj("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class am{constructor(e,t){this.data=e,this.contentType=t||null}}function Fj(n,e){switch(n){case Bs.RAW:return new am(pR(e));case Bs.BASE64:case Bs.BASE64URL:return new am(mR(n,e));case Bs.DATA_URL:return new am($j(e),Uj(e))}throw gv()}function pR(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=n.charCodeAt(++t);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function Bj(n){let e;try{e=decodeURIComponent(n)}catch{throw dc(Bs.DATA_URL,"Malformed data URL.")}return pR(e)}function mR(n,e){switch(n){case Bs.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw dc(n,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Bs.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw dc(n,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=Vj(e)}catch(r){throw r.message.includes("polyfill")?r:dc(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}class gR{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw dc(Bs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=jj(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function $j(n){const e=new gR(n);return e.base64?mR(Bs.BASE64,e.rest):Bj(e.rest)}function Uj(n){return new gR(n).contentType}function jj(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,t){let s=0,r="";J0(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(J0(this.data_)){const s=this.data_,r=Lj(s,e,t);return r===null?null:new Zr(r)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new Zr(s,!0)}}static getBlob(...e){if(yv()){const t=e.map(s=>s instanceof Zr?s.data_:s);return new Zr(Dj.apply(null,t))}else{const t=e.map(o=>_v(o)?Fj(Bs.RAW,o).data:o.data_);let s=0;t.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)r[i++]=o[a]}),new Zr(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _R(n){let e;try{e=JSON.parse(n)}catch{return null}return Cj(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Hj(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function yR(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wj(n,e){return e}let Tn=class{constructor(e,t,s,r){this.server=e,this.local=t||e,this.writable=!!s,this.xform=r||Wj}},ah=null;function qj(n){return!_v(n)||n.length<2?n:yR(n)}function vR(){if(ah)return ah;const n=[];n.push(new Tn("bucket")),n.push(new Tn("generation")),n.push(new Tn("metageneration")),n.push(new Tn("name","fullPath",!0));function e(i,o){return qj(o)}const t=new Tn("name");t.xform=e,n.push(t);function s(i,o){return o!==void 0?Number(o):o}const r=new Tn("size");return r.xform=s,n.push(r),n.push(new Tn("timeCreated")),n.push(new Tn("updated")),n.push(new Tn("md5Hash",null,!0)),n.push(new Tn("cacheControl",null,!0)),n.push(new Tn("contentDisposition",null,!0)),n.push(new Tn("contentEncoding",null,!0)),n.push(new Tn("contentLanguage",null,!0)),n.push(new Tn("contentType",null,!0)),n.push(new Tn("metadata","customMetadata",!0)),ah=n,ah}function Kj(n,e){function t(){const s=n.bucket,r=n.fullPath,i=new Xn(s,r);return e._makeStorageReference(i)}Object.defineProperty(n,"ref",{get:t})}function Gj(n,e,t){const s={};s.type="file";const r=t.length;for(let i=0;i<r;i++){const o=t[i];s[o.local]=o.xform(s,e[o.server])}return Kj(s,n),s}function bR(n,e,t){const s=_R(e);return s===null?null:Gj(n,s,t)}function Qj(n,e,t,s){const r=_R(e);if(r===null||!_v(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(c=>{const u=n.bucket,h=n.fullPath,f="/b/"+o(u)+"/o/"+o(h),p=vv(f,t,s),m=fR({alt:"media",token:c});return p+m})[0]}function Jj(n,e){const t={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(t[i.server]=n[i.local])}return JSON.stringify(t)}class wR{constructor(e,t,s,r){this.url=e,this.method=t,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(n){if(!n)throw gv()}function Yj(n,e){function t(s,r){const i=bR(n,r,e);return ER(i!==null),i}return t}function Xj(n,e){function t(s,r){const i=bR(n,r,e);return ER(i!==null),Qj(i,r,n.host,n._protocol)}return t}function TR(n){function e(t,s){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=hj():r=uj():t.getStatus()===402?r=cj(n.bucket):t.getStatus()===403?r=dj(n.path):r=s,r.status=t.getStatus(),r.serverResponse=s.serverResponse,r}return e}function Zj(n){const e=TR(n);function t(s,r){let i=e(s,r);return s.getStatus()===404&&(i=lj(n.path)),i.serverResponse=r.serverResponse,i}return t}function e9(n,e,t){const s=e.fullServerUrl(),r=vv(s,n.host,n._protocol),i="GET",o=n.maxOperationRetryTime,a=new wR(r,i,Xj(n,t),o);return a.errorHandler=Zj(e),a}function t9(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function n9(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=t9(null,e)),s}function s9(n,e,t,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let P="";for(let D=0;D<2;D++)P=P+Math.random().toString().slice(2);return P}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=n9(e,s,r),u=Jj(c,t),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",p=Zr.getBlob(h,s,f);if(p===null)throw yj();const m={name:c.fullPath},_=vv(i,n.host,n._protocol),v="POST",I=n.maxUploadRetryTime,O=new wR(_,v,Yj(n,t),I);return O.urlParams=m,O.headers=o,O.body=p.uploadData(),O.errorHandler=TR(e),O}class r9{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=yo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=yo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=yo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,r){if(this.sent_)throw Pl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),r!==void 0)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Pl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Pl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Pl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Pl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class i9 extends r9{initXhr(){this.xhr_.responseType="text"}}function SR(){return new i9}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,t){this._service=e,t instanceof Xn?this._location=t:this._location=Xn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Oo(e,t)}get root(){const e=new Xn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return yR(this._location.path)}get storage(){return this._service}get parent(){const e=zj(this._location.path);if(e===null)return null;const t=new Xn(this._location.bucket,e);return new Oo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw wj(e)}}function o9(n,e,t){n._throwIfRoot("uploadBytes");const s=s9(n.storage,n._location,vR(),new Zr(e,!0),t);return n.storage.makeRequestWithTokens(s,SR).then(r=>({metadata:r,ref:n}))}function a9(n){n._throwIfRoot("getDownloadURL");const e=e9(n.storage,n._location,vR());return n.storage.makeRequestWithTokens(e,SR).then(t=>{if(t===null)throw vj();return t})}function l9(n,e){const t=Hj(n._location.path,e),s=new Xn(n._location.bucket,t);return new Oo(n.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c9(n){return/^[A-Za-z]+:\/\//.test(n)}function u9(n,e){return new Oo(n,e)}function IR(n,e){if(n instanceof bv){const t=n;if(t._bucket==null)throw _j();const s=new Oo(t,t._bucket);return e!=null?IR(s,e):s}else return e!==void 0?l9(n,e):n}function h9(n,e){if(e&&c9(e)){if(n instanceof bv)return u9(n,e);throw Lg("To use ref(service, url), the first argument must be a Storage instance.")}else return IR(n,e)}function X0(n,e){const t=e==null?void 0:e[hR];return t==null?null:Xn.makeFromBucketSpec(t,n)}function d9(n,e,t,s={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:r}=s;r&&(n._overrideAuthToken=typeof r=="string"?r:P_(r,n.app.options.projectId))}class bv{constructor(e,t,s,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=uR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=oj,this._maxUploadRetryTime=aj,this._requests=new Set,r!=null?this._bucket=Xn.makeFromBucketSpec(r,this._host):this._bucket=X0(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xn.makeFromBucketSpec(this._url,e):this._bucket=X0(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Y0("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Y0("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Oo(this,e)}_makeRequest(e,t,s,r,i=!0){if(this._deleted)return new Ej(dR());{const o=Oj(e,this._appId,s,r,t,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()}}const Z0="@firebase/storage",eT="0.13.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR="storage";function f9(n,e,t){return n=Ze(n),o9(n,e,t)}function p9(n){return n=Ze(n),a9(n)}function m9(n,e){return n=Ze(n),h9(n,e)}function kR(n=Xa(),e){n=Ze(n);const s=Ya(n,CR).getImmediate({identifier:e}),r=gf("storage");return r&&g9(s,...r),s}function g9(n,e,t,s={}){d9(n,e,t,s)}function _9(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new bv(t,s,r,e,Di)}function y9(){Cs(new ds(CR,_9,"PUBLIC").setMultipleInstances(!0)),Nn(Z0,eT,""),Nn(Z0,eT,"esm2017")}y9();const lm=new WeakMap;function AR(n,e){return lm.has(e)||lm.set(e,{f:{},r:{},s:{},u:{}}),lm.get(e)}function RR(n,e,t,s){if(!n)return t;const[r,i]=PR(n);if(!r)return t;const o=AR(void 0,s)[r]||{},a=e||i;return a&&a in o?o[a]:t}function v9(n,e,t,s){if(!n)return;const[r,i]=PR(n);if(!r)return;const o=AR(void 0,s)[r],a=e||i;if(a)return t.then(l=>{o[a]=l}).catch(Pt),a}function PR(n){return CF(n)||kF(n)?["f",n.path]:AF(n)?["r",n.toString()]:RF(n)?["s",n.toString()]:[]}const cm=new WeakMap;function xR(n,e,t){const s=Fi();cm.has(s)||cm.set(s,new Map);const r=cm.get(s),i=v9(e,t,n,s);return i&&r.set(i,n),i?()=>r.delete(i):Pt}function b9(n){if(!n.exists())return null;const e=n.val();return Bi(e)?Object.defineProperty(e,"id",{value:n.key}):{$value:e,id:n.key}}function xl(n,e){for(let t=0;t<n.length;t++)if(n[t].id===e)return t;return-1}const wv={reset:!1,serialize:b9,wait:!0};function w9(n,e,t,s,r){const i=Object.assign({},wv,r);let o=Pt;function a(l){const c=i.serialize(l);n.value=c,t(c)}return i.once?A1(e).then(a).catch(s):o=R1(e,a,s),l=>{if(o(),l){const c=typeof l=="function"?l():null;n.value=c}}}function E9(n,e,t,s,r){const i=Object.assign({},wv,r);let o=i.wait?[]:n;i.wait||(n.value=[]);let a=Pt,l=Pt,c=Pt,u=Pt,h=Pt;return i.once?A1(e).then(f=>{const p=[];f.forEach(m=>{p.push(i.serialize(m))}),t(n.value=p)}).catch(s):(a=NU(e,(f,p)=>{const m=dn(o),_=p?xl(m,p)+1:0;m.splice(_,0,i.serialize(f))},s),c=DU(e,f=>{const p=dn(o);p.splice(xl(p,f.key),1)},s),l=OU(e,f=>{const p=dn(o);p.splice(xl(p,f.key),1,i.serialize(f))},s),u=MU(e,(f,p)=>{const m=dn(o),_=xl(m,f.key),v=m.splice(_,1)[0],I=p?xl(m,p)+1:0;m.splice(I,0,v)},s),h=R1(e,()=>{const f=dn(o);i.wait&&(n.value=f,o=n),t(f),h()},s)),f=>{if(h(),a(),c(),l(),u(),f){const p=typeof f=="function"?f():[];n.value=p}}}function T9(n,e={},t=!1){let s=Pt;const r=Object.assign({},wv,e),i=dn(n),o=r.target||G();ik()&&(r.once=!0);const l=RR(i,r.ssrKey,o.value,Fi());o.value=l;let u=!(t?(l||[]).length>0:l!==void 0);const h=G(),f=G(!1),p=nf(),m=Xd();let _=Pt;function v(){const P=dn(n),D=new Promise((B,M)=>{if(s(r.reset),!P)return s=Pt,B(null);f.value=u,u=!0,Array.isArray(o.value)?s=E9(o,P,B,M,r):s=w9(o,P,B,M,r)}).catch(B=>{throw p.value===D&&(h.value=B),B}).finally(()=>{p.value===D&&(f.value=!1)});p.value=D}let I=Pt;(ut(n)||typeof n=="function")&&(I=js(n,v)),v(),i&&(_=xR(p.value,i,r.ssrKey)),m&&(m_(O),su()&&I_(()=>p.value));function O(P=r.reset){I(),_(),s(P)}return Object.defineProperties(o,{data:{get:()=>o},error:{get:()=>h},pending:{get:()=>f},promise:{get:()=>p},stop:{get:()=>O}})}function S9(n,e){const t=G([]);return T9(n,{target:t,...e},!0)}function I9(n){return Cy(Fi(n))}const C9={toFirestore(n){return n},fromFirestore(n,e){return n.exists()?Object.defineProperties(n.data(e),{id:{value:n.id}}):null}};function Vg(n,e,t,s){if(!SF(n))return[n,{}];const r=[{},{}],i=Object.keys(t).reduce((a,l)=>{const c=t[l];return a[c.path]=c.data(),a},{});function o(a,l,c,u){l=l||{};const[h,f]=u;Object.getOwnPropertyNames(a).forEach(p=>{const m=Object.getOwnPropertyDescriptor(a,p);m&&!m.enumerable&&Object.defineProperty(h,p,m)});for(const p in a){const m=a[p];if(m==null||m instanceof Date||m instanceof Ot||m instanceof Gf)h[p]=m;else if(W_(m)){const _=c+p;h[p]=_ in t?l[p]:m.path,f[_]=m.converter?m:m.withConverter(s.converter)}else if(Array.isArray(m)){h[p]=Array(m.length);for(let _=0;_<m.length;_++){const v=m[_];v&&v.path in i&&(h[p][_]=i[v.path])}o(m,l[p]||h[p],c+p+".",[h[p],f])}else Bi(m)?(h[p]={},o(m,l[p],c+p+".",[h[p],f])):h[p]=m}}return o(n,e,"",r),r}const Ev={reset:!1,wait:!0,maxRefDepth:2,converter:C9,snapshotOptions:{serverTimestamps:"estimate"}};function Pd(n){for(const e in n)n[e].unsub()}function Fg(n,e,t,s,r,i,o,a,l){const[c,u]=Vg(s.data(n.snapshotOptions),H_(e,t),r,n);i.set(e,t,c),Bg(n,e,t,r,u,i,o,a,l)}function k9({ref:n,target:e,path:t,depth:s,resolve:r,reject:i,ops:o},a){const l=Object.create(null);let c=Pt;return a.once?dv(n).then(u=>{u.exists()?Fg(a,e,t,u,l,o,s,r,i):(o.set(e,t,null),r())}).catch(i):c=pv(n,u=>{u.exists()?Fg(a,e,t,u,l,o,s,r,i):(o.set(e,t,null),r())},i),()=>{c(),Pd(l)}}function Bg(n,e,t,s,r,i,o,a,l){const c=Object.keys(r);if(Object.keys(s).filter(_=>c.indexOf(_)<0).forEach(_=>{s[_].unsub(),delete s[_]}),!c.length||++o>n.maxRefDepth)return a(t);let h=0;const f=c.length,p=Object.create(null);function m(_){_ in p&&++h>=f&&a(t)}c.forEach(_=>{const v=s[_],I=r[_],O=`${t}.${_}`;if(p[O]=!0,v)if(v.path!==I.path)v.unsub();else return;s[_]={data:()=>H_(e,O),unsub:k9({ref:I,target:e,path:O,depth:o,ops:i,resolve:m.bind(null,O),reject:l},n),path:I.path}})}function A9(n,e,t,s,r,i){const o=Object.assign({},Ev,i),{snapshotListenOptions:a,snapshotOptions:l,wait:c,once:u}=o,h="value";let f=G(c?[]:n.value);c||t.set(n,h,[]);const p=s;let m,_=Pt;const v=[],I={added:({newIndex:P,doc:D})=>{v.splice(P,0,Object.create(null));const B=v[P],[M,A]=Vg(D.data(l),void 0,B,o);t.add(dn(f),P,M),Bg(o,f,`${h}.${P}`,B,A,t,0,s.bind(null,D),r)},modified:({oldIndex:P,newIndex:D,doc:B})=>{const M=dn(f),A=v[P],T=M[P],[E,C]=Vg(B.data(l),T,A,o);v.splice(D,0,A),t.remove(M,P),t.add(M,D,E),Bg(o,f,`${h}.${D}`,A,C,t,0,s,r)},removed:({oldIndex:P})=>{const D=dn(f);t.remove(D,P),Pd(v.splice(P,1)[0])}};function O(P){const D=P.docChanges(a);if(!m&&D.length){m=!0;let B=0;const M=D.length,A=Object.create(null);for(let T=0;T<M;T++)A[D[T].doc.id]=!0;s=T=>{T&&T.id in A&&++B>=M&&(c&&(t.set(n,h,dn(f)),f=n),p(dn(f)),s=Pt)}}D.forEach(B=>{I[B.type](B)}),D.length||(c&&(t.set(n,h,dn(f)),f=n),s(dn(f)))}return u?rj(e).then(O).catch(r):_=pv(e,O,r),P=>{if(_(),P){const D=typeof P=="function"?P():[];t.set(n,h,D)}v.forEach(Pd)}}function R9(n,e,t,s,r,i){const o=Object.assign({},Ev,i),a="value",l=Object.create(null);s=PF(s,()=>H_(n,a));let c=Pt;function u(h){h.exists()?Fg(o,n,a,h,l,t,0,s,r):(t.set(n,a,null),s(null))}return o.once?dv(e).then(u).catch(r):c=pv(e,u,r),h=>{if(c(),h){const f=typeof h=="function"?h():null;t.set(n,a,f)}Pd(l)}}const tT=Symbol();function NR(n,e){let t=Pt;const s=Object.assign({},Ev,e),r=dn(n),i=s.target||G();ik()&&(s.once=!0);const o=RR(r,s.ssrKey,tT,Fi()),a=o!==tT;a&&(i.value=o);let l=!a;const c=G(!1),u=G(),h=nf(),f=Xd();let p=Pt;function m(){let I=dn(n);const O=new Promise((P,D)=>{if(t(s.reset),!I)return t=Pt,P(null);c.value=l,l=!0,I.converter||(I=I.withConverter(s.converter)),t=(W_(I)?R9:A9)(i,I,P9,P,D,s)}).catch(P=>(h.value===O&&(u.value=P),Promise.reject(P))).finally(()=>{h.value===O&&(c.value=!1)});h.value=O}let _=Pt;(ut(n)||typeof n=="function")&&(_=js(n,m)),m(),r&&(p=xR(h.value,r,s.ssrKey)),su()&&I_(()=>h.value),f&&m_(v);function v(I=s.reset){_(),p(),t(I)}return Object.defineProperties(i,{error:{get:()=>u},data:{get:()=>i},pending:{get:()=>c},promise:{get:()=>h},stop:{get:()=>v}})}const P9={set:(n,e,t)=>EF(n,e,t),add:(n,e,t)=>n.splice(e,0,t),remove:(n,e)=>n.splice(e,1)};function x9(n,e){return NR(n,{target:G([]),...e})}function N9(n,e){return NR(n,e)}function OR(n){return tv(Fi(n))}function O9(n){return M9({initialUser:n,dependencies:{popupRedirectResolver:ek,persistence:[YC,WC,U_]}})}const MR=Symbol("VueFireAuth");function M9({dependencies:n,initialUser:e}){return(t,s)=>{const[r,i]=D9(t,s,e,n);DF(r,i)}}function D9(n,e,t,s,r=VC(n,s)){const i=NF(n,e).run(()=>G(t));return ok.set(n,i),e.provide(MR,r),[i,r]}function L9(n){return wF?xn(MR):null}function DR(n){return kR(Fi(n))}const V9=DR;function F9(n,{firebaseApp:e,modules:t=[]}){n.provide(rk,e);for(const s of t)s(e,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B9{constructor(e,t,s,r){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Rn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=s.getImmediate({optional:!0}),this.auth||t.get().then(i=>this.auth=i,()=>{}),this.messaging||s.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r==null||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),s=await this.getMessagingToken(),r=await this.getAppCheckToken(e);return{authToken:t,messagingToken:s,appCheckToken:r}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $g="us-central1";class $9{constructor(e,t,s,r,i=$g,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new B9(e,t,s,r),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=$g}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function U9(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}const nT="@firebase/functions",sT="0.12.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j9="auth-internal",z9="app-check-internal",H9="messaging-internal";function W9(n){const e=(t,{instanceIdentifier:s})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider(j9),o=t.getProvider(H9),a=t.getProvider(z9);return new $9(r,i,o,a,s)};Cs(new ds(LR,e,"PUBLIC").setMultipleInstances(!0)),Nn(nT,sT,n),Nn(nT,sT,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q9(n=Xa(),e=$g){const s=Ya(Ze(n),LR).getImmediate({identifier:e}),r=gf("functions");return r&&K9(s,...r),s}function K9(n,e,t){U9(Ze(n),e,t)}W9();const G9={apiKey:"AIzaSyDVcuVYreFbL1_I5fOu--Vpu4uJ65CrCyY",authDomain:"shadowbanshee-79c70.firebaseapp.com",projectId:"shadowbanshee-79c70",storageBucket:"gs://shadowbanshee-79c70.firebasestorage.app",messagingSenderId:"791402631168",appId:"1:791402631168:web:c4295ea2da19d8e9b048e5",databaseURL:"https://shadowbanshee-79c70-default-rtdb.firebaseio.com"},ll=mC(G9),Q9=Cy(ll),J9=tv(ll);tk(ll);q9(ll);kR(ll);Sy(Q9,"todos");ev(J9,"todos");/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const aa=typeof document<"u";function VR(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function Y9(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&VR(n.default)}const tt=Object.assign;function um(n,e){const t={};for(const s in e){const r=e[s];t[s]=Ps(r)?r.map(n):n(r)}return t}const fc=()=>{},Ps=Array.isArray,FR=/#/g,X9=/&/g,Z9=/\//g,ez=/=/g,tz=/\?/g,BR=/\+/g,nz=/%5B/g,sz=/%5D/g,$R=/%5E/g,rz=/%60/g,UR=/%7B/g,iz=/%7C/g,jR=/%7D/g,oz=/%20/g;function Tv(n){return encodeURI(""+n).replace(iz,"|").replace(nz,"[").replace(sz,"]")}function az(n){return Tv(n).replace(UR,"{").replace(jR,"}").replace($R,"^")}function Ug(n){return Tv(n).replace(BR,"%2B").replace(oz,"+").replace(FR,"%23").replace(X9,"%26").replace(rz,"`").replace(UR,"{").replace(jR,"}").replace($R,"^")}function lz(n){return Ug(n).replace(ez,"%3D")}function cz(n){return Tv(n).replace(FR,"%23").replace(tz,"%3F")}function uz(n){return n==null?"":cz(n).replace(Z9,"%2F")}function Hc(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const hz=/\/$/,dz=n=>n.replace(hz,"");function hm(n,e,t="/"){let s,r={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(s=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),r=n(i)),a>-1&&(s=s||e.slice(0,a),o=e.slice(a,e.length)),s=gz(s??e,t),{fullPath:s+(i&&"?")+i+o,path:s,query:r,hash:Hc(o)}}function fz(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function rT(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function pz(n,e,t){const s=e.matched.length-1,r=t.matched.length-1;return s>-1&&s===r&&Ba(e.matched[s],t.matched[r])&&zR(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function Ba(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function zR(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!mz(n[t],e[t]))return!1;return!0}function mz(n,e){return Ps(n)?iT(n,e):Ps(e)?iT(e,n):n===e}function iT(n,e){return Ps(e)?n.length===e.length&&n.every((t,s)=>t===e[s]):n.length===1&&n[0]===e}function gz(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),s=n.split("/"),r=s[s.length-1];(r===".."||r===".")&&s.push("");let i=t.length-1,o,a;for(o=0;o<s.length;o++)if(a=s[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+s.slice(o).join("/")}const $r={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Wc;(function(n){n.pop="pop",n.push="push"})(Wc||(Wc={}));var pc;(function(n){n.back="back",n.forward="forward",n.unknown=""})(pc||(pc={}));function _z(n){if(!n)if(aa){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),dz(n)}const yz=/^[^#]+#/;function vz(n,e){return n.replace(yz,"#")+e}function bz(n,e){const t=document.documentElement.getBoundingClientRect(),s=n.getBoundingClientRect();return{behavior:e.behavior,left:s.left-t.left-(e.left||0),top:s.top-t.top-(e.top||0)}}const Yf=()=>({left:window.scrollX,top:window.scrollY});function wz(n){let e;if("el"in n){const t=n.el,s=typeof t=="string"&&t.startsWith("#"),r=typeof t=="string"?s?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!r)return;e=bz(r,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function oT(n,e){return(history.state?history.state.position-e:-1)+n}const jg=new Map;function Ez(n,e){jg.set(n,e)}function Tz(n){const e=jg.get(n);return jg.delete(n),e}let Sz=()=>location.protocol+"//"+location.host;function HR(n,e){const{pathname:t,search:s,hash:r}=e,i=n.indexOf("#");if(i>-1){let a=r.includes(n.slice(i))?n.slice(i).length:1,l=r.slice(a);return l[0]!=="/"&&(l="/"+l),rT(l,"")}return rT(t,n)+s+r}function Iz(n,e,t,s){let r=[],i=[],o=null;const a=({state:f})=>{const p=HR(n,location),m=t.value,_=e.value;let v=0;if(f){if(t.value=p,e.value=f,o&&o===m){o=null;return}v=_?f.position-_.position:0}else s(p);r.forEach(I=>{I(t.value,m,{delta:v,type:Wc.pop,direction:v?v>0?pc.forward:pc.back:pc.unknown})})};function l(){o=t.value}function c(f){r.push(f);const p=()=>{const m=r.indexOf(f);m>-1&&r.splice(m,1)};return i.push(p),p}function u(){const{history:f}=window;f.state&&f.replaceState(tt({},f.state,{scroll:Yf()}),"")}function h(){for(const f of i)f();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:h}}function aT(n,e,t,s=!1,r=!1){return{back:n,current:e,forward:t,replaced:s,position:window.history.length,scroll:r?Yf():null}}function Cz(n){const{history:e,location:t}=window,s={value:HR(n,t)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,u){const h=n.indexOf("#"),f=h>-1?(t.host&&document.querySelector("base")?n:n.slice(h))+l:Sz()+n+l;try{e[u?"replaceState":"pushState"](c,"",f),r.value=c}catch(p){console.error(p),t[u?"replace":"assign"](f)}}function o(l,c){const u=tt({},e.state,aT(r.value.back,l,r.value.forward,!0),c,{position:r.value.position});i(l,u,!0),s.value=l}function a(l,c){const u=tt({},r.value,e.state,{forward:l,scroll:Yf()});i(u.current,u,!0);const h=tt({},aT(s.value,l,null),{position:u.position+1},c);i(l,h,!1),s.value=l}return{location:s,state:r,push:a,replace:o}}function kz(n){n=_z(n);const e=Cz(n),t=Iz(n,e.state,e.location,e.replace);function s(i,o=!0){o||t.pauseListeners(),history.go(i)}const r=tt({location:"",base:n,go:s,createHref:vz.bind(null,n)},e,t);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function Az(n){return typeof n=="string"||n&&typeof n=="object"}function WR(n){return typeof n=="string"||typeof n=="symbol"}const qR=Symbol("");var lT;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(lT||(lT={}));function $a(n,e){return tt(new Error,{type:n,[qR]:!0},e)}function lr(n,e){return n instanceof Error&&qR in n&&(e==null||!!(n.type&e))}const cT="[^/]+?",Rz={sensitive:!1,strict:!1,start:!0,end:!0},Pz=/[.+*?^${}()[\]/\\]/g;function xz(n,e){const t=tt({},Rz,e),s=[];let r=t.start?"^":"";const i=[];for(const c of n){const u=c.length?[]:[90];t.strict&&!c.length&&(r+="/");for(let h=0;h<c.length;h++){const f=c[h];let p=40+(t.sensitive?.25:0);if(f.type===0)h||(r+="/"),r+=f.value.replace(Pz,"\\$&"),p+=40;else if(f.type===1){const{value:m,repeatable:_,optional:v,regexp:I}=f;i.push({name:m,repeatable:_,optional:v});const O=I||cT;if(O!==cT){p+=10;try{new RegExp(`(${O})`)}catch(D){throw new Error(`Invalid custom RegExp for param "${m}" (${O}): `+D.message)}}let P=_?`((?:${O})(?:/(?:${O}))*)`:`(${O})`;h||(P=v&&c.length<2?`(?:/${P})`:"/"+P),v&&(P+="?"),r+=P,p+=20,v&&(p+=-8),_&&(p+=-20),O===".*"&&(p+=-50)}u.push(p)}s.push(u)}if(t.strict&&t.end){const c=s.length-1;s[c][s[c].length-1]+=.7000000000000001}t.strict||(r+="/?"),t.end?r+="$":t.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,t.sensitive?"":"i");function a(c){const u=c.match(o),h={};if(!u)return null;for(let f=1;f<u.length;f++){const p=u[f]||"",m=i[f-1];h[m.name]=p&&m.repeatable?p.split("/"):p}return h}function l(c){let u="",h=!1;for(const f of n){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const p of f)if(p.type===0)u+=p.value;else if(p.type===1){const{value:m,repeatable:_,optional:v}=p,I=m in c?c[m]:"";if(Ps(I)&&!_)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const O=Ps(I)?I.join("/"):I;if(!O)if(v)f.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${m}"`);u+=O}}return u||"/"}return{re:o,score:s,keys:i,parse:a,stringify:l}}function Nz(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=e[t]-n[t];if(s)return s;t++}return n.length<e.length?n.length===1&&n[0]===80?-1:1:n.length>e.length?e.length===1&&e[0]===80?1:-1:0}function KR(n,e){let t=0;const s=n.score,r=e.score;for(;t<s.length&&t<r.length;){const i=Nz(s[t],r[t]);if(i)return i;t++}if(Math.abs(r.length-s.length)===1){if(uT(s))return 1;if(uT(r))return-1}return r.length-s.length}function uT(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const Oz={type:0,value:""},Mz=/[a-zA-Z0-9_]/;function Dz(n){if(!n)return[[]];if(n==="/")return[[Oz]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(p){throw new Error(`ERR (${t})/"${c}": ${p}`)}let t=0,s=t;const r=[];let i;function o(){i&&r.push(i),i=[]}let a=0,l,c="",u="";function h(){c&&(t===0?i.push({type:0,value:c}):t===1||t===2||t===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function f(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){s=t,t=4;continue}switch(t){case 0:l==="/"?(c&&h(),o()):l===":"?(h(),t=1):f();break;case 4:f(),t=s;break;case 1:l==="("?t=2:Mz.test(l)?f():(h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:t=3:u+=l;break;case 3:h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),h(),o(),r}function Lz(n,e,t){const s=xz(Dz(n.path),t),r=tt(s,{record:n,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function Vz(n,e){const t=[],s=new Map;e=pT({strict:!1,end:!0,sensitive:!1},e);function r(h){return s.get(h)}function i(h,f,p){const m=!p,_=dT(h);_.aliasOf=p&&p.record;const v=pT(e,h),I=[_];if("alias"in h){const D=typeof h.alias=="string"?[h.alias]:h.alias;for(const B of D)I.push(dT(tt({},_,{components:p?p.record.components:_.components,path:B,aliasOf:p?p.record:_})))}let O,P;for(const D of I){const{path:B}=D;if(f&&B[0]!=="/"){const M=f.record.path,A=M[M.length-1]==="/"?"":"/";D.path=f.record.path+(B&&A+B)}if(O=Lz(D,f,v),p?p.alias.push(O):(P=P||O,P!==O&&P.alias.push(O),m&&h.name&&!fT(O)&&o(h.name)),GR(O)&&l(O),_.children){const M=_.children;for(let A=0;A<M.length;A++)i(M[A],O,p&&p.children[A])}p=p||O}return P?()=>{o(P)}:fc}function o(h){if(WR(h)){const f=s.get(h);f&&(s.delete(h),t.splice(t.indexOf(f),1),f.children.forEach(o),f.alias.forEach(o))}else{const f=t.indexOf(h);f>-1&&(t.splice(f,1),h.record.name&&s.delete(h.record.name),h.children.forEach(o),h.alias.forEach(o))}}function a(){return t}function l(h){const f=$z(h,t);t.splice(f,0,h),h.record.name&&!fT(h)&&s.set(h.record.name,h)}function c(h,f){let p,m={},_,v;if("name"in h&&h.name){if(p=s.get(h.name),!p)throw $a(1,{location:h});v=p.record.name,m=tt(hT(f.params,p.keys.filter(P=>!P.optional).concat(p.parent?p.parent.keys.filter(P=>P.optional):[]).map(P=>P.name)),h.params&&hT(h.params,p.keys.map(P=>P.name))),_=p.stringify(m)}else if(h.path!=null)_=h.path,p=t.find(P=>P.re.test(_)),p&&(m=p.parse(_),v=p.record.name);else{if(p=f.name?s.get(f.name):t.find(P=>P.re.test(f.path)),!p)throw $a(1,{location:h,currentLocation:f});v=p.record.name,m=tt({},f.params,h.params),_=p.stringify(m)}const I=[];let O=p;for(;O;)I.unshift(O.record),O=O.parent;return{name:v,path:_,params:m,matched:I,meta:Bz(I)}}n.forEach(h=>i(h));function u(){t.length=0,s.clear()}return{addRoute:i,resolve:c,removeRoute:o,clearRoutes:u,getRoutes:a,getRecordMatcher:r}}function hT(n,e){const t={};for(const s of e)s in n&&(t[s]=n[s]);return t}function dT(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:Fz(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function Fz(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const s in n.components)e[s]=typeof t=="object"?t[s]:t;return e}function fT(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function Bz(n){return n.reduce((e,t)=>tt(e,t.meta),{})}function pT(n,e){const t={};for(const s in n)t[s]=s in e?e[s]:n[s];return t}function $z(n,e){let t=0,s=e.length;for(;t!==s;){const i=t+s>>1;KR(n,e[i])<0?s=i:t=i+1}const r=Uz(n);return r&&(s=e.lastIndexOf(r,s-1)),s}function Uz(n){let e=n;for(;e=e.parent;)if(GR(e)&&KR(n,e)===0)return e}function GR({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function jz(n){const e={};if(n===""||n==="?")return e;const s=(n[0]==="?"?n.slice(1):n).split("&");for(let r=0;r<s.length;++r){const i=s[r].replace(BR," "),o=i.indexOf("="),a=Hc(o<0?i:i.slice(0,o)),l=o<0?null:Hc(i.slice(o+1));if(a in e){let c=e[a];Ps(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function mT(n){let e="";for(let t in n){const s=n[t];if(t=lz(t),s==null){s!==void 0&&(e+=(e.length?"&":"")+t);continue}(Ps(s)?s.map(i=>i&&Ug(i)):[s&&Ug(s)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function zz(n){const e={};for(const t in n){const s=n[t];s!==void 0&&(e[t]=Ps(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}const Hz=Symbol(""),gT=Symbol(""),Xf=Symbol(""),QR=Symbol(""),zg=Symbol("");function Nl(){let n=[];function e(s){return n.push(s),()=>{const r=n.indexOf(s);r>-1&&n.splice(r,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function qr(n,e,t,s,r,i=o=>o()){const o=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((a,l)=>{const c=f=>{f===!1?l($a(4,{from:t,to:e})):f instanceof Error?l(f):Az(f)?l($a(2,{from:e,to:f})):(o&&s.enterCallbacks[r]===o&&typeof f=="function"&&o.push(f),a())},u=i(()=>n.call(s&&s.instances[r],e,t,c));let h=Promise.resolve(u);n.length<3&&(h=h.then(c)),h.catch(f=>l(f))})}function dm(n,e,t,s,r=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(VR(l)){const u=(l.__vccOpts||l)[e];u&&i.push(qr(u,t,s,o,a,r))}else{let c=l();i.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const h=Y9(u)?u.default:u;o.mods[a]=u,o.components[a]=h;const p=(h.__vccOpts||h)[e];return p&&qr(p,t,s,o,a,r)()}))}}return i}function _T(n){const e=xn(Xf),t=xn(QR),s=et(()=>{const l=Y(n.to);return e.resolve(l)}),r=et(()=>{const{matched:l}=s.value,{length:c}=l,u=l[c-1],h=t.matched;if(!u||!h.length)return-1;const f=h.findIndex(Ba.bind(null,u));if(f>-1)return f;const p=yT(l[c-2]);return c>1&&yT(u)===p&&h[h.length-1].path!==p?h.findIndex(Ba.bind(null,l[c-2])):f}),i=et(()=>r.value>-1&&Qz(t.params,s.value.params)),o=et(()=>r.value>-1&&r.value===t.matched.length-1&&zR(t.params,s.value.params));function a(l={}){if(Gz(l)){const c=e[Y(n.replace)?"replace":"push"](Y(n.to)).catch(fc);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:s,href:et(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}function Wz(n){return n.length===1?n[0]:n}const qz=T_({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:_T,setup(n,{slots:e}){const t=Ka(_T(n)),{options:s}=xn(Xf),r=et(()=>({[vT(n.activeClass,s.linkActiveClass,"router-link-active")]:t.isActive,[vT(n.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&Wz(e.default(t));return n.custom?i:hf("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:r.value},i)}}}),Kz=qz;function Gz(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function Qz(n,e){for(const t in e){const s=e[t],r=n[t];if(typeof s=="string"){if(s!==r)return!1}else if(!Ps(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function yT(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const vT=(n,e,t)=>n??e??t,Jz=T_({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const s=xn(zg),r=et(()=>n.route||s.value),i=xn(gT,0),o=et(()=>{let c=Y(i);const{matched:u}=r.value;let h;for(;(h=u[c])&&!h.components;)c++;return c}),a=et(()=>r.value.matched[o.value]);Zl(gT,et(()=>o.value+1)),Zl(Hz,a),Zl(zg,r);const l=G();return js(()=>[l.value,a.value,n.name],([c,u,h],[f,p,m])=>{u&&(u.instances[h]=c,p&&p!==u&&c&&c===f&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!Ba(u,p)||!f)&&(u.enterCallbacks[h]||[]).forEach(_=>_(c))},{flush:"post"}),()=>{const c=r.value,u=n.name,h=a.value,f=h&&h.components[u];if(!f)return bT(t.default,{Component:f,route:c});const p=h.props[u],m=p?p===!0?c.params:typeof p=="function"?p(c):p:null,v=hf(f,tt({},m,e,{onVnodeUnmounted:I=>{I.component.isUnmounted&&(h.instances[u]=null)},ref:l}));return bT(t.default,{Component:v,route:c})||v}}});function bT(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const JR=Jz;function Yz(n){const e=Vz(n.routes,n),t=n.parseQuery||jz,s=n.stringifyQuery||mT,r=n.history,i=Nl(),o=Nl(),a=Nl(),l=nf($r);let c=$r;aa&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=um.bind(null,z=>""+z),h=um.bind(null,uz),f=um.bind(null,Hc);function p(z,fe){let ce,_e;return WR(z)?(ce=e.getRecordMatcher(z),_e=fe):_e=z,e.addRoute(_e,ce)}function m(z){const fe=e.getRecordMatcher(z);fe&&e.removeRoute(fe)}function _(){return e.getRoutes().map(z=>z.record)}function v(z){return!!e.getRecordMatcher(z)}function I(z,fe){if(fe=tt({},fe||l.value),typeof z=="string"){const L=hm(t,z,fe.path),H=e.resolve({path:L.path},fe),J=r.createHref(L.fullPath);return tt(L,H,{params:f(H.params),hash:Hc(L.hash),redirectedFrom:void 0,href:J})}let ce;if(z.path!=null)ce=tt({},z,{path:hm(t,z.path,fe.path).path});else{const L=tt({},z.params);for(const H in L)L[H]==null&&delete L[H];ce=tt({},z,{params:h(L)}),fe.params=h(fe.params)}const _e=e.resolve(ce,fe),Je=z.hash||"";_e.params=u(f(_e.params));const R=fz(s,tt({},z,{hash:az(Je),path:_e.path})),N=r.createHref(R);return tt({fullPath:R,hash:Je,query:s===mT?zz(z.query):z.query||{}},_e,{redirectedFrom:void 0,href:N})}function O(z){return typeof z=="string"?hm(t,z,l.value.path):tt({},z)}function P(z,fe){if(c!==z)return $a(8,{from:fe,to:z})}function D(z){return A(z)}function B(z){return D(tt(O(z),{replace:!0}))}function M(z){const fe=z.matched[z.matched.length-1];if(fe&&fe.redirect){const{redirect:ce}=fe;let _e=typeof ce=="function"?ce(z):ce;return typeof _e=="string"&&(_e=_e.includes("?")||_e.includes("#")?_e=O(_e):{path:_e},_e.params={}),tt({query:z.query,hash:z.hash,params:_e.path!=null?{}:z.params},_e)}}function A(z,fe){const ce=c=I(z),_e=l.value,Je=z.state,R=z.force,N=z.replace===!0,L=M(ce);if(L)return A(tt(O(L),{state:typeof L=="object"?tt({},Je,L.state):Je,force:R,replace:N}),fe||ce);const H=ce;H.redirectedFrom=fe;let J;return!R&&pz(s,_e,ce)&&(J=$a(16,{to:H,from:_e}),ht(_e,_e,!0,!1)),(J?Promise.resolve(J):C(H,_e)).catch(K=>lr(K)?lr(K,2)?K:Qe(K):te(K,H,_e)).then(K=>{if(K){if(lr(K,2))return A(tt({replace:N},O(K.to),{state:typeof K.to=="object"?tt({},Je,K.to.state):Je,force:R}),fe||H)}else K=k(H,_e,!0,N,Je);return x(H,_e,K),K})}function T(z,fe){const ce=P(z,fe);return ce?Promise.reject(ce):Promise.resolve()}function E(z){const fe=Or.values().next().value;return fe&&typeof fe.runWithContext=="function"?fe.runWithContext(z):z()}function C(z,fe){let ce;const[_e,Je,R]=Xz(z,fe);ce=dm(_e.reverse(),"beforeRouteLeave",z,fe);for(const L of _e)L.leaveGuards.forEach(H=>{ce.push(qr(H,z,fe))});const N=T.bind(null,z,fe);return ce.push(N),Fn(ce).then(()=>{ce=[];for(const L of i.list())ce.push(qr(L,z,fe));return ce.push(N),Fn(ce)}).then(()=>{ce=dm(Je,"beforeRouteUpdate",z,fe);for(const L of Je)L.updateGuards.forEach(H=>{ce.push(qr(H,z,fe))});return ce.push(N),Fn(ce)}).then(()=>{ce=[];for(const L of R)if(L.beforeEnter)if(Ps(L.beforeEnter))for(const H of L.beforeEnter)ce.push(qr(H,z,fe));else ce.push(qr(L.beforeEnter,z,fe));return ce.push(N),Fn(ce)}).then(()=>(z.matched.forEach(L=>L.enterCallbacks={}),ce=dm(R,"beforeRouteEnter",z,fe,E),ce.push(N),Fn(ce))).then(()=>{ce=[];for(const L of o.list())ce.push(qr(L,z,fe));return ce.push(N),Fn(ce)}).catch(L=>lr(L,8)?L:Promise.reject(L))}function x(z,fe,ce){a.list().forEach(_e=>E(()=>_e(z,fe,ce)))}function k(z,fe,ce,_e,Je){const R=P(z,fe);if(R)return R;const N=fe===$r,L=aa?history.state:{};ce&&(_e||N?r.replace(z.fullPath,tt({scroll:N&&L&&L.scroll},Je)):r.push(z.fullPath,Je)),l.value=z,ht(z,fe,ce,N),Qe()}let b;function ye(){b||(b=r.listen((z,fe,ce)=>{if(!Ns.listening)return;const _e=I(z),Je=M(_e);if(Je){A(tt(Je,{replace:!0,force:!0}),_e).catch(fc);return}c=_e;const R=l.value;aa&&Ez(oT(R.fullPath,ce.delta),Yf()),C(_e,R).catch(N=>lr(N,12)?N:lr(N,2)?(A(tt(O(N.to),{force:!0}),_e).then(L=>{lr(L,20)&&!ce.delta&&ce.type===Wc.pop&&r.go(-1,!1)}).catch(fc),Promise.reject()):(ce.delta&&r.go(-ce.delta,!1),te(N,_e,R))).then(N=>{N=N||k(_e,R,!1),N&&(ce.delta&&!lr(N,8)?r.go(-ce.delta,!1):ce.type===Wc.pop&&lr(N,20)&&r.go(-1,!1)),x(_e,R,N)}).catch(fc)}))}let Ve=Nl(),We=Nl(),j;function te(z,fe,ce){Qe(z);const _e=We.list();return _e.length?_e.forEach(Je=>Je(z,fe,ce)):console.error(z),Promise.reject(z)}function Re(){return j&&l.value!==$r?Promise.resolve():new Promise((z,fe)=>{Ve.add([z,fe])})}function Qe(z){return j||(j=!z,ye(),Ve.list().forEach(([fe,ce])=>z?ce(z):fe()),Ve.reset()),z}function ht(z,fe,ce,_e){const{scrollBehavior:Je}=n;if(!aa||!Je)return Promise.resolve();const R=!ce&&Tz(oT(z.fullPath,0))||(_e||!ce)&&history.state&&history.state.scroll||null;return Mi().then(()=>Je(z,fe,R)).then(N=>N&&wz(N)).catch(N=>te(N,z,fe))}const pt=z=>r.go(z);let vt;const Or=new Set,Ns={currentRoute:l,listening:!0,addRoute:p,removeRoute:m,clearRoutes:e.clearRoutes,hasRoute:v,getRoutes:_,resolve:I,options:n,push:D,replace:B,go:pt,back:()=>pt(-1),forward:()=>pt(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:We.add,isReady:Re,install(z){const fe=this;z.component("RouterLink",Kz),z.component("RouterView",JR),z.config.globalProperties.$router=fe,Object.defineProperty(z.config.globalProperties,"$route",{enumerable:!0,get:()=>Y(l)}),aa&&!vt&&l.value===$r&&(vt=!0,D(r.location).catch(Je=>{}));const ce={};for(const Je in $r)Object.defineProperty(ce,Je,{get:()=>l.value[Je],enumerable:!0});z.provide(Xf,fe),z.provide(QR,lI(ce)),z.provide(zg,l);const _e=z.unmount;Or.add(z),z.unmount=function(){Or.delete(z),Or.size<1&&(c=$r,b&&b(),b=null,l.value=$r,vt=!1,j=!1),_e()}}};function Fn(z){return z.reduce((fe,ce)=>fe.then(()=>E(ce)),Promise.resolve())}return Ns}function Xz(n,e){const t=[],s=[],r=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(c=>Ba(c,a))?s.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>Ba(c,l))||r.push(l))}return[t,s,r]}function Zf(){return xn(Xf)}const yt=(n,e)=>{const t=n.__vccOpts||n;for(const[s,r]of e)t[s]=r;return t},Zz={key:0,id:"alert"},e5={__name:"Alert",setup(n,{expose:e}){const t=G([]);return e({setAlert:(r,i="error",o=5e3)=>{t.value.push({message:r,type:i}),setTimeout(()=>{t.value.shift()},o)}}),(r,i)=>t.value.length?($(),W("div",Zz,[($(!0),W(rt,null,Io(t.value,(o,a)=>($(),W("div",{key:a,class:is(["alert-box",o.type])},[w("span",null,De(o.message),1)],2))),128))])):de("",!0)}},YR=yt(e5,[["__scopeId","data-v-bd25fa76"]]),t5={__name:"App",setup(n){const e=G(null);return Xs(()=>{if(!e.value){console.warn("Alert ref not found");return}Zl("setAlert",(t,s="error",r=5e3)=>{e.value.setAlert(t,s,r)})}),(t,s)=>($(),W(rt,null,[F(YR,{ref_key:"alertRef",ref:e},null,512),F(Y(JR))],64))}},Sv="/assets/Advice-BVQM3XXG.png",XR="/assets/weekly-banshee-dTdnEX1o.png",n5="/assets/eye-Cdir2JGr.gif",Iv="/assets/exploreButton-Da7T4RJC.png",s5=Object.freeze(Object.defineProperty({__proto__:null,default:Iv},Symbol.toStringTag,{value:"Module"})),r5="/assets/superkidspeech-C0hPdfzw.png",i5="/assets/instagram-button-BRdgrWoq.png",o5="/assets/youtube-button-DYZ7x8OH.png",a5="/assets/etsy-button-Cys0YOvM.png",l5="/assets/Oneeyedsuperkid-BjwfmPDz.png",c5=["to"],u5=["to"],h5=["type"],d5={__name:"Button",props:{customClass:{type:[String,Array,Object],default:null},isX:{type:Boolean,default:!1},isRouter:{type:Boolean,default:!1},to:String,isImage:{type:Boolean,default:!1},isHover:{type:Boolean,default:!1},src:String,hoverSrc:String,type:{type:String,default:"button"}},emits:["click"],setup(n){const e=Zf(),t=n,s=et(()=>{const a=["vueButton"];return t.customClass&&a.push(t.customClass),t.isRouter&&a.push("router-button"),t.isImage&&a.push("image-button"),t.isX&&a.push("x-button"),a});function r(a){t.to&&e.push(t.to)}const i=G(t.src);js(()=>t.src,a=>{t.isHover||(i.value=a)}),js(()=>t.hoverSrc,a=>{t.isHover&&(i.value=t.src)});function o(a){t.isHover&&(i.value=a?t.hoverSrc:t.src)}return(a,l)=>n.isX?($(),W("button",{key:0,class:is([s.value]),onClick:l[0]||(l[0]=c=>a.$emit("click",c))},l[7]||(l[7]=[w("p",null,"✗",-1)]),2)):n.isRouter&&n.isImage&&n.isHover?($(),W("button",{key:1,onClick:r,to:n.to,class:is(s.value),onMouseover:l[1]||(l[1]=c=>o(!0)),onMouseleave:l[2]||(l[2]=c=>o(!1))},[so(a.$slots,"default",{currentSrc:i.value},void 0)],42,c5)):n.isRouter?($(),W("button",{key:2,onClick:r,to:n.to,class:is(s.value)},[so(a.$slots,"default",{},void 0)],10,u5)):n.isImage?($(),W("button",{key:3,class:is(s.value),onClick:l[3]||(l[3]=c=>a.$emit("click",c)),onMouseover:l[4]||(l[4]=c=>o(!0)),onMouseleave:l[5]||(l[5]=c=>o(!1))},[n.isHover?so(a.$slots,"default",{key:0,currentSrc:i.value},void 0):so(a.$slots,"default",{key:1},void 0)],34)):($(),W("button",{key:4,class:is(s.value),type:n.type,onClick:l[6]||(l[6]=c=>a.$emit("click",c))},[so(a.$slots,"default",{},void 0)],10,h5))}},ae=yt(d5,[["__scopeId","data-v-987ee1ad"]]),f5={class:"header_container"},p5={__name:"Header",setup(n){return(e,t)=>($(),W("div",f5,[F(ae,{isImage:"",isRouter:"",to:"/",class:"header",type:"button",onClick:t[0]||(t[0]=s=>e.navigateTo("index"))},{default:Z(()=>t[1]||(t[1]=[w("img",{src:l5},null,-1),w("p",{class:"title"},"Home of The Shadow Banshee, The Dreamwalker, The Superkid and more...",-1)])),_:1})]))}},ps=yt(p5,[["__scopeId","data-v-8eb2e9c1"]]),m5={class:"navbar"},g5=Object.assign({inheritAttrs:!1},{__name:"NavBar",setup(n){return(e,t)=>($(),W("nav",m5,[F(ae,{isRouter:"",to:"/explore"},{default:Z(()=>t[0]||(t[0]=[ne("Explore")])),_:1}),F(ae,{isRouter:"",to:"/periodical"},{default:Z(()=>t[1]||(t[1]=[ne("Periodical")])),_:1}),F(ae,{isRouter:"",to:"/gallery"},{default:Z(()=>t[2]||(t[2]=[ne("Art")])),_:1}),F(ae,{isRouter:"",to:"/faq"},{default:Z(()=>t[3]||(t[3]=[ne("FAQ")])),_:1}),F(ae,{isRouter:"",to:"/shop"},{default:Z(()=>t[4]||(t[4]=[ne("Shop")])),_:1}),F(ae,{isRouter:"",to:"/locations"},{default:Z(()=>t[5]||(t[5]=[ne("Locations")])),_:1})]))}}),xr=yt(g5,[["__scopeId","data-v-2e5a6a0a"]]),Mo="/assets/gif-esdr860u.gif",_5={__name:"Modal",props:{isOverlay:{type:Boolean,default:!1},customClass:{type:[String,Array,Object],default:null}},setup(n){const e=n,t=et(()=>{const s=["modal"];return e.isOverlay?s.push("modal--overlay"):s.push("modal--window"),s});return(s,r)=>($(),W("div",{class:is([t.value,n.customClass])},[so(s.$slots,"default",{},void 0)],2))}},Qs=yt(_5,[["__scopeId","data-v-baec181f"]]),Zo="http://127.0.0.1:5001/shadowbanshee-79c70/us-central1/api",Nr=ou("user",()=>{const n=L9(),e=OF(),t=OR(),s=tv(),r=tk(),i=et(()=>{var j;return(j=e.value)!=null&&j.uid?Mg(s,"users",e.value.uid):null}),o=N9(i),a=et(()=>{var j;return(j=e.value)==null?void 0:j.email}),l=et(()=>{var j;return(j=o.data.value)==null?void 0:j.username}),c=et(()=>{var j;return(j=e.value)==null?void 0:j.uid}),u=et(()=>!!e.value),h=et(()=>{var j;return((j=e.value)==null?void 0:j.emailVerified)===!0}),f=et(()=>{var j;return(j=o.data.value)==null?void 0:j.subscribed}),p=et(()=>{var j;return(j=o.data.value)==null?void 0:j.subscription}),m=et(()=>{var j;return(j=o.data.value)==null?void 0:j.customerId}),_=et(()=>{var j;return(j=o.data.value)==null?void 0:j.subscriptionId});async function v(){for(;!c.value;)await new Promise(te=>setTimeout(te,100));console.log("UID before fetch:",c.value);const j=await fetch(`${Zo}/check-admin`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:c.value})});if(j.ok){const te=await j.json();return console.log("Admin data fetched successfully:",te),{data:te,success:!0}}else throw console.error("Failed to fetch admin data:",await j.json()),new Error(`Failed to fetch admin data: ${j.statusText}`)}const I=et(()=>{var j;return(((j=o.data.value)==null?void 0:j.donationAmount)/100).toFixed(2)}),O=G(r.currentUser);Jw(r,async j=>{if(j)try{await j.getIdToken()}catch{console.warn("Stale session, signing out"),r.signOut()}});async function P(j,te){try{console.log(Zo);let Re=j;if(!j.includes("@")){if(console.log('Identifier does not include "@", attempting username lookup.'),Re=await D(Re),!Re)throw console.error("User not found:",Error.message),new Error(`User "${j}" not found, did you mean something else?`);j=Re}return await B2(n,j,te),!0}catch(Re){return console.error("Login failed:",Re),!1}}async function D(j){try{console.log("Fetching email for username:",j);const te=await fetch("http://127.0.0.1:5001/shadowbanshee-79c70/us-central1/api/get-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:j})});if(!te.ok)throw console.error("Server response:",await te.json()),console.log("Response status:",te.status),console.log("Response status:",te),console.error("Failed to fetch email from server:",te.statusText),new Error("Failed to fetch email from server");const Re=await te.json();return console.log("Fetched email:",Re.email),Re.email}catch(te){return console.error("Error fetching email from server:",te),null}}async function B(){try{return console.log("Logging out"),await n.signOut(),!0}catch(j){return console.error("Logout failed:",j),!1}}async function M(j,te,Re){try{const Qe=await fetch("http://127.0.0.1:5001/shadowbanshee-79c70/us-central1/api/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:j,email:te,password:Re})}),ht=await Qe.json();if(!Qe.ok){console.error("Server response:",ht);const pt=ht.error||"Signup failed on the server.";throw new Error(pt)}return await V2(r,ht.token),ht}catch(Qe){throw console.error("Sign up failed:",Qe),Qe}}async function A(j){try{console.log("Checking username:",j);const te=await fetch(`${Zo}/check-username`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:j})});if(!te.ok)throw console.error("Server response:",await te.json()),console.log("Response status:",te.status),console.log("Response status:",te),console.error("Failed to check username:",te.statusText),new Error("Failed to check username!");const Re=await te.json();return console.log("Fetched username:",Re.exists),Re}catch(te){return console.error("Error fetching username from server:",te),null}}async function T(j){try{console.log("Checking email:",j);const te=await fetch(`${Zo}/check-email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:j})});if(!te.ok)throw console.error("Server response:",await te.json()),console.log("Response status:",te.status),console.log("Response status:",te),console.error("Failed to check email:",te.statusText),new Error("Failed to check email!");const Re=await te.json();return console.log("Fetched email:",Re.exists),Re}catch(te){return console.error("Error fetching email from server:",te),null}}Jw(r,async j=>{if(O.value=j,j&&j.emailVerified){const te=Mg(s,"users",j.uid),Re=await dv(te);if(Re.exists()&&!Re.data().verified)try{await Q0(te,{verified:!0}),h.value=!0,console.log("User Firestore updated for email verification.")}catch(Qe){console.error("Error updating user Firestore:",Qe)}}});async function E(j){if(!O.value)throw new Error("User is not logged in");try{return await Q0(i.value,j),Object.assign(o.value,j),!0}catch(te){return console.error("Failed to update user profile:",te),!1}}async function C(j,te,Re){if(console.log("Creating subscription. free:",j,Re,te),j)ih(i.value,{subscribed:!0,subscription:"free",donationAmount:0},{merge:!0});else if(Re>=299){console.log("Creating subscription for amount:",Re),console.log("Creating subscription for name:",te);const Qe=await create(te);if(Qe.success){const ht=await subscribe(Re,Qe.customer);if(ht.success)return console.log("Subscription created successfully:",ht),ih(i.value,{subscribed:!0,subscription:"snail-mail",donationAmount:Re,customerId:Qe.customer},{merge:!0}),{success:!0,subscriptionId:ht.subscriptionId,clientSecret:ht.clientSecret};console.error("Failed to create subscription:",ht.error)}}}async function x(){if(console.log("Unsubscribing user"),O.subscription==="free"){console.log("free"),ih(i.value,{subscribed:!1,subscription:null,donationAmount:0},{merge:!0});return}}async function k(j,te,Re){if(console.log("Editing:",j),j>=299){console.log("Editing:",j,m.value,_.value);const Qe=await fetch(`${Zo}/edit-subscription`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currency:"usd",unit_amount:j,customerId:m.value,subscriptionId:_.value})});if(!Qe.ok)throw console.error("Server response:",await Qe.json()),console.log("Response status:",Qe.status),console.log("Response status:",Qe),console.error("Failed to edit subscription:",Qe.statusText),new Error("Failed to edit subscription!");const ht=await Qe.json();return ht.success?(console.log("Subscription edited successfully:",ht),ih(i.value,{donationAmount:j},{merge:!0}),{success:!0}):{success:!1,error:"Error!"}}}async function b(j){try{console.log("Deleting account for user:",j);const te=await fetch(`${Zo}/delete-account`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:j})}),Re=await te.json();if(!te.ok){console.error("Server response:",Re);const Qe=Re.message||Re.errorMessage||"Delete failed on the server.";throw new Error(Qe)}return console.log("Account deleted successfully:",Re),Re}catch(te){throw console.error("Delete failed:",te),te}}const ye=x9(ej(ev(s,"weeklyPosts"),tj("createdAt","desc"))),Ve=G(!1),We=G(null);return{vueAuth:n,vueUser:e,vueFS:t,userEmail:a,user:O,uid:c,username:l,profile:o,isLoggedIn:u,isVerified:h,subscribed:f,subscription:p,donationAmount:I,posts:ye,loading:Ve,error:We,getAdmin:v,Login:P,Logout:B,SignUp:M,CheckUsername:A,CheckEmail:T,Subscribe:C,Unsubscribe:x,EditSub:k,UpdateProfile:E,DeleteAccount:b}});function Su(){const n=xn("setAlert");if(!n)throw new Error("setAlert not provided!");return n}const y5={class:"input"},v5={key:0},b5={class:"input"},w5={key:0},E5={class:"input"},T5={key:0},S5={class:"input"},I5={key:0},C5={class:"input"},k5={key:0,src:Mo,alt:"Loading...",style:{width:"4em",margin:"-1.4vw"}},A5={id:"error-message"},R5={key:1,style:{margin:"5vw"}},P5={key:0,style:{"margin-bottom":"1vw"}},x5={key:2,class:"loading",src:Mo},N5={__name:"SignUp",setup(n){const e=Su(),t=Nr(),{isLoggedIn:s}=ff(t),r=G(!1),i=G(!1),o=G(""),a=G(""),l=G(""),c=G(""),u=G(""),h=G(""),f=G(""),p=G(""),m=G(!1),_=G(!1),v=G(!1),I=G(!1),O=G(!1),P=G(""),D=async()=>{if(o.value){m.value=!0;try{return(await t.CheckUsername(o.value)).exists?(u.value=" ✗ Username is already taken!",!1):(u.value=" ✓ Good!",!0)}catch{u.value=" ✗ Error checking username."}}},B=async()=>{if(a.value){_.value=!0;try{return(await t.CheckEmail(a.value)).exists?(h.value=" ✗ Email is already registered!",!1):(h.value=" ✓ Good!",!0)}catch{h.value=" ✗ Error checking email."}}},M=async()=>{if(l.value)return v.value=!0,l.value.length<6?(f.value=" ✗ Use at least 6 numbers, letters or characters!",!1):(f.value=" ✓ Good!",!0)},A=async()=>{if(c.value)return I.value=!0,c.value!=l.value?(p.value=" ✗ Passwords don't match!",!1):(p.value=" ✓ Good!",!0)};async function T(){r.value=!0,O.value=!0,P.value="...",console.log("Signing up...",o.value,a.value,l.value);const E=await D(),C=await B(),x=await M(),k=await A(),b=ye=>new Promise(Ve=>setTimeout(Ve,ye));if(!E||!C||!x||!k){await b(2e3),P.value="Please fix the errors above before submitting.",console.log("Signup Failed."),P.value=" ✗ Check fields!",e(P.value,"error",3e3),r.value=!1;return}try{await t.SignUp(o.value,a.value,l.value)?(console.log("Created account successfully! An email has been sent to your address. :)"),e("Created account successfully! An email has been sent to your address. :)","success",3e3),P.value="Success!",r.value=!1,i.value=!0):(console.log("Signup Failed."),P.value="Signup Failed:",e(P.value,"error",3e3),r.value=!1)}catch(ye){console.error("Error signing up:",ye),P.value="Error signing up: "+ye.message,e(P.value,"error",3e3),r.value=!1}finally{console.log(s.value),r.value=!1}}return(E,C)=>($(),bt(Qs,{isOverlay:"",class:"signup-modal"},{default:Z(()=>[F(ae,{isX:"",onClick:C[0]||(C[0]=x=>E.$emit("close"))}),i.value?de("",!0):($(),W("form",{key:0,onSubmit:Sr(T,["prevent"]),class:"create-account-form"},[C[7]||(C[7]=w("p",null," We don't have access to your password and it secured via Google Firebase! You will receive an Email to verify your account. :) ",-1)),w("div",y5,[nn(w("input",{"onUpdate:modelValue":C[1]||(C[1]=x=>o.value=x),onBlur:D,type:"text",placeholder:"Username",required:""},null,544),[[Un,o.value]]),m.value?($(),W("p",v5,De(u.value),1)):de("",!0)]),w("div",b5,[nn(w("input",{"onUpdate:modelValue":C[2]||(C[2]=x=>a.value=x),onBlur:B,type:"email",placeholder:"Email",required:""},null,544),[[Un,a.value]]),_.value?($(),W("p",w5,De(h.value),1)):de("",!0)]),w("div",E5,[nn(w("input",{"onUpdate:modelValue":C[3]||(C[3]=x=>l.value=x),onBlur:M,type:"password",placeholder:"Password",required:""},null,544),[[Un,l.value]]),v.value?($(),W("p",T5,De(f.value),1)):de("",!0)]),w("div",S5,[nn(w("input",{"onUpdate:modelValue":C[4]||(C[4]=x=>c.value=x),onBlur:A,type:"password",placeholder:"Double check password!",required:""},null,544),[[Un,c.value]]),I.value?($(),W("p",I5,De(p.value),1)):de("",!0)]),w("div",C5,[F(ae,{class:"submit-button",type:"submit"},{default:Z(()=>C[6]||(C[6]=[ne("Create Account! ->")])),_:1}),r.value?($(),W("img",k5)):de("",!0),w("p",A5,De(P.value),1)])],32)),i.value?($(),W("div",R5,[Y(t).isVerified?de("",!0):($(),W("p",P5," Created account successfully! A validation link has been sent to your email address. :) ")),w("p",null,[C[8]||(C[8]=ne(" (Didn't get it? ")),w("a",{href:"#",onClick:C[5]||(C[5]=Sr((...x)=>E.resend&&E.resend(...x),["prevent"]))},"Click here to resend!"),C[9]||(C[9]=ne(") "))])])):de("",!0),r.value?($(),W("img",x5)):de("",!0)]),_:1}))}},O5=yt(N5,[["__scopeId","data-v-e6938d4a"]]),M5={key:0},D5={key:1},L5={class:"login"},V5={key:1},F5={style:{padding:"0",margin:"0.4vw"}},B5={style:{padding:"0",margin:"0.4vw"}},$5={key:0},U5={key:2,id:"error-message"},j5={key:3,id:"loading",src:Mo,alt:""},z5={key:0,id:"sign-up"},H5={__name:"Login",setup(n,{expose:e}){const t=Su(),s=Nr(),{isLoggedIn:r,username:i,userEmail:o}=ff(s),a=G(!1),l=G(!1),c=G(!1),u=G(""),h=G(""),f=G(!1),p=G(""),m=()=>{console.log("Loggin clicked..."),a.value=!a.value,console.log("logged?",r.value)};async function _(){l.value=!0,f.value=!0,p.value="Logging in...",console.log("Logging in...");try{await s.Login(u.value,h.value)?(console.log("Login successful and user data updated."),t("Logged in!","success",3e3),f.value=!1,l.value=!1):(console.log("Login failed."),p.value="Login failed! Check info?",t(p.value,"error",3e3),l.value=!1)}catch(O){console.error("Error logging in:",O),p.value="Error logging in: "+O.message,t(p.value,"error",3e3),l.value=!1}finally{console.log(r.value),l.value=!1}}async function v(){l.value=!0,f.value=!0,p.value="Logging out...",console.log("Logging out...");try{const O=await s.Logout();console.log("Logout successful."),l.value=!1,O?(console.log("Logout successful."),t("Logged out!","success",3e3),p.value="",l.value=!1):(console.log("Logout failed."),p.value="Logout failed.",t(p.value,"error",3e3),l.value=!1)}catch(O){console.error("Error signing out:",O),p.value="Error signing out: "+O.message,t(p.value,"error",3e3),l.value=!1}finally{console.log(r.value),l.value=!1}console.log("Logged out")}async function I(){c.value=!0,a.value=!1}return e({doSignUp:I,toggleLogin:m}),(O,P)=>($(),W(rt,null,[c.value?($(),bt(O5,{key:0,onClose:P[0]||(P[0]=D=>c.value=!1)})):de("",!0),F(ae,{onClick:P[1]||(P[1]=D=>a.value=!0),id:"login-button"},{default:Z(()=>[Y(s).isLoggedIn?de("",!0):($(),W("p",M5,"Login")),Y(s).isLoggedIn?($(),W("p",D5,"Account")):de("",!0)]),_:1}),F(iu,{name:"Slide"},{default:Z(()=>[a.value?($(),bt(Qs,{key:0,class:"login-sidebar slide-in-done"},{default:Z(()=>[F(ae,{onClick:P[2]||(P[2]=D=>a.value=!1),isX:""}),w("div",L5,[Y(r)?de("",!0):($(),W("form",{key:0,id:"login-form",onSubmit:Sr(_,["prevent"])},[P[5]||(P[5]=w("p",null,"Log in:",-1)),nn(w("input",{"onUpdate:modelValue":P[3]||(P[3]=D=>u.value=D),type:"text",id:"login-username-email",placeholder:"Username or Email",required:""},null,512),[[Un,u.value]]),nn(w("input",{"onUpdate:modelValue":P[4]||(P[4]=D=>h.value=D),type:"password",id:"login-password",placeholder:"Password",required:""},null,512),[[Un,h.value]]),F(ae,{type:"submit",customClass:"submit-button",disabled:l.value},{default:Z(()=>[ne(De(l.value?"Logging In...":"Login"),1)]),_:1},8,["disabled"])],32)),Y(r)?($(),W("div",V5,[P[9]||(P[9]=w("p",{style:{padding:"0",margin:"0.4vw"}},"Logged in!",-1)),w("h3",F5,De(Y(i)),1),w("p",B5,De(Y(o)),1),Y(s).isVerified?de("",!0):($(),W("div",$5,P[6]||(P[6]=[w("p",null,"You are not verified!",-1),w("a",{href:"#"},"Resend verification?",-1),w("p",null,"Put the wrong email? You can change it in account:",-1)]))),F(ae,{class:"controls",isRouter:"",to:"/account"},{default:Z(()=>P[7]||(P[7]=[ne("Account")])),_:1}),F(ae,{class:"controls",onClick:v},{default:Z(()=>P[8]||(P[8]=[ne("Logout")])),_:1})])):de("",!0),f.value?($(),W("p",U5,De(p.value),1)):de("",!0),l.value?($(),W("img",j5)):de("",!0)]),Y(r)?de("",!0):($(),W("div",z5,[P[11]||(P[11]=w("span",null,"Don't have an account? Create one!",-1)),F(ae,{onClick:I,id:"signup-button",class:"nav-button"},{default:Z(()=>P[10]||(P[10]=[ne("Sign Up")])),_:1})]))]),_:1})):de("",!0)]),_:1})],64))}},nr=yt(H5,[["__scopeId","data-v-0809ccc5"]]),W5="/assets/clouds-DwLUdGDO.gif",q5={},K5={class:"clouds",src:W5};function G5(n,e){return $(),W("img",K5)}const Do=yt(q5,[["render",G5]]),Q5={__name:"Tooltip",props:{content:{type:String,required:!0},disabled:{type:Boolean,default:!1},position:{type:String,default:"top"}},setup(n){const e=n,t=G(!1),s=G(0),r=G(0),i=G(null),o=h=>{e.disabled&&(t.value=!0,Mi(()=>{a(h.clientX,h.clientY)}))},a=(h,f)=>{let m=h+15,_=f+15;const v=window.innerWidth||document.documentElement.clientWidth,I=window.innerHeight||document.documentElement.clientHeight;if(i.value){const O=i.value.offsetWidth,P=i.value.offsetHeight;m<0&&(m=15),m+O>v&&(m=h-O-15,m<0&&(m=v-O-15,m<0&&(m=0))),_<0&&(_=15),_+P>I&&(_=f-P-15,_<0&&(_=I-P-15,_<0&&(_=0)))}s.value=m,r.value=_},l=h=>{t.value&&a(h.clientX,h.clientY)},c=()=>{t.value=!1},u=et(()=>({position:"fixed",left:`${s.value}px`,top:`${r.value}px`}));return(h,f)=>($(),W("div",{class:"tooltip-wrapper",onMouseenter:o,onMouseleave:c,onMousemove:l},[so(h.$slots,"default",{},void 0),F(iu,{name:"tooltip-fade"},{default:Z(()=>[t.value?($(),W("div",{key:0,class:"tooltip-content",style:Jd(u.value),ref_key:"contentRef",ref:i},De(n.content),5)):de("",!0)]),_:1})],32))}},Oh=yt(Q5,[["__scopeId","data-v-ba1a89b2"]]),J5="/assets/periodical_logo_2-DiKawi0e.png",ep="/assets/periodical_logo-D2i1vkZD.png",Y5="/assets/shop-CHULmh5_.png",X5="/assets/bansheebutton1-CQ7D7oK7.png",Z5=Object.freeze(Object.defineProperty({__proto__:null,default:X5},Symbol.toStringTag,{value:"Module"})),eH="/assets/bansheebutton2-D3Mwor_k.png",tH=Object.freeze(Object.defineProperty({__proto__:null,default:eH},Symbol.toStringTag,{value:"Module"})),nH="/assets/buttonbackground-DLg9ljaF.gif",sH=Object.freeze(Object.defineProperty({__proto__:null,default:nH},Symbol.toStringTag,{value:"Module"})),rH="/assets/dreambutton1-Ny24-FVD.png",iH=Object.freeze(Object.defineProperty({__proto__:null,default:rH},Symbol.toStringTag,{value:"Module"})),oH="/assets/dreambutton2-Cgqmnf2Z.png",aH=Object.freeze(Object.defineProperty({__proto__:null,default:oH},Symbol.toStringTag,{value:"Module"})),lH="/assets/superkidbutton2-D62iNZ10.png",cH=Object.freeze(Object.defineProperty({__proto__:null,default:lH},Symbol.toStringTag,{value:"Module"})),uH="/assets/superkidbuttonopen2-BP3vgxm1.png",hH=Object.freeze(Object.defineProperty({__proto__:null,default:uH},Symbol.toStringTag,{value:"Module"})),wT=Object.assign({"../assets/images/zine_buttons/bansheebutton1.png":Z5,"../assets/images/zine_buttons/bansheebutton2.png":tH,"../assets/images/zine_buttons/buttonbackground.gif":sH,"../assets/images/zine_buttons/dreambutton1.png":iH,"../assets/images/zine_buttons/dreambutton2.png":aH,"../assets/images/zine_buttons/exploreButton.png":s5,"../assets/images/zine_buttons/superkidbutton2.png":cH,"../assets/images/zine_buttons/superkidbuttonopen2.png":hH}),Cn=Ka({});for(const n in wT){const e=n.split("/").pop().replace(/\.(png|jpg|jpeg|gif|webp)$/,"");Cn[e]=wT[n].default}const dH={class:"home"},fH={class:"page-content"},pH={class:"links"},mH={class:"middle-buttons"},gH=["src"],_H=["src"],yH={class:"explore"},vH={class:"explore-buttons"},bH=["src"],wH=["src"],EH=["src"],TH={class:"social"},SH={class:"social-buttons"},IH={__name:"Home",setup(n){const e=Nr();Xs(()=>{console.log(Cn.superkidbutton2)});const t=Zf(),s=async r=>{await t.push({name:"explore"}),setTimeout(()=>{const i=document.getElementById(r);i&&i.scrollIntoView({behavior:"smooth"})},150)};return(r,i)=>($(),W("div",dH,[F(ps),F(xr),F(nr),F(Do),w("div",fH,[w("div",pH,[F(ae,{isRouter:"",isImage:"",to:"/questions",id:"question"},{default:Z(()=>i[3]||(i[3]=[w("img",{id:"advice",src:Sv,alt:""},null,-1)])),_:1}),F(Oh,{content:"Subscribe to the Periodical to read the Weekly-ish Banshee!",disabled:!Y(e).subscribed},{default:Z(()=>[F(ae,{isRouter:"",isImage:"",to:"/weekly",id:"weekly-ish",disabled:!Y(e).subscribed},{default:Z(()=>i[4]||(i[4]=[w("img",{id:"weekly",src:XR,alt:""},null,-1)])),_:1},8,["disabled"])]),_:1},8,["disabled"])]),i[10]||(i[10]=w("img",{class:"eye",src:n5},null,-1)),w("div",mH,[F(ae,{isRouter:"",to:"/periodical",class:"periodical",isImage:"",isHover:"",src:Y(J5),hoverSrc:Y(ep)},{default:Z(({currentSrc:o})=>[w("img",{src:o},null,8,gH)]),_:1},8,["src","hoverSrc"]),F(ae,{isRouter:"",to:"/shop",isImage:"",class:"shop"},{default:Z(()=>[w("img",{src:Y(Y5)},null,8,_H)]),_:1})]),F(Do),w("div",yH,[F(ae,{isRouter:"",to:"/explore",isImage:""},{default:Z(()=>i[5]||(i[5]=[w("img",{src:Iv,alt:""},null,-1)])),_:1}),w("div",vH,[F(ae,{onClick:i[0]||(i[0]=o=>s("banshee-section")),isImage:"",isHover:"",src:Y(Cn).bansheebutton1,hoverSrc:Y(Cn).bansheebutton2},{default:Z(({currentSrc:o})=>[w("img",{src:o},null,8,bH)]),_:1},8,["src","hoverSrc"]),F(ae,{onClick:i[1]||(i[1]=o=>s("dream-section")),isImage:"",isHover:"",src:Y(Cn).dreambutton1,hoverSrc:Y(Cn).dreambutton2},{default:Z(({currentSrc:o})=>[w("img",{src:o},null,8,wH)]),_:1},8,["src","hoverSrc"]),F(ae,{onClick:i[2]||(i[2]=o=>s("superkid-section")),isImage:"",isHover:"",src:Y(Cn).superkidbutton2,hoverSrc:Y(Cn).superkidbuttonopen2},{default:Z(({currentSrc:o})=>[w("img",{src:o},null,8,EH)]),_:1},8,["src","hoverSrc"])])]),w("div",TH,[i[9]||(i[9]=w("img",{src:r5,class:"superKidSpeach"},null,-1)),w("div",SH,[F(ae,{isImage:""},{default:Z(()=>i[6]||(i[6]=[w("img",{src:i5,onclick:"window.open('https://www.instagram.com/oneeyedsuperkid/', '_blank')"},null,-1),w("a",null,"Instagram",-1)])),_:1}),F(ae,{isImage:""},{default:Z(()=>i[7]||(i[7]=[w("img",{src:o5,onclick:"window.open('https://www.youtube.com/@oneeyedsuperkid', '_blank')"},null,-1),w("a",null,"YouTube",-1)])),_:1}),F(ae,{isImage:""},{default:Z(()=>i[8]||(i[8]=[w("img",{src:a5,onclick:"window.open('https://www.etsy.com/shop/Oneeyedsuperkid', '_blank')"},null,-1),w("a",null,"ETSY Shop",-1)])),_:1})])])])]))}},CH=yt(IH,[["__scopeId","data-v-b7a86615"]]),kH={__name:"HomeView",setup(n){return(e,t)=>($(),W("main",null,[F(CH)]))}},AH="/assets/superKidHeader-CyQXXct2.png",RH="/assets/superWalk-CCEtF_be.gif",PH="/assets/superKidMP3s-DGjl4zgd.png",xH="/assets/originOfSuperKid-DTo7TmQo.png",NH="/assets/superkidminizine1-DGzE4Jak.png",ZR="/assets/back_button-TGJvmQ_9.png",eP="/assets/next_button-CPH3Q98R.png",OH="/assets/bookClosed-B7XfwFvj.png",MH="/assets/shadowBansheeHeader-B0ZiVSDc.png",DH="/assets/door1-DOMBN4IF.png",LH="/assets/twisty-BdckC9Re.gif",VH="/assets/dreamWalkerHeader-BqSZ5l44.png",FH="/assets/nimWalk-CeMx1T0I.gif",BH={id:"top",class:"home"},$H={class:"page-content"},UH={class:"explore"},jH={class:"explore-buttons"},zH=["src"],HH=["src"],WH=["src"],qH={id:"superkid-section",class:"section"},KH={id:"comic"},GH={class:"navigation-buttons"},QH={id:"banshee-section",class:"section"},JH={__name:"Explore",setup(n){const e=G(!1);function t(){e.value=window.scrollY>20}Xs(()=>{console.log(Cn.superkidbutton2),window.addEventListener("scroll",t)}),S_(()=>{window.removeEventListener("scroll",t)});function s(r){const i=document.getElementById(r);i&&i.scrollIntoView({behavior:"smooth"})}return(r,i)=>($(),W("div",BH,[F(ps),F(xr),F(nr),F(Do),w("div",$H,[w("div",UH,[F(ae,{isImage:""},{default:Z(()=>i[4]||(i[4]=[w("img",{src:Iv,alt:""},null,-1)])),_:1}),w("div",jH,[F(ae,{onClick:i[0]||(i[0]=o=>s("banshee-section")),isImage:"",isHover:"",src:Y(Cn).bansheebutton1,hoverSrc:Y(Cn).bansheebutton2},{default:Z(({currentSrc:o})=>[w("img",{src:o},null,8,zH)]),_:1},8,["src","hoverSrc"]),F(ae,{onClick:i[1]||(i[1]=o=>s("dream-section")),isImage:"",isHover:"",src:Y(Cn).dreambutton1,hoverSrc:Y(Cn).dreambutton2},{default:Z(({currentSrc:o})=>[w("img",{src:o},null,8,HH)]),_:1},8,["src","hoverSrc"]),F(ae,{onClick:i[2]||(i[2]=o=>s("superkid-section")),isImage:"",isHover:"",src:Y(Cn).superkidbutton2,hoverSrc:Y(Cn).superkidbuttonopen2},{default:Z(({currentSrc:o})=>[w("img",{src:o},null,8,WH)]),_:1},8,["src","hoverSrc"])])]),w("div",qH,[i[11]||(i[11]=w("img",{class:"superKidHeader",src:AH,alt:""},null,-1)),i[12]||(i[12]=w("img",{class:"superWalk",src:RH,alt:""},null,-1)),i[13]||(i[13]=w("img",{class:"mp3s",src:PH,alt:""},null,-1)),F(ae,{isImage:"",class:"origin",onclick:"window.location.href='periodical'"},{default:Z(()=>i[5]||(i[5]=[w("img",{src:xH},null,-1)])),_:1}),w("div",KH,[F(ae,{isImage:"",id:"close",onclick:"closeComic()"},{default:Z(()=>i[6]||(i[6]=[ne("X")])),_:1}),i[9]||(i[9]=w("img",{id:"comicPage",src:NH,alt:""},null,-1)),w("div",GH,[F(ae,{isImage:"",id:"prevBtn",onclick:"prevPage()"},{default:Z(()=>i[7]||(i[7]=[w("img",{src:ZR,alt:""},null,-1)])),_:1}),F(ae,{isImage:"",id:"nextBtn",onclick:"nextPage()"},{default:Z(()=>i[8]||(i[8]=[w("img",{src:eP,alt:""},null,-1)])),_:1})])]),F(ae,{isImage:"",id:"book",onclick:"comic()"},{default:Z(()=>i[10]||(i[10]=[w("img",{id:"bookImage",src:OH,alt:""},null,-1),w("span",{id:"bookDots"},null,-1)])),_:1}),i[14]||(i[14]=w("a",{href:"https://www.instagram.com/oneeyedsuperkid/",target:"_blank",rel:"noopener"},"@Oneeyedsuperkid",-1))]),w("div",QH,[i[17]||(i[17]=w("img",{id:"bansheeHeader",src:MH},null,-1)),F(ae,{isImage:"",id:"advice",onclick:"window.location.href='questions'"},{default:Z(()=>i[15]||(i[15]=[w("img",{src:Sv},null,-1)])),_:1}),i[18]||(i[18]=w("div",{id:"door"},[w("img",{id:"doorImage",src:DH})],-1)),i[19]||(i[19]=w("img",{id:"twisty",src:LH},null,-1)),F(ae,{isImage:"",id:"periodical",onclick:"window.location.href='periodical'"},{default:Z(()=>i[16]||(i[16]=[w("img",{src:ep},null,-1)])),_:1}),i[20]||(i[20]=w("a",{href:"https://www.instagram.com/theshadowbanshee/",target:"_blank",rel:"noopener"},"@TheShadowBanshee",-1))]),i[21]||(i[21]=w("div",{id:"dream-section",class:"section"},[w("img",{class:"dreamWalkerHeader",src:VH,alt:""}),w("img",{class:"nimWalk",src:FH,alt:""}),w("a",{href:"https://www.instagram.com/the.dream.engine/",target:"_blank",rel:"noopener"},"@the.dream.engine")],-1)),nn(w("div",{onClick:i[3]||(i[3]=o=>s("top")),id:"backToTopBtn",title:"Back to Top"},"Back to Top",512),[[NM,e.value]])])]))}},YH=yt(JH,[["__scopeId","data-v-fc5fce1a"]]),XH={__name:"ExploreView",setup(n){return(e,t)=>($(),W("main",null,[F(YH)]))}},ZH="/assets/sub%20button-CWTceMcp.png",eW="/assets/arrow-C6oKTRzP.png",tP="/assets/page1-BtCacEgF.png",fm="/assets/Read%20me-OeEO9g6S.png",nP="/assets/page1-oKgvb96s.png",sP="/assets/page1-Cs7gSOSs.png",rP="data:image/svg+xml,%3csvg%20id='Layer_1'%20data-name='Layer%201'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20150%2034'%3e%3cdefs%3e%3cstyle%3e.cls-1{fill:%23fff;}%3c/style%3e%3c/defs%3e%3ctitle%3ePowered%20by%20Stripe%20-%20white%3c/title%3e%3cpath%20class='cls-1'%20d='M146,0H3.73A3.73,3.73,0,0,0,0,3.73V30.27A3.73,3.73,0,0,0,3.73,34H146a4,4,0,0,0,4-4V4A4,4,0,0,0,146,0Zm3,30a3,3,0,0,1-3,3H3.73A2.74,2.74,0,0,1,1,30.27V3.73A2.74,2.74,0,0,1,3.73,1H146a3,3,0,0,1,3,3Z'/%3e%3cpath%20class='cls-1'%20d='M17.07,11.24h-4.3V22h1.92V17.84h2.38c2.4,0,3.9-1.16,3.9-3.3S19.47,11.24,17.07,11.24Zm-.1,5H14.69v-3.3H17c1.38,0,2.11.59,2.11,1.65S18.35,16.19,17,16.19Z'/%3e%3cpath%20class='cls-1'%20d='M25.1,14a3.77,3.77,0,0,0-3.8,4.09,3.81,3.81,0,1,0,7.59,0A3.76,3.76,0,0,0,25.1,14Zm0,6.67c-1.22,0-2-1-2-2.58s.76-2.58,2-2.58,2,1,2,2.58S26.31,20.66,25.1,20.66Z'/%3e%3cpolygon%20class='cls-1'%20points='36.78%2019.35%2035.37%2014.13%2033.89%2014.13%2032.49%2019.35%2031.07%2014.13%2029.22%2014.13%2031.59%2022.01%2033.15%2022.01%2034.59%2016.85%2036.03%2022.01%2037.59%2022.01%2039.96%2014.13%2038.18%2014.13%2036.78%2019.35'/%3e%3cpath%20class='cls-1'%20d='M44,14a3.83,3.83,0,0,0-3.75,4.09,3.79,3.79,0,0,0,3.83,4.09A3.47,3.47,0,0,0,47.49,20L46,19.38a1.78,1.78,0,0,1-1.83,1.26A2.12,2.12,0,0,1,42,18.47h5.52v-.6C47.54,15.71,46.32,14,44,14Zm-1.93,3.13A1.92,1.92,0,0,1,44,15.5a1.56,1.56,0,0,1,1.69,1.62Z'/%3e%3cpath%20class='cls-1'%20d='M50.69,15.3V14.13h-1.8V22h1.8V17.87a1.89,1.89,0,0,1,2-2,4.68,4.68,0,0,1,.66,0v-1.8c-.14,0-.3,0-.51,0A2.29,2.29,0,0,0,50.69,15.3Z'/%3e%3cpath%20class='cls-1'%20d='M57.48,14a3.83,3.83,0,0,0-3.75,4.09,3.79,3.79,0,0,0,3.83,4.09A3.47,3.47,0,0,0,60.93,20l-1.54-.59a1.78,1.78,0,0,1-1.83,1.26,2.12,2.12,0,0,1-2.1-2.17H61v-.6C61,15.71,59.76,14,57.48,14Zm-1.93,3.13a1.92,1.92,0,0,1,1.92-1.62,1.56,1.56,0,0,1,1.69,1.62Z'/%3e%3cpath%20class='cls-1'%20d='M67.56,15a2.85,2.85,0,0,0-2.26-1c-2.21,0-3.47,1.85-3.47,4.09s1.26,4.09,3.47,4.09a2.82,2.82,0,0,0,2.26-1V22h1.8V11.24h-1.8Zm0,3.35a2,2,0,0,1-2,2.28c-1.31,0-2-1-2-2.52s.7-2.52,2-2.52c1.11,0,2,.81,2,2.29Z'/%3e%3cpath%20class='cls-1'%20d='M79.31,14A2.88,2.88,0,0,0,77,15V11.24h-1.8V22H77v-.83a2.86,2.86,0,0,0,2.27,1c2.2,0,3.46-1.86,3.46-4.09S81.51,14,79.31,14ZM79,20.6a2,2,0,0,1-2-2.28v-.47c0-1.48.84-2.29,2-2.29,1.3,0,2,1,2,2.52S80.25,20.6,79,20.6Z'/%3e%3cpath%20class='cls-1'%20d='M86.93,19.66,85,14.13H83.1L86,21.72l-.3.74a1,1,0,0,1-1.14.79,4.12,4.12,0,0,1-.6,0v1.51a4.62,4.62,0,0,0,.73.05,2.67,2.67,0,0,0,2.78-2l3.24-8.62H88.82Z'/%3e%3cpath%20class='cls-1'%20d='M125,12.43a3,3,0,0,0-2.13.87l-.14-.69h-2.39V25.53l2.72-.59V21.81a3,3,0,0,0,1.93.7c1.94,0,3.72-1.59,3.72-5.11C128.71,14.18,126.91,12.43,125,12.43Zm-.65,7.63a1.61,1.61,0,0,1-1.28-.52l0-4.11a1.64,1.64,0,0,1,1.3-.55c1,0,1.68,1.13,1.68,2.58S125.36,20.06,124.35,20.06Z'/%3e%3cpath%20class='cls-1'%20d='M133.73,12.43c-2.62,0-4.21,2.26-4.21,5.11,0,3.37,1.88,5.08,4.56,5.08a6.12,6.12,0,0,0,3-.73V19.64a5.79,5.79,0,0,1-2.7.62c-1.08,0-2-.39-2.14-1.7h5.38c0-.15,0-.74,0-1C137.71,14.69,136.35,12.43,133.73,12.43Zm-1.47,4.07c0-1.26.77-1.79,1.45-1.79s1.4.53,1.4,1.79Z'/%3e%3cpath%20class='cls-1'%20d='M113,13.36l-.17-.82h-2.32v9.71h2.68V15.67a1.87,1.87,0,0,1,2.05-.58V12.54A1.8,1.8,0,0,0,113,13.36Z'/%3e%3cpath%20class='cls-1'%20d='M99.46,15.46c0-.44.36-.61.93-.61a5.9,5.9,0,0,1,2.7.72V12.94a7,7,0,0,0-2.7-.51c-2.21,0-3.68,1.18-3.68,3.16,0,3.1,4.14,2.6,4.14,3.93,0,.52-.44.69-1,.69a6.78,6.78,0,0,1-3-.9V22a7.38,7.38,0,0,0,3,.64c2.26,0,3.82-1.15,3.82-3.16C103.62,16.12,99.46,16.72,99.46,15.46Z'/%3e%3cpath%20class='cls-1'%20d='M107.28,10.24l-2.65.58v8.93a2.77,2.77,0,0,0,2.82,2.87,4.16,4.16,0,0,0,1.91-.37V20c-.35.15-2.06.66-2.06-1V15h2.06V12.66h-2.06Z'/%3e%3cpolygon%20class='cls-1'%20points='116.25%2011.7%20118.98%2011.13%20118.98%208.97%20116.25%209.54%20116.25%2011.7'/%3e%3crect%20class='cls-1'%20x='116.25'%20y='12.61'%20width='2.73'%20height='9.64'/%3e%3c/svg%3e",ET="/assets/selector-BSxkODtT.png",tW="/assets/cybertier1-vhvkFvcB.png",nW="/assets/interdimensionaldelivery1-D8G9Vp5T.png",sW="/assets/page7-ommuB3bR.png",rW="/assets/page2-Dc9pNhXj.png",iW="/assets/page3-Db2kBeVV.png",oW="/assets/page4-CSILi9vR.png",aW="/assets/page5-4WeDlJya.png",lW="/assets/page6-CIszwRxD.png",cW="/assets/page7-ommuB3bR.png",uW="/assets/page8-CzJ7Klze.png",hW="/assets/page6-CIszwRxD.png",dW="/assets/page2-DoRb4UXK.png",fW="/assets/page3-CPvNMudV.png",pW="/assets/page4-BrPStMfj.png",mW="/assets/page5-CqJAX7YD.png",gW="/assets/page6-CElJaWQ6.png",_W="/assets/page7-CD147GSv.png",yW="/assets/page2-imu3TQM-.png",vW="/assets/page3-B0hLFbCW.png",bW="/assets/page4-CYIHZkzZ.png",wW="/assets/page5-cN6vNMWQ.png",EW="/assets/page6-Emx2fjl9.png",TW="/assets/page7-CaMNAfrj.png",SW={id:"page"},IW={class:"page-content"},CW=["src"],kW={__name:"Book",props:{bookId:{type:[String,Number],default:null}},emits:["close"],setup(n,{emit:e}){const t=n,s=e,r=G([]),i=G(0),o=G(0);Xs(()=>{t.bookId===1?(console.log("book open: ",t.bookId),r.value=u(a),i.value=r.value.length):t.bookId===2?(console.log("book open: ",t.bookId),r.value=u(l),i.value=r.value.length):t.bookId===3&&(console.log("book open: ",t.bookId),r.value=u(c),i.value=r.value.length)});const a=Object.assign({"/src/assets/images/periodical/TSBP1/page1.png":tP,"/src/assets/images/periodical/TSBP1/page10.png":sW,"/src/assets/images/periodical/TSBP1/page2.png":rW,"/src/assets/images/periodical/TSBP1/page3.png":iW,"/src/assets/images/periodical/TSBP1/page4.png":oW,"/src/assets/images/periodical/TSBP1/page5.png":aW,"/src/assets/images/periodical/TSBP1/page6.png":lW,"/src/assets/images/periodical/TSBP1/page7.png":cW,"/src/assets/images/periodical/TSBP1/page8.png":uW,"/src/assets/images/periodical/TSBP1/page9.png":hW}),l=Object.assign({"/src/assets/images/periodical/TSBP2/page1.png":nP,"/src/assets/images/periodical/TSBP2/page2.png":dW,"/src/assets/images/periodical/TSBP2/page3.png":fW,"/src/assets/images/periodical/TSBP2/page4.png":pW,"/src/assets/images/periodical/TSBP2/page5.png":mW,"/src/assets/images/periodical/TSBP2/page6.png":gW,"/src/assets/images/periodical/TSBP2/page7.png":_W}),c=Object.assign({"/src/assets/images/periodical/TSBP3/page1.png":sP,"/src/assets/images/periodical/TSBP3/page2.png":yW,"/src/assets/images/periodical/TSBP3/page3.png":vW,"/src/assets/images/periodical/TSBP3/page4.png":bW,"/src/assets/images/periodical/TSBP3/page5.png":wW,"/src/assets/images/periodical/TSBP3/page6.png":EW,"/src/assets/images/periodical/TSBP3/page7.png":TW});function u(m){return Object.entries(m).sort(([_],[v])=>{var P,D;const I=parseInt(((P=_.match(/page(\d+)/))==null?void 0:P[1])||"0",10),O=parseInt(((D=v.match(/page(\d+)/))==null?void 0:D[1])||"0",10);return I-O}).map(([_,v])=>v)}function h(){console.log("clicked!"),o.value<i.value-1&&o.value++,console.log(i.value-1),console.log(o.value)}function f(){console.log("clicked!"),o.value>0&&o.value--}const p=()=>{console.log("Closing book..."),r.value=[],i.value=0,o.value=0,s("close")};return(m,_)=>($(),bt(Qs,{isOverlay:"",customClass:"",id:"book-modal"},{default:Z(()=>[F(ae,{isX:"",onClick:p}),w("div",SW,[F(ae,{onClick:f,id:"prev",class:"navigate",isImage:""},{default:Z(()=>_[0]||(_[0]=[w("img",{src:ZR,alt:""},null,-1)])),_:1}),w("div",IW,[w("img",{src:r.value[o.value],alt:""},null,8,CW)]),F(ae,{onClick:h,id:"next",class:"navigate",isImage:""},{default:Z(()=>_[1]||(_[1]=[w("img",{src:eP,alt:""},null,-1)])),_:1})])]),_:1}))}},AW=yt(kW,[["__scopeId","data-v-c2b4ee76"]]);function iP(){const n=Nr(),e=G(!1);et(()=>n.subscription==="free");const t=G(3),s=G(300),r=G(!1),i=G(null);function o(){if(e.value){i.value=null,r.value=!1;return}else i.value=null,r.value=!1,t.value<3?(t.value=3,r.value=!0,i.value="The price for snail-mail is at least $3.00!"):t.value>10?(t.value=10,r.value=!0,i.value="The max price is $10.00! For now ;)"):(s.value=parseFloat(t.value)*100,console.log("Amount updated on blur:",s.value))}return js(t,function(){let a=String(t.value).replace(/[^0-9]/g,"");a==="10"?t.value="10":a.length>=1&&(t.value=a.slice(-1)),s.value=parseFloat(t.value)*100,console.log("Amount updated:",s.value)}),{input:t,amount:s,amount_error:r,amount_message:i,free_selected:e,doAmount:o}}var oP="basil",RW=function(e){return e===3?"v3":e},aP="https://js.stripe.com",PW="".concat(aP,"/").concat(oP,"/stripe.js"),xW=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,NW=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var OW=function(e){return xW.test(e)||NW.test(e)},MW=function(){for(var e=document.querySelectorAll('script[src^="'.concat(aP,'"]')),t=0;t<e.length;t++){var s=e[t];if(OW(s.src))return s}return null},TT=function(e){var t="",s=document.createElement("script");s.src="".concat(PW).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(s),s},DW=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"7.3.0",startTime:t})},Ol=null,lh=null,ch=null,LW=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},VW=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},FW=function(e){return Ol!==null?Ol:(Ol=new Promise(function(t,s){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var r=MW();if(!(r&&e)){if(!r)r=TT(e);else if(r&&ch!==null&&lh!==null){var i;r.removeEventListener("load",ch),r.removeEventListener("error",lh),(i=r.parentNode)===null||i===void 0||i.removeChild(r),r=TT(e)}}ch=VW(t,s),lh=LW(s),r.addEventListener("load",ch),r.addEventListener("error",lh)}catch(o){s(o);return}}),Ol.catch(function(t){return Ol=null,Promise.reject(t)}))},BW=function(e,t,s){if(e===null)return null;var r=t[0],i=r.match(/^pk_test/),o=RW(e.version),a=oP;i&&o!==a&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("7.3.0"," expected Stripe.js@").concat(a,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var l=e.apply(void 0,t);return DW(l,s),l},Ml,lP=!1,cP=function(){return Ml||(Ml=FW(null).catch(function(e){return Ml=null,Promise.reject(e)}),Ml)};Promise.resolve().then(function(){return cP()}).catch(function(n){lP||console.warn(n)});var $W=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];lP=!0;var r=Date.now();return cP().then(function(i){return BW(i,t,r)})};const Dl="http://127.0.0.1:5001/shadowbanshee-79c70/us-central1/api",uP=ou("stripe",()=>{const n=G(null),e=G(null),t=G(null),s=G(null),r=G(null);async function i(){try{const m=await o();n.value=m,e.value=await $W(m)}catch(m){console.error("Failed to initialize Stripe:",m)}}async function o(){const m=await fetch(`${Dl}/stripe-public-key`);if(!m.ok)throw new Error("Network response was not ok");return(await m.json()).publicKey}async function a(m){const _=await fetch(`${Dl}/create-payment-intent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:m,currency:"usd",paymentMethodType:"card"})});if(!_.ok){const I=await _.text();throw new Error("Failed to retrieve client secret: "+I)}const{clientSecret:v}=await _.json();if(!v)throw new Error("Failed to retrieve client secret");return v}async function l(m,_,v){if(!e.value)throw new Error("Stripe not initialized");t.value=e.value.elements({clientSecret:m}),_&&(s.value=t.value.create("address",{mode:"shipping"}),s.value.mount(_)),r.value=t.value.create("payment"),r.value.mount(v)}async function c(){if(console.log("paying..."),!e.value||!t.value)throw new Error("Stripe not ready");const{error:m}=await e.value.confirmPayment({elements:t.value,confirmParams:{},redirect:"if_required"});return m?{success:!1,error:m.message}:{success:!0}}async function u(m,_){if(!m)return{success:!1,error:"Email is required"};console.log("Name:",_);const v=await fetch(`${Dl}/create-customer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:m,name:_})});if(!v.ok){let O;try{O=await v.json()}catch{throw new Error(`HTTP Error: ${v.status} ${v.statusText}`)}const P=O.error||O.message||`Server error with status ${v.status}`;throw new Error(P)}const I=await v.json();return I.success&&I.customer?{success:!0,customer:I.customer}:{success:!1,error:`${I.error}
 ${I.message}`||"Stripe returned no customer."}}async function h(m,_,v){try{if(!(await fetch(`${Dl}/update-customer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:m,address:_,name:v})})).ok)throw new Error("Failed to update Stripe customer");return!0}catch(I){return console.error("UpdateCustomer failed:",I),!1}}async function f(m,_){console.log("Customer data:",_),console.log("amount:",m);try{const v=await fetch(`${Dl}/create-subscription`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({unit_amount:m,customer:_})});if(!v.ok)throw new Error(`Failed to create sub: ${v.statusText}`);const I=await v.json();return I.success&&I.subscriptionId?{success:!0,subscriptionId:I.subscriptionId,clientSecret:I.clientSecret}:{success:!1,error:"Invalid subscription data returned"}}catch(v){console.error("Error during customer creation:",v)}}async function p(){if(!s.value)return null;const m=await s.value.getValue();return m.complete?m.value:null}return{publicKey:n,stripe:e,InitStripe:i,FetchStripePublicKey:o,FetchClientSecret:a,MountElements:l,ConfirmPayment:c,CreateCustomer:u,UpdateCustomer:h,Subscribe:f,GetAddress:p}}),UW={class:"home"},jW={class:"page-content"},zW={class:"center"},HW={id:"flex-container"},WW={class:"left button-hover"},qW={class:"right"},KW={class:"top-right"},GW={id:"top-right-left"},QW={id:"top-right-right"},JW={class:"bottom-right"},YW={class:"bottom-right-container"},XW={key:0,class:"login-prompt modal-content"},ZW={key:1,class:"login-prompt modal-content"},eq={key:2,id:"subscription-area",class:"modal-content"},tq={key:0},nq={key:1,id:"subscription-form"},sq={id:"subscription-box"},rq={class:"subscription-options button-hover"},iq={key:0,id:"input-area"},oq={key:0,id:"amount-message"},aq={key:1},lq={key:0,id:"free-description",class:"description"},cq={key:1,id:"snail-description",class:"description"},uq={id:"payment"},hq={key:2,id:"error-message"},dq={key:3,id:"loading-indicator"},fq={__name:"Periodical",setup(n){const e=uP(),t=G(0),s=G(!1),r=k=>{t.value=k,s.value=!0,console.log(`Requesting Comic: ${k}`),console.log(`is Comic?: ${s.value}`)},i=()=>{t.value=null,s.value=!1};function o(k){const b=document.getElementById(k);b&&b.scrollIntoView({behavior:"smooth"})}const a=G(null),l=G(null),c=G(null),u=G("start"),h=Nr(),f=G(!1),p=G(null),m=G(null),_=G("null"),v=G(null),{input:I,amount:O,amount_error:P,amount_message:D,free_selected:B,doAmount:M}=iP();async function A(){if(console.log("clicked,",B.value,I.value),u.value="confirm",m.value=null,B.value&&O.value===0){console.log("free_selected! & free amount!");return}else if(B.value===!1&&O.value<300){console.log("no!");return}else await k();async function k(){f.value=!0,e.InitStripe();try{const b=await e.CreateCustomer(h.userEmail);if(b.success){_.value=b.customer.id,console.log("Customer created successfully:",_.value);const ye=await e.Subscribe(O.value,_.value);if(ye.success)p.value=ye.clientSecret,v.value=ye.subscriptionId,console.log("Subscription created successfully:",ye.subscriptionId,ye.clientSecret,p.value),B.value?await e.MountElements(p.value,c.value):await e.MountElements(p.value,l.value,c.value);else{m.value=ye.error||"Failed to create subscription.",console.error("Failed to create subscription:",ye.error);return}}else{m.value=`Error: ${b.error}`||"Failed to create customer.",console.error("Failed to create customer.",b.error);return}}catch(b){m.value=`Unexpected error: (Not supposed to happen!) ${b.message}`||"An unexpected error occurred during payment setup.",console.error("Error setting up payment:",b.message)}finally{f.value=!1}}}async function T(){if(f.value=!0,await Mi(),o("loading-indicator"),m.value=null,B.value&&O.value===0){console.log("free_selected! & free amount!"),await h.Subscribe(B.value),u.value="done";return}else if(B.value===!1&&O.value<300){console.log("no!");return}else if(await e.ConfirmPayment()){let b=!1,ye=null,Ve=!1;try{B.value||(ye=await e.GetAddress(),console.log("Address:",ye.address)),b=await h.UpdateProfile({subscribed:!0,subscription:B.value?"free":"snail-mail",subscriptionId:v.value,customerId:_.value,donationAmount:O.value,...ye&&{address:ye.address,name:ye.name}})}catch(We){console.error("Error updating customer:",We),console.error("Failed to update profile")}if(b){try{Ve=await e.UpdateCustomer(_.value,ye.address,ye.name)}catch(We){console.error("Error updating Stripe customer:",We),console.error("Failed to update Stripe customer")}Ve?(console.log("Customer updated successfully"),u.value="done",l.value=null,c.value=null):console.error("Failed to update Stripe customer")}else console.error("Failed som ewhere!")}}const E=G(null),C=()=>{var k;(k=E.value)==null||k.doSignUp()},x=()=>{var k;(k=E.value)==null||k.toggleLogin()};return(k,b)=>{const ye=C_("RouterLink");return $(),W("div",UW,[F(ps),F(xr),F(nr,{ref_key:"login",ref:E},null,512),F(Do),s.value?($(),bt(AW,{key:0,bookId:t.value,onClose:i},null,8,["bookId"])):de("",!0),w("div",jW,[w("div",zW,[w("div",HW,[w("div",WW,[F(ae,{isImage:"",id:"periodical",onClick:b[0]||(b[0]=Ve=>o("subscription-area"))},{default:Z(()=>b[10]||(b[10]=[w("img",{src:ep,alt:""},null,-1),w("img",{id:"subButton",src:ZH,alt:""},null,-1),w("div",{class:"text2"},[w("p",null,[ne(" Sign up for the Shadow Banshee"),w("br"),ne(" Periodical Subscription! ")])],-1),w("img",{id:"arrow",src:eW,alt:""},null,-1)])),_:1})]),w("div",qW,[w("div",KW,[w("div",GW,[F(ae,{isRouter:"",isImage:"",to:"/questions",id:"question"},{default:Z(()=>b[11]||(b[11]=[w("img",{id:"advice",src:Sv,alt:""},null,-1),w("div",{class:"text"},[w("p",null,"Ask the Banshee questions!")],-1)])),_:1})]),w("div",QW,[F(Oh,{content:"Subscribe to the Periodical to read the Weekly-ish Banshee!",disabled:!Y(h).subscribed},{default:Z(()=>[F(ae,{isRouter:"",isImage:"",to:"/weekly",id:"weekly-ish",disabled:!Y(h).subscribed},{default:Z(()=>b[12]||(b[12]=[w("img",{id:"weekly",src:XR,alt:""},null,-1),w("div",{class:"text"},[w("p",{class:"text3"},"Weekly-ish Banshee!")],-1)])),_:1},8,["disabled"])]),_:1},8,["disabled"])])]),w("div",JW,[b[16]||(b[16]=w("p",{id:"read"},"Read the Shadow Banshee Periodical!",-1)),w("div",YW,[F(ae,{isImage:"",onClick:b[1]||(b[1]=Ve=>r(1)),id:"TSBP1",class:"card-container"},{default:Z(()=>b[13]||(b[13]=[w("img",{class:"card card-left",src:tP,alt:""},null,-1),w("img",{class:"readMe card-left",src:fm,alt:""},null,-1)])),_:1}),F(Oh,{content:"Subscribe to the Periodical to read TSBP2 or read TSBP1!",disabled:!Y(h).subscribed},{default:Z(()=>[F(ae,{isImage:"",onClick:b[2]||(b[2]=Ve=>r(2)),id:"TSBP2",class:"card-container",disabled:!Y(h).subscribed},{default:Z(()=>b[14]||(b[14]=[w("img",{class:"card card-middle",src:nP},null,-1),w("img",{class:"readMe card-middle",src:fm,alt:""},null,-1)])),_:1},8,["disabled"])]),_:1},8,["disabled"]),F(Oh,{content:"Subscribe to the Periodical to read TSBP3 or read TSBP1!",disabled:!Y(h).subscribed},{default:Z(()=>[F(ae,{isImage:"",onClick:b[3]||(b[3]=Ve=>r(3)),id:"TSBP3",class:"card-container",disabled:!Y(h).subscribed},{default:Z(()=>b[15]||(b[15]=[w("img",{class:"card card-right",src:sP},null,-1),w("img",{class:"readMe card-right",src:fm,alt:""},null,-1)])),_:1},8,["disabled"])]),_:1},8,["disabled"])])])])])]),b[55]||(b[55]=w("img",{class:"stripeImg",src:rP,style:{width:"12%","margin-left":"-32%"}},null,-1)),Y(h).isLoggedIn?Y(h).isVerified?Y(h).isLoggedIn?($(),W("div",eq,[Y(h).subscription==="snail-mail"?($(),W("div",tq,[b[24]||(b[24]=w("h3",null,"Congrats!",-1)),b[25]||(b[25]=w("p",null,"Thank you for subscribing to the Shadow Banshee Periodical,",-1)),b[26]||(b[26]=w("p",null,'"Interdimensional Delivery" teir!',-1)),b[27]||(b[27]=w("p",null,"You will get Periodical Content Mailed to you bi-monthly",-1)),b[28]||(b[28]=w("p",null," Including: Periodicals, Shadow Banshee Mini Zines, and Stickers! ",-1)),w("p",null,[b[23]||(b[23]=ne(" View digital content here, and in ")),F(ye,{to:"/weekly"},{default:Z(()=>b[22]||(b[22]=[ne("Weekly")])),_:1})])])):de("",!0),!Y(h).subscribed||Y(h).subscription!=="snail-mail"||!Y(h).isVerified?($(),W("div",nq,[b[37]||(b[37]=w("h2",null,"Subscribe to the Shadow Banshee Periodical!",-1)),b[38]||(b[38]=w("h3",{id:"subscription-type"},"Select a Subscription Type:",-1)),w("div",sq,[w("div",rq,[w("div",{class:is({border:Y(B)}),id:"free-information"},[b[30]||(b[30]=w("img",{id:"selector1",class:"selector",src:ET,alt:""},null,-1)),F(ae,{onClick:b[4]||(b[4]=()=>{B.value=!0,I.value=0,O.value=0,Y(M)()}),type:"button",isImage:"",class:"selection-images",id:"free-tier"},{default:Z(()=>b[29]||(b[29]=[w("img",{src:tW,alt:""},null,-1),w("h3",null,"FREE CYBER TIER",-1),w("h3",null,"DIGITAL SUBSCRIPTION",-1),w("p",{class:"information"}," YOU GET: DIGITAL ACCESS TO ALL PERIODICAL ISSUES Digital access to the weekly-ish banshee (Free or Pay what you can!) ",-1)])),_:1})],2),w("div",{class:is({border:!Y(B)}),id:"paid-information"},[b[32]||(b[32]=w("img",{id:"selector2",class:"selector",src:ET,alt:""},null,-1)),F(ae,{onClick:b[5]||(b[5]=Ve=>{B.value=!1,I.value=3,O.value=300,Y(M)()}),type:"button",isImage:"",class:"selection-images",id:"snail-mail"},{default:Z(()=>b[31]||(b[31]=[w("img",{src:nW},null,-1),w("h3",null,"INTERDIMENSIONAL DELIVERY",-1),w("h3",null,"SNAIL MAIL",-1),w("p",{id:"snail-info",class:"information"}," (Snail-mail subscription) You get: Everything in the cyber tier PLUS: Every new issue of TSB periodical in the mail! (Quarterly-ish) (along with healthy quantities of stickers + occasional mini zines sent at random) $3-10 monthly ",-1)])),_:1})],2)])]),!(Y(h).subscription==="free"&&Y(B))&&!(Y(h).subscription==="paid"&&!Y(B))?($(),W("div",iq,[b[34]||(b[34]=w("h3",null,"Choose your subscription amount!",-1)),b[35]||(b[35]=w("span",{id:"subscription-description"},null,-1)),b[36]||(b[36]=w("label",{for:"amount"},"Amount: $",-1)),nn(w("input",{onBlur:b[6]||(b[6]=(...Ve)=>Y(M)&&Y(M)(...Ve)),"onUpdate:modelValue":b[7]||(b[7]=Ve=>ut(I)?I.value=Ve:null),name:"amount",id:"amount",type:"number",min:"3",max:"10"},null,544),[[Un,Y(I)]]),F(ae,{onClick:A,id:"register-button",class:"nav-button"},{default:Z(()=>b[33]||(b[33]=[ne("Register")])),_:1}),Y(P)?($(),W("div",oq,De(Y(D)),1)):de("",!0)])):de("",!0),Y(h).subscription==="free"&&Y(B)?($(),W("div",aq," Already subscribed! Check out the Periodical or the Weekly, or upgrade to Snail Mail! ")):de("",!0)])):de("",!0)])):de("",!0):($(),W("div",ZW,b[21]||(b[21]=[w("span",null,"Make sure to verify your email to subscribe! Check your email, or resend verification!",-1)]))):($(),W("div",XW,[w("span",null,[F(ae,{style:{display:"inline"},onClick:x},{default:Z(()=>b[17]||(b[17]=[ne("Log in")])),_:1}),b[19]||(b[19]=ne(" or ")),F(ae,{style:{display:"inline"},onClick:C},{default:Z(()=>b[18]||(b[18]=[ne("create an account ")])),_:1}),b[20]||(b[20]=ne(" to subscribe!"))])])),u.value==="confirm"||u.value==="done"?($(),bt(Qs,{key:3,isOverlay:"",id:"checkout"},{default:Z(()=>[F(ae,{isX:"",onClick:b[8]||(b[8]=Ve=>u.value="start")}),u.value==="confirm"?($(),W(rt,{key:0},[b[42]||(b[42]=w("h2",null,"Subscribing to",-1)),b[43]||(b[43]=w("span",{id:"checkout-description"},null,-1)),b[44]||(b[44]=w("br",null,null,-1)),w("span",null,"Price: $"+De(Y(I)),1),Y(B)?($(),W("span",lq," With the Free Cyber Tier Subscription, you get updates from the Shadow Banshee to your Email Address! Plus, access to the quarterly-ish periodical, and the weekly-ish banshee archives! ")):de("",!0),Y(B)?de("",!0):($(),W("span",cq," With the Snail-Mail subscription, you get the Shadow Banshee Periodical mailed to your door! weekly-ish updates from the Shadow Banshee to your Email Address! Plus, digital access to the periodical, and the weekly-ish banshee archives! ")),w("div",uq,[w("div",{ref_key:"emailRef",ref:a,id:"email-element"},null,512),w("div",{ref_key:"addressRef",ref:l,id:"address-element"},null,512),w("div",{ref_key:"paymentRef",ref:c,id:"payment-element"},null,512),b[39]||(b[39]=w("div",{id:"payment-result"},null,-1))]),m.value?($(),W("div",hq,De(m.value),1)):de("",!0),f.value?($(),W("div",dq,b[40]||(b[40]=[w("h2",null,"Initializing Stripe...",-1),w("img",{src:Mo,alt:""},null,-1)]))):de("",!0),f.value?de("",!0):($(),bt(ae,{key:4,onClick:b[9]||(b[9]=Ve=>T()),id:"confirm-button",class:"nav-button"},{default:Z(()=>b[41]||(b[41]=[ne("Subscribe")])),_:1}))],64)):de("",!0),u.value==="done"?($(),W(rt,{key:1},[b[50]||(b[50]=w("h2",{style:{"margin-top":"1.8vw"}},"Subscription Successful!",-1)),b[51]||(b[51]=w("p",null,"Thank you for subscribing to the Shadow Banshee Periodical!",-1)),b[52]||(b[52]=w("p",null,"You will now get zines in the mail bi-monthly.",-1)),b[53]||(b[53]=w("p",null,"Read the periodical on this page!",-1)),w("p",null,[b[46]||(b[46]=ne(" read the ")),F(ye,{to:"/weekly"},{default:Z(()=>b[45]||(b[45]=[ne("weekly-ish Banshee")])),_:1}),b[47]||(b[47]=ne(" here! "))]),b[54]||(b[54]=w("p",null,"Check your email for updates. :)",-1)),w("p",null,[b[49]||(b[49]=ne(" You can manage your subscription, unsubscribe, etc, in ")),F(ye,{to:"/account"},{default:Z(()=>b[48]||(b[48]=[ne("Account!")])),_:1})])],64)):de("",!0)]),_:1})):de("",!0)])])}}},pq=yt(fq,[["__scopeId","data-v-6980cfa4"]]),mq={__name:"PeriodicalView",setup(n){return(e,t)=>($(),W("main",null,[F(pq)]))}},gq="/assets/eyeSeeYou-CuU0OC1c.png",_q="/assets/OESKALGORITHM-CBfO7MtN.png",yq="/assets/wasthatreallyyou-ByTIa20X.png",vq={class:"home"},bq={__name:"Gallery",setup(n){return(e,t)=>($(),W("div",vq,[F(ps),F(xr),F(nr),t[0]||(t[0]=hM('<div class="page-content" data-v-7a05de0a><div class="art-container" data-v-7a05de0a><img src="'+gq+'" alt="" data-v-7a05de0a><img src="'+_q+'" alt="" data-v-7a05de0a><img src="'+yq+'" alt="" data-v-7a05de0a></div></div>',1))]))}},wq=yt(bq,[["__scopeId","data-v-7a05de0a"]]),Eq={__name:"GalleryView",setup(n){return(e,t)=>($(),W("main",null,[F(wq)]))}},Tq="/assets/faqpage-Cqz-WUoK.png",Sq="/assets/faqpage1-BdIcZaTv.png",Iq={class:"home"},Cq=`I frequently ask myself this.

I am an interdimensional,
independent multidisciplinary multidilusionary artist.
I make approximately three different comics.
I sing, I dance, what can't I do?
(code. My brother created this whole site :)`,kq=`(How does it work?)

The periodical is a zine that I make,
featuring the shadow banshee comics,
and the shadow banshee advice column,
where it answers questions sent in by readers.

it also contains my other comics, NAMELY:

oneeyedsuperkid (that's me) and
The dreamwalker (IF YOU LIKE ESCAPISM)

I have thoughtfully created many options for obtaining it,
either via the periodical subscription, or on my
online shop OR at local comic book shops chicagoland only!*
(*For now)`,Aq={__name:"FAQ",setup(n){return(e,t)=>($(),W("div",Iq,[F(ps),F(xr),F(nr),w("div",{class:"page-content"},[w("div",{id:"container"},[w("div",{id:"faq1",style:{"white-space":"pre-line"}},[w("div",{class:"text"},[t[0]||(t[0]=w("h3",null,"Who am I",-1)),w("p",null,De(Cq))]),t[1]||(t[1]=w("img",{src:Tq,alt:""},null,-1))]),w("div",{id:"faq2"},[w("div",{class:"text"},[t[2]||(t[2]=w("h3",null,"WHAT IS THE SHADOW BANSHEE PERIODICAL",-1)),w("p",null,De(kq))]),t[3]||(t[3]=w("img",{src:Sq,alt:""},null,-1))])])])]))}},Rq=yt(Aq,[["__scopeId","data-v-77e78d91"]]),Pq={__name:"FAQView",setup(n){return(e,t)=>($(),W("main",null,[F(Rq)]))}},xq="/assets/page6-CIszwRxD.png",Nq="/assets/cover-u6luvehh.png",Oq="/assets/tsbp1-C1dn5R4y.jpg",Mq="/assets/tsbp2-jfDxfLLP.jpg",Dq="/assets/tsbp3-Q8Z3SEas.jpg",Lq="/assets/tsbp4-r_wGqaBV.jpg",Vq="/assets/TSBP2listing(1)-BEiUBMXh.png",Fq="/assets/TSBP2listing(2)-BJo729Nb.png",Bq="/assets/TSBP2listing(3)-D1hnY1L_.png",$q="/assets/TSBP2listing(4)-qsBcwrz9.png",Uq="/assets/TSBP2listing(5)-rj4cen4i.png",jq="/assets/TSBP2cover-Dqsh4kdl.png",zq="/assets/TSBP3%20listing%20photo%201-XsZ_cWT2.png",Hq="/assets/TSBP3%20listing%20photo%203-CM6Gdvk9.png",Wq="/assets/TSBP3%20listing%20photo%204-BJyDE9Zb.png",qq="/assets/TSBP3%20listing%20photo%205-D30QxY2-.png",Kq="/assets/TSBP3%20listing%20photo%208-COqLxNS8.png",Gq="/assets/TSBP3%20listing%20photos%202-SqKkPfzj.png",Qq="/assets/cover-BIZCfFo8.png",Jq="/assets/bewareofBansheeSticker-OsUIHvpJ.png",Yq="/assets/sign-BlgaJfCp.png",Xq="/assets/cont-existing-CxQ_D2OZ.jpg",Zq="/assets/cont-existing2-Ctg3IOGw.jpg",e7="/assets/cont-existing3-DaddUMHh.jpg",t7="/assets/tSBMinizine_CONTINUOUSLYEXISTINGININNERTHOUGHT-B8OKKeXO.png",n7="/assets/bansheeCrossingSticker-P2lBqrDI.png",s7="/assets/cropped_sign-DSIZvznC.jpg",r7="/assets/Doingnothing-CIMBCgdD.png",i7="/assets/TSB-headfull-BuMVOWgC.jpg",o7="/assets/TSB-headfull2-D5wTDZJj.jpg",a7="/assets/TSB-headfull3-jI99WVOw.jpg",l7="/assets/tSBMinizine_HEADFULLOFCLOUDS-COlljQJC.png",c7="/assets/tSBMinizine_PUDDLESOFTHOUGHT-BaojFmZa.png",u7="/assets/puddles-BGpqClou.jpg",h7="/assets/puddles2-hRuT1Eay.jpg",d7="/assets/puddles3-BhLzYUq1.jpg",f7="/assets/puddlesOfThought-CQ8Al_Hj.png",p7="/assets/sPREADBANSHEESTICKERS-B7y0RBiQ.png",m7="/assets/sticker1-CCliAdJT.jpg",g7="/assets/sticker2-Dt4WxyzB.jpg",_7="/assets/TSBLurksQuietlyInTheWilderness-1RY5e32A.png",y7="/assets/tSBMinizine_THESHADOWBANSHEELURKSQUIETLYINTHEWILDERNESS-BjUm5nYi.png",v7="/assets/tsbquietly-2-DdPk_K-i.jpg",b7="/assets/tsbquietly-3-DKqfdWSp.jpg",w7="/assets/tsbquietly-_MWbEJiU.jpg",E7="/assets/Tunnelbanshee-BLUXdMl_.png",T7="/assets/tSBMinizine_THESHADOWBANSHEEFEELSWOBBLYINTHEENDLESSNESS-BtSvE7K-.png",S7="/assets/tsbwobbly-2-BuCiWkHR.jpg",I7="/assets/tsbwobbly-3-BDxJJaz7.jpg",C7="/assets/tsbwobbly-BL-PUsrU.jpg",k7="/assets/whenManeuvering-DLkIwTMZ.png",A7="/assets/shopHeader-DrIQyLkd.png",R7="/assets/filterAll-vpZr6mRS.png",P7="/assets/zines-a_HXKx9w.png",x7="/assets/filterStickers-BcmARAPh.png",N7="/assets/NEW-D2HzVTIE.png",Cv=ou("cart",()=>{const n=G([]),e=et(()=>n.value.reduce((o,a)=>o+a.price*a.quantity,0));function t(o){const a=n.value.find(l=>l.title===o.title);a?a.quantity++:n.value.push({...o,quantity:1})}function s(o,a){const l=n.value.find(c=>c.title===o.title);l&&(l.quantity+=a)}function r(o){n.value=n.value.filter(a=>a.title!==o.title)}function i(){n.value=[]}return{cart:n,totalPrice:e,AddToCart:t,UpdateQuantity:s,RemoveFromCart:r,ClearCart:i}}),O7={id:"count"},M7={class:"cart-content"},D7={class:"total-price"},L7={id:"cart-items"},V7={key:"item.id",class:"item"},F7=["src"],B7={style:{position:"relative",display:"inline-flex","flex-direction":"column",margin:"0",padding:"0",height:"fit-content",width:"100%"}},$7={style:{"max-width":"fit-content"}},U7={style:{"max-width":"fit-content"}},j7={style:{"max-width":"fit-content"}},z7={__name:"Cart",emits:["checkout"],setup(n,{emit:e}){const t=Cv(),s=G(!1);function r(i){i.quantity-=1,i.quantity<=0&&t.RemoveFromCart(i)}return(i,o)=>($(),W(rt,null,[F(ae,{class:"cart-button",onClick:o[0]||(o[0]=a=>s.value=!0)},{default:Z(()=>[o[3]||(o[3]=ne(" 🛒 ")),w("span",O7,De(Y(t).cart.length),1)]),_:1}),F(iu,{name:"Slide"},{default:Z(()=>[s.value?($(),bt(Qs,{key:0,class:"cart-sidebar slide-in-done"},{default:Z(()=>[F(ae,{isX:"",onClick:o[1]||(o[1]=a=>s.value=!1)}),w("div",M7,[o[5]||(o[5]=w("h2",{style:{margin:"1vw"}},"Your Cart:",-1)),F(ae,{style:{"margin-bottom":"1vw"},onClick:o[2]||(o[2]=a=>(i.$emit("checkout"),s.value=!1))},{default:Z(()=>o[4]||(o[4]=[ne("Proceed to Checkout")])),_:1}),w("div",D7,[w("p",null,"Total Price: $"+De(Y(t).totalPrice),1)]),w("div",L7,[($(!0),W(rt,null,Io(Y(t).cart,a=>($(),W("div",V7,[w("img",{src:a.cover},null,8,F7),w("div",B7,[w("p",$7,De(a.title),1),w("p",U7,"Price: $"+De(a.price)+".00",1),w("p",j7," Qty: ( "+De(a.quantity)+" ) ――― Remove? ",1),F(ae,{isX:"",onClick:l=>r(a)},null,8,["onClick"])])]))),128))])])]),_:1})):de("",!0)]),_:1})],64))}},H7=yt(z7,[["__scopeId","data-v-f8aa2694"]]),W7={key:0,class:"checkout-form"},q7={style:{"flex-direction":"column","max-width":"40%"}},K7={id:"checkout-items"},G7={key:"item.id",class:"item"},Q7=["src"],J7={key:0,id:"loading-indicator"},Y7={key:1,id:"paying-indicator"},X7={key:1,id:"ultimatum-result"},Z7={__name:"Checkout",emits:["close"],setup(n,{emit:e}){const t=Su(),s=uP(),r=Cv(),i=et(()=>r.totalPrice*100);G(!0);const o=G(null),a=G(null),l=G(null),c=G(!1);Xs(async()=>{if(c.value=!0,await s.InitStripe(),i.value>0)try{const _=await s.FetchClientSecret(i.value);await s.MountElements(_,o.value,a.value,l.value),c.value=!1}catch(_){console.error("Error setting up payment:",_)}else console.warn("Amount is 0 or less. No payment setup.")});const u=G(!1),h=G(!1),f=G(!1);async function p(){if(!u.value){console.log("paying..."),f.value=!0,u.value=!0,h.value=!1,Mi(()=>{m("paying-indicator")});try{await s.ConfirmPayment()&&(h.value=!0,f.value=!1,r.ClearCart(),t("Payment successful!","success",3e3))}catch(_){console.error("Payment error:",_)}}}function m(_){const v=document.getElementById(_);v&&v.scrollIntoView({behavior:"smooth"})}return(_,v)=>($(),bt(iu,{name:"Slide"},{default:Z(()=>[F(Qs,{isOverlay:"",id:"checkout"},{default:Z(()=>[F(ae,{isX:"",onClick:v[0]||(v[0]=I=>_.$emit("close"))}),h.value?de("",!0):($(),W("div",W7,[w("div",q7,[w("p",null,"Total price: $"+De(Y(r).totalPrice),1),w("div",K7,[($(!0),W(rt,null,Io(Y(r).cart,I=>($(),W("div",G7,[w("img",{src:I.cover},null,8,Q7),ne(" "+De(I.title)+" - $"+De(I.price)+" quantity "+De(I.quantity),1)]))),128))])]),w("form",{id:"payment-form",onSubmit:Sr(p,["prevent"])},[c.value?($(),W("div",J7,v[1]||(v[1]=[w("h3",null,"Initializing Stripe...",-1),w("img",{src:Mo,alt:""},null,-1)]))):de("",!0),v[4]||(v[4]=w("h3",null,"Shipping info",-1)),w("div",{id:"address-element",ref_key:"addressRef",ref:o},null,512),v[5]||(v[5]=w("h3",null,"Please double check ALL of your information! Payment Info",-1)),w("div",{id:"payment-element",ref_key:"paymentRef",ref:a},null,512),v[6]||(v[6]=w("div",{id:"payment-result"},null,-1)),f.value?($(),W("div",Y7,v[2]||(v[2]=[w("h3",null,"Initializing Stripe...",-1),w("img",{src:Mo,alt:""},null,-1)]))):de("",!0),F(ae,{type:"submit"},{default:Z(()=>v[3]||(v[3]=[ne("Pay")])),_:1})],32)])),h.value?($(),W("div",X7,v[7]||(v[7]=[w("h3",null,[ne(" Payment successfull! "),w("br"),w("br"),ne("Feel free to close out of checkout "),w("br"),ne("and continue browsing our site! "),w("br"),ne("THANKS! ")],-1)]))):de("",!0)]),_:1})]),_:1}))}},eK=yt(Z7,[["__scopeId","data-v-af3a7f17"]]),tK={class:"item zine"},nK=["src"],sK={class:"image-carousel"},rK={class:"image-container"},iK=["src"],oK=["src"],aK={class:"desc"},lK={class:"price"},cK={__name:"Item",props:{item:Object,openId:[String,Number]},emits:["open","addToCart"],setup(n,{expose:e,emit:t}){const s=n,r=G(0),i=t;function o(){i("addToCart",s.item)}const a=et(()=>s.openId===s.item.id);function l(){i("open",s.item.id)}function c(){i("open",null)}e({close:c});function u(){console.log("nextImage",r.value,s.item.images.length),r.value=(r.value+1)%s.item.images.length}function h(){r.value=(r.value-1+s.item.images.length)%s.item.images.length}return(f,p)=>($(),W(rt,null,[w("div",tK,[F(ae,{isImage:"",onClick:l},{default:Z(()=>[w("img",{src:n.item.cover,alt:""},null,8,nK)]),_:1})]),F(iu,{name:"slide"},{default:Z(()=>[a.value?($(),bt(Qs,{key:0,class:"info",item:n.item},{default:Z(()=>[F(ae,{isX:"",onClick:c}),w("div",sK,[F(ae,{class:"arrow left",onClick:Sr(h,["stop"])},{default:Z(()=>p[0]||(p[0]=[ne("◀")])),_:1}),w("div",rK,[w("img",{src:n.item.images[r.value],alt:""},null,8,iK)]),($(!0),W(rt,null,Io(f.imageUrls,(m,_)=>($(),W("div",{key:_},[w("img",{class:"ico",src:m},null,8,oK)]))),128)),F(ae,{class:"arrow right",onClick:Sr(u,["stop"])},{default:Z(()=>p[1]||(p[1]=[ne("▶")])),_:1})]),w("div",aK,[w("p",null,De(n.item.title),1),w("span",null,De(n.item.description),1),w("p",lK,"$"+De(n.item.price.toFixed(2))+" USD",1),F(ae,{class:"add-to-cart",onClick:o},{default:Z(()=>p[2]||(p[2]=[ne("Add to Cart")])),_:1})])]),_:1},8,["item"])):de("",!0)]),_:1})],64))}},uK=yt(cK,[["__scopeId","data-v-ee082de1"]]),hK=[{id:"TSBP3",title:"Shadow Banshee Periodical #3",price:7,description:`The Shadow Banshee Periodical issue #3: to DO or NOT to do 
Contains: 
The Banshee: A dream is but a shadow 
Pages 2-3
The Oneeyedsuperkid: Things To Do
Pages 4-8
The Shadow Banshee advice column 
Pages 8-10`,type:"zine"},{id:"TSBP2",title:"Shadow Banshee Periodical #2",price:7,description:"The Shadow Banshee Periodical Starring the Banshee, and other comics from the mind of Oneeyedsuperkid. Featuring the Shadow Banshee advice column",type:"zine"},{id:"TSBP1",title:"Shadow Banshee Periodical #1",price:7,description:"The original Shadow Banshee Periodical Starring the Banshee, and other comics from the mind of Oneeyedsuperkid. Featuring the Shadow Banshee advice column",type:"zine"},{id:"wobbly",title:"Wobbly in the Endlessness",price:5,description:`The Banshee explores its thoughts while floating in space <3 

 4 by 5 ½" 8 page folded printed zine `,type:"zine"},{id:"wilderness",title:"Quietely in the Wilderness",price:5,description:`The Shadow Banshee's sporadic activities during night time hours 

 4 by 5 ½" 8 page folded printed zine`,type:"zine"},{id:"continuously",title:"Continuously existing in inner thought",price:5,description:`The Banshee faces it's inner thoughts 

 4 by 5 ½" 8 page folded printed zine`,type:"zine"},{id:"headfull",title:"Head full of Clouds",price:5,description:`A day in the life of the Shadow Banshee 

 4 by 5 ½" 8 page folded printed zine `,type:"zine"},{id:"puddles",title:"Puddles of Thought",price:5,description:`The Banshee ponders ways in which to embrace a perfectly good rainy day 

 4 by 5 ½" 8 page folded printed zine `,type:"zine"},{id:"beware",title:"Beware of Banshee sticker",price:3,description:`Beware of Banshee stickers to notify innocent bypassers of Shadow Banshee in the area ⚠️ Printed on glossy label paper, water resistant not waterproof semi permanent 

 5 stickers`,type:"sticker"},{id:"crossing",title:"Shadow Banshee Crossing sticker",price:3,description:`Help these beautiful creatures safely navigate roadways and street crossings. 

 5 Stickers `,type:"sticker"},{id:"spread",title:"Spread Stickers pack",price:5,description:"20 random spread banshee stickers, for semi permanent indoor or outdoor distributing",type:"sticker"}],dK={class:"home"},fK={class:"ui"},pK={id:"shop"},mK={id:"filter"},gK={class:"filterButtons"},_K={id:"last"},yK={id:"shopSpace"},vK={__name:"Shop",setup(n){const e=G(!1),t=Cv(),s=Object.assign({"/src/assets/images/shop/items/TSBP1/TSBPIssue1DigitalPage10.png":xq,"/src/assets/images/shop/items/TSBP1/cover/cover.png":Nq,"/src/assets/images/shop/items/TSBP1/tsbp1.jpg":Oq,"/src/assets/images/shop/items/TSBP1/tsbp2.jpg":Mq,"/src/assets/images/shop/items/TSBP1/tsbp3.jpg":Dq,"/src/assets/images/shop/items/TSBP1/tsbp4.jpg":Lq,"/src/assets/images/shop/items/TSBP2/TSBP2listing(1).png":Vq,"/src/assets/images/shop/items/TSBP2/TSBP2listing(2).png":Fq,"/src/assets/images/shop/items/TSBP2/TSBP2listing(3).png":Bq,"/src/assets/images/shop/items/TSBP2/TSBP2listing(4).png":$q,"/src/assets/images/shop/items/TSBP2/TSBP2listing(5).png":Uq,"/src/assets/images/shop/items/TSBP2/cover/TSBP2cover.png":jq,"/src/assets/images/shop/items/TSBP3/TSBP3 listing photo 1.png":zq,"/src/assets/images/shop/items/TSBP3/TSBP3 listing photo 3.png":Hq,"/src/assets/images/shop/items/TSBP3/TSBP3 listing photo 4.png":Wq,"/src/assets/images/shop/items/TSBP3/TSBP3 listing photo 5.png":qq,"/src/assets/images/shop/items/TSBP3/TSBP3 listing photo 8.png":Kq,"/src/assets/images/shop/items/TSBP3/TSBP3 listing photos 2.png":Gq,"/src/assets/images/shop/items/TSBP3/cover/cover.png":Qq,"/src/assets/images/shop/items/beware/cover/bewareofBansheeSticker.png":Jq,"/src/assets/images/shop/items/beware/sign.png":Yq,"/src/assets/images/shop/items/continuously/cont-existing.jpg":Xq,"/src/assets/images/shop/items/continuously/cont-existing2.jpg":Zq,"/src/assets/images/shop/items/continuously/cont-existing3.jpg":e7,"/src/assets/images/shop/items/continuously/cover/tSBMinizine_CONTINUOUSLYEXISTINGININNERTHOUGHT.png":t7,"/src/assets/images/shop/items/crossing/cover/bansheeCrossingSticker.png":n7,"/src/assets/images/shop/items/crossing/cropped_sign.jpg":s7,"/src/assets/images/shop/items/headfull/Doingnothing.png":r7,"/src/assets/images/shop/items/headfull/TSB-headfull.jpg":i7,"/src/assets/images/shop/items/headfull/TSB-headfull2.jpg":o7,"/src/assets/images/shop/items/headfull/TSB-headfull3.jpg":a7,"/src/assets/images/shop/items/headfull/cover/tSBMinizine_HEADFULLOFCLOUDS.png":l7,"/src/assets/images/shop/items/puddles/cover/tSBMinizine_PUDDLESOFTHOUGHT.png":c7,"/src/assets/images/shop/items/puddles/puddles.jpg":u7,"/src/assets/images/shop/items/puddles/puddles2.jpg":h7,"/src/assets/images/shop/items/puddles/puddles3.jpg":d7,"/src/assets/images/shop/items/puddles/puddlesOfThought.png":f7,"/src/assets/images/shop/items/spread/cover/sPREADBANSHEESTICKERS.png":p7,"/src/assets/images/shop/items/spread/sticker1.jpg":m7,"/src/assets/images/shop/items/spread/sticker2.jpg":g7,"/src/assets/images/shop/items/wilderness/TSBLurksQuietlyInTheWilderness.png":_7,"/src/assets/images/shop/items/wilderness/cover/tSBMinizine_THESHADOWBANSHEELURKSQUIETLYINTHEWILDERNESS.png":y7,"/src/assets/images/shop/items/wilderness/tsbquietly-2.jpg":v7,"/src/assets/images/shop/items/wilderness/tsbquietly-3.jpg":b7,"/src/assets/images/shop/items/wilderness/tsbquietly.jpg":w7,"/src/assets/images/shop/items/wobbly/Tunnelbanshee.png":E7,"/src/assets/images/shop/items/wobbly/cover/tSBMinizine_THESHADOWBANSHEEFEELSWOBBLYINTHEENDLESSNESS.png":T7,"/src/assets/images/shop/items/wobbly/tsbwobbly-2.jpg":S7,"/src/assets/images/shop/items/wobbly/tsbwobbly-3.jpg":I7,"/src/assets/images/shop/items/wobbly/tsbwobbly.jpg":C7,"/src/assets/images/shop/items/wobbly/whenManeuvering.png":k7}),r=G(null);function i(c){r.value=c}const o=Object.fromEntries(hK.map(c=>[c.id,{...c,cover:null,images:[]}]));for(const c in s){const u=c.split("/"),h=u[u.indexOf("items")+1],f=u.includes("cover"),p=s[c],m=o[h];if(!m){console.warn(`No matching item for image folder: ${h}`);continue}f?m.cover=p:m.images.push(p),console.log(`Added image: ${p} to item: ${m}, isCover: ${f}`)}const a=G(Object.values(o));async function l(c){await t.AddToCart(c)}return(c,u)=>($(),W("div",dK,[F(ps,{class:"homeLink"}),w("div",fK,[F(nr),F(H7,{cart:Y(t),price:c.totalPrice,onCheckout:u[0]||(u[0]=h=>e.value=!0)},null,8,["cart","price"])]),e.value?($(),bt(eK,{key:0,cart:Y(t),price:c.totalPrice,onClose:u[1]||(u[1]=h=>e.value=!1)},null,8,["cart","price"])):de("",!0),F(Do),u[8]||(u[8]=w("img",{class:"shopHeader",src:A7,alt:""},null,-1)),w("div",pK,[w("div",mK,[u[5]||(u[5]=w("p",null,"Filter Items:",-1)),w("div",gK,[F(ae,{isImage:"",class:"all",onclick:"filterItems('all')"},{default:Z(()=>u[2]||(u[2]=[w("img",{src:R7,alt:""},null,-1)])),_:1}),w("div",_K,[F(ae,{isImage:"",class:"zines",onclick:"filterItems('zine')"},{default:Z(()=>u[3]||(u[3]=[w("img",{src:P7,alt:""},null,-1)])),_:1}),F(ae,{isImage:"",class:"stickers",onclick:"filterItems('sticker')"},{default:Z(()=>u[4]||(u[4]=[w("img",{src:x7,alt:""},null,-1)])),_:1})])])]),u[7]||(u[7]=w("img",{class:"stripeImg",src:rP,style:{width:"12%","margin-left":"-64%"}},null,-1)),w("div",yK,[u[6]||(u[6]=w("img",{style:{position:"absolute",top:"0",left:"0",width:"10vw","z-index":"1"},src:N7},null,-1)),($(!0),W(rt,null,Io(a.value,h=>($(),bt(uK,{key:h.id,item:h,openId:r.value,onAddToCart:l,onOpen:i},null,8,["item","openId"]))),128))])])]))}},bK=yt(vK,[["__scopeId","data-v-dd4c8704"]]),wK={__name:"ShopView",setup(n){return(e,t)=>($(),W("main",null,[F(bK)]))}},EK={class:"home"},TK={__name:"Locations",setup(n){return(e,t)=>($(),W("div",EK,[F(ps),F(xr),F(nr),t[0]||(t[0]=w("div",{class:"page-content"},[w("div",{style:{display:"flex","flex-direction":"column",width:"80%",margin:"auto","align-items":"center"}},[w("h1",null,[ne("Updated list of places "),w("br"),ne("that carry my comics! ")]),w("iframe",{src:"https://www.google.com/maps/d/u/0/embed?mid=15j6SUwo6iB4O5wqUW4X2nZ8lhhq-xcE&ehbc=2E312F",width:"600",height:"450",frameborder:"0",style:{border:"0"},allowfullscreen:"","aria-hidden":"false",tabindex:"0"}),w("div",{id:"List"},[w("p",{class:"centeredText"},[w("span",{id:"ListTitleSub"},[ne("If you have any suggestions Email me!"),w("br"),ne(" oneeyedsuperkid@gmail.com"),w("br")])]),w("p",null,[w("span",{id:"ListTitleSub"},[ne(" Chicago "),w("br")]),w("br"),ne(" Cosmic Bikes"),w("br"),ne(" Howling Pages"),w("br"),ne(" Maximum Distractions"),w("br"),ne(" Quimbys"),w("br"),ne(" Third Coast Comics"),w("br"),ne(" Alleycat Comics"),w("br"),ne(" Women and Children First Bookstore"),w("br"),ne(" Zombie Unicorn Comics"),w("br"),ne(" First Aid Comics (Taylor)"),w("br"),ne(" Hell Yeah Comics (Skokie)"),w("br"),w("br"),w("span",{id:"ListTitleSub"},[ne("Michigan"),w("br")]),w("br"),ne(" Rabbit Hole Comics (Hartford)"),w("br"),w("br"),w("span",{id:"ListTitleSub"},[ne("Indiana"),w("br")]),w("br"),ne(" The Green Door Bookstore (Hobart) "),w("br")])])])],-1))]))}},SK=yt(TK,[["__scopeId","data-v-41756390"]]),IK={__name:"LocationsView",setup(n){return(e,t)=>($(),W("main",null,[F(SK)]))}},CK=["innerHTML"],kK=["src"],AK={key:0},RK={key:1},PK={key:2},hP={__name:"Posts",setup(n){const e=Nr(),{posts:t,loading:s,error:r}=ff(e);return(i,o)=>($(),W(rt,null,[($(!0),W(rt,null,Io(Y(t),a=>($(),W("div",{key:a.id,class:"post"},[w("h2",null,De(a.subject),1),w("div",{innerHTML:a.content},null,8,CK),($(!0),W(rt,null,Io(a.imageUrl,(l,c)=>($(),W("img",{key:c,src:l},null,8,kK))),128))]))),128)),Y(s)?($(),W("div",AK,"Loading posts...")):Y(r)?($(),W("div",RK,"Error loading posts: "+De(Y(r)),1)):Y(t).length===0?($(),W("div",PK,"No posts available.")):de("",!0)],64))}},xK={class:"home"},NK={class:"page-content"},OK={id:"weekly-content"},MK={__name:"Weekly",setup(n){return(e,t)=>($(),W("div",xK,[F(ps),F(xr),F(nr),F(Do),w("div",NK,[t[0]||(t[0]=w("h3",{id:"head"},"Welcome to the Weekly-ish Banshee!",-1)),w("div",OK,[F(hP)])])]))}},DK={__name:"WeeklyView",setup(n){return(e,t)=>($(),W("main",null,[F(MK)]))}},LK="/assets/example_question-BzzLTOrn.png",VK="/assets/speghatti_question-1hL4brzx.png",FK="/assets/issue2-CAXRKHkU.png",BK="/assets/peter_question-DDLIcBXD.png",$K="/assets/superkid_quesion-LGgiElLv.png",UK=ou("database",()=>{const n=I9(),e=Cy(),t=BU(Sy(e,"questions"),FU("timestamp")),s=S9(t),r=G(!1),i=G(null);return{vueDb:n,db:e,questions:s,loading:r,error:i}}),jK={class:"home"},zK={class:"page-content"},HK={__name:"Questions",setup(n){const t=UK().db,s=G(""),r=G(""),i=G("");function o(){console.log(s.value,r.value,i.value),PU(Sy(t,"questions"),{name:s.value,question:i.value,contact:r.value,timestamp:JU()}).then(function(){alert("Question submitted successfully!"),i.value="",s.value="",r.value=""}).catch(function(a){console.error("Error submitting question:",a),alert("An error occurred. Please try again later.")})}return(a,l)=>($(),W("div",jK,[F(ps),F(xr),F(nr),F(Do),w("div",zK,[l[7]||(l[7]=w("div",{class:"edge"},[w("img",{src:LK,class:"example_question"}),w("img",{src:VK,class:"speghatti_question"}),w("img",{src:FK,class:"issue2"})],-1)),w("form",qI(a.form,{onSubmit:Sr(o,["prevent"]),id:"questionForm",class:"container"}),[F(ae,{isRouter:"",to:"/periodical",isImage:"",class:"buttonHeader"},{default:Z(()=>l[3]||(l[3]=[w("img",{src:ep,alt:""},null,-1)])),_:1}),l[5]||(l[5]=w("p",null,"LEAVE THE INFO YOU WANT DISPLAYED IN MY ZINE :)",-1)),nn(w("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>s.value=c),class:"name text",placeholder:"Name (optional)"},null,512),[[Un,s.value]]),nn(w("input",{"onUpdate:modelValue":l[1]||(l[1]=c=>r.value=c),class:"contact text",placeholder:"@ or Business (optional)"},null,512),[[Un,r.value]]),l[6]||(l[6]=w("p",null,"LEAVE BLANK FOR -ANONYMOUS",-1)),nn(w("textarea",{"onUpdate:modelValue":l[2]||(l[2]=c=>i.value=c),class:"question text",placeholder:"Your Question Here"},null,512),[[Un,i.value]]),F(ae,{type:"submit",id:"submit"},{default:Z(()=>l[4]||(l[4]=[ne("Submit")])),_:1})],16),l[8]||(l[8]=w("div",{class:"bottom"},[w("img",{src:BK,class:"peter_question"}),w("img",{src:$K,class:"superkid_quesion"})],-1))])]))}},WK=yt(HK,[["__scopeId","data-v-67e42fdd"]]),qK={__name:"QuestionsView",setup(n){return(e,t)=>($(),W("main",null,[F(WK)]))}},KK={class:"home"},GK={id:"account-info"},QK={id:"account-username"},JK={id:"account-email"},YK={key:0},XK={key:1,id:"edit-user",style:{display:"flex","flex-direction":"column"}},ZK={key:2},e8={id:"subscriptions"},t8={id:"subscription-list"},n8={key:0,id:"unsubscribed"},s8={key:1,id:"subscribed-free"},r8={key:2,id:"subscribed-paid"},i8={key:3,id:"input-area",style:{border:"1px solid black","border-radius":"1vw",padding:"1vw"}},o8={style:{display:"flex","flex-direction":"column","align-items":"flex-start"}},a8={key:0,style:{display:"flex","flex-direction":"row","margin-bottom":"1vw"}},l8={style:{display:"flex","flex-direction":"row","margin-bottom":"3vw"}},c8={key:1},u8={key:2},h8={key:3},d8={key:0,id:"amount-message"},f8={id:"canceled",style:{display:"none"}},p8={key:3,id:"error-message"},m8={__name:"Account",setup(n){const e=Su(),{input:t,amount:s,amount_error:r,amount_message:i,amountBlur:o}=iP(),a=Zf(),l=Nr(),{isLoggedIn:c}=ff(l),u=G(!1),h=G(!1),f=G(""),p=G(!1),m=G(!1),_=G(!1),v=G(!1);async function I(){u.value=!0,h.value=!0,f.value="...",console.log("Is logged in?",c),console.log("Deleting account...",l.uid);try{await l.DeleteAccount(l.uid)?(console.log("Deleted successfully! :)"),e("Deleted successfully! :)","success",3e3),f.value="Success!",u.value=!1,await l.Logout()):(console.log("Delete Failed."),f.value="Delete Failed:",e(f.value,"error",3e3),u.value=!1)}catch(B){console.error("Error Deleting:",B),f.value="Error Deleting: "+B.message,e(f.value,"error",3e3),u.value=!1}finally{u.value=!1}}function O(){u.value=!0,h.value=!0,f.value="...",console.log("Logging out...");try{l.Logout(),u.value=!1,a.push({name:"home"}).then(()=>{Mi(()=>{console.log("Logged out successfully."),e("Logged out successfully.","success",3e3)})})}catch(B){console.error("Error logging out:",B),f.value="Error logging out: "+B.message,e(f.value,"error",3e3),u.value=!1}finally{u.value=!1}}async function P(){try{(await l.EditSub(s.value,_.value,v.value)).success?(console.log("Edited successfully! :)"),e("Edited successfully! :)","success",3e3),u.value=!1):(console.log("Edit Failed."),f.value="Edit Failed:",e(f.value,"error",3e3),u.value=!1)}catch(B){console.error("Error Editing:",B),f.value="Error Editing: "+B.message,e(f.value,"error",3e3),u.value=!1}finally{u.value=!1}}async function D(){u.value=!0,h.value=!0,f.value="...";try{await l.Unsubscribe(l.uid)?(console.log("Deleted successfully! :)"),e("Deleted successfully! :)","success",3e3),f.value="Success!",u.value=!1,await l.Logout()):(console.log("Delete Failed."),f.value="Delete Failed:",e(f.value,"error",3e3),u.value=!1)}catch(B){console.error("Error Deleting:",B),f.value="Error Deleting: "+B.message,e(f.value,"error",3e3),u.value=!1}finally{u.value=!1}}return(B,M)=>{const A=C_("RouterLink");return $(),W("div",KK,[F(YR,{ref:"alertRef"},null,512),Y(c)?de("",!0):($(),bt(ps,{key:0})),Y(c)?de("",!0):($(),bt(Qs,{key:1,isOverlay:"",class:"deleted"},{default:Z(()=>M[9]||(M[9]=[w("p",null,"Account successfully deleted!",-1)])),_:1})),Y(c)?($(),bt(Qs,{key:2,isOverlay:"",class:"page-content"},{default:Z(()=>[F(ps),w("div",GK,[w("p",null,[M[10]||(M[10]=ne(" Username: ")),w("span",QK,De(Y(l).username),1)]),w("p",null,[M[11]||(M[11]=ne(" Email: ")),w("span",JK,De(Y(l).userEmail),1)])]),Y(l).isVerified?de("",!0):($(),W("div",YK,[p.value?de("",!0):($(),bt(ae,{key:0,onClick:M[0]||(M[0]=T=>p.value=!0)},{default:Z(()=>M[12]||(M[12]=[ne("Edit")])),_:1})),p.value?($(),W("div",XK,[M[14]||(M[14]=w("p",null,"Edit your account:",-1)),M[15]||(M[15]=ne(" username:")),M[16]||(M[16]=w("input",{type:"text",name:"username",id:"username"},null,-1)),M[17]||(M[17]=ne(" email:")),M[18]||(M[18]=w("input",{type:"text",name:"email",id:"email"},null,-1)),F(ae,{onClick:M[1]||(M[1]=T=>p.value=!1),style:{"margin-top":"1vw","margin-bottom":"1vw"}},{default:Z(()=>M[13]||(M[13]=[ne("Cancel")])),_:1})])):de("",!0)])),p.value?de("",!0):($(),bt(ae,{key:1,onClick:O},{default:Z(()=>M[19]||(M[19]=[ne("Log out")])),_:1})),Y(l).isVerified?de("",!0):($(),W("p",ZK,[M[20]||(M[20]=ne(" Need to ")),w("a",{href:"#",onClick:M[2]||(M[2]=Sr((...T)=>B.resend&&B.resend(...T),["prevent"]))},"resend Verification?")])),w("div",e8,[M[44]||(M[44]=w("h3",null,"Subscriptions",-1)),w("div",t8,[Y(l).subscribed?de("",!0):($(),W("div",n8,[M[24]||(M[24]=w("p",null,"You are not subscribed to any newsletters.",-1)),w("p",null,[M[22]||(M[22]=ne(" Check out the ")),F(A,{to:"/periodical"},{default:Z(()=>M[21]||(M[21]=[ne("Shadow Banshee Periodical")])),_:1}),M[23]||(M[23]=ne(" page! "))])])),Y(l).subscription==="free"?($(),W("div",s8,[M[26]||(M[26]=w("p",null,"Subscription Type: Free Cyber Teir!",-1)),M[27]||(M[27]=w("h3",null,"Amount: $0/monthly",-1)),M[28]||(M[28]=w("p",null,"You can subscribe to the Snail-Mail teir at any time!",-1)),M[29]||(M[29]=w("p",null,"Or, Unsubscribe:",-1)),F(ae,{onClick:D,class:"unsubscribe-button"},{default:Z(()=>M[25]||(M[25]=[ne("Unsubscribe")])),_:1})])):de("",!0),Y(l).subscription==="snail-mail"?($(),W("div",r8,[w("p",null,"Subscription Type: "+De(Y(l).subscription)+"!",1),w("h3",null,"Amount: $ "+De(Y(l).donationAmount)+" /monthly",1),M[32]||(M[32]=w("p",null,"You can edit or cancel your Stripe subscription at any time!",-1)),M[33]||(M[33]=w("p",null,"Price changes or cancelations happen next billing cycle,",-1)),M[34]||(M[34]=w("p",null,"and can always be edited or re-instated.",-1)),M[35]||(M[35]=w("h3",null,"Edit your subscription:",-1)),m.value?de("",!0):($(),bt(ae,{key:0,onClick:M[3]||(M[3]=T=>m.value=!0),id:"edit-button"},{default:Z(()=>M[30]||(M[30]=[ne("Edit Subscription")])),_:1})),m.value?de("",!0):($(),bt(ae,{key:1,class:"unsubscribe-button"},{default:Z(()=>M[31]||(M[31]=[ne("Unsubscribe")])),_:1}))])):de("",!0),m.value?($(),W("div",i8,[F(ae,{onClick:M[4]||(M[4]=T=>m.value=!1),style:{"margin-bottom":"1vw"}},{default:Z(()=>M[36]||(M[36]=[ne("Cancel")])),_:1}),w("div",o8,[v.value?de("",!0):($(),W("div",a8,[M[37]||(M[37]=w("label",{for:"downgrade"},"Downgrade to Free? (Cyber Tier)",-1)),nn(w("input",{"onUpdate:modelValue":M[5]||(M[5]=T=>_.value=T),"true-value":!0,"false-value":!1,name:"downgrade",type:"checkbox"},null,512),[[Sw,_.value]])])),w("div",l8,[M[38]||(M[38]=w("label",{for:"cancel"},"Cancel completely?",-1)),nn(w("input",{"onUpdate:modelValue":M[6]||(M[6]=T=>v.value=T),"true-value":!0,"false-value":!1,name:"cancel",type:"checkbox"},null,512),[[Sw,v.value]])]),v.value?de("",!0):($(),W("div",c8,[M[39]||(M[39]=w("label",{for:"amount"},"Amount: $",-1)),nn(w("input",{onBlur:M[7]||(M[7]=(...T)=>Y(o)&&Y(o)(...T)),"onUpdate:modelValue":M[8]||(M[8]=T=>ut(t)?t.value=T:null),name:"amount",id:"amount",type:"number",min:"3",max:"10"},null,544),[[Un,Y(t)]])])),h.value?($(),W("div",u8,[w("p",null,De(f.value),1)])):de("",!0),v.value?($(),W("div",h8,M[40]||(M[40]=[w("p",null," Canceling will completely unsubscribe you from all emails and will cancel your stripe subscription at the end of the cycle! ",-1),w("p",null," You can always re-subscribe, but you can't delete your account until the end of the cycle. ",-1)]))):de("",!0)]),F(ae,{onClick:P,style:{"margin-top":"1vw"}},{default:Z(()=>M[41]||(M[41]=[ne("Save Changes")])),_:1}),Y(r)?($(),W("div",d8,De(Y(i)),1)):de("",!0)])):de("",!0),w("div",f8,[M[43]||(M[43]=w("p",null,[ne(" Your Paid subscription is canceled but still active until "),w("span",{id:"cancel-date"}),ne(". ")],-1)),F(ae,{id:"reactivate-button",class:"nav-button"},{default:Z(()=>M[42]||(M[42]=[ne("Reactivate Subscription")])),_:1})])])]),M[46]||(M[46]=w("h3",null,"↓You can scroll down to delete your account↓",-1)),F(ae,{onClick:I,id:"delete-account-button",style:{"background-color":"red"}},{default:Z(()=>M[45]||(M[45]=[ne("Delete Account")])),_:1}),h.value?($(),W("p",p8,De(f.value),1)):de("",!0)]),_:1})):de("",!0)])}}},g8=yt(m8,[["__scopeId","data-v-a92f7aa2"]]),_8={__name:"AccountView",setup(n){return(e,t)=>($(),W("main",null,[F(g8)]))}},y8={class:"home"},v8={class:"page-content"},b8={style:{display:"flex","flex-direction":"column"}},w8={key:1,style:{display:"flex","justify-content":"center","align-items":"center"}},E8={id:"logged-in"},T8={key:2,id:"error-message"},S8={key:0,id:"loading",src:Mo,alt:"",style:{width:"24%"}},I8={__name:"Verify",setup(n){const e=Su(),t=Nr(),s=G(!1),r=G(""),i=G(""),o=G(!1),a=G("");async function l(){s.value=!0,o.value=!0,a.value="Logging in...",console.log("Logging in...");try{await t.Login(r.value,i.value)?(s.value=!1,console.log("Login successful and user data updated."),e("Logged in!","success",3e3),a.value=""):(console.log("Login failed."),a.value="Login failed. Please check your credentials.",e(a.value,"error",3e3),s.value=!1)}catch(c){console.error("Error signing in:",c),a.value="Error signing in: "+c.message,e(a.value,"error",3e3),s.value=!1}finally{console.log(isLoggedIn.value),s.value=!1}}return(c,u)=>{const h=C_("RouterLink");return $(),W("div",y8,[F(ps),Y(t).isLoggedIn?($(),bt(xr,{key:0})):de("",!0),F(nr),w("div",v8,[F(Qs,{class:"login-modal"},{default:Z(()=>[w("div",b8,[Y(t).isLoggedIn?de("",!0):($(),W("form",{key:0,onSubmit:Sr(l,["prevent"]),class:"login-form"},[u[2]||(u[2]=w("p",null," ✓ You've been Verified! Sign in. :)",-1)),nn(w("input",{"onUpdate:modelValue":u[0]||(u[0]=f=>r.value=f),type:"text",id:"login-username-email",placeholder:"Username or Email",required:""},null,512),[[Un,r.value]]),nn(w("input",{"onUpdate:modelValue":u[1]||(u[1]=f=>i.value=f),type:"password",id:"login-password",placeholder:"Password",required:""},null,512),[[Un,i.value]]),F(ae,{type:"submit",customClass:"submitButton",disabled:s.value},{default:Z(()=>[ne(De(s.value?"Logging In...":"Login"),1)]),_:1},8,["disabled"])],32)),Y(t).isLoggedIn?($(),W("div",w8,[w("div",E8,[u[13]||(u[13]=w("h3",null," ✓ You are logged in!",-1)),w("p",null,[u[5]||(u[5]=ne(" Feel free to check out the")),u[6]||(u[6]=w("br",null,null,-1)),u[7]||(u[7]=ne(" Periodical page to subscribe to")),u[8]||(u[8]=w("br",null,null,-1)),F(h,{to:"/periodical"},{default:Z(()=>u[3]||(u[3]=[ne("the Shadow Banshee Periodical,")])),_:1}),u[9]||(u[9]=ne(" read the")),u[10]||(u[10]=w("br",null,null,-1)),F(h,{to:"/weekly"},{default:Z(()=>u[4]||(u[4]=[ne("weekly-ish Banshee,")])),_:1}),u[11]||(u[11]=w("br",null,null,-1)),u[12]||(u[12]=ne(" and more! "))])])])):de("",!0),o.value?($(),W("p",T8,De(a.value),1)):de("",!0)]),s.value?($(),W("img",S8)):de("",!0)]),_:1})])])}}},C8=yt(I8,[["__scopeId","data-v-b555ddc5"]]),k8={__name:"VerifyView",setup(n){return(e,t)=>($(),W("main",null,[F(C8)]))}};function Yt(n){this.content=n}Yt.prototype={constructor:Yt,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var s=t&&t!=n?this.remove(t):this,r=s.find(n),i=s.content.slice();return r==-1?i.push(t||n,e):(i[r+1]=e,t&&(i[r]=t)),new Yt(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Yt(t)},addToStart:function(n,e){return new Yt([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Yt(t)},addBefore:function(n,e,t){var s=this.remove(e),r=s.content.slice(),i=s.find(n);return r.splice(i==-1?r.length:i,0,e,t),new Yt(r)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Yt.from(n),n.size?new Yt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Yt.from(n),n.size?new Yt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Yt.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Yt.from=function(n){if(n instanceof Yt)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Yt(e)};function dP(n,e,t){for(let s=0;;s++){if(s==n.childCount||s==e.childCount)return n.childCount==e.childCount?null:t;let r=n.child(s),i=e.child(s);if(r==i){t+=r.nodeSize;continue}if(!r.sameMarkup(i))return t;if(r.isText&&r.text!=i.text){for(let o=0;r.text[o]==i.text[o];o++)t++;return t}if(r.content.size||i.content.size){let o=dP(r.content,i.content,t+1);if(o!=null)return o}t+=r.nodeSize}}function fP(n,e,t,s){for(let r=n.childCount,i=e.childCount;;){if(r==0||i==0)return r==i?null:{a:t,b:s};let o=n.child(--r),a=e.child(--i),l=o.nodeSize;if(o==a){t-=l,s-=l;continue}if(!o.sameMarkup(a))return{a:t,b:s};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,s--;return{a:t,b:s}}if(o.content.size||a.content.size){let c=fP(o.content,a.content,t-1,s-1);if(c)return c}t-=l,s-=l}}class X{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let s=0;s<e.length;s++)this.size+=e[s].nodeSize}nodesBetween(e,t,s,r=0,i){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&s(l,r+a,i||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),s,r+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,s,r){let i="",o=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?r?typeof r=="function"?r(a):r:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&s&&(o?o=!1:i+=s),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,s=e.firstChild,r=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(s)&&(r[r.length-1]=t.withText(t.text+s.text),i=1);i<e.content.length;i++)r.push(e.content[i]);return new X(r,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let s=[],r=0;if(t>e)for(let i=0,o=0;o<t;i++){let a=this.content[i],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),s.push(a),r+=a.nodeSize),o=l}return new X(s,r)}cutByIndex(e,t){return e==t?X.empty:e==0&&t==this.content.length?this:new X(this.content.slice(e,t))}replaceChild(e,t){let s=this.content[e];if(s==t)return this;let r=this.content.slice(),i=this.size+t.nodeSize-s.nodeSize;return r[e]=t,new X(r,i)}addToStart(e){return new X([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new X(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,s=0;t<this.content.length;t++){let r=this.content[t];e(r,s,t),s+=r.nodeSize}}findDiffStart(e,t=0){return dP(this,e,t)}findDiffEnd(e,t=this.size,s=e.size){return fP(this,e,t,s)}findIndex(e,t=-1){if(e==0)return uh(0,e);if(e==this.size)return uh(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let s=0,r=0;;s++){let i=this.child(s),o=r+i.nodeSize;if(o>=e)return o==e||t>0?uh(s+1,o):uh(s,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return X.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new X(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return X.empty;let t,s=0;for(let r=0;r<e.length;r++){let i=e[r];s+=i.nodeSize,r&&i.isText&&e[r-1].sameMarkup(i)?(t||(t=e.slice(0,r)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new X(t||e,s)}static from(e){if(!e)return X.empty;if(e instanceof X)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new X([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}X.empty=new X([],0);const pm={index:0,offset:0};function uh(n,e){return pm.index=n,pm.offset=e,pm}function xd(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let s=0;s<n.length;s++)if(!xd(n[s],e[s]))return!1}else{for(let s in n)if(!(s in e)||!xd(n[s],e[s]))return!1;for(let s in e)if(!(s in n))return!1}return!0}let ct=class Hg{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,s=!1;for(let r=0;r<e.length;r++){let i=e[r];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,r));else{if(i.type.excludes(this.type))return e;!s&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),s=!0),t&&t.push(i)}}return t||(t=e.slice()),s||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&xd(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let s=e.marks[t.type];if(!s)throw new RangeError(`There is no mark type ${t.type} in this schema`);let r=s.create(t.attrs);return s.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++)if(!e[s].eq(t[s]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Hg.none;if(e instanceof Hg)return[e];let t=e.slice();return t.sort((s,r)=>s.type.rank-r.type.rank),t}};ct.none=[];class Nd extends Error{}class he{constructor(e,t,s){this.content=e,this.openStart=t,this.openEnd=s}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let s=mP(this.content,e+this.openStart,t);return s&&new he(s,this.openStart,this.openEnd)}removeBetween(e,t){return new he(pP(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return he.empty;let s=t.openStart||0,r=t.openEnd||0;if(typeof s!="number"||typeof r!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new he(X.fromJSON(e,t.content),s,r)}static maxOpen(e,t=!0){let s=0,r=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)s++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)r++;return new he(e,s,r)}}he.empty=new he(X.empty,0,0);function pP(n,e,t){let{index:s,offset:r}=n.findIndex(e),i=n.maybeChild(s),{index:o,offset:a}=n.findIndex(t);if(r==e||i.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(s!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(s,i.copy(pP(i.content,e-r-1,t-r-1)))}function mP(n,e,t,s){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r);if(i==e||o.isText)return n.cut(0,e).append(t).append(n.cut(e));let a=mP(o.content,e-i-1,t);return a&&n.replaceChild(r,o.copy(a))}function A8(n,e,t){if(t.openStart>n.depth)throw new Nd("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Nd("Inconsistent open depths");return gP(n,e,t,0)}function gP(n,e,t,s){let r=n.index(s),i=n.node(s);if(r==e.index(s)&&s<n.depth-t.openStart){let o=gP(n,e,t,s+1);return i.copy(i.content.replaceChild(r,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==s&&e.depth==s){let o=n.parent,a=o.content;return bo(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=R8(t,n);return bo(i,yP(n,o,a,e,s))}else return bo(i,Od(n,e,s))}function _P(n,e){if(!e.type.compatibleContent(n.type))throw new Nd("Cannot join "+e.type.name+" onto "+n.type.name)}function Wg(n,e,t){let s=n.node(t);return _P(s,e.node(t)),s}function vo(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function mc(n,e,t,s){let r=(e||n).node(t),i=0,o=e?e.index(t):r.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(vo(n.nodeAfter,s),i++));for(let a=i;a<o;a++)vo(r.child(a),s);e&&e.depth==t&&e.textOffset&&vo(e.nodeBefore,s)}function bo(n,e){return n.type.checkContent(e),n.copy(e)}function yP(n,e,t,s,r){let i=n.depth>r&&Wg(n,e,r+1),o=s.depth>r&&Wg(t,s,r+1),a=[];return mc(null,n,r,a),i&&o&&e.index(r)==t.index(r)?(_P(i,o),vo(bo(i,yP(n,e,t,s,r+1)),a)):(i&&vo(bo(i,Od(n,e,r+1)),a),mc(e,t,r,a),o&&vo(bo(o,Od(t,s,r+1)),a)),mc(s,null,r,a),new X(a)}function Od(n,e,t){let s=[];if(mc(null,n,t,s),n.depth>t){let r=Wg(n,e,t+1);vo(bo(r,Od(n,e,t+1)),s)}return mc(e,null,t,s),new X(s)}function R8(n,e){let t=e.depth-n.openStart,r=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)r=e.node(i).copy(X.from(r));return{start:r.resolveNoCache(n.openStart+t),end:r.resolveNoCache(r.content.size-n.openEnd-t)}}class qc{constructor(e,t,s){this.pos=e,this.path=t,this.parentOffset=s,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let s=this.pos-this.path[this.path.length-1],r=e.child(t);return s?e.child(t).cut(s):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let s=this.path[t*3],r=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)r+=s.child(i).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return ct.none;if(this.textOffset)return e.child(t).marks;let s=e.maybeChild(t-1),r=e.maybeChild(t);if(!s){let a=s;s=r,r=a}let i=s.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!r||!i[o].isInSet(r.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let s=t.marks,r=e.parent.maybeChild(e.index());for(var i=0;i<s.length;i++)s[i].type.spec.inclusive===!1&&(!r||!s[i].isInSet(r.marks))&&(s=s[i--].removeFromSet(s));return s}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let s=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);s>=0;s--)if(e.pos<=this.end(s)&&(!t||t(this.node(s))))return new Md(this,e,s);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let s=[],r=0,i=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(i),c=i-l;if(s.push(o,a,r+l),!c||(o=o.child(a),o.isText))break;i=c-1,r+=l+1}return new qc(t,s,i)}static resolveCached(e,t){let s=ST.get(e);if(s)for(let i=0;i<s.elts.length;i++){let o=s.elts[i];if(o.pos==t)return o}else ST.set(e,s=new P8);let r=s.elts[s.i]=qc.resolve(e,t);return s.i=(s.i+1)%x8,r}}class P8{constructor(){this.elts=[],this.i=0}}const x8=12,ST=new WeakMap;class Md{constructor(e,t,s){this.$from=e,this.$to=t,this.depth=s}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const N8=Object.create(null);let di=class qg{constructor(e,t,s,r=ct.none){this.type=e,this.attrs=t,this.marks=r,this.content=s||X.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,s,r=0){this.content.nodesBetween(e,t,s,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,s,r){return this.content.textBetween(e,t,s,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,s){return this.type==e&&xd(this.attrs,t||e.defaultAttrs||N8)&&ct.sameSet(this.marks,s||ct.none)}copy(e=null){return e==this.content?this:new qg(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new qg(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,s=!1){if(e==t)return he.empty;let r=this.resolve(e),i=this.resolve(t),o=s?0:r.sharedDepth(t),a=r.start(o),c=r.node(o).content.cut(r.pos-a,i.pos-a);return new he(c,r.depth-o,i.depth-o)}replace(e,t,s){return A8(this.resolve(e),this.resolve(t),s)}nodeAt(e){for(let t=this;;){let{index:s,offset:r}=t.content.findIndex(e);if(t=t.maybeChild(s),!t)return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:s}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:s}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:s}=this.content.findIndex(e);if(s<e)return{node:this.content.child(t),index:t,offset:s};let r=this.content.child(t-1);return{node:r,index:t-1,offset:s-r.nodeSize}}resolve(e){return qc.resolveCached(this,e)}resolveNoCache(e){return qc.resolve(this,e)}rangeHasMark(e,t,s){let r=!1;return t>e&&this.nodesBetween(e,t,i=>(s.isInSet(i.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),vP(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,s=X.empty,r=0,i=s.childCount){let o=this.contentMatchAt(e).matchFragment(s,r,i),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=r;l<i;l++)if(!this.type.allowsMarks(s.child(l).marks))return!1;return!0}canReplaceWith(e,t,s,r){if(r&&!this.type.allowsMarks(r))return!1;let i=this.contentMatchAt(e).matchType(s),o=i&&i.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=ct.none;for(let t=0;t<this.marks.length;t++){let s=this.marks[t];s.type.checkAttrs(s.attrs),e=s.addToSet(e)}if(!ct.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let s;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");s=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,s)}let r=X.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,r,s);return i.type.checkAttrs(i.attrs),i}};di.prototype.text=void 0;class Dd extends di{constructor(e,t,s,r){if(super(e,t,null,r),!s)throw new RangeError("Empty text nodes are not allowed");this.text=s}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):vP(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Dd(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Dd(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function vP(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Lo{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let s=new O8(e,t);if(s.next==null)return Lo.empty;let r=bP(s);s.next&&s.err("Unexpected trailing text");let i=$8(B8(r));return U8(i,s),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,s=e.childCount){let r=this;for(let i=t;r&&i<s;i++)r=r.matchType(e.child(i).type);return r}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let s=0;s<e.next.length;s++)if(this.next[t].type==e.next[s].type)return!0;return!1}fillBefore(e,t=!1,s=0){let r=[this];function i(o,a){let l=o.matchFragment(e,s);if(l&&(!t||l.validEnd))return X.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:h}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&r.indexOf(h)==-1){r.push(h);let f=i(h,a.concat(u));if(f)return f}}return null}return i(this,[])}findWrapping(e){for(let s=0;s<this.wrapCache.length;s+=2)if(this.wrapCache[s]==e)return this.wrapCache[s+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),s=[{match:this,type:null,via:null}];for(;s.length;){let r=s.shift(),i=r.match;if(i.matchType(e)){let o=[];for(let a=r;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!r.type||l.validEnd)&&(s.push({match:a.contentMatch,type:a,via:r}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(s){e.push(s);for(let r=0;r<s.next.length;r++)e.indexOf(s.next[r].next)==-1&&t(s.next[r].next)}return t(this),e.map((s,r)=>{let i=r+(s.validEnd?"*":" ")+" ";for(let o=0;o<s.next.length;o++)i+=(o?", ":"")+s.next[o].type.name+"->"+e.indexOf(s.next[o].next);return i}).join(`
`)}}Lo.empty=new Lo(!0);class O8{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function bP(n){let e=[];do e.push(M8(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function M8(n){let e=[];do e.push(D8(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function D8(n){let e=F8(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=L8(n,e);else break;return e}function IT(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function L8(n,e){let t=IT(n),s=t;return n.eat(",")&&(n.next!="}"?s=IT(n):s=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:s,expr:e}}function V8(n,e){let t=n.nodeTypes,s=t[e];if(s)return[s];let r=[];for(let i in t){let o=t[i];o.isInGroup(e)&&r.push(o)}return r.length==0&&n.err("No node type or group '"+e+"' found"),r}function F8(n){if(n.eat("(")){let e=bP(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=V8(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function B8(n){let e=[[]];return r(i(n,0),t()),e;function t(){return e.push([])-1}function s(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function r(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=i(o.exprs[l],a);if(l==o.exprs.length-1)return c;r(c,a=t())}else if(o.type=="star"){let l=t();return s(a,l),r(i(o.expr,l),l),[s(l)]}else if(o.type=="plus"){let l=t();return r(i(o.expr,a),l),r(i(o.expr,l),l),[s(l)]}else{if(o.type=="opt")return[s(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=t();r(i(o.expr,l),u),l=u}if(o.max==-1)r(i(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=t();s(l,u),r(i(o.expr,l),u),l=u}return[s(l)]}else{if(o.type=="name")return[s(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function wP(n,e){return e-n}function CT(n,e){let t=[];return s(e),t.sort(wP);function s(r){let i=n[r];if(i.length==1&&!i[0].term)return s(i[0].to);t.push(r);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&t.indexOf(l)==-1&&s(l)}}}function $8(n){let e=Object.create(null);return t(CT(n,0));function t(s){let r=[];s.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<r.length;u++)r[u][0]==a&&(c=r[u][1]);CT(n,l).forEach(u=>{c||r.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=e[s.join(",")]=new Lo(s.indexOf(n.length-1)>-1);for(let o=0;o<r.length;o++){let a=r[o][1].sort(wP);i.next.push({type:r[o][0],next:e[a.join(",")]||t(a)})}return i}}function U8(n,e){for(let t=0,s=[n];t<s.length;t++){let r=s[t],i=!r.validEnd,o=[];for(let a=0;a<r.next.length;a++){let{type:l,next:c}=r.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),s.indexOf(c)==-1&&s.push(c)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function EP(n){let e=Object.create(null);for(let t in n){let s=n[t];if(!s.hasDefault)return null;e[t]=s.default}return e}function TP(n,e){let t=Object.create(null);for(let s in n){let r=e&&e[s];if(r===void 0){let i=n[s];if(i.hasDefault)r=i.default;else throw new RangeError("No value supplied for attribute "+s)}t[s]=r}return t}function SP(n,e,t,s){for(let r in e)if(!(r in n))throw new RangeError(`Unsupported attribute ${r} for ${t} of type ${r}`);for(let r in n){let i=n[r];i.validate&&i.validate(e[r])}}function IP(n,e){let t=Object.create(null);if(e)for(let s in e)t[s]=new z8(n,s,e[s]);return t}let kT=class CP{constructor(e,t,s){this.name=e,this.schema=t,this.spec=s,this.markSet=null,this.groups=s.group?s.group.split(" "):[],this.attrs=IP(e,s.attrs),this.defaultAttrs=EP(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(s.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Lo.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:TP(this.attrs,e)}create(e=null,t,s){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new di(this,this.computeAttrs(e),X.from(t),ct.setFrom(s))}createChecked(e=null,t,s){return t=X.from(t),this.checkContent(t),new di(this,this.computeAttrs(e),t,ct.setFrom(s))}createAndFill(e=null,t,s){if(e=this.computeAttrs(e),t=X.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let r=this.contentMatch.matchFragment(t),i=r&&r.fillBefore(X.empty,!0);return i?new di(this,e,t.append(i),ct.setFrom(s)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let s=0;s<e.childCount;s++)if(!this.allowsMarks(e.child(s).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){SP(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let s=0;s<e.length;s++)this.allowsMarkType(e[s].type)?t&&t.push(e[s]):t||(t=e.slice(0,s));return t?t.length?t:ct.none:e}static compile(e,t){let s=Object.create(null);e.forEach((i,o)=>s[i]=new CP(i,t,o));let r=t.spec.topNode||"doc";if(!s[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!s.text)throw new RangeError("Every schema needs a 'text' type");for(let i in s.text.attrs)throw new RangeError("The text node type should not have attributes");return s}};function j8(n,e,t){let s=t.split("|");return r=>{let i=r===null?"null":typeof r;if(s.indexOf(i)<0)throw new RangeError(`Expected value of type ${s} for attribute ${e} on type ${n}, got ${i}`)}}class z8{constructor(e,t,s){this.hasDefault=Object.prototype.hasOwnProperty.call(s,"default"),this.default=s.default,this.validate=typeof s.validate=="string"?j8(e,t,s.validate):s.validate}get isRequired(){return!this.hasDefault}}class tp{constructor(e,t,s,r){this.name=e,this.rank=t,this.schema=s,this.spec=r,this.attrs=IP(e,r.attrs),this.excluded=null;let i=EP(this.attrs);this.instance=i?new ct(this,i):null}create(e=null){return!e&&this.instance?this.instance:new ct(this,TP(this.attrs,e))}static compile(e,t){let s=Object.create(null),r=0;return e.forEach((i,o)=>s[i]=new tp(i,r++,t,o)),s}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){SP(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class kP{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let r in e)t[r]=e[r];t.nodes=Yt.from(e.nodes),t.marks=Yt.from(e.marks||{}),this.nodes=kT.compile(this.spec.nodes,this),this.marks=tp.compile(this.spec.marks,this);let s=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let i=this.nodes[r],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=s[o]||(s[o]=Lo.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?AT(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let r in this.marks){let i=this.marks[r],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:AT(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,s,r){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof kT){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,s,r)}text(e,t){let s=this.nodes.text;return new Dd(s,s.defaultAttrs,e,ct.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return di.fromJSON(this,e)}markFromJSON(e){return ct.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function AT(n,e){let t=[];for(let s=0;s<e.length;s++){let r=e[s],i=n.marks[r],o=i;if(i)t.push(i);else for(let a in n.marks){let l=n.marks[a];(r=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(r)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[s]+"'")}return t}function H8(n){return n.tag!=null}function W8(n){return n.style!=null}class fi{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let s=this.matchedStyles=[];t.forEach(r=>{if(H8(r))this.tags.push(r);else if(W8(r)){let i=/[^=]*/.exec(r.style)[0];s.indexOf(i)<0&&s.push(i),this.styles.push(r)}}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let s=new PT(this,t,!1);return s.addAll(e,ct.none,t.from,t.to),s.finish()}parseSlice(e,t={}){let s=new PT(this,t,!0);return s.addAll(e,ct.none,t.from,t.to),he.maxOpen(s.finish())}matchTag(e,t,s){for(let r=s?this.tags.indexOf(s)+1:0;r<this.tags.length;r++){let i=this.tags[r];if(G8(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,t,s,r){for(let i=r?this.styles.indexOf(r)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!s.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function s(r){let i=r.priority==null?50:r.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<i)break}t.splice(o,0,r)}for(let r in e.marks){let i=e.marks[r].spec.parseDOM;i&&i.forEach(o=>{s(o=xT(o)),o.mark||o.ignore||o.clearMark||(o.mark=r)})}for(let r in e.nodes){let i=e.nodes[r].spec.parseDOM;i&&i.forEach(o=>{s(o=xT(o)),o.node||o.ignore||o.mark||(o.node=r)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new fi(e,fi.schemaRules(e)))}}const AP={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},q8={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},RP={ol:!0,ul:!0},Kc=1,Kg=2,Mh=4;function RT(n,e,t){return e!=null?(e?Kc:0)|(e==="full"?Kg:0):n&&n.whitespace=="pre"?Kc|Kg:t&-5}class hh{constructor(e,t,s,r,i,o){this.type=e,this.attrs=t,this.marks=s,this.solid=r,this.options=o,this.content=[],this.activeMarks=ct.none,this.match=i||(o&Mh?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(X.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let s=this.type.contentMatch,r;return(r=s.findWrapping(e.type))?(this.match=s,r):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Kc)){let s=this.content[this.content.length-1],r;if(s&&s.isText&&(r=/[ \t\r\n\u000c]+$/.exec(s.text))){let i=s;s.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-r[0].length))}}let t=X.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(X.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!AP.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class PT{constructor(e,t,s){this.parser=e,this.options=t,this.isOpen=s,this.open=0,this.localPreserveWS=!1;let r=t.topNode,i,o=RT(null,t.preserveWhitespace,0)|(s?Mh:0);r?i=new hh(r.type,r.attrs,ct.none,!0,t.topMatch||r.type.contentMatch,o):s?i=new hh(null,null,ct.none,!0,null,o):i=new hh(e.schema.topNodeType,null,ct.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let s=e.nodeValue,r=this.top,i=r.options&Kg?"full":this.localPreserveWS||(r.options&Kc)>0;if(i==="full"||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(s)){if(i)i!=="full"?s=s.replace(/\r?\n|\r/g," "):s=s.replace(/\r\n?/g,`
`);else if(s=s.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(s)&&this.open==this.nodes.length-1){let o=r.content[r.content.length-1],a=e.previousSibling;(!o||a&&a.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(s=s.slice(1))}s&&this.insertNode(this.parser.schema.text(s),t,!/\S/.test(s)),this.findInText(e)}else this.findInside(e)}addElement(e,t,s){let r=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),a;RP.hasOwnProperty(o)&&this.parser.normalizeLists&&K8(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,s));e:if(l?l.ignore:q8.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(AP.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let h=l&&l.skip?t:this.readStyles(e,t);h&&this.addAll(e,h),c&&this.sync(i),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=r}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let s=e.style;if(s&&s.length)for(let r=0;r<this.parser.matchedStyles.length;r++){let i=this.parser.matchedStyles[r],o=s.getPropertyValue(i);if(o)for(let a=void 0;;){let l=this.parser.matchStyle(i,o,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,s,r){let i,o;if(t.node)if(o=this.parser.schema.nodes[t.node],o.isLeaf)this.insertNode(o.create(t.attrs),s,e.nodeName=="BR")||this.leafFallback(e,s);else{let l=this.enter(o,t.attrs||null,s,t.preserveWhitespace);l&&(i=!0,s=l)}else{let l=this.parser.schema.marks[t.mark];s=s.concat(l.create(t.attrs))}let a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(r)this.addElement(e,s,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,s,!1));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,s),this.findAround(e,l,!1)}i&&this.sync(a)&&this.open--}addAll(e,t,s,r){let i=s||0;for(let o=s?e.childNodes[s]:e.firstChild,a=r==null?null:e.childNodes[r];o!=a;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,t);this.findAtPoint(e,i)}findPlace(e,t,s){let r,i;for(let o=this.open,a=0;o>=0;o--){let l=this.nodes[o],c=l.findWrapping(e);if(c&&(!r||r.length>c.length+a)&&(r=c,i=l,!c.length))break;if(l.solid){if(s)break;a+=2}}if(!r)return null;this.sync(i);for(let o=0;o<r.length;o++)t=this.enterInner(r[o],null,t,!1);return t}insertNode(e,t,s){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let r=this.findPlace(e,t,s);if(r){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=ct.none;for(let a of r.concat(e.marks))(i.type?i.type.allowsMarkType(a.type):NT(a.type,e.type))&&(o=a.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,s,r){let i=this.findPlace(e.create(t),s,!1);return i&&(i=this.enterInner(e,t,s,!0,r)),i}enterInner(e,t,s,r=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let a=RT(e,i,o.options);o.options&Mh&&o.content.length==0&&(a|=Mh);let l=ct.none;return s=s.filter(c=>(o.type?o.type.allowsMarkType(c.type):NT(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new hh(e,t,l,r,null,a)),this.open++,s}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=Kc)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let s=this.nodes[t].content;for(let r=s.length-1;r>=0;r--)e+=s[r].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let s=0;s<this.find.length;s++)this.find[s].node==e&&this.find[s].offset==t&&(this.find[s].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,s){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&t.compareDocumentPosition(this.find[r].node)&(s?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),s=this.options.context,r=!this.isOpen&&(!s||s.parent.type==this.nodes[0].type),i=-(s?s.depth+1:0)+(r?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&r?this.nodes[l].type:s&&l>=i?s.node(l-i).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(s&&s.isTextblock&&s.defaultAttrs)return s}for(let t in this.parser.schema.nodes){let s=this.parser.schema.nodes[t];if(s.isTextblock&&s.defaultAttrs)return s}}}function K8(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let s=e.nodeType==1?e.nodeName.toLowerCase():null;s&&RP.hasOwnProperty(s)&&t?(t.appendChild(e),e=t):s=="li"?t=e:s&&(t=null)}}function G8(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function xT(n){let e={};for(let t in n)e[t]=n[t];return e}function NT(n,e){let t=e.schema.nodes;for(let s in t){let r=t[s];if(!r.allowsMarkType(n))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||i.indexOf(u)<0&&o(u))return!0}};if(o(r.contentMatch))return!0}}class Wo{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},s){s||(s=mm(t).createDocumentFragment());let r=s,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)r=i.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(i.push([c,r]),r.appendChild(u.dom),r=u.contentDOM||u.dom)}}r.appendChild(this.serializeNodeInner(o,t))}),s}serializeNodeInner(e,t){let{dom:s,contentDOM:r}=Dh(mm(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return s}serializeNode(e,t={}){let s=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let i=this.serializeMark(e.marks[r],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(s),s=i.dom)}return s}serializeMark(e,t,s={}){let r=this.marks[e.type.name];return r&&Dh(mm(s),r(e,t),null,e.attrs)}static renderSpec(e,t,s=null,r){return Dh(e,t,s,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Wo(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=OT(e.nodes);return t.text||(t.text=s=>s.text),t}static marksFromSchema(e){return OT(e.marks)}}function OT(n){let e={};for(let t in n){let s=n[t].spec.toDOM;s&&(e[t]=s)}return e}function mm(n){return n.document||window.document}const MT=new WeakMap;function Q8(n){let e=MT.get(n);return e===void 0&&MT.set(n,e=J8(n)),e}function J8(n){let e=null;function t(s){if(s&&typeof s=="object")if(Array.isArray(s))if(typeof s[0]=="string")e||(e=[]),e.push(s);else for(let r=0;r<s.length;r++)t(s[r]);else for(let r in s)t(s[r])}return t(n),e}function Dh(n,e,t,s){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let r=e[0],i;if(typeof r!="string")throw new RangeError("Invalid array passed to renderSpec");if(s&&(i=Q8(s))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=r.indexOf(" ");o>0&&(t=r.slice(0,o),r=r.slice(o+1));let a,l=t?n.createElementNS(t,r):n.createElement(r),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let h in c)if(c[h]!=null){let f=h.indexOf(" ");f>0?l.setAttributeNS(h.slice(0,f),h.slice(f+1),c[h]):l.setAttribute(h,c[h])}}for(let h=u;h<e.length;h++){let f=e[h];if(f===0){if(h<e.length-1||h>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:m}=Dh(n,f,t,s);if(l.appendChild(p),m){if(a)throw new RangeError("Multiple content holes");a=m}}}return{dom:l,contentDOM:a}}const PP=65535,xP=Math.pow(2,16);function Y8(n,e){return n+e*xP}function DT(n){return n&PP}function X8(n){return(n-(n&PP))/xP}const NP=1,OP=2,Lh=4,MP=8;class Gg{constructor(e,t,s){this.pos=e,this.delInfo=t,this.recover=s}get deleted(){return(this.delInfo&MP)>0}get deletedBefore(){return(this.delInfo&(NP|Lh))>0}get deletedAfter(){return(this.delInfo&(OP|Lh))>0}get deletedAcross(){return(this.delInfo&Lh)>0}}class Qn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Qn.empty)return Qn.empty}recover(e){let t=0,s=DT(e);if(!this.inverted)for(let r=0;r<s;r++)t+=this.ranges[r*3+2]-this.ranges[r*3+1];return this.ranges[s*3]+t+X8(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,s){let r=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],u=this.ranges[a+o],h=l+c;if(e<=h){let f=c?e==l?-1:e==h?1:t:t,p=l+r+(f<0?0:u);if(s)return p;let m=e==(t<0?l:h)?null:Y8(a/3,e-l),_=e==l?OP:e==h?NP:Lh;return(t<0?e!=l:e!=h)&&(_|=MP),new Gg(p,_,m)}r+=u-c}return s?e+r:new Gg(e+r,0,null)}touches(e,t){let s=0,r=DT(t),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let c=this.ranges[a+i],u=l+c;if(e<=u&&a==r*3)return!0;s+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,s=this.inverted?1:2;for(let r=0,i=0;r<this.ranges.length;r+=3){let o=this.ranges[r],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),c=this.ranges[r+t],u=this.ranges[r+s];e(a,a+c,l,l+u),i+=u-c}}invert(){return new Qn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Qn.empty:new Qn(e<0?[0,-e,0]:[0,0,e])}}Qn.empty=new Qn([]);class Gc{constructor(e,t,s=0,r=e?e.length:0){this.mirror=t,this.from=s,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new Gc(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,s=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],r!=null&&r<t?s+r:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,s=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),r!=null&&r>t?s-r-1:void 0)}}invert(){let e=new Gc;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let s=this.from;s<this.to;s++)e=this._maps[s].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,s){let r=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this._maps[l].recover(a.recover);continue}}r|=a.delInfo,e=a.pos}return s?e:new Gg(e,r,null)}}const gm=Object.create(null);class wn{getMap(){return Qn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let s=gm[t.stepType];if(!s)throw new RangeError(`No step type ${t.stepType} defined`);return s.fromJSON(e,t)}static jsonID(e,t){if(e in gm)throw new RangeError("Duplicate use of step JSON ID "+e);return gm[e]=t,t.prototype.jsonID=e,t}}class Nt{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Nt(e,null)}static fail(e){return new Nt(null,e)}static fromReplace(e,t,s,r){try{return Nt.ok(e.replace(t,s,r))}catch(i){if(i instanceof Nd)return Nt.fail(i.message);throw i}}}function kv(n,e,t){let s=[];for(let r=0;r<n.childCount;r++){let i=n.child(r);i.content.size&&(i=i.copy(kv(i.content,e,i))),i.isInline&&(i=e(i,t,r)),s.push(i)}return X.fromArray(s)}class ni extends wn{constructor(e,t,s){super(),this.from=e,this.to=t,this.mark=s}apply(e){let t=e.slice(this.from,this.to),s=e.resolve(this.from),r=s.node(s.sharedDepth(this.to)),i=new he(kv(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),r),t.openStart,t.openEnd);return Nt.fromReplace(e,this.from,this.to,i)}invert(){return new $s(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),s=e.mapResult(this.to,-1);return t.deleted&&s.deleted||t.pos>=s.pos?null:new ni(t.pos,s.pos,this.mark)}merge(e){return e instanceof ni&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ni(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ni(t.from,t.to,e.markFromJSON(t.mark))}}wn.jsonID("addMark",ni);class $s extends wn{constructor(e,t,s){super(),this.from=e,this.to=t,this.mark=s}apply(e){let t=e.slice(this.from,this.to),s=new he(kv(t.content,r=>r.mark(this.mark.removeFromSet(r.marks)),e),t.openStart,t.openEnd);return Nt.fromReplace(e,this.from,this.to,s)}invert(){return new ni(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),s=e.mapResult(this.to,-1);return t.deleted&&s.deleted||t.pos>=s.pos?null:new $s(t.pos,s.pos,this.mark)}merge(e){return e instanceof $s&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new $s(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new $s(t.from,t.to,e.markFromJSON(t.mark))}}wn.jsonID("removeMark",$s);class si extends wn{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Nt.fail("No node at mark step's position");let s=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Nt.fromReplace(e,this.pos,this.pos+1,new he(X.from(s),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let s=this.mark.addToSet(t.marks);if(s.length==t.marks.length){for(let r=0;r<t.marks.length;r++)if(!t.marks[r].isInSet(s))return new si(this.pos,t.marks[r]);return new si(this.pos,this.mark)}}return new Vo(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new si(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new si(t.pos,e.markFromJSON(t.mark))}}wn.jsonID("addNodeMark",si);class Vo extends wn{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Nt.fail("No node at mark step's position");let s=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Nt.fromReplace(e,this.pos,this.pos+1,new he(X.from(s),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new si(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Vo(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Vo(t.pos,e.markFromJSON(t.mark))}}wn.jsonID("removeNodeMark",Vo);class jt extends wn{constructor(e,t,s,r=!1){super(),this.from=e,this.to=t,this.slice=s,this.structure=r}apply(e){return this.structure&&Qg(e,this.from,this.to)?Nt.fail("Structure replace would overwrite content"):Nt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Qn([this.from,this.to-this.from,this.slice.size])}invert(e){return new jt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),s=e.mapResult(this.to,-1);return t.deletedAcross&&s.deletedAcross?null:new jt(t.pos,Math.max(t.pos,s.pos),this.slice,this.structure)}merge(e){if(!(e instanceof jt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?he.empty:new he(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new jt(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?he.empty:new he(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new jt(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new jt(t.from,t.to,he.fromJSON(e,t.slice),!!t.structure)}}wn.jsonID("replace",jt);class Ht extends wn{constructor(e,t,s,r,i,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=s,this.gapTo=r,this.slice=i,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Qg(e,this.from,this.gapFrom)||Qg(e,this.gapTo,this.to)))return Nt.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Nt.fail("Gap is not a flat range");let s=this.slice.insertAt(this.insert,t.content);return s?Nt.fromReplace(e,this.from,this.to,s):Nt.fail("Content does not fit in gap")}getMap(){return new Qn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ht(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),s=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?s.pos:e.map(this.gapTo,1);return t.deletedAcross&&s.deletedAcross||r<t.pos||i>s.pos?null:new Ht(t.pos,s.pos,r,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ht(t.from,t.to,t.gapFrom,t.gapTo,he.fromJSON(e,t.slice),t.insert,!!t.structure)}}wn.jsonID("replaceAround",Ht);function Qg(n,e,t){let s=n.resolve(e),r=t-e,i=s.depth;for(;r>0&&i>0&&s.indexAfter(i)==s.node(i).childCount;)i--,r--;if(r>0){let o=s.node(i).maybeChild(s.indexAfter(i));for(;r>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,r--}}return!1}function Z8(n,e,t,s){let r=[],i=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let h=l.marks;if(!s.isInSet(h)&&u.type.allowsMarkType(s.type)){let f=Math.max(c,e),p=Math.min(c+l.nodeSize,t),m=s.addToSet(h);for(let _=0;_<h.length;_++)h[_].isInSet(m)||(o&&o.to==f&&o.mark.eq(h[_])?o.to=p:r.push(o=new $s(f,p,h[_])));a&&a.to==f?a.to=p:i.push(a=new ni(f,p,s))}}),r.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function eG(n,e,t,s){let r=[],i=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(s instanceof tp){let c=o.marks,u;for(;u=s.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else s?s.isInSet(o.marks)&&(l=[s]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let h=l[u],f;for(let p=0;p<r.length;p++){let m=r[p];m.step==i-1&&h.eq(r[p].style)&&(f=m)}f?(f.to=c,f.step=i):r.push({style:h,from:Math.max(a,e),to:c,step:i})}}}),r.forEach(o=>n.step(new $s(o.from,o.to,o.style)))}function Av(n,e,t,s=t.contentMatch,r=!0){let i=n.doc.nodeAt(e),o=[],a=e+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),u=a+c.nodeSize,h=s.matchType(c.type);if(!h)o.push(new jt(a,u,he.empty));else{s=h;for(let f=0;f<c.marks.length;f++)t.allowsMarkType(c.marks[f].type)||n.step(new $s(a,u,c.marks[f]));if(r&&c.isText&&t.whitespace!="pre"){let f,p=/\r?\n|\r/g,m;for(;f=p.exec(c.text);)m||(m=new he(X.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),o.push(new jt(a+f.index,a+f.index+f[0].length,m))}}a=u}if(!s.validEnd){let l=s.fillBefore(X.empty,!0);n.replace(a,a,new he(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function tG(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function cl(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let s=n.depth;;--s){let r=n.$from.node(s),i=n.$from.index(s),o=n.$to.indexAfter(s);if(s<n.depth&&r.canReplace(i,o,t))return s;if(s==0||r.type.spec.isolating||!tG(r,i,o))break}return null}function nG(n,e,t){let{$from:s,$to:r,depth:i}=e,o=s.before(i+1),a=r.after(i+1),l=o,c=a,u=X.empty,h=0;for(let m=i,_=!1;m>t;m--)_||s.index(m)>0?(_=!0,u=X.from(s.node(m).copy(u)),h++):l--;let f=X.empty,p=0;for(let m=i,_=!1;m>t;m--)_||r.after(m+1)<r.end(m)?(_=!0,f=X.from(r.node(m).copy(f)),p++):c++;n.step(new Ht(l,c,o,a,new he(u.append(f),h,p),u.size-h,!0))}function Rv(n,e,t=null,s=n){let r=sG(n,e),i=r&&rG(s,e);return i?r.map(LT).concat({type:e,attrs:t}).concat(i.map(LT)):null}function LT(n){return{type:n,attrs:null}}function sG(n,e){let{parent:t,startIndex:s,endIndex:r}=n,i=t.contentMatchAt(s).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return t.canReplaceWith(s,r,o)?i:null}function rG(n,e){let{parent:t,startIndex:s,endIndex:r}=n,i=t.child(s),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=s;l&&c<r;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function iG(n,e,t){let s=X.empty;for(let o=t.length-1;o>=0;o--){if(s.size){let a=t[o].type.contentMatch.matchFragment(s);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}s=X.from(t[o].type.create(t[o].attrs,s))}let r=e.start,i=e.end;n.step(new Ht(r,i,r,i,new he(s,0,0),t.length,!0))}function oG(n,e,t,s,r){if(!s.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{let l=typeof r=="function"?r(o):r;if(o.isTextblock&&!o.hasMarkup(s,l)&&aG(n.doc,n.mapping.slice(i).map(a),s)){let c=null;if(s.schema.linebreakReplacement){let p=s.whitespace=="pre",m=!!s.contentMatch.matchType(s.schema.linebreakReplacement);p&&!m?c=!1:!p&&m&&(c=!0)}c===!1&&LP(n,o,a,i),Av(n,n.mapping.slice(i).map(a,1),s,void 0,c===null);let u=n.mapping.slice(i),h=u.map(a,1),f=u.map(a+o.nodeSize,1);return n.step(new Ht(h,f,h+1,f-1,new he(X.from(s.create(l,null,o.marks)),0,0),1,!0)),c===!0&&DP(n,o,a,i),!1}})}function DP(n,e,t,s){e.forEach((r,i)=>{if(r.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(r.text);){let l=n.mapping.slice(s).map(t+1+i+o.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function LP(n,e,t,s){e.forEach((r,i)=>{if(r.type==r.type.schema.linebreakReplacement){let o=n.mapping.slice(s).map(t+1+i);n.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function aG(n,e,t){let s=n.resolve(e),r=s.index();return s.parent.canReplaceWith(r,r+1,t)}function lG(n,e,t,s,r){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let o=t.create(s,null,r||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,o);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new Ht(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new he(X.from(o),0,0),1,!0))}function Er(n,e,t=1,s){let r=n.resolve(e),i=r.depth-t,o=s&&s[s.length-1]||r.parent;if(i<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!o.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let c=r.depth-1,u=t-2;c>i;c--,u--){let h=r.node(c),f=r.index(c);if(h.type.spec.isolating)return!1;let p=h.content.cutByIndex(f,h.childCount),m=s&&s[u+1];m&&(p=p.replaceChild(0,m.type.create(m.attrs)));let _=s&&s[u]||h;if(!h.canReplace(f+1,h.childCount)||!_.type.validContent(p))return!1}let a=r.indexAfter(i),l=s&&s[0];return r.node(i).canReplaceWith(a,a,l?l.type:r.node(i+1).type)}function cG(n,e,t=1,s){let r=n.doc.resolve(e),i=X.empty,o=X.empty;for(let a=r.depth,l=r.depth-t,c=t-1;a>l;a--,c--){i=X.from(r.node(a).copy(i));let u=s&&s[c];o=X.from(u?u.type.create(u.attrs,o):r.node(a).copy(o))}n.step(new jt(e,e,new he(i.append(o),t,t),!0))}function zi(n,e){let t=n.resolve(e),s=t.index();return VP(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(s,s+1)}function uG(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:s}=n.type.schema;for(let r=0;r<e.childCount;r++){let i=e.child(r),o=i.type==s?n.type.schema.nodes.text:i.type;if(t=t.matchType(o),!t||!n.type.allowsMarks(i.marks))return!1}return t.validEnd}function VP(n,e){return!!(n&&e&&!n.isLeaf&&uG(n,e))}function np(n,e,t=-1){let s=n.resolve(e);for(let r=s.depth;;r--){let i,o,a=s.index(r);if(r==s.depth?(i=s.nodeBefore,o=s.nodeAfter):t>0?(i=s.node(r+1),a++,o=s.node(r).maybeChild(a)):(i=s.node(r).maybeChild(a-1),o=s.node(r+1)),i&&!i.isTextblock&&VP(i,o)&&s.node(r).canReplace(a,a+1))return e;if(r==0)break;e=t<0?s.before(r):s.after(r)}}function hG(n,e,t){let s=null,{linebreakReplacement:r}=n.doc.type.schema,i=n.doc.resolve(e-t),o=i.node().type;if(r&&o.inlineContent){let u=o.whitespace=="pre",h=!!o.contentMatch.matchType(r);u&&!h?s=!1:!u&&h&&(s=!0)}let a=n.steps.length;if(s===!1){let u=n.doc.resolve(e+t);LP(n,u.node(),u.before(),a)}o.inlineContent&&Av(n,e+t-1,o,i.node().contentMatchAt(i.index()),s==null);let l=n.mapping.slice(a),c=l.map(e-t);if(n.step(new jt(c,l.map(e+t,-1),he.empty,!0)),s===!0){let u=n.doc.resolve(c);DP(n,u.node(),u.before(),n.steps.length)}return n}function dG(n,e,t){let s=n.resolve(e);if(s.parent.canReplaceWith(s.index(),s.index(),t))return e;if(s.parentOffset==0)for(let r=s.depth-1;r>=0;r--){let i=s.index(r);if(s.node(r).canReplaceWith(i,i,t))return s.before(r+1);if(i>0)return null}if(s.parentOffset==s.parent.content.size)for(let r=s.depth-1;r>=0;r--){let i=s.indexAfter(r);if(s.node(r).canReplaceWith(i,i,t))return s.after(r+1);if(i<s.node(r).childCount)return null}return null}function FP(n,e,t){let s=n.resolve(e);if(!t.content.size)return e;let r=t.content;for(let i=0;i<t.openStart;i++)r=r.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let o=s.depth;o>=0;o--){let a=o==s.depth?0:s.pos<=(s.start(o+1)+s.end(o+1))/2?-1:1,l=s.index(o)+(a>0?1:0),c=s.node(o),u=!1;if(i==1)u=c.canReplace(l,l,r);else{let h=c.contentMatchAt(l).findWrapping(r.firstChild.type);u=h&&c.canReplaceWith(l,l,h[0])}if(u)return a==0?s.pos:a<0?s.before(o+1):s.after(o+1)}return null}function sp(n,e,t=e,s=he.empty){if(e==t&&!s.size)return null;let r=n.resolve(e),i=n.resolve(t);return BP(r,i,s)?new jt(e,t,s):new fG(r,i,s).fit()}function BP(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class fG{constructor(e,t,s){this.$from=e,this.$to=t,this.unplaced=s,this.frontier=[],this.placed=X.empty;for(let r=0;r<=e.depth;r++){let i=e.node(r);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=X.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,s=this.$from,r=this.close(e<0?this.$to:s.doc.resolve(e));if(!r)return null;let i=this.placed,o=s.depth,a=r.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new he(i,o,a);return e>-1?new Ht(s.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||s.pos!=this.$to.pos?new jt(s.pos,r.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,s=0,r=this.unplaced.openEnd;s<e;s++){let i=t.firstChild;if(t.childCount>1&&(r=0),i.type.spec.isolating&&r<=s){e=s;break}t=i.content}for(let t=1;t<=2;t++)for(let s=t==1?e:this.unplaced.openStart;s>=0;s--){let r,i=null;s?(i=_m(this.unplaced.content,s-1).firstChild,r=i.content):r=this.unplaced.content;let o=r.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,h=null;if(t==1&&(o?c.matchType(o.type)||(h=c.fillBefore(X.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:s,frontierDepth:a,parent:i,inject:h};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:s,frontierDepth:a,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:s}=this.unplaced,r=_m(e,t);return!r.childCount||r.firstChild.isLeaf?!1:(this.unplaced=new he(e,t+1,Math.max(s,r.size+t>=e.size-s?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:s}=this.unplaced,r=_m(e,t);if(r.childCount<=1&&t>0){let i=e.size-t<=t+r.size;this.unplaced=new he(ql(e,t-1,1),t-1,i?t-1:s)}else this.unplaced=new he(ql(e,t,1),t,s)}placeNodes({sliceDepth:e,frontierDepth:t,parent:s,inject:r,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let _=0;_<i.length;_++)this.openFrontierNode(i[_]);let o=this.unplaced,a=s?s.content:o.content,l=o.openStart-e,c=0,u=[],{match:h,type:f}=this.frontier[t];if(r){for(let _=0;_<r.childCount;_++)u.push(r.child(_));h=h.matchFragment(r)}let p=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let _=a.child(c),v=h.matchType(_.type);if(!v)break;c++,(c>1||l==0||_.content.size)&&(h=v,u.push($P(_.mark(f.allowedMarks(_.marks)),c==1?l:0,c==a.childCount?p:-1)))}let m=c==a.childCount;m||(p=-1),this.placed=Kl(this.placed,t,X.from(u)),this.frontier[t].match=h,m&&p<0&&s&&s.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let _=0,v=a;_<p;_++){let I=v.lastChild;this.frontier.push({type:I.type,match:I.contentMatchAt(I.childCount)}),v=I.content}this.unplaced=m?e==0?he.empty:new he(ql(o.content,e-1,1),e-1,p<0?o.openEnd:e-1):new he(ql(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!ym(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:s}=this.$to,r=this.$to.after(s);for(;s>1&&r==this.$to.end(--s);)++r;return r}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:s,type:r}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=ym(e,t,r,s,i);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=ym(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Kl(this.placed,t.depth,t.fit)),e=t.move;for(let s=t.depth+1;s<=e.depth;s++){let r=e.node(s),i=r.type.contentMatch.fillBefore(r.content,!0,e.index(s));this.openFrontierNode(r.type,r.attrs,i)}return e}openFrontierNode(e,t=null,s){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=Kl(this.placed,this.depth,X.from(e.create(t,s))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(X.empty,!0);t.childCount&&(this.placed=Kl(this.placed,this.frontier.length,t))}}function ql(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(ql(n.firstChild.content,e-1,t)))}function Kl(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Kl(n.lastChild.content,e-1,t)))}function _m(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function $P(n,e,t){if(e<=0)return n;let s=n.content;return e>1&&(s=s.replaceChild(0,$P(s.firstChild,e-1,s.childCount==1?t-1:0))),e>0&&(s=n.type.contentMatch.fillBefore(s).append(s),t<=0&&(s=s.append(n.type.contentMatch.matchFragment(s).fillBefore(X.empty,!0)))),n.copy(s)}function ym(n,e,t,s,r){let i=n.node(e),o=r?n.indexAfter(e):n.index(e);if(o==i.childCount&&!t.compatibleContent(i.type))return null;let a=s.fillBefore(i.content,!0,o);return a&&!pG(t,i.content,o)?a:null}function pG(n,e,t){for(let s=t;s<e.childCount;s++)if(!n.allowsMarks(e.child(s).marks))return!0;return!1}function mG(n){return n.spec.defining||n.spec.definingForContent}function gG(n,e,t,s){if(!s.size)return n.deleteRange(e,t);let r=n.doc.resolve(e),i=n.doc.resolve(t);if(BP(r,i,s))return n.step(new jt(e,t,s));let o=jP(r,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(r.depth+1);o.unshift(a);for(let f=r.depth,p=r.pos-1;f>0;f--,p--){let m=r.node(f).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;o.indexOf(f)>-1?a=f:r.before(f)==p&&o.splice(1,0,-f)}let l=o.indexOf(a),c=[],u=s.openStart;for(let f=s.content,p=0;;p++){let m=f.firstChild;if(c.push(m),p==s.openStart)break;f=m.content}for(let f=u-1;f>=0;f--){let p=c[f],m=mG(p.type);if(m&&!p.sameMarkup(r.node(Math.abs(a)-1)))u=f;else if(m||!p.type.isTextblock)break}for(let f=s.openStart;f>=0;f--){let p=(f+u+1)%(s.openStart+1),m=c[p];if(m)for(let _=0;_<o.length;_++){let v=o[(_+l)%o.length],I=!0;v<0&&(I=!1,v=-v);let O=r.node(v-1),P=r.index(v-1);if(O.canReplaceWith(P,P,m.type,m.marks))return n.replace(r.before(v),I?i.after(v):t,new he(UP(s.content,0,s.openStart,p),p,s.openEnd))}}let h=n.steps.length;for(let f=o.length-1;f>=0&&(n.replace(e,t,s),!(n.steps.length>h));f--){let p=o[f];p<0||(e=r.before(p),t=i.after(p))}}function UP(n,e,t,s,r){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(UP(i.content,e+1,t,s,i)))}if(e>s){let i=r.contentMatchAt(0),o=i.fillBefore(n).append(n);n=o.append(i.matchFragment(o).fillBefore(X.empty,!0))}return n}function _G(n,e,t,s){if(!s.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let r=dG(n.doc,e,s.type);r!=null&&(e=t=r)}n.replaceRange(e,t,new he(X.from(s),0,0))}function yG(n,e,t){let s=n.doc.resolve(e),r=n.doc.resolve(t),i=jP(s,r);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||s.node(a).type.contentMatch.validEnd)return n.delete(s.start(a),r.end(a));if(a>0&&(l||s.node(a-1).canReplace(s.index(a-1),r.indexAfter(a-1))))return n.delete(s.before(a),r.after(a))}for(let o=1;o<=s.depth&&o<=r.depth;o++)if(e-s.start(o)==s.depth-o&&t>s.end(o)&&r.end(o)-t!=r.depth-o&&s.start(o-1)==r.start(o-1)&&s.node(o-1).canReplace(s.index(o-1),r.index(o-1)))return n.delete(s.before(o),t);n.delete(e,t)}function jP(n,e){let t=[],s=Math.min(n.depth,e.depth);for(let r=s;r>=0;r--){let i=n.start(r);if(i<n.pos-(n.depth-r)||e.end(r)>e.pos+(e.depth-r)||n.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;(i==e.start(r)||r==n.depth&&r==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&r&&e.start(r-1)==i-1)&&t.push(r)}return t}class Sa extends wn{constructor(e,t,s){super(),this.pos=e,this.attr=t,this.value=s}apply(e){let t=e.nodeAt(this.pos);if(!t)return Nt.fail("No node at attribute step's position");let s=Object.create(null);for(let i in t.attrs)s[i]=t.attrs[i];s[this.attr]=this.value;let r=t.type.create(s,null,t.marks);return Nt.fromReplace(e,this.pos,this.pos+1,new he(X.from(r),0,t.isLeaf?0:1))}getMap(){return Qn.empty}invert(e){return new Sa(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Sa(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Sa(t.pos,t.attr,t.value)}}wn.jsonID("attr",Sa);class Qc extends wn{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let s=e.type.create(t,e.content,e.marks);return Nt.ok(s)}getMap(){return Qn.empty}invert(e){return new Qc(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Qc(t.attr,t.value)}}wn.jsonID("docAttr",Qc);let Ua=class extends Error{};Ua=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Ua.prototype=Object.create(Error.prototype);Ua.prototype.constructor=Ua;Ua.prototype.name="TransformError";class vG{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Gc}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Ua(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,s=he.empty){let r=sp(this.doc,e,t,s);return r&&this.step(r),this}replaceWith(e,t,s){return this.replace(e,t,new he(X.from(s),0,0))}delete(e,t){return this.replace(e,t,he.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,s){return gG(this,e,t,s),this}replaceRangeWith(e,t,s){return _G(this,e,t,s),this}deleteRange(e,t){return yG(this,e,t),this}lift(e,t){return nG(this,e,t),this}join(e,t=1){return hG(this,e,t),this}wrap(e,t){return iG(this,e,t),this}setBlockType(e,t=e,s,r=null){return oG(this,e,t,s,r),this}setNodeMarkup(e,t,s=null,r){return lG(this,e,t,s,r),this}setNodeAttribute(e,t,s){return this.step(new Sa(e,t,s)),this}setDocAttribute(e,t){return this.step(new Qc(e,t)),this}addNodeMark(e,t){return this.step(new si(e,t)),this}removeNodeMark(e,t){let s=this.doc.nodeAt(e);if(!s)throw new RangeError("No node at position "+e);if(t instanceof ct)t.isInSet(s.marks)&&this.step(new Vo(e,t));else{let r=s.marks,i,o=[];for(;i=t.isInSet(r);)o.push(new Vo(e,i)),r=i.removeFromSet(r);for(let a=o.length-1;a>=0;a--)this.step(o[a])}return this}split(e,t=1,s){return cG(this,e,t,s),this}addMark(e,t,s){return Z8(this,e,t,s),this}removeMark(e,t,s){return eG(this,e,t,s),this}clearIncompatible(e,t,s){return Av(this,e,t,s),this}}const vm=Object.create(null);class Le{constructor(e,t,s){this.$anchor=e,this.$head=t,this.ranges=s||[new bG(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=he.empty){let s=t.content.lastChild,r=null;for(let a=0;a<t.openEnd;a++)r=s,s=s.lastChild;let i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(i);e.replaceRange(u.map(l.pos),u.map(c.pos),a?he.empty:t),a==0&&BT(e,i,(s?s.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let s=e.steps.length,r=this.ranges;for(let i=0;i<r.length;i++){let{$from:o,$to:a}=r[i],l=e.mapping.slice(s),c=l.map(o.pos),u=l.map(a.pos);i?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),BT(e,s,t.isInline?-1:1))}}static findFrom(e,t,s=!1){let r=e.parent.inlineContent?new Ne(e):la(e.node(0),e.parent,e.pos,e.index(),t,s);if(r)return r;for(let i=e.depth-1;i>=0;i--){let o=t<0?la(e.node(0),e.node(i),e.before(i+1),e.index(i),t,s):la(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,s);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new es(e.node(0))}static atStart(e){return la(e,e,0,0,1)||new es(e)}static atEnd(e){return la(e,e,e.content.size,e.childCount,-1)||new es(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let s=vm[t.type];if(!s)throw new RangeError(`No selection type ${t.type} defined`);return s.fromJSON(e,t)}static jsonID(e,t){if(e in vm)throw new RangeError("Duplicate use of selection JSON ID "+e);return vm[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Ne.between(this.$anchor,this.$head).getBookmark()}}Le.prototype.visible=!0;class bG{constructor(e,t){this.$from=e,this.$to=t}}let VT=!1;function FT(n){!VT&&!n.parent.inlineContent&&(VT=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class Ne extends Le{constructor(e,t=e){FT(e),FT(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let s=e.resolve(t.map(this.head));if(!s.parent.inlineContent)return Le.near(s);let r=e.resolve(t.map(this.anchor));return new Ne(r.parent.inlineContent?r:s,s)}replace(e,t=he.empty){if(super.replace(e,t),t==he.empty){let s=this.$from.marksAcross(this.$to);s&&e.ensureMarks(s)}}eq(e){return e instanceof Ne&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new rp(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ne(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,s=t){let r=e.resolve(t);return new this(r,s==t?r:e.resolve(s))}static between(e,t,s){let r=e.pos-t.pos;if((!s||r)&&(s=r>=0?1:-1),!t.parent.inlineContent){let i=Le.findFrom(t,s,!0)||Le.findFrom(t,-s,!0);if(i)t=i.$head;else return Le.near(t,s)}return e.parent.inlineContent||(r==0?e=t:(e=(Le.findFrom(e,-s,!0)||Le.findFrom(e,s,!0)).$anchor,e.pos<t.pos!=r<0&&(e=t))),new Ne(e,t)}}Le.jsonID("text",Ne);class rp{constructor(e,t){this.anchor=e,this.head=t}map(e){return new rp(e.map(this.anchor),e.map(this.head))}resolve(e){return Ne.between(e.resolve(this.anchor),e.resolve(this.head))}}class Ee extends Le{constructor(e){let t=e.nodeAfter,s=e.node(0).resolve(e.pos+t.nodeSize);super(e,s),this.node=t}map(e,t){let{deleted:s,pos:r}=t.mapResult(this.anchor),i=e.resolve(r);return s?Le.near(i):new Ee(i)}content(){return new he(X.from(this.node),0,0)}eq(e){return e instanceof Ee&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Pv(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ee(e.resolve(t.anchor))}static create(e,t){return new Ee(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Ee.prototype.visible=!1;Le.jsonID("node",Ee);class Pv{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:s}=e.mapResult(this.anchor);return t?new rp(s,s):new Pv(s)}resolve(e){let t=e.resolve(this.anchor),s=t.nodeAfter;return s&&Ee.isSelectable(s)?new Ee(t):Le.near(t)}}class es extends Le{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=he.empty){if(t==he.empty){e.delete(0,e.doc.content.size);let s=Le.atStart(e.doc);s.eq(e.selection)||e.setSelection(s)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new es(e)}map(e){return new es(e)}eq(e){return e instanceof es}getBookmark(){return wG}}Le.jsonID("all",es);const wG={map(){return this},resolve(n){return new es(n)}};function la(n,e,t,s,r,i=!1){if(e.inlineContent)return Ne.create(n,t);for(let o=s-(r>0?0:1);r>0?o<e.childCount:o>=0;o+=r){let a=e.child(o);if(a.isAtom){if(!i&&Ee.isSelectable(a))return Ee.create(n,t-(r<0?a.nodeSize:0))}else{let l=la(n,a,t+r,r<0?a.childCount:0,r,i);if(l)return l}t+=a.nodeSize*r}return null}function BT(n,e,t){let s=n.steps.length-1;if(s<e)return;let r=n.steps[s];if(!(r instanceof jt||r instanceof Ht))return;let i=n.mapping.maps[s],o;i.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(Le.near(n.doc.resolve(o),t))}const $T=1,UT=2,jT=4;class EG extends vG{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|$T)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&$T)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=UT,this}ensureMarks(e){return ct.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&UT)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&-3,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let s=this.selection;return t&&(e=e.mark(this.storedMarks||(s.empty?s.$from.marks():s.$from.marksAcross(s.$to)||ct.none))),s.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,s){let r=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(s==null&&(s=t),s=s??t,!e)return this.deleteRange(t,s);let i=this.storedMarks;if(!i){let o=this.doc.resolve(t);i=s==t?o.marks():o.marksAcross(this.doc.resolve(s))}return this.replaceRangeWith(t,s,r.text(e,i)),this.selection.empty||this.setSelection(Le.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=jT,this}get scrolledIntoView(){return(this.updated&jT)>0}}function zT(n,e){return!e||!n?n:n.bind(e)}class Gl{constructor(e,t,s){this.name=e,this.init=zT(t.init,s),this.apply=zT(t.apply,s)}}const TG=[new Gl("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Gl("selection",{init(n,e){return n.selection||Le.atStart(e.doc)},apply(n){return n.selection}}),new Gl("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,s){return s.selection.$cursor?n.storedMarks:null}}),new Gl("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class bm{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=TG.slice(),t&&t.forEach(s=>{if(this.pluginsByKey[s.key])throw new RangeError("Adding different instances of a keyed plugin ("+s.key+")");this.plugins.push(s),this.pluginsByKey[s.key]=s,s.spec.state&&this.fields.push(new Gl(s.key,s.spec.state,s))})}}class da{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let s=0;s<this.config.plugins.length;s++)if(s!=t){let r=this.config.plugins[s];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],s=this.applyInner(e),r=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=r?r[o].n:0,c=r?r[o].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,s);if(u&&s.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!r){r=[];for(let h=0;h<this.config.plugins.length;h++)r.push(h<o?{state:s,n:t.length}:{state:this,n:0})}t.push(u),s=s.applyInner(u),i=!0}r&&(r[o]={state:s,n:t.length})}}if(!i)return{state:s,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new da(this.config),s=this.config.fields;for(let r=0;r<s.length;r++){let i=s[r];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new EG(this)}static create(e){let t=new bm(e.doc?e.doc.type.schema:e.schema,e.plugins),s=new da(t);for(let r=0;r<t.fields.length;r++)s[t.fields[r].name]=t.fields[r].init(e,s);return s}reconfigure(e){let t=new bm(this.schema,e.plugins),s=t.fields,r=new da(t);for(let i=0;i<s.length;i++){let o=s[i].name;r[o]=this.hasOwnProperty(o)?this[o]:s[i].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(s=>s.toJSON())),e&&typeof e=="object")for(let s in e){if(s=="doc"||s=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[s],i=r.spec.state;i&&i.toJSON&&(t[s]=i.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,s){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let r=new bm(e.schema,e.plugins),i=new da(r);return r.fields.forEach(o=>{if(o.name=="doc")i.doc=di.fromJSON(e.schema,t.doc);else if(o.name=="selection")i.selection=Le.fromJSON(i.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(s)for(let a in s){let l=s[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){i[o.name]=c.fromJSON.call(l,e,t[a],i);return}}i[o.name]=o.init(e,i)}}),i}}function zP(n,e,t){for(let s in n){let r=n[s];r instanceof Function?r=r.bind(e):s=="handleDOMEvents"&&(r=zP(r,e,{})),t[s]=r}return t}class Wn{constructor(e){this.spec=e,this.props={},e.props&&zP(e.props,this,this.props),this.key=e.key?e.key.key:HP("plugin")}getState(e){return e[this.key]}}const wm=Object.create(null);function HP(n){return n in wm?n+"$"+ ++wm[n]:(wm[n]=0,n+"$")}class sr{constructor(e="key"){this.key=HP(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Zt=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},ja=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let Jg=null;const hr=function(n,e,t){let s=Jg||(Jg=document.createRange());return s.setEnd(n,t??n.nodeValue.length),s.setStart(n,e||0),s},SG=function(){Jg=null},Fo=function(n,e,t,s){return t&&(HT(n,e,t,s,-1)||HT(n,e,t,s,1))},IG=/^(img|br|input|textarea|hr)$/i;function HT(n,e,t,s,r){for(;;){if(n==t&&e==s)return!0;if(e==(r<0?0:as(n))){let i=n.parentNode;if(!i||i.nodeType!=1||Iu(n)||IG.test(n.nodeName)||n.contentEditable=="false")return!1;e=Zt(n)+(r<0?0:1),n=i}else if(n.nodeType==1){if(n=n.childNodes[e+(r<0?-1:0)],n.contentEditable=="false")return!1;e=r<0?as(n):0}else return!1}}function as(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function CG(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=as(n)}else if(n.parentNode&&!Iu(n))e=Zt(n),n=n.parentNode;else return null}}function kG(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!Iu(n))e=Zt(n)+1,n=n.parentNode;else return null}}function AG(n,e,t){for(let s=e==0,r=e==as(n);s||r;){if(n==t)return!0;let i=Zt(n);if(n=n.parentNode,!n)return!1;s=s&&i==0,r=r&&i==as(n)}}function Iu(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const ip=function(n){return n.focusNode&&Fo(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function oo(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function RG(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function PG(n,e,t){if(n.caretPositionFromPoint)try{let s=n.caretPositionFromPoint(e,t);if(s)return{node:s.offsetNode,offset:Math.min(as(s.offsetNode),s.offset)}}catch{}if(n.caretRangeFromPoint){let s=n.caretRangeFromPoint(e,t);if(s)return{node:s.startContainer,offset:Math.min(as(s.startContainer),s.startOffset)}}}const Js=typeof navigator<"u"?navigator:null,WT=typeof document<"u"?document:null,Hi=Js&&Js.userAgent||"",Yg=/Edge\/(\d+)/.exec(Hi),WP=/MSIE \d/.exec(Hi),Xg=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Hi),zn=!!(WP||Xg||Yg),pi=WP?document.documentMode:Xg?+Xg[1]:Yg?+Yg[1]:0,xs=!zn&&/gecko\/(\d+)/i.test(Hi);xs&&+(/Firefox\/(\d+)/.exec(Hi)||[0,0])[1];const Zg=!zn&&/Chrome\/(\d+)/.exec(Hi),_n=!!Zg,qP=Zg?+Zg[1]:0,On=!zn&&!!Js&&/Apple Computer/.test(Js.vendor),za=On&&(/Mobile\/\w+/.test(Hi)||!!Js&&Js.maxTouchPoints>2),rs=za||(Js?/Mac/.test(Js.platform):!1),xG=Js?/Win/.test(Js.platform):!1,_r=/Android \d/.test(Hi),Cu=!!WT&&"webkitFontSmoothing"in WT.documentElement.style,NG=Cu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function OG(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function cr(n,e){return typeof n=="number"?n:n[e]}function MG(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,s=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*s}}function qT(n,e,t){let s=n.someProp("scrollThreshold")||0,r=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let o=t||n.dom;o;){if(o.nodeType!=1){o=ja(o);continue}let a=o,l=a==i.body,c=l?OG(i):MG(a),u=0,h=0;if(e.top<c.top+cr(s,"top")?h=-(c.top-e.top+cr(r,"top")):e.bottom>c.bottom-cr(s,"bottom")&&(h=e.bottom-e.top>c.bottom-c.top?e.top+cr(r,"top")-c.top:e.bottom-c.bottom+cr(r,"bottom")),e.left<c.left+cr(s,"left")?u=-(c.left-e.left+cr(r,"left")):e.right>c.right-cr(s,"right")&&(u=e.right-c.right+cr(r,"right")),u||h)if(l)i.defaultView.scrollBy(u,h);else{let p=a.scrollLeft,m=a.scrollTop;h&&(a.scrollTop+=h),u&&(a.scrollLeft+=u);let _=a.scrollLeft-p,v=a.scrollTop-m;e={left:e.left-_,top:e.top-v,right:e.right-_,bottom:e.bottom-v}}let f=l?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(f))break;o=f=="absolute"?o.offsetParent:ja(o)}}function DG(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),s,r;for(let i=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(i,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){s=a,r=l.top;break}}return{refDOM:s,refTop:r,stack:KP(n.dom)}}function KP(n){let e=[],t=n.ownerDocument;for(let s=n;s&&(e.push({dom:s,top:s.scrollTop,left:s.scrollLeft}),n!=t);s=ja(s));return e}function LG({refDOM:n,refTop:e,stack:t}){let s=n?n.getBoundingClientRect().top:0;GP(t,s==0?0:s-e)}function GP(n,e){for(let t=0;t<n.length;t++){let{dom:s,top:r,left:i}=n[t];s.scrollTop!=r+e&&(s.scrollTop=r+e),s.scrollLeft!=i&&(s.scrollLeft=i)}}let ea=null;function VG(n){if(n.setActive)return n.setActive();if(ea)return n.focus(ea);let e=KP(n);n.focus(ea==null?{get preventScroll(){return ea={preventScroll:!0},!0}}:void 0),ea||(ea=!1,GP(e,0))}function QP(n,e){let t,s=2e8,r,i=0,o=e.top,a=e.top,l,c;for(let u=n.firstChild,h=0;u;u=u.nextSibling,h++){let f;if(u.nodeType==1)f=u.getClientRects();else if(u.nodeType==3)f=hr(u).getClientRects();else continue;for(let p=0;p<f.length;p++){let m=f[p];if(m.top<=o&&m.bottom>=a){o=Math.max(m.bottom,o),a=Math.min(m.top,a);let _=m.left>e.left?m.left-e.left:m.right<e.left?e.left-m.right:0;if(_<s){t=u,s=_,r=_&&t.nodeType==3?{left:m.right<e.left?m.right:m.left,top:e.top}:e,u.nodeType==1&&_&&(i=h+(e.left>=(m.left+m.right)/2?1:0));continue}}else m.top>e.top&&!l&&m.left<=e.left&&m.right>=e.left&&(l=u,c={left:Math.max(m.left,Math.min(m.right,e.left)),top:m.top});!t&&(e.left>=m.right&&e.top>=m.top||e.left>=m.left&&e.top>=m.bottom)&&(i=h+1)}}return!t&&l&&(t=l,r=c,s=0),t&&t.nodeType==3?FG(t,r):!t||s&&t.nodeType==1?{node:n,offset:i}:QP(t,r)}function FG(n,e){let t=n.nodeValue.length,s=document.createRange();for(let r=0;r<t;r++){s.setEnd(n,r+1),s.setStart(n,r);let i=jr(s,1);if(i.top!=i.bottom&&xv(e,i))return{node:n,offset:r+(e.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function xv(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function BG(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function $G(n,e,t){let{node:s,offset:r}=QP(e,t),i=-1;if(s.nodeType==1&&!s.firstChild){let o=s.getBoundingClientRect();i=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(s,r,i)}function UG(n,e,t,s){let r=-1;for(let i=e,o=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!o&&l.left>s.left||l.top>s.top?r=a.posBefore:(!o&&l.right<s.left||l.bottom<s.top)&&(r=a.posAfter),o=!0),!a.contentDOM&&r<0&&!a.node.isText))return(a.node.isBlock?s.top<(l.top+l.bottom)/2:s.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;i=a.dom.parentNode}return r>-1?r:n.docView.posFromDOM(e,t,-1)}function JP(n,e,t){let s=n.childNodes.length;if(s&&t.top<t.bottom)for(let r=Math.max(0,Math.min(s-1,Math.floor(s*(e.top-t.top)/(t.bottom-t.top))-2)),i=r;;){let o=n.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(xv(e,c))return JP(o,e,c)}}if((i=(i+1)%s)==r)break}return n}function jG(n,e){let t=n.dom.ownerDocument,s,r=0,i=PG(t,e.left,e.top);i&&({node:s,offset:r}=i);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!xv(e,c)||(o=JP(n.dom,e,c),!o))return null}if(On)for(let c=o;s&&c;c=ja(c))c.draggable&&(s=void 0);if(o=BG(o,e),s){if(xs&&s.nodeType==1&&(r=Math.min(r,s.childNodes.length),r<s.childNodes.length)){let u=s.childNodes[r],h;u.nodeName=="IMG"&&(h=u.getBoundingClientRect()).right<=e.left&&h.bottom>e.top&&r++}let c;Cu&&r&&s.nodeType==1&&(c=s.childNodes[r-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&r--,s==n.dom&&r==s.childNodes.length-1&&s.lastChild.nodeType==1&&e.top>s.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(r==0||s.nodeType!=1||s.childNodes[r-1].nodeName!="BR")&&(a=UG(n,s,r,e))}a==null&&(a=$G(n,o,e));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function KT(n){return n.top<n.bottom||n.left<n.right}function jr(n,e){let t=n.getClientRects();if(t.length){let s=t[e<0?0:t.length-1];if(KT(s))return s}return Array.prototype.find.call(t,KT)||n.getBoundingClientRect()}const zG=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function YP(n,e,t){let{node:s,offset:r,atom:i}=n.docView.domFromPos(e,t<0?-1:1),o=Cu||xs;if(s.nodeType==3)if(o&&(zG.test(s.nodeValue)||(t<0?!r:r==s.nodeValue.length))){let l=jr(hr(s,r,r),t);if(xs&&r&&/\s/.test(s.nodeValue[r-1])&&r<s.nodeValue.length){let c=jr(hr(s,r-1,r-1),-1);if(c.top==l.top){let u=jr(hr(s,r,r+1),-1);if(u.top!=l.top)return Ll(u,u.left<c.left)}}return l}else{let l=r,c=r,u=t<0?1:-1;return t<0&&!r?(c++,u=-1):t>=0&&r==s.nodeValue.length?(l--,u=1):t<0?l--:c++,Ll(jr(hr(s,l,c),u),u<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&r&&(t<0||r==as(s))){let l=s.childNodes[r-1];if(l.nodeType==1)return Em(l.getBoundingClientRect(),!1)}if(i==null&&r<as(s)){let l=s.childNodes[r];if(l.nodeType==1)return Em(l.getBoundingClientRect(),!0)}return Em(s.getBoundingClientRect(),t>=0)}if(i==null&&r&&(t<0||r==as(s))){let l=s.childNodes[r-1],c=l.nodeType==3?hr(l,as(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Ll(jr(c,1),!1)}if(i==null&&r<as(s)){let l=s.childNodes[r];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?hr(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return Ll(jr(c,-1),!0)}return Ll(jr(s.nodeType==3?hr(s):s,-t),t>=0)}function Ll(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Em(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function XP(n,e,t){let s=n.state,r=n.root.activeElement;s!=e&&n.updateState(e),r!=n.dom&&n.focus();try{return t()}finally{s!=e&&n.updateState(s),r!=n.dom&&r&&r.focus()}}function HG(n,e,t){let s=e.selection,r=t=="up"?s.$from:s.$to;return XP(n,e,()=>{let{node:i}=n.docView.domFromPos(r.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=YP(n,r.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=hr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const WG=/[\u0590-\u08ac]/;function qG(n,e,t){let{$head:s}=e.selection;if(!s.parent.isTextblock)return!1;let r=s.parentOffset,i=!r,o=r==s.parent.content.size,a=n.domSelection();return a?!WG.test(s.parent.textContent)||!a.modify?t=="left"||t=="backward"?i:o:XP(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:h}=n.domSelectionRange(),f=a.caretBidiLevel;a.modify("move",t,"character");let p=s.depth?n.docView.domAfterPos(s.before()):n.dom,{focusNode:m,focusOffset:_}=n.domSelectionRange(),v=m&&!p.contains(m.nodeType==1?m:m.parentNode)||l==m&&c==_;try{a.collapse(u,h),l&&(l!=u||c!=h)&&a.extend&&a.extend(l,c)}catch{}return f!=null&&(a.caretBidiLevel=f),v}):s.pos==s.start()||s.pos==s.end()}let GT=null,QT=null,JT=!1;function KG(n,e,t){return GT==e&&QT==t?JT:(GT=e,QT=t,JT=t=="up"||t=="down"?HG(n,e,t):qG(n,e,t))}const us=0,YT=1,ho=2,Ys=3;class ku{constructor(e,t,s,r){this.parent=e,this.children=t,this.dom=s,this.contentDOM=r,this.dirty=us,s.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,s){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,s=this.posAtStart;;t++){let r=this.children[t];if(r==e)return s;s+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,s){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(s<0){let i,o;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let r;if(e==this.dom&&this.contentDOM)r=t>Zt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){r=!1;break}if(i.previousSibling)break}if(r==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){r=!0;break}if(i.nextSibling)break}}return r??s>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let s=!0,r=e;r;r=r.parentNode){let i=this.getDesc(r),o;if(i&&(!t||i.node))if(s&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))s=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let s=t;s;s=s.parent)if(s==this)return t}posFromDOM(e,t,s){for(let r=e;r;r=r.parentNode){let i=this.getDesc(r);if(i)return i.localPosFromDOM(e,t,s)}return-1}descAt(e){for(let t=0,s=0;t<this.children.length;t++){let r=this.children[t],i=s+r.size;if(s==e&&i!=s){for(;!r.border&&r.children.length;)for(let o=0;o<r.children.length;o++){let a=r.children[o];if(a.size){r=a;break}}return r}if(e<i)return r.descAt(e-s-r.border);s=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let s=0,r=0;for(let i=0;s<this.children.length;s++){let o=this.children[s],a=i+o.size;if(a>e||o instanceof ex){r=e-i;break}i=a}if(r)return this.children[s].domFromPos(r-this.children[s].border,t);for(let i;s&&!(i=this.children[s-1]).size&&i instanceof ZP&&i.side>=0;s--);if(t<=0){let i,o=!0;for(;i=s?this.children[s-1]:null,!(!i||i.dom.parentNode==this.contentDOM);s--,o=!1);return i&&t&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?Zt(i.dom)+1:0}}else{let i,o=!0;for(;i=s<this.children.length?this.children[s]:null,!(!i||i.dom.parentNode==this.contentDOM);s++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?Zt(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,s=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,i=-1;for(let o=s,a=0;;a++){let l=this.children[a],c=o+l.size;if(r==-1&&e<=c){let u=o+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=o;for(let h=a;h>0;h--){let f=this.children[h-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){r=Zt(f.dom)+1;break}e-=f.size}r==-1&&(r=0)}if(r>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let h=this.children[u];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){i=Zt(h.dom);break}t+=h.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:s}=this.domFromPos(e,0);if(t.nodeType!=1||s==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[s]}setSelection(e,t,s,r=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let p=0,m=0;p<this.children.length;p++){let _=this.children[p],v=m+_.size;if(i>m&&o<v)return _.setSelection(e-m-_.border,t-m-_.border,s,r);m=v}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=s.root.getSelection(),u=s.domSelectionRange(),h=!1;if((xs||On)&&e==t){let{node:p,offset:m}=a;if(p.nodeType==3){if(h=!!(m&&p.nodeValue[m-1]==`
`),h&&m==p.nodeValue.length)for(let _=p,v;_;_=_.parentNode){if(v=_.nextSibling){v.nodeName=="BR"&&(a=l={node:v.parentNode,offset:Zt(v)+1});break}let I=_.pmViewDesc;if(I&&I.node&&I.node.isBlock)break}}else{let _=p.childNodes[m-1];h=_&&(_.nodeName=="BR"||_.contentEditable=="false")}}if(xs&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let p=u.focusNode.childNodes[u.focusOffset];p&&p.contentEditable=="false"&&(r=!0)}if(!(r||h&&On)&&Fo(a.node,a.offset,u.anchorNode,u.anchorOffset)&&Fo(l.node,l.offset,u.focusNode,u.focusOffset))return;let f=!1;if((c.extend||e==t)&&!h){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),f=!0}catch{}}if(!f){if(e>t){let m=a;a=l,l=m}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let s=0,r=0;r<this.children.length;r++){let i=this.children[r],o=s+i.size;if(s==o?e<=o&&t>=s:e<o&&t>s){let a=s+i.border,l=o-i.border;if(e>=a&&t<=l){this.dirty=e==s||t==o?ho:YT,e==a&&t==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=Ys:i.markDirty(e-a,t-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?ho:Ys}s=o}this.dirty=ho}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let s=e==1?ho:YT;t.dirty<s&&(t.dirty=s)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class ZP extends ku{constructor(e,t,s,r){let i,o=t.type.toDOM;if(typeof o=="function"&&(o=o(s,()=>{if(!i)return r;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==us&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class GG extends ku{constructor(e,t,s,r){super(e,[],t,null),this.textDOM=s,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Bo extends ku{constructor(e,t,s,r,i){super(e,[],s,r),this.mark=t,this.spec=i}static create(e,t,s,r){let i=r.nodeViews[t.type.name],o=i&&i(t,r,s);return(!o||!o.dom)&&(o=Wo.renderSpec(document,t.type.spec.toDOM(t,s),null,t.attrs)),new Bo(e,t,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Ys||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Ys&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=us){let s=this.parent;for(;!s.node;)s=s.parent;s.dirty<this.dirty&&(s.dirty=this.dirty),this.dirty=us}}slice(e,t,s){let r=Bo.create(this.parent,this.mark,!0,s),i=this.children,o=this.size;t<o&&(i=t_(i,t,o,s)),e>0&&(i=t_(i,0,e,s));for(let a=0;a<i.length;a++)i[a].parent=r;return r.children=i,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class mi extends ku{constructor(e,t,s,r,i,o,a,l,c){super(e,[],i,o),this.node=t,this.outerDeco=s,this.innerDeco=r,this.nodeDOM=a}static create(e,t,s,r,i,o){let a=i.nodeViews[t.type.name],l,c=a&&a(t,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},s,r),u=c&&c.dom,h=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:h}=Wo.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!h&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let f=u;return u=sx(u,s,t),c?l=new QG(e,t,s,r,u,h||null,f,c,i,o+1):t.isText?new op(e,t,s,r,u,f,i):new mi(e,t,s,r,u,h||null,f,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let s=this.children[t];if(this.dom.contains(s.dom.parentNode)){e.contentElement=s.dom.parentNode;break}}e.contentElement||(e.getContent=()=>X.empty)}return e}matchesNode(e,t,s){return this.dirty==us&&e.eq(this.node)&&Ld(t,this.outerDeco)&&s.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let s=this.node.inlineContent,r=t,i=e.composing?this.localCompositionInfo(e,t):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new YG(this,o&&o.node,e);eQ(this.node,this.innerDeco,(c,u,h)=>{c.spec.marks?l.syncToMarks(c.spec.marks,s,e):c.type.side>=0&&!h&&l.syncToMarks(u==this.node.childCount?ct.none:this.node.child(u).marks,s,e),l.placeWidget(c,e,r)},(c,u,h,f)=>{l.syncToMarks(c.marks,s,e);let p;l.findNodeMatch(c,u,h,f)||a&&e.state.selection.from>r&&e.state.selection.to<r+c.nodeSize&&(p=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,u,h,p,e)||l.updateNextNode(c,u,h,e,f,r)||l.addNode(c,u,h,e,r),r+=c.nodeSize}),l.syncToMarks([],s,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==ho)&&(o&&this.protectLocalComposition(e,o),tx(this.contentDOM,this.children,e),za&&tQ(this.dom))}localCompositionInfo(e,t){let{from:s,to:r}=e.state.selection;if(!(e.state.selection instanceof Ne)||s<t||r>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=nQ(this.node.content,o,s-t,r-t);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:s,text:r}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new GG(this,i,t,r);e.input.compositionNodes.push(o),this.children=t_(this.children,s,s+r.length,e,o)}update(e,t,s,r){return this.dirty==Ys||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,s,r),!0)}updateInner(e,t,s,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=s,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=us}updateOuterDeco(e){if(Ld(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,s=this.dom;this.dom=nx(this.dom,this.nodeDOM,e_(this.outerDeco,this.node,t),e_(e,this.node,t)),this.dom!=s&&(s.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function XT(n,e,t,s,r){sx(s,e,n);let i=new mi(void 0,n,e,t,s,s,s,r,0);return i.contentDOM&&i.updateChildren(r,0),i}class op extends mi{constructor(e,t,s,r,i,o,a){super(e,t,s,r,i,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,s,r){return this.dirty==Ys||this.dirty!=us&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=us||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=us,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,s){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,s)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,s){let r=this.node.cut(e,t),i=document.createTextNode(r.text);return new op(this.parent,r,this.outerDeco,this.innerDeco,i,i,s)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Ys)}get domAtom(){return!1}isText(e){return this.node.text==e}}class ex extends ku{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==us&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class QG extends mi{constructor(e,t,s,r,i,o,a,l,c,u){super(e,t,s,r,i,o,a,c,u),this.spec=l}update(e,t,s,r){if(this.dirty==Ys)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,t,s);return i&&this.updateInner(e,t,s,r),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,s,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,s,r){this.spec.setSelection?this.spec.setSelection(e,t,s.root):super.setSelection(e,t,s,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function tx(n,e,t){let s=n.firstChild,r=!1;for(let i=0;i<e.length;i++){let o=e[i],a=o.dom;if(a.parentNode==n){for(;a!=s;)s=ZT(s),r=!0;s=s.nextSibling}else r=!0,n.insertBefore(a,s);if(o instanceof Bo){let l=s?s.previousSibling:n.lastChild;tx(o.contentDOM,o.children,t),s=l?l.nextSibling:n.firstChild}}for(;s;)s=ZT(s),r=!0;r&&t.trackWrites==n&&(t.trackWrites=null)}const gc=function(n){n&&(this.nodeName=n)};gc.prototype=Object.create(null);const fo=[new gc];function e_(n,e,t){if(n.length==0)return fo;let s=t?fo[0]:new gc,r=[s];for(let i=0;i<n.length;i++){let o=n[i].type.attrs;if(o){o.nodeName&&r.push(s=new gc(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&r.length==1&&r.push(s=new gc(e.isInline?"span":"div")),a=="class"?s.class=(s.class?s.class+" ":"")+l:a=="style"?s.style=(s.style?s.style+";":"")+l:a!="nodeName"&&(s[a]=l))}}}return r}function nx(n,e,t,s){if(t==fo&&s==fo)return e;let r=e;for(let i=0;i<s.length;i++){let o=s[i],a=t[i];if(i){let l;a&&a.nodeName==o.nodeName&&r!=n&&(l=r.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(r),a=fo[0]),r=l}JG(r,a||fo[0],o)}return r}function JG(n,e,t){for(let s in e)s!="class"&&s!="style"&&s!="nodeName"&&!(s in t)&&n.removeAttribute(s);for(let s in t)s!="class"&&s!="style"&&s!="nodeName"&&t[s]!=e[s]&&n.setAttribute(s,t[s]);if(e.class!=t.class){let s=e.class?e.class.split(" ").filter(Boolean):[],r=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&n.classList.remove(s[i]);for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&n.classList.add(r[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let s=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=s.exec(e.style);)n.style.removeProperty(r[1])}t.style&&(n.style.cssText+=t.style)}}function sx(n,e,t){return nx(n,n,fo,e_(e,t,n.nodeType!=1))}function Ld(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function ZT(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class YG{constructor(e,t,s){this.lock=t,this.view=s,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=XG(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let s=e;s<t;s++)this.top.children[s].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,s){let r=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;r<o&&(r==i-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&e[r].type.spec.spanning!==!1;)r++;for(;r<i;)this.destroyRest(),this.top.dirty=us,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Bo.create(this.top,e[i],t,s);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,s,r){let i=-1,o;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,s))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,s)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,s,r,i){let o=this.top.children[r];return o.dirty==Ys&&o.dom==o.contentDOM&&(o.dirty=ho),o.update(e,t,s,i)?(this.destroyBetween(this.index,r),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let s=e.pmViewDesc;if(s){for(let r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==s)return r}return-1}e=t}}updateNextNode(e,t,s,r,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof mi){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let u=l.dom,h,f=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Ys&&Ld(t,l.outerDeco));if(!f&&l.update(e,t,s,r))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!f&&(h=this.recreateWrapper(l,e,t,s,r,o)))return this.destroyBetween(this.index,a),this.top.children[this.index]=h,h.contentDOM&&(h.dirty=ho,h.updateChildren(r,o+1),h.dirty=us),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,s,r,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!Ld(s,e.outerDeco)||!r.eq(e.innerDeco))return null;let a=mi.create(this.top,t,s,r,i,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,s,r,i){let o=mi.create(this.top,e,t,s,r,i);o.contentDOM&&o.updateChildren(r,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,s){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(e)&&(e==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let i=new ZP(this.top,e,t,s);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Bo;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof op)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((On||_n)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let s=document.createElement(e);e=="IMG"&&(s.className="ProseMirror-separator",s.alt=""),e=="BR"&&(s.className="ProseMirror-trailingBreak");let r=new ex(this.top,[],s,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function XG(n,e){let t=e,s=t.children.length,r=n.childCount,i=new Map,o=[];e:for(;r>0;){let a;for(;;)if(s){let c=t.children[s-1];if(c instanceof Bo)t=c,s=c.children.length;else{a=c,s--;break}}else{if(t==e)break e;s=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(r-1))break;--r,i.set(a,r),o.push(a)}}return{index:r,matched:i,matches:o.reverse()}}function ZG(n,e){return n.type.side-e.type.side}function eQ(n,e,t,s){let r=e.locals(n),i=0;if(r.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);s(u,r,e.forChild(i,u),c),i+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,h;for(;o<r.length&&r[o].to==i;){let v=r[o++];v.widget&&(u?(h||(h=[u])).push(v):u=v)}if(u)if(h){h.sort(ZG);for(let v=0;v<h.length;v++)t(h[v],c,!!l)}else t(u,c,!!l);let f,p;if(l)p=-1,f=l,l=null;else if(c<n.childCount)p=c,f=n.child(c++);else break;for(let v=0;v<a.length;v++)a[v].to<=i&&a.splice(v--,1);for(;o<r.length&&r[o].from<=i&&r[o].to>i;)a.push(r[o++]);let m=i+f.nodeSize;if(f.isText){let v=m;o<r.length&&r[o].from<v&&(v=r[o].from);for(let I=0;I<a.length;I++)a[I].to<v&&(v=a[I].to);v<m&&(l=f.cut(v-i),f=f.cut(0,v-i),m=v,p=-1)}else for(;o<r.length&&r[o].to<m;)o++;let _=f.isInline&&!f.isLeaf?a.filter(v=>!v.inline):a.slice();s(f,_,e.forChild(i,f),p),i=m}}function tQ(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function nQ(n,e,t,s){for(let r=0,i=0;r<n.childCount&&i<=s;){let o=n.child(r++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;r<n.childCount;){let c=n.child(r++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=t){if(i>=s&&l.slice(s-e.length-a,s-a)==e)return s-e.length;let c=a<s?l.lastIndexOf(e,s-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==s&&l.length>=s+e.length-a&&l.slice(s-a,s-a+e.length)==e)return s}}return-1}function t_(n,e,t,s,r){let i=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=t||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,s)),r&&(i.push(r),r=void 0),u>t&&i.push(l.slice(t-c,l.size,s)))}return i}function Nv(n,e=null){let t=n.domSelectionRange(),s=n.state.doc;if(!t.focusNode)return null;let r=n.docView.nearestDesc(t.focusNode),i=r&&r.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=s.resolve(o),l,c;if(ip(t)){for(l=o;r&&!r.node;)r=r.parent;let h=r.node;if(r&&h.isAtom&&Ee.isSelectable(h)&&r.parent&&!(h.isInline&&AG(t.focusNode,t.focusOffset,r.dom))){let f=r.posBefore;c=new Ee(o==f?a:s.resolve(f))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let h=o,f=o;for(let p=0;p<t.rangeCount;p++){let m=t.getRangeAt(p);h=Math.min(h,n.docView.posFromDOM(m.startContainer,m.startOffset,1)),f=Math.max(f,n.docView.posFromDOM(m.endContainer,m.endOffset,-1))}if(h<0)return null;[l,o]=f==n.state.selection.anchor?[f,h]:[h,f],a=s.resolve(o)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let u=s.resolve(l);if(!c){let h=e=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=Ov(n,u,a,h)}return c}function rx(n){return n.editable?n.hasFocus():ox(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Tr(n,e=!1){let t=n.state.selection;if(ix(n,t),!!rx(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&_n){let s=n.domSelectionRange(),r=n.domObserver.currentSelection;if(s.anchorNode&&r.anchorNode&&Fo(s.anchorNode,s.anchorOffset,r.anchorNode,r.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)rQ(n);else{let{anchor:s,head:r}=t,i,o;eS&&!(t instanceof Ne)&&(t.$from.parent.inlineContent||(i=tS(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=tS(n,t.to))),n.docView.setSelection(s,r,n,e),eS&&(i&&nS(i),o&&nS(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&sQ(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const eS=On||_n&&qP<63;function tS(n,e){let{node:t,offset:s}=n.docView.domFromPos(e,0),r=s<t.childNodes.length?t.childNodes[s]:null,i=s?t.childNodes[s-1]:null;if(On&&r&&r.contentEditable=="false")return Tm(r);if((!r||r.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(r)return Tm(r);if(i)return Tm(i)}}function Tm(n){return n.contentEditable="true",On&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function nS(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function sQ(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),s=t.anchorNode,r=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=s||t.anchorOffset!=r)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!rx(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function rQ(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let s=n.cursorWrapper.dom,r=s.nodeName=="IMG";r?t.setStart(s.parentNode,Zt(s)+1):t.setStart(s,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!r&&!n.state.selection.visible&&zn&&pi<=11&&(s.disabled=!0,s.disabled=!1)}function ix(n,e){if(e instanceof Ee){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(sS(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else sS(n)}function sS(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Ov(n,e,t,s){return n.someProp("createSelectionBetween",r=>r(n,e,t))||Ne.between(e,t,s)}function rS(n){return n.editable&&!n.hasFocus()?!1:ox(n)}function ox(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function iQ(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return Fo(e.node,e.offset,t.anchorNode,t.anchorOffset)}function n_(n,e){let{$anchor:t,$head:s}=n.selection,r=e>0?t.max(s):t.min(s),i=r.parent.inlineContent?r.depth?n.doc.resolve(e>0?r.after():r.before()):null:r;return i&&Le.findFrom(i,e)}function Kr(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function iS(n,e,t){let s=n.state.selection;if(s instanceof Ne)if(t.indexOf("s")>-1){let{$head:r}=s,i=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=n.state.doc.resolve(r.pos+i.nodeSize*(e<0?-1:1));return Kr(n,new Ne(s.$anchor,o))}else if(s.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let r=n_(n.state,e);return r&&r instanceof Ee?Kr(n,r):!1}else if(!(rs&&t.indexOf("m")>-1)){let r=s.$head,i=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter,o;if(!i||i.isText)return!1;let a=e<0?r.pos-i.nodeSize:r.pos;return i.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?Ee.isSelectable(i)?Kr(n,new Ee(e<0?n.state.doc.resolve(r.pos-i.nodeSize):r)):Cu?Kr(n,new Ne(n.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(s instanceof Ee&&s.node.isInline)return Kr(n,new Ne(e>0?s.$to:s.$from));{let r=n_(n.state,e);return r?Kr(n,r):!1}}}function Vd(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function _c(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function ta(n,e){return e<0?oQ(n):aQ(n)}function oQ(n){let e=n.domSelectionRange(),t=e.focusNode,s=e.focusOffset;if(!t)return;let r,i,o=!1;for(xs&&t.nodeType==1&&s<Vd(t)&&_c(t.childNodes[s],-1)&&(o=!0);;)if(s>0){if(t.nodeType!=1)break;{let a=t.childNodes[s-1];if(_c(a,-1))r=t,i=--s;else if(a.nodeType==3)t=a,s=t.nodeValue.length;else break}}else{if(ax(t))break;{let a=t.previousSibling;for(;a&&_c(a,-1);)r=t.parentNode,i=Zt(a),a=a.previousSibling;if(a)t=a,s=Vd(t);else{if(t=t.parentNode,t==n.dom)break;s=0}}}o?s_(n,t,s):r&&s_(n,r,i)}function aQ(n){let e=n.domSelectionRange(),t=e.focusNode,s=e.focusOffset;if(!t)return;let r=Vd(t),i,o;for(;;)if(s<r){if(t.nodeType!=1)break;let a=t.childNodes[s];if(_c(a,1))i=t,o=++s;else break}else{if(ax(t))break;{let a=t.nextSibling;for(;a&&_c(a,1);)i=a.parentNode,o=Zt(a)+1,a=a.nextSibling;if(a)t=a,s=0,r=Vd(t);else{if(t=t.parentNode,t==n.dom)break;s=r=0}}}i&&s_(n,i,o)}function ax(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function lQ(n,e){for(;n&&e==n.childNodes.length&&!Iu(n);)e=Zt(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function cQ(n,e){for(;n&&!e&&!Iu(n);)e=Zt(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function s_(n,e,t){if(e.nodeType!=3){let i,o;(o=lQ(e,t))?(e=o,t=0):(i=cQ(e,t))&&(e=i,t=i.nodeValue.length)}let s=n.domSelection();if(!s)return;if(ip(s)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),s.removeAllRanges(),s.addRange(i)}else s.extend&&s.extend(e,t);n.domObserver.setCurSelection();let{state:r}=n;setTimeout(()=>{n.state==r&&Tr(n)},50)}function oS(n,e){let t=n.state.doc.resolve(e);if(!(_n||xG)&&t.parent.inlineContent){let r=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(i.left-r.left)>1)return i.left<r.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(i.left-r.left)>1)return i.left>r.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function aS(n,e,t){let s=n.state.selection;if(s instanceof Ne&&!s.empty||t.indexOf("s")>-1||rs&&t.indexOf("m")>-1)return!1;let{$from:r,$to:i}=s;if(!r.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=n_(n.state,e);if(o&&o instanceof Ee)return Kr(n,o)}if(!r.parent.inlineContent){let o=e<0?r:i,a=s instanceof es?Le.near(o,e):Le.findFrom(o,e);return a?Kr(n,a):!1}return!1}function lS(n,e){if(!(n.state.selection instanceof Ne))return!0;let{$head:t,$anchor:s,empty:r}=n.state.selection;if(!t.sameParent(s))return!0;if(!r)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let o=n.state.tr;return e<0?o.delete(t.pos-i.nodeSize,t.pos):o.delete(t.pos,t.pos+i.nodeSize),n.dispatch(o),!0}return!1}function cS(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function uQ(n){if(!On||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let s=e.firstChild;cS(n,s,"true"),setTimeout(()=>cS(n,s,"false"),20)}return!1}function hQ(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function dQ(n,e){let t=e.keyCode,s=hQ(e);if(t==8||rs&&t==72&&s=="c")return lS(n,-1)||ta(n,-1);if(t==46&&!e.shiftKey||rs&&t==68&&s=="c")return lS(n,1)||ta(n,1);if(t==13||t==27)return!0;if(t==37||rs&&t==66&&s=="c"){let r=t==37?oS(n,n.state.selection.from)=="ltr"?-1:1:-1;return iS(n,r,s)||ta(n,r)}else if(t==39||rs&&t==70&&s=="c"){let r=t==39?oS(n,n.state.selection.from)=="ltr"?1:-1:1;return iS(n,r,s)||ta(n,r)}else{if(t==38||rs&&t==80&&s=="c")return aS(n,-1,s)||ta(n,-1);if(t==40||rs&&t==78&&s=="c")return uQ(n)||aS(n,1,s)||ta(n,1);if(s==(rs?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Mv(n,e){n.someProp("transformCopied",p=>{e=p(e,n)});let t=[],{content:s,openStart:r,openEnd:i}=e;for(;r>1&&i>1&&s.childCount==1&&s.firstChild.childCount==1;){r--,i--;let p=s.firstChild;t.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),s=p.content}let o=n.someProp("clipboardSerializer")||Wo.fromSchema(n.state.schema),a=fx(),l=a.createElement("div");l.appendChild(o.serializeFragment(s,{document:a}));let c=l.firstChild,u,h=0;for(;c&&c.nodeType==1&&(u=dx[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let m=a.createElement(u[p]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),h++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${r} ${i}${h?` -${h}`:""} ${JSON.stringify(t)}`);let f=n.someProp("clipboardTextSerializer",p=>p(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:f,slice:e}}function lx(n,e,t,s,r){let i=r.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=e&&(s||i||!t);if(l){if(n.someProp("transformPastedText",f=>{e=f(e,i||s,n)}),i)return e?new he(X.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):he.empty;let h=n.someProp("clipboardTextParser",f=>f(e,r,s,n));if(h)a=h;else{let f=r.marks(),{schema:p}=n.state,m=Wo.fromSchema(p);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(_=>{let v=o.appendChild(document.createElement("p"));_&&v.appendChild(m.serializeNode(p.text(_,f)))})}}else n.someProp("transformPastedHTML",h=>{t=h(t,n)}),o=gQ(t),Cu&&_Q(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let h=+u[3];h>0;h--){let f=o.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;o=f}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||fi.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:r,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!fQ.test(f.parentNode.nodeName)?{ignore:!0}:null}})),u)a=yQ(uS(a,+u[1],+u[2]),u[4]);else if(a=he.maxOpen(pQ(a.content,r),!0),a.openStart||a.openEnd){let h=0,f=0;for(let p=a.content.firstChild;h<a.openStart&&!p.type.spec.isolating;h++,p=p.firstChild);for(let p=a.content.lastChild;f<a.openEnd&&!p.type.spec.isolating;f++,p=p.lastChild);a=uS(a,h,f)}return n.someProp("transformPasted",h=>{a=h(a,n)}),a}const fQ=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function pQ(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.index(t)),i,o=[];if(n.forEach(a=>{if(!o)return;let l=r.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&i.length&&ux(l,i,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=hx(o[o.length-1],i.length));let u=cx(a,l);o.push(u),r=r.matchType(u.type),i=l}}),o)return X.from(o)}return n}function cx(n,e,t=0){for(let s=e.length-1;s>=t;s--)n=e[s].create(null,X.from(n));return n}function ux(n,e,t,s,r){if(r<n.length&&r<e.length&&n[r]==e[r]){let i=ux(n,e,t,s.lastChild,r+1);if(i)return s.copy(s.content.replaceChild(s.childCount-1,i));if(s.contentMatchAt(s.childCount).matchType(r==n.length-1?t.type:n[r+1]))return s.copy(s.content.append(X.from(cx(t,n,r+1))))}}function hx(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,hx(n.lastChild,e-1)),s=n.contentMatchAt(n.childCount).fillBefore(X.empty,!0);return n.copy(t.append(s))}function r_(n,e,t,s,r,i){let o=e<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(i=0),r<s-1&&(a=r_(a,e,t,s,r+1,i)),r>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,i<=r).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(X.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function uS(n,e,t){return e<n.openStart&&(n=new he(r_(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new he(r_(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const dx={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let hS=null;function fx(){return hS||(hS=document.implementation.createHTMLDocument("title"))}let Sm=null;function mQ(n){let e=window.trustedTypes;return e?(Sm||(Sm=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),Sm.createHTML(n)):n}function gQ(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=fx().createElement("div"),s=/<([a-z][^>\s]+)/i.exec(n),r;if((r=s&&dx[s[1].toLowerCase()])&&(n=r.map(i=>"<"+i+">").join("")+n+r.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=mQ(n),r)for(let i=0;i<r.length;i++)t=t.querySelector(r[i])||t;return t}function _Q(n){let e=n.querySelectorAll(_n?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let s=e[t];s.childNodes.length==1&&s.textContent==" "&&s.parentNode&&s.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),s)}}function yQ(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,s;try{s=JSON.parse(e)}catch{return n}let{content:r,openStart:i,openEnd:o}=n;for(let a=s.length-2;a>=0;a-=2){let l=t.nodes[s[a]];if(!l||l.hasRequiredAttrs())break;r=X.from(l.create(s[a+1],r)),i++,o++}return new he(r,i,o)}const Mn={},Dn={},vQ={touchstart:!0,touchmove:!0};class bQ{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function wQ(n){for(let e in Mn){let t=Mn[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=s=>{TQ(n,s)&&!Dv(n,s)&&(n.editable||!(s.type in Dn))&&t(n,s)},vQ[e]?{passive:!0}:void 0)}On&&n.dom.addEventListener("input",()=>null),i_(n)}function ri(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function EQ(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function i_(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=s=>Dv(n,s))})}function Dv(n,e){return n.someProp("handleDOMEvents",t=>{let s=t[e.type];return s?s(n,e)||e.defaultPrevented:!1})}function TQ(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function SQ(n,e){!Dv(n,e)&&Mn[e.type]&&(n.editable||!(e.type in Dn))&&Mn[e.type](n,e)}Dn.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!mx(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(_r&&_n&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),za&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let s=Date.now();n.input.lastIOSEnter=s,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==s&&(n.someProp("handleKeyDown",r=>r(n,oo(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",s=>s(n,t))||dQ(n,t)?t.preventDefault():ri(n,"key")};Dn.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Dn.keypress=(n,e)=>{let t=e;if(mx(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||rs&&t.metaKey)return;if(n.someProp("handleKeyPress",r=>r(n,t))){t.preventDefault();return}let s=n.state.selection;if(!(s instanceof Ne)||!s.$from.sameParent(s.$to)){let r=String.fromCharCode(t.charCode);!/[\r\n]/.test(r)&&!n.someProp("handleTextInput",i=>i(n,s.$from.pos,s.$to.pos,r))&&n.dispatch(n.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}};function ap(n){return{left:n.clientX,top:n.clientY}}function IQ(n,e){let t=e.x-n.clientX,s=e.y-n.clientY;return t*t+s*s<100}function Lv(n,e,t,s,r){if(s==-1)return!1;let i=n.state.doc.resolve(s);for(let o=i.depth+1;o>0;o--)if(n.someProp(e,a=>o>i.depth?a(n,t,i.nodeAfter,i.before(o),r,!0):a(n,t,i.node(o),i.before(o),r,!1)))return!0;return!1}function Ia(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let s=n.state.tr.setSelection(e);s.setMeta("pointer",!0),n.dispatch(s)}function CQ(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),s=t.nodeAfter;return s&&s.isAtom&&Ee.isSelectable(s)?(Ia(n,new Ee(t)),!0):!1}function kQ(n,e){if(e==-1)return!1;let t=n.state.selection,s,r;t instanceof Ee&&(s=t.node);let i=n.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(Ee.isSelectable(a)){s&&t.$from.depth>0&&o>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?r=i.before(t.$from.depth):r=i.before(o);break}}return r!=null?(Ia(n,Ee.create(n.state.doc,r)),!0):!1}function AQ(n,e,t,s,r){return Lv(n,"handleClickOn",e,t,s)||n.someProp("handleClick",i=>i(n,e,s))||(r?kQ(n,t):CQ(n,t))}function RQ(n,e,t,s){return Lv(n,"handleDoubleClickOn",e,t,s)||n.someProp("handleDoubleClick",r=>r(n,e,s))}function PQ(n,e,t,s){return Lv(n,"handleTripleClickOn",e,t,s)||n.someProp("handleTripleClick",r=>r(n,e,s))||xQ(n,t,s)}function xQ(n,e,t){if(t.button!=0)return!1;let s=n.state.doc;if(e==-1)return s.inlineContent?(Ia(n,Ne.create(s,0,s.content.size)),!0):!1;let r=s.resolve(e);for(let i=r.depth+1;i>0;i--){let o=i>r.depth?r.nodeAfter:r.node(i),a=r.before(i);if(o.inlineContent)Ia(n,Ne.create(s,a+1,a+1+o.content.size));else if(Ee.isSelectable(o))Ia(n,Ee.create(s,a));else continue;return!0}}function Vv(n){return Fd(n)}const px=rs?"metaKey":"ctrlKey";Mn.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let s=Vv(n),r=Date.now(),i="singleClick";r-n.input.lastClick.time<500&&IQ(t,n.input.lastClick)&&!t[px]&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:r,x:t.clientX,y:t.clientY,type:i};let o=n.posAtCoords(ap(t));o&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new NQ(n,o,t,!!s)):(i=="doubleClick"?RQ:PQ)(n,o.pos,o.inside,t)?t.preventDefault():ri(n,"pointer"))};class NQ{constructor(e,t,s,r){this.view=e,this.pos=t,this.event=s,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!s[px],this.allowDefault=s.shiftKey;let i,o;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);i=u.parent,o=u.depth?u.before():0}const a=r?null:s.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(s.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof Ee&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&xs&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ri(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Tr(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(ap(e))),this.updateAllowDefault(e),this.allowDefault||!t?ri(this.view,"pointer"):AQ(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||On&&this.mightDrag&&!this.mightDrag.node.isAtom||_n&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Ia(this.view,Le.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):ri(this.view,"pointer")}move(e){this.updateAllowDefault(e),ri(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Mn.touchstart=n=>{n.input.lastTouch=Date.now(),Vv(n),ri(n,"pointer")};Mn.touchmove=n=>{n.input.lastTouch=Date.now(),ri(n,"pointer")};Mn.contextmenu=n=>Vv(n);function mx(n,e){return n.composing?!0:On&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const OQ=_r?5e3:-1;Dn.compositionstart=Dn.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof Ne&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(s=>s.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Fd(n,!0),n.markCursor=null;else if(Fd(n,!e.selection.empty),xs&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let s=n.domSelectionRange();for(let r=s.focusNode,i=s.focusOffset;r&&r.nodeType==1&&i!=0;){let o=i<0?r.lastChild:r.childNodes[i-1];if(!o)break;if(o.nodeType==3){let a=n.domSelection();a&&a.collapse(o,o.nodeValue.length);break}else r=o,i=-1}}n.input.composing=!0}gx(n,OQ)};Dn.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,gx(n,20))};function gx(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Fd(n),e))}function _x(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=DQ());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function MQ(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=CG(e.focusNode,e.focusOffset),s=kG(e.focusNode,e.focusOffset);if(t&&s&&t!=s){let r=s.pmViewDesc,i=n.domObserver.lastChangedTextNode;if(t==i||s==i)return i;if(!r||!r.isText(s.nodeValue))return s;if(n.input.compositionNode==s){let o=t.pmViewDesc;if(!(!o||!o.isText(t.nodeValue)))return s}}return t||s}function DQ(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Fd(n,e=!1){if(!(_r&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),_x(n),e||n.docView&&n.docView.dirty){let t=Nv(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!n.state.selection.empty?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function LQ(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let s=getSelection(),r=document.createRange();r.selectNodeContents(e),n.dom.blur(),s.removeAllRanges(),s.addRange(r),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Jc=zn&&pi<15||za&&NG<604;Mn.copy=Dn.cut=(n,e)=>{let t=e,s=n.state.selection,r=t.type=="cut";if(s.empty)return;let i=Jc?null:t.clipboardData,o=s.content(),{dom:a,text:l}=Mv(n,o);i?(t.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):LQ(n,a),r&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function VQ(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function FQ(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,s=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(s.contentEditable="true"),s.style.cssText="position: fixed; left: -10000px; top: 10px",s.focus();let r=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),s.parentNode&&s.parentNode.removeChild(s),t?Yc(n,s.value,null,r,e):Yc(n,s.textContent,s.innerHTML,r,e)},50)}function Yc(n,e,t,s,r){let i=lx(n,e,t,s,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,r,i||he.empty)))return!0;if(!i)return!1;let o=VQ(i),a=o?n.state.tr.replaceSelectionWith(o,s):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function yx(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Dn.paste=(n,e)=>{let t=e;if(n.composing&&!_r)return;let s=Jc?null:t.clipboardData,r=n.input.shiftKey&&n.input.lastKeyCode!=45;s&&Yc(n,yx(s),s.getData("text/html"),r,t)?t.preventDefault():FQ(n,t)};class vx{constructor(e,t,s){this.slice=e,this.move=t,this.node=s}}const BQ=rs?"altKey":"ctrlKey";function bx(n,e){let t=n.someProp("dragCopies",s=>!s(e));return t??!e[BQ]}Mn.dragstart=(n,e)=>{let t=e,s=n.input.mouseDown;if(s&&s.done(),!t.dataTransfer)return;let r=n.state.selection,i=r.empty?null:n.posAtCoords(ap(t)),o;if(!(i&&i.pos>=r.from&&i.pos<=(r instanceof Ee?r.to-1:r.to))){if(s&&s.mightDrag)o=Ee.create(n.state.doc,s.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let h=n.docView.nearestDesc(t.target,!0);h&&h.node.type.spec.draggable&&h!=n.docView&&(o=Ee.create(n.state.doc,h.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c,slice:u}=Mv(n,a);(!t.dataTransfer.files.length||!_n||qP>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Jc?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Jc||t.dataTransfer.setData("text/plain",c),n.dragging=new vx(u,bx(n,t),o)};Mn.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Dn.dragover=Dn.dragenter=(n,e)=>e.preventDefault();Dn.drop=(n,e)=>{let t=e,s=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let r=n.posAtCoords(ap(t));if(!r)return;let i=n.state.doc.resolve(r.pos),o=s&&s.slice;o?n.someProp("transformPasted",m=>{o=m(o,n)}):o=lx(n,yx(t.dataTransfer),Jc?null:t.dataTransfer.getData("text/html"),!1,i);let a=!!(s&&bx(n,t));if(n.someProp("handleDrop",m=>m(n,t,o||he.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?FP(n.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let c=n.state.tr;if(a){let{node:m}=s;m?m.replace(c):c.deleteSelection()}let u=c.mapping.map(l),h=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,f=c.doc;if(h?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(f))return;let p=c.doc.resolve(u);if(h&&Ee.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new Ee(p));else{let m=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((_,v,I,O)=>m=O),c.setSelection(Ov(n,p,c.doc.resolve(m)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Mn.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Tr(n)},20))};Mn.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Mn.beforeinput=(n,e)=>{if(_n&&_r&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:s}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=s||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,oo(8,"Backspace")))))return;let{$cursor:r}=n.state.selection;r&&r.pos>0&&n.dispatch(n.state.tr.delete(r.pos-1,r.pos).scrollIntoView())},50)}};for(let n in Dn)Mn[n]=Dn[n];function Xc(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Bd{constructor(e,t){this.toDOM=e,this.spec=t||wo,this.side=this.spec.side||0}map(e,t,s,r){let{pos:i,deleted:o}=e.mapResult(t.from+r,this.side<0?-1:1);return o?null:new ls(i-s,i-s,this)}valid(){return!0}eq(e){return this==e||e instanceof Bd&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Xc(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class gi{constructor(e,t){this.attrs=e,this.spec=t||wo}map(e,t,s,r){let i=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-s,o=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-s;return i>=o?null:new ls(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof gi&&Xc(this.attrs,e.attrs)&&Xc(this.spec,e.spec)}static is(e){return e.type instanceof gi}destroy(){}}class Fv{constructor(e,t){this.attrs=e,this.spec=t||wo}map(e,t,s,r){let i=e.mapResult(t.from+r,1);if(i.deleted)return null;let o=e.mapResult(t.to+r,-1);return o.deleted||o.pos<=i.pos?null:new ls(i.pos-s,o.pos-s,this)}valid(e,t){let{index:s,offset:r}=e.content.findIndex(t.from),i;return r==t.from&&!(i=e.child(s)).isText&&r+i.nodeSize==t.to}eq(e){return this==e||e instanceof Fv&&Xc(this.attrs,e.attrs)&&Xc(this.spec,e.spec)}destroy(){}}class ls{constructor(e,t,s){this.from=e,this.to=t,this.type=s}copy(e,t){return new ls(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,s){return this.type.map(e,this,t,s)}static widget(e,t,s){return new ls(e,e,new Bd(t,s))}static inline(e,t,s,r){return new ls(e,t,new gi(s,r))}static node(e,t,s,r){return new ls(e,t,new Fv(s,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof gi}get widget(){return this.type instanceof Bd}}const ca=[],wo={};class Mt{constructor(e,t){this.local=e.length?e:ca,this.children=t.length?t:ca}static create(e,t){return t.length?$d(t,e,0,wo):un}find(e,t,s){let r=[];return this.findInner(e??0,t??1e9,r,0,s),r}findInner(e,t,s,r,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!i||i(a.spec))&&s.push(a.copy(a.from+r,a.to+r))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,s,r+a,i)}}map(e,t,s){return this==un||e.maps.length==0?this:this.mapInner(e,t,0,0,s||wo)}mapInner(e,t,s,r,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,s,r);l&&l.type.valid(t,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?$Q(this.children,o||[],e,t,s,r,i):o?new Mt(o.sort(Eo),ca):un}add(e,t){return t.length?this==un?Mt.create(e,t):this.addInner(e,t,0):this}addInner(e,t,s){let r,i=0;e.forEach((a,l)=>{let c=l+s,u;if(u=Ex(t,a,c)){for(r||(r=this.children.slice());i<r.length&&r[i]<l;)i+=3;r[i]==l?r[i+2]=r[i+2].addInner(a,u,c+1):r.splice(i,0,l,l+a.nodeSize,$d(u,a,c+1,wo)),i+=3}});let o=wx(i?Tx(t):t,-s);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new Mt(o.length?this.local.concat(o).sort(Eo):this.local,r||this.children)}remove(e){return e.length==0||this==un?this:this.removeInner(e,0)}removeInner(e,t){let s=this.children,r=this.local;for(let i=0;i<s.length;i+=3){let o,a=s[i]+t,l=s[i+1]+t;for(let u=0,h;u<e.length;u++)(h=e[u])&&h.from>a&&h.to<l&&(e[u]=null,(o||(o=[])).push(h));if(!o)continue;s==this.children&&(s=this.children.slice());let c=s[i+2].removeInner(o,a+1);c!=un?s[i+2]=c:(s.splice(i,3),i-=3)}if(r.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let a=0;a<r.length;a++)r[a].eq(o,t)&&(r==this.local&&(r=this.local.slice()),r.splice(a--,1))}return s==this.children&&r==this.local?this:r.length||s.length?new Mt(r,s):un}forChild(e,t){if(this==un)return this;if(t.isLeaf)return Mt.empty;let s,r;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(s=this.children[a+2]);break}let i=e+1,o=i+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof gi){let c=Math.max(i,l.from)-i,u=Math.min(o,l.to)-i;c<u&&(r||(r=[])).push(l.copy(c,u))}}if(r){let a=new Mt(r.sort(Eo),ca);return s?new ei([a,s]):a}return s||un}eq(e){if(this==e)return!0;if(!(e instanceof Mt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Bv(this.localsInner(e))}localsInner(e){if(this==un)return ca;if(e.inlineContent||!this.local.some(gi.is))return this.local;let t=[];for(let s=0;s<this.local.length;s++)this.local[s].type instanceof gi||t.push(this.local[s]);return t}forEachSet(e){e(this)}}Mt.empty=new Mt([],[]);Mt.removeOverlap=Bv;const un=Mt.empty;class ei{constructor(e){this.members=e}map(e,t){const s=this.members.map(r=>r.map(e,t,wo));return ei.from(s)}forChild(e,t){if(t.isLeaf)return Mt.empty;let s=[];for(let r=0;r<this.members.length;r++){let i=this.members[r].forChild(e,t);i!=un&&(i instanceof ei?s=s.concat(i.members):s.push(i))}return ei.from(s)}eq(e){if(!(e instanceof ei)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,s=!0;for(let r=0;r<this.members.length;r++){let i=this.members[r].localsInner(e);if(i.length)if(!t)t=i;else{s&&(t=t.slice(),s=!1);for(let o=0;o<i.length;o++)t.push(i[o])}}return t?Bv(s?t:t.sort(Eo)):ca}static from(e){switch(e.length){case 0:return un;case 1:return e[0];default:return new ei(e.every(t=>t instanceof Mt)?e:e.reduce((t,s)=>t.concat(s instanceof Mt?s:s.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function $Q(n,e,t,s,r,i,o){let a=n.slice();for(let c=0,u=i;c<t.maps.length;c++){let h=0;t.maps[c].forEach((f,p,m,_)=>{let v=_-m-(p-f);for(let I=0;I<a.length;I+=3){let O=a[I+1];if(O<0||f>O+u-h)continue;let P=a[I]+u-h;p>=P?a[I+1]=f<=P?-2:-1:f>=u&&v&&(a[I]+=v,a[I+1]+=v)}h+=v}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+i),h=u-r;if(h<0||h>=s.content.size){l=!0;continue}let f=t.map(n[c+1]+i,-1),p=f-r,{index:m,offset:_}=s.content.findIndex(h),v=s.maybeChild(m);if(v&&_==h&&_+v.nodeSize==p){let I=a[c+2].mapInner(t,v,u+1,n[c]+i+1,o);I!=un?(a[c]=h,a[c+1]=p,a[c+2]=I):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=UQ(a,n,e,t,r,i,o),u=$d(c,s,0,o);e=u.local;for(let h=0;h<a.length;h+=3)a[h+1]<0&&(a.splice(h,3),h-=3);for(let h=0,f=0;h<u.children.length;h+=3){let p=u.children[h];for(;f<a.length&&a[f]<p;)f+=3;a.splice(f,0,u.children[h],u.children[h+1],u.children[h+2])}}return new Mt(e.sort(Eo),a)}function wx(n,e){if(!e||!n.length)return n;let t=[];for(let s=0;s<n.length;s++){let r=n[s];t.push(new ls(r.from+e,r.to+e,r.type))}return t}function UQ(n,e,t,s,r,i,o){function a(l,c){for(let u=0;u<l.local.length;u++){let h=l.local[u].map(s,r,c);h?t.push(h):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+i+1);return t}function Ex(n,e,t){if(e.isLeaf)return null;let s=t+e.nodeSize,r=null;for(let i=0,o;i<n.length;i++)(o=n[i])&&o.from>t&&o.to<s&&((r||(r=[])).push(o),n[i]=null);return r}function Tx(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function $d(n,e,t,s){let r=[],i=!1;e.forEach((a,l)=>{let c=Ex(n,a,l+t);if(c){i=!0;let u=$d(c,a,t+l+1,s);u!=un&&r.push(l,l+a.nodeSize,u)}});let o=wx(i?Tx(n):n,-t).sort(Eo);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(s.onRemove&&s.onRemove(o[a].spec),o.splice(a--,1));return o.length||r.length?new Mt(o,r):un}function Eo(n,e){return n.from-e.from||n.to-e.to}function Bv(n){let e=n;for(let t=0;t<e.length-1;t++){let s=e[t];if(s.from!=s.to)for(let r=t+1;r<e.length;r++){let i=e[r];if(i.from==s.from){i.to!=s.to&&(e==n&&(e=n.slice()),e[r]=i.copy(i.from,s.to),dS(e,r+1,i.copy(s.to,i.to)));continue}else{i.from<s.to&&(e==n&&(e=n.slice()),e[t]=s.copy(s.from,i.from),dS(e,r,s.copy(i.from,s.to)));break}}}return e}function dS(n,e,t){for(;e<n.length&&Eo(t,n[e])>0;)e++;n.splice(e,0,t)}function Im(n){let e=[];return n.someProp("decorations",t=>{let s=t(n.state);s&&s!=un&&e.push(s)}),n.cursorWrapper&&e.push(Mt.create(n.state.doc,[n.cursorWrapper.deco])),ei.from(e)}const jQ={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},zQ=zn&&pi<=11;class HQ{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class WQ{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new HQ,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(s=>{for(let r=0;r<s.length;r++)this.queue.push(s[r]);zn&&pi<=11&&s.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),zQ&&(this.onCharData=s=>{this.queue.push({target:s.target,type:"characterData",oldValue:s.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,jQ)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(rS(this.view)){if(this.suppressingSelectionUpdates)return Tr(this.view);if(zn&&pi<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Fo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,s;for(let i=e.focusNode;i;i=ja(i))t.add(i);for(let i=e.anchorNode;i;i=ja(i))if(t.has(i)){s=i;break}let r=s&&this.view.docView.nearestDesc(s);if(r&&r.ignoreMutation({type:"selection",target:s.nodeType==3?s.parentNode:s}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let s=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(s)&&rS(e)&&!this.ignoreSelectionChange(s),i=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let h=this.registerMutation(t[u],l);h&&(i=i<0?h.from:Math.min(h.from,i),o=o<0?h.to:Math.max(h.to,o),h.typeOver&&(a=!0))}if(xs&&l.length){let u=l.filter(h=>h.nodeName=="BR");if(u.length==2){let[h,f]=u;h.parentNode&&h.parentNode.parentNode==f.parentNode?f.remove():h.remove()}else{let{focusNode:h}=this.currentSelection;for(let f of u){let p=f.parentNode;p&&p.nodeName=="LI"&&(!h||GQ(e,h)!=p)&&f.remove()}}}let c=null;i<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&ip(s)&&(c=Nv(e))&&c.eq(Le.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Tr(e),this.currentSelection.set(s),e.scrollToSelection()):(i>-1||r)&&(i>-1&&(e.docView.markDirty(i,o),qQ(e)),this.handleDOMChange(i,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(s)||Tr(e),this.currentSelection.set(s))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let s=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(s==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!s||s.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let h=e.addedNodes[u];t.push(h),h.nodeType==3&&(this.lastChangedTextNode=h)}if(s.contentDOM&&s.contentDOM!=s.dom&&!s.contentDOM.contains(e.target))return{from:s.posBefore,to:s.posAfter};let r=e.previousSibling,i=e.nextSibling;if(zn&&pi<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:h,nextSibling:f}=e.addedNodes[u];(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(r=h),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f)}let o=r&&r.parentNode==e.target?Zt(r)+1:0,a=s.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?Zt(i):e.target.childNodes.length,c=s.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:s.posAtStart-s.border,to:s.posAtEnd+s.border}:(this.lastChangedTextNode=e.target,{from:s.posAtStart,to:s.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let fS=new WeakMap,pS=!1;function qQ(n){if(!fS.has(n)&&(fS.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=xs,pS)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),pS=!0}}function mS(n,e){let t=e.startContainer,s=e.startOffset,r=e.endContainer,i=e.endOffset,o=n.domAtPos(n.state.selection.anchor);return Fo(o.node,o.offset,r,i)&&([t,s,r,i]=[r,i,t,s]),{anchorNode:t,anchorOffset:s,focusNode:r,focusOffset:i}}function KQ(n,e){if(e.getComposedRanges){let r=e.getComposedRanges(n.root)[0];if(r)return mS(n,r)}let t;function s(r){r.preventDefault(),r.stopImmediatePropagation(),t=r.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",s,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",s,!0),t?mS(n,t):null}function GQ(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let s=n.docView.nearestDesc(t,!0);if(s&&s.node.isBlock)return t}return null}function QQ(n,e,t){let{node:s,fromOffset:r,toOffset:i,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],ip(l)||c.push({node:l.focusNode,offset:l.focusOffset})),_n&&n.input.lastKeyCode===8)for(let v=i;v>r;v--){let I=s.childNodes[v-1],O=I.pmViewDesc;if(I.nodeName=="BR"&&!O){i=v;break}if(!O||O.size)break}let h=n.state.doc,f=n.someProp("domParser")||fi.fromSchema(n.state.schema),p=h.resolve(o),m=null,_=f.parse(s,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:r,to:i,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:JQ,context:p});if(c&&c[0].pos!=null){let v=c[0].pos,I=c[1]&&c[1].pos;I==null&&(I=v),m={anchor:v+o,head:I+o}}return{doc:_,sel:m,from:o,to:a}}function JQ(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(On&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||On&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const YQ=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function XQ(n,e,t,s,r){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let E=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,C=Nv(n,E);if(C&&!n.state.selection.eq(C)){if(_n&&_r&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",k=>k(n,oo(13,"Enter"))))return;let x=n.state.tr.setSelection(C);E=="pointer"?x.setMeta("pointer",!0):E=="key"&&x.scrollIntoView(),i&&x.setMeta("composition",i),n.dispatch(x)}return}let o=n.state.doc.resolve(e),a=o.sharedDepth(t);e=o.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=QQ(n,e,t),u=n.state.doc,h=u.slice(c.from,c.to),f,p;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(f=n.state.selection.to,p="end"):(f=n.state.selection.from,p="start"),n.input.lastKeyCode=null;let m=tJ(h.content,c.doc.content,c.from,f,p);if(m&&n.input.domChangeCount++,(za&&n.input.lastIOSEnter>Date.now()-225||_r)&&r.some(E=>E.nodeType==1&&!YQ.test(E.nodeName))&&(!m||m.endA>=m.endB)&&n.someProp("handleKeyDown",E=>E(n,oo(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!m)if(s&&l instanceof Ne&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))m={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let E=gS(n,n.state.doc,c.sel);if(E&&!E.eq(n.state.selection)){let C=n.state.tr.setSelection(E);i&&C.setMeta("composition",i),n.dispatch(C)}}return}n.state.selection.from<n.state.selection.to&&m.start==m.endB&&n.state.selection instanceof Ne&&(m.start>n.state.selection.from&&m.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?m.start=n.state.selection.from:m.endA<n.state.selection.to&&m.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(m.endB+=n.state.selection.to-m.endA,m.endA=n.state.selection.to)),zn&&pi<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>c.from&&c.doc.textBetween(m.start-c.from-1,m.start-c.from+1)=="  "&&(m.start--,m.endA--,m.endB--);let _=c.doc.resolveNoCache(m.start-c.from),v=c.doc.resolveNoCache(m.endB-c.from),I=u.resolve(m.start),O=_.sameParent(v)&&_.parent.inlineContent&&I.end()>=m.endA,P;if((za&&n.input.lastIOSEnter>Date.now()-225&&(!O||r.some(E=>E.nodeName=="DIV"||E.nodeName=="P"))||!O&&_.pos<c.doc.content.size&&(!_.sameParent(v)||!_.parent.inlineContent)&&!/\S/.test(c.doc.textBetween(_.pos,v.pos,"",""))&&(P=Le.findFrom(c.doc.resolve(_.pos+1),1,!0))&&P.head>_.pos)&&n.someProp("handleKeyDown",E=>E(n,oo(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>m.start&&eJ(u,m.start,m.endA,_,v)&&n.someProp("handleKeyDown",E=>E(n,oo(8,"Backspace")))){_r&&_n&&n.domObserver.suppressSelectionUpdates();return}_n&&m.endB==m.start&&(n.input.lastChromeDelete=Date.now()),_r&&!O&&_.start()!=v.start()&&v.parentOffset==0&&_.depth==v.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==m.endA&&(m.endB-=2,v=c.doc.resolveNoCache(m.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(E){return E(n,oo(13,"Enter"))})},20));let D=m.start,B=m.endA,M,A,T;if(O){if(_.pos==v.pos)zn&&pi<=11&&_.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Tr(n),20)),M=n.state.tr.delete(D,B),A=u.resolve(m.start).marksAcross(u.resolve(m.endA));else if(m.endA==m.endB&&(T=ZQ(_.parent.content.cut(_.parentOffset,v.parentOffset),I.parent.content.cut(I.parentOffset,m.endA-I.start()))))M=n.state.tr,T.type=="add"?M.addMark(D,B,T.mark):M.removeMark(D,B,T.mark);else if(_.parent.child(_.index()).isText&&_.index()==v.index()-(v.textOffset?0:1)){let E=_.parent.textBetween(_.parentOffset,v.parentOffset);if(n.someProp("handleTextInput",C=>C(n,D,B,E)))return;M=n.state.tr.insertText(E,D,B)}}if(M||(M=n.state.tr.replace(D,B,c.doc.slice(m.start-c.from,m.endB-c.from))),c.sel){let E=gS(n,M.doc,c.sel);E&&!(_n&&n.composing&&E.empty&&(m.start!=m.endB||n.input.lastChromeDelete<Date.now()-100)&&(E.head==D||E.head==M.mapping.map(B)-1)||zn&&E.empty&&E.head==D)&&M.setSelection(E)}A&&M.ensureMarks(A),i&&M.setMeta("composition",i),n.dispatch(M.scrollIntoView())}function gS(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Ov(n,e.resolve(t.anchor),e.resolve(t.head))}function ZQ(n,e){let t=n.firstChild.marks,s=e.firstChild.marks,r=t,i=s,o,a,l;for(let u=0;u<s.length;u++)r=s[u].removeFromSet(r);for(let u=0;u<t.length;u++)i=t[u].removeFromSet(i);if(r.length==1&&i.length==0)a=r[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(r.length==0&&i.length==1)a=i[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(X.from(c).eq(n))return{mark:a,type:o}}function eJ(n,e,t,s,r){if(t-e<=r.pos-s.pos||Cm(s,!0,!1)<r.pos)return!1;let i=n.resolve(e);if(!s.parent.isTextblock){let a=i.nodeAfter;return a!=null&&t==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=n.resolve(Cm(i,!0,!0));return!o.parent.isTextblock||o.pos>t||Cm(o,!0,!1)<t?!1:s.parent.content.cut(s.parentOffset).eq(o.parent.content)}function Cm(n,e,t){let s=n.depth,r=e?n.end():n.pos;for(;s>0&&(e||n.indexAfter(s)==n.node(s).childCount);)s--,r++,e=!1;if(t){let i=n.node(s).maybeChild(n.indexAfter(s));for(;i&&!i.isLeaf;)i=i.firstChild,r++}return r}function tJ(n,e,t,s,r){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(r=="end"){let l=Math.max(0,i-Math.min(o,a));s-=o+l-i}if(o<i&&n.size<e.size){let l=s<=i&&s>=o?i-s:0;i-=l,i&&i<e.size&&_S(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=s<=i&&s>=a?i-s:0;i-=l,i&&i<n.size&&_S(n.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function _S(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class nJ{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new bQ,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(ES),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=bS(this),vS(this),this.nodeViews=wS(this),this.docView=XT(this.state.doc,yS(this),Im(this),this.dom,this),this.domObserver=new WQ(this,(s,r,i,o)=>XQ(this,s,r,i,o)),this.domObserver.start(),wQ(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&i_(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(ES),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let s in this._props)t[s]=this._props[s];t.state=this.state;for(let s in e)t[s]=e[s];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var s;let r=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(_x(this),o=!0),this.state=e;let a=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let p=wS(this);rJ(p,this.nodeViews)&&(this.nodeViews=p,i=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&i_(this),this.editable=bS(this),vS(this);let l=Im(this),c=yS(this),u=r.plugins!=e.plugins&&!r.doc.eq(e.doc)?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",h=i||!this.docView.matchesNode(e.doc,c,l);(h||!e.selection.eq(r.selection))&&(o=!0);let f=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&DG(this);if(o){this.domObserver.stop();let p=h&&(zn||_n)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&sJ(r.selection,e.selection);if(h){let m=_n?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=MQ(this)),(i||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=XT(e.doc,c,l,this.dom,this)),m&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&iQ(this))?Tr(this,p):(ix(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),!((s=this.dragging)===null||s===void 0)&&s.node&&!r.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,r),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():f&&LG(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof Ee){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&qT(this,t.getBoundingClientRect(),e)}else qT(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let s=this.directPlugins[t];s.spec.view&&this.pluginViews.push(s.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let s=this.state.plugins[t];s.spec.view&&this.pluginViews.push(s.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let s=this.pluginViews[t];s.update&&s.update(this,e)}}updateDraggedNode(e,t){let s=e.node,r=-1;if(this.state.doc.nodeAt(s.from)==s.node)r=s.from;else{let i=s.from+(this.state.doc.content.size-t.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==s.node&&(r=i)}this.dragging=new vx(e.slice,e.move,r<0?void 0:Ee.create(this.state.doc,r))}someProp(e,t){let s=this._props&&this._props[e],r;if(s!=null&&(r=t?t(s):s))return r;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(r=t?t(a):a))return r}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[e];if(a!=null&&(r=t?t(a):a))return r}}hasFocus(){if(zn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&VG(this.dom),Tr(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return jG(this,e)}coordsAtPos(e,t=1){return YP(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,s=-1){let r=this.docView.posFromDOM(e,t,s);if(r==null)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){return KG(this,t||this.state,e)}pasteHTML(e,t){return Yc(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Yc(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return Mv(this,e)}destroy(){this.docView&&(EQ(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Im(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,SG())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return SQ(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?On&&this.root.nodeType===11&&RG(this.dom.ownerDocument)==this.dom&&KQ(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function yS(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let s in t)s=="class"?e.class+=" "+t[s]:s=="style"?e.style=(e.style?e.style+";":"")+t[s]:!e[s]&&s!="contenteditable"&&s!="nodeName"&&(e[s]=String(t[s]))}),e.translate||(e.translate="no"),[ls.node(0,n.state.doc.content.size,e)]}function vS(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:ls.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function bS(n){return!n.someProp("editable",e=>e(n.state)===!1)}function sJ(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function wS(n){let e=Object.create(null);function t(s){for(let r in s)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=s[r])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function rJ(n,e){let t=0,s=0;for(let r in n){if(n[r]!=e[r])return!0;t++}for(let r in e)s++;return t!=s}function ES(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Pi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ud={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},iJ=typeof navigator<"u"&&/Mac/.test(navigator.platform),oJ=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var en=0;en<10;en++)Pi[48+en]=Pi[96+en]=String(en);for(var en=1;en<=24;en++)Pi[en+111]="F"+en;for(var en=65;en<=90;en++)Pi[en]=String.fromCharCode(en+32),Ud[en]=String.fromCharCode(en);for(var km in Pi)Ud.hasOwnProperty(km)||(Ud[km]=Pi[km]);function aJ(n){var e=iJ&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||oJ&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Ud:Pi)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const lJ=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),cJ=typeof navigator<"u"&&/Win/.test(navigator.platform);function uJ(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let s,r,i,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))s=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))lJ?o=!0:r=!0;else throw new Error("Unrecognized modifier name: "+l)}return s&&(t="Alt-"+t),r&&(t="Ctrl-"+t),o&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function hJ(n){let e=Object.create(null);for(let t in n)e[uJ(t)]=n[t];return e}function Am(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function dJ(n){return new Wn({props:{handleKeyDown:Sx(n)}})}function Sx(n){let e=hJ(n);return function(t,s){let r=aJ(s),i,o=e[Am(r,s)];if(o&&o(t.state,t.dispatch,t))return!0;if(r.length==1&&r!=" "){if(s.shiftKey){let a=e[Am(r,s,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((s.altKey||s.metaKey||s.ctrlKey)&&!(cJ&&s.ctrlKey&&s.altKey)&&(i=Pi[s.keyCode])&&i!=r){let a=e[Am(i,s)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const $v=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function Ix(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const Cx=(n,e,t)=>{let s=Ix(n,t);if(!s)return!1;let r=Uv(s);if(!r){let o=s.blockRange(),a=o&&cl(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let i=r.nodeBefore;if(Dx(n,r,e,-1))return!0;if(s.parent.content.size==0&&(Ha(i,"end")||Ee.isSelectable(i)))for(let o=s.depth;;o--){let a=sp(n.doc,s.before(o),s.after(o),he.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(Ha(i,"end")?Le.findFrom(l.doc.resolve(l.mapping.map(r.pos,-1)),-1):Ee.create(l.doc,r.pos-i.nodeSize)),e(l.scrollIntoView())}return!0}if(o==1||s.node(o-1).childCount>1)break}return i.isAtom&&r.depth==s.depth-1?(e&&e(n.tr.delete(r.pos-i.nodeSize,r.pos).scrollIntoView()),!0):!1},fJ=(n,e,t)=>{let s=Ix(n,t);if(!s)return!1;let r=Uv(s);return r?kx(n,r,e):!1},pJ=(n,e,t)=>{let s=Rx(n,t);if(!s)return!1;let r=jv(s);return r?kx(n,r,e):!1};function kx(n,e,t){let s=e.nodeBefore,r=s,i=e.pos-1;for(;!r.isTextblock;i--){if(r.type.spec.isolating)return!1;let u=r.lastChild;if(!u)return!1;r=u}let o=e.nodeAfter,a=o,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=sp(n.doc,i,l,he.empty);if(!c||c.from!=i||c instanceof jt&&c.slice.size>=l-i)return!1;if(t){let u=n.tr.step(c);u.setSelection(Ne.create(u.doc,i)),t(u.scrollIntoView())}return!0}function Ha(n,e,t=!1){for(let s=n;s;s=e=="start"?s.firstChild:s.lastChild){if(s.isTextblock)return!0;if(t&&s.childCount!=1)return!1}return!1}const Ax=(n,e,t)=>{let{$head:s,empty:r}=n.selection,i=s;if(!r)return!1;if(s.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):s.parentOffset>0)return!1;i=Uv(s)}let o=i&&i.nodeBefore;return!o||!Ee.isSelectable(o)?!1:(e&&e(n.tr.setSelection(Ee.create(n.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function Uv(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function Rx(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const Px=(n,e,t)=>{let s=Rx(n,t);if(!s)return!1;let r=jv(s);if(!r)return!1;let i=r.nodeAfter;if(Dx(n,r,e,1))return!0;if(s.parent.content.size==0&&(Ha(i,"start")||Ee.isSelectable(i))){let o=sp(n.doc,s.before(),s.after(),he.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Ha(i,"start")?Le.findFrom(a.doc.resolve(a.mapping.map(r.pos)),1):Ee.create(a.doc,a.mapping.map(r.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&r.depth==s.depth-1?(e&&e(n.tr.delete(r.pos,r.pos+i.nodeSize).scrollIntoView()),!0):!1},xx=(n,e,t)=>{let{$head:s,empty:r}=n.selection,i=s;if(!r)return!1;if(s.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):s.parentOffset<s.parent.content.size)return!1;i=jv(s)}let o=i&&i.nodeAfter;return!o||!Ee.isSelectable(o)?!1:(e&&e(n.tr.setSelection(Ee.create(n.doc,i.pos)).scrollIntoView()),!0)};function jv(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const mJ=(n,e)=>{let t=n.selection,s=t instanceof Ee,r;if(s){if(t.node.isTextblock||!zi(n.doc,t.from))return!1;r=t.from}else if(r=np(n.doc,t.from,-1),r==null)return!1;if(e){let i=n.tr.join(r);s&&i.setSelection(Ee.create(i.doc,r-n.doc.resolve(r).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},gJ=(n,e)=>{let t=n.selection,s;if(t instanceof Ee){if(t.node.isTextblock||!zi(n.doc,t.to))return!1;s=t.to}else if(s=np(n.doc,t.to,1),s==null)return!1;return e&&e(n.tr.join(s).scrollIntoView()),!0},_J=(n,e)=>{let{$from:t,$to:s}=n.selection,r=t.blockRange(s),i=r&&cl(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)},Nx=(n,e)=>{let{$head:t,$anchor:s}=n.selection;return!t.parent.type.spec.code||!t.sameParent(s)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function zv(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const yJ=(n,e)=>{let{$head:t,$anchor:s}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(s))return!1;let r=t.node(-1),i=t.indexAfter(-1),o=zv(r.contentMatchAt(i));if(!o||!r.canReplaceWith(i,i,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(Le.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},Ox=(n,e)=>{let t=n.selection,{$from:s,$to:r}=t;if(t instanceof es||s.parent.inlineContent||r.parent.inlineContent)return!1;let i=zv(r.parent.contentMatchAt(r.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!s.parentOffset&&r.index()<r.parent.childCount?s:r).pos,a=n.tr.insert(o,i.createAndFill());a.setSelection(Ne.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},Mx=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(Er(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let s=t.blockRange(),r=s&&cl(s);return r==null?!1:(e&&e(n.tr.lift(s,r).scrollIntoView()),!0)};function vJ(n){return(e,t)=>{let{$from:s,$to:r}=e.selection;if(e.selection instanceof Ee&&e.selection.node.isBlock)return!s.parentOffset||!Er(e.doc,s.pos)?!1:(t&&t(e.tr.split(s.pos).scrollIntoView()),!0);if(!s.depth)return!1;let i=[],o,a,l=!1,c=!1;for(let p=s.depth;;p--)if(s.node(p).isBlock){l=s.end(p)==s.pos+(s.depth-p),c=s.start(p)==s.pos-(s.depth-p),a=zv(s.node(p-1).contentMatchAt(s.indexAfter(p-1))),i.unshift(l&&a?{type:a}:null),o=p;break}else{if(p==1)return!1;i.unshift(null)}let u=e.tr;(e.selection instanceof Ne||e.selection instanceof es)&&u.deleteSelection();let h=u.mapping.map(s.pos),f=Er(u.doc,h,i.length,i);if(f||(i[0]=a?{type:a}:null,f=Er(u.doc,h,i.length,i)),!f)return!1;if(u.split(h,i.length,i),!l&&c&&s.node(o).type!=a){let p=u.mapping.map(s.before(o)),m=u.doc.resolve(p);a&&s.node(o-1).canReplaceWith(m.index(),m.index()+1,a)&&u.setNodeMarkup(u.mapping.map(s.before(o)),a)}return t&&t(u.scrollIntoView()),!0}}const bJ=vJ(),wJ=(n,e)=>{let{$from:t,to:s}=n.selection,r,i=t.sharedDepth(s);return i==0?!1:(r=t.before(i),e&&e(n.tr.setSelection(Ee.create(n.doc,r))),!0)};function EJ(n,e,t){let s=e.nodeBefore,r=e.nodeAfter,i=e.index();return!s||!r||!s.type.compatibleContent(r.type)?!1:!s.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-s.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(r.isTextblock||zi(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function Dx(n,e,t,s){let r=e.nodeBefore,i=e.nodeAfter,o,a,l=r.type.spec.isolating||i.type.spec.isolating;if(!l&&EJ(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(a=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&a.matchType(o[0]||i.type).validEnd){if(t){let p=e.pos+i.nodeSize,m=X.empty;for(let I=o.length-1;I>=0;I--)m=X.from(o[I].create(null,m));m=X.from(r.copy(m));let _=n.tr.step(new Ht(e.pos-1,p,e.pos,p,new he(m,1,0),o.length,!0)),v=_.doc.resolve(p+2*o.length);v.nodeAfter&&v.nodeAfter.type==r.type&&zi(_.doc,v.pos)&&_.join(v.pos),t(_.scrollIntoView())}return!0}let u=i.type.spec.isolating||s>0&&l?null:Le.findFrom(e,1),h=u&&u.$from.blockRange(u.$to),f=h&&cl(h);if(f!=null&&f>=e.depth)return t&&t(n.tr.lift(h,f).scrollIntoView()),!0;if(c&&Ha(i,"start",!0)&&Ha(r,"end")){let p=r,m=[];for(;m.push(p),!p.isTextblock;)p=p.lastChild;let _=i,v=1;for(;!_.isTextblock;_=_.firstChild)v++;if(p.canReplace(p.childCount,p.childCount,_.content)){if(t){let I=X.empty;for(let P=m.length-1;P>=0;P--)I=X.from(m[P].copy(I));let O=n.tr.step(new Ht(e.pos-m.length,e.pos+i.nodeSize,e.pos+v,e.pos+i.nodeSize-v,new he(I,m.length,0),0,!0));t(O.scrollIntoView())}return!0}}return!1}function Lx(n){return function(e,t){let s=e.selection,r=n<0?s.$from:s.$to,i=r.depth;for(;r.node(i).isInline;){if(!i)return!1;i--}return r.node(i).isTextblock?(t&&t(e.tr.setSelection(Ne.create(e.doc,n<0?r.start(i):r.end(i)))),!0):!1}}const TJ=Lx(-1),SJ=Lx(1);function IJ(n,e=null){return function(t,s){let{$from:r,$to:i}=t.selection,o=r.blockRange(i),a=o&&Rv(o,n,e);return a?(s&&s(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function TS(n,e=null){return function(t,s){let r=!1;for(let i=0;i<t.selection.ranges.length&&!r;i++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[i];t.doc.nodesBetween(o,a,(l,c)=>{if(r)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)r=!0;else{let u=t.doc.resolve(c),h=u.index();r=u.parent.canReplaceWith(h,h+1,n)}})}if(!r)return!1;if(s){let i=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];i.setBlockType(a,l,n,e)}s(i.scrollIntoView())}return!0}}function Hv(...n){return function(e,t,s){for(let r=0;r<n.length;r++)if(n[r](e,t,s))return!0;return!1}}Hv($v,Cx,Ax);Hv($v,Px,xx);Hv(Nx,Ox,Mx,bJ);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function CJ(n,e=null){return function(t,s){let{$from:r,$to:i}=t.selection,o=r.blockRange(i);if(!o)return!1;let a=s?t.tr:null;return kJ(a,o,n,e)?(s&&s(a.scrollIntoView()),!0):!1}}function kJ(n,e,t,s=null){let r=!1,i=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=o.resolve(e.start-2);i=new Md(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Md(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),r=!0}let a=Rv(i,t,s,e);return a?(n&&AJ(n,e,a,r,t),!0):!1}function AJ(n,e,t,s,r){let i=X.empty;for(let u=t.length-1;u>=0;u--)i=X.from(t[u].type.create(t[u].attrs,i));n.step(new Ht(e.start-(s?2:0),e.end,e.start,e.end,new he(i,0,0),t.length,!0));let o=0;for(let u=0;u<t.length;u++)t[u].type==r&&(o=u+1);let a=t.length-o,l=e.start+t.length-(s?2:0),c=e.parent;for(let u=e.startIndex,h=e.endIndex,f=!0;u<h;u++,f=!1)!f&&Er(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function RJ(n){return function(e,t){let{$from:s,$to:r}=e.selection,i=s.blockRange(r,o=>o.childCount>0&&o.firstChild.type==n);return i?t?s.node(i.depth-1).type==n?PJ(e,t,n,i):xJ(e,t,i):!0:!1}}function PJ(n,e,t,s){let r=n.tr,i=s.end,o=s.$to.end(s.depth);i<o&&(r.step(new Ht(i-1,o,i,o,new he(X.from(t.create(null,s.parent.copy())),1,0),1,!0)),s=new Md(r.doc.resolve(s.$from.pos),r.doc.resolve(o),s.depth));const a=cl(s);if(a==null)return!1;r.lift(s,a);let l=r.doc.resolve(r.mapping.map(i,-1)-1);return zi(r.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&r.join(l.pos),e(r.scrollIntoView()),!0}function xJ(n,e,t){let s=n.tr,r=t.parent;for(let p=t.end,m=t.endIndex-1,_=t.startIndex;m>_;m--)p-=r.child(m).nodeSize,s.delete(p-1,p+1);let i=s.doc.resolve(t.start),o=i.nodeAfter;if(s.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==r.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?X.empty:X.from(r))))return!1;let h=i.pos,f=h+o.nodeSize;return s.step(new Ht(h-(a?1:0),f+(l?1:0),h+1,f-1,new he((a?X.empty:X.from(r.copy(X.empty))).append(l?X.empty:X.from(r.copy(X.empty))),a?0:1,l?0:1),a?0:1)),e(s.scrollIntoView()),!0}function NJ(n){return function(e,t){let{$from:s,$to:r}=e.selection,i=s.blockRange(r,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=X.from(c?n.create():null),h=new he(X.from(n.create(null,X.from(a.type.create(null,u)))),c?3:1,0),f=i.start,p=i.end;t(e.tr.step(new Ht(f-(c?3:1),p,f,p,h,1,!0)).scrollIntoView())}return!0}}function lp(n){const{state:e,transaction:t}=n;let{selection:s}=t,{doc:r}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return s},get doc(){return r},get tr(){return s=t.selection,r=t.doc,i=t.storedMarks,t}}}class cp{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:s}=this,{view:r}=t,{tr:i}=s,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const h=l(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:s,editor:r,state:i}=this,{view:o}=r,a=[],l=!!e,c=e||i.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(f=>f===!0)),h={...Object.fromEntries(Object.entries(s).map(([f,p])=>[f,(..._)=>{const v=this.buildProps(c,t),I=p(..._)(v);return a.push(I),h}])),run:u};return h}createCan(e){const{rawCommands:t,state:s}=this,r=!1,i=e||s.tr,o=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(e,t=!0){const{rawCommands:s,editor:r,state:i}=this,{view:o}=r,a={tr:e,editor:r,view:o,state:lp({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(s).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class OJ{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const s=this.callbacks[e];return s&&s.forEach(r=>r.apply(this,t)),this}off(e,t){const s=this.callbacks[e];return s&&(t?this.callbacks[e]=s.filter(r=>r!==t):delete this.callbacks[e]),this}once(e,t){const s=(...r)=>{this.off(e,s),t.apply(this,r)};return this.on(e,s)}removeAllListeners(){this.callbacks={}}}function ge(n,e,t){return n.config[e]===void 0&&n.parent?ge(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?ge(n.parent,e,t):null}):n.config[e]}function up(n){const e=n.filter(r=>r.type==="extension"),t=n.filter(r=>r.type==="node"),s=n.filter(r=>r.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:s}}function Vx(n){const e=[],{nodeExtensions:t,markExtensions:s}=up(n),r=[...t,...s],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage,extensions:r},l=ge(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(h=>{Object.entries(u.attributes).forEach(([f,p])=>{e.push({type:h,name:f,attribute:{...i,...p}})})})})}),r.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=ge(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,h])=>{const f={...i,...h};typeof(f==null?void 0:f.default)=="function"&&(f.default=f.default()),f!=null&&f.isRequired&&(f==null?void 0:f.default)===void 0&&delete f.default,e.push({type:o.name,name:u,attribute:f})})}),e}function Kt(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function bn(...n){return n.filter(e=>!!e).reduce((e,t)=>{const s={...e};return Object.entries(t).forEach(([r,i])=>{if(!s[r]){s[r]=i;return}if(r==="class"){const a=i?String(i).split(" "):[],l=s[r]?s[r].split(" "):[],c=a.filter(u=>!l.includes(u));s[r]=[...l,...c].join(" ")}else if(r==="style"){const a=i?i.split(";").map(u=>u.trim()).filter(Boolean):[],l=s[r]?s[r].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[h,f]=u.split(":").map(p=>p.trim());c.set(h,f)}),a.forEach(u=>{const[h,f]=u.split(":").map(p=>p.trim());c.set(h,f)}),s[r]=Array.from(c.entries()).map(([u,h])=>`${u}: ${h}`).join("; ")}else s[r]=i}),s},{})}function o_(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,s)=>bn(t,s),{})}function Fx(n){return typeof n=="function"}function Fe(n,e=void 0,...t){return Fx(n)?e?n.bind(e)(...t):n(...t):n}function MJ(n={}){return Object.keys(n).length===0&&n.constructor===Object}function DJ(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function SS(n,e){return"style"in n?n:{...n,getAttrs:t=>{const s=n.getAttrs?n.getAttrs(t):n.attrs;if(s===!1)return!1;const r=e.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(t):DJ(t.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...s,...r}}}}function IS(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&MJ(t)?!1:t!=null))}function LJ(n,e){var t;const s=Vx(n),{nodeExtensions:r,markExtensions:i}=up(n),o=(t=r.find(c=>ge(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(r.map(c=>{const u=s.filter(I=>I.type===c.name),h={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((I,O)=>{const P=ge(O,"extendNodeSchema",h);return{...I,...P?P(c):{}}},{}),p=IS({...f,content:Fe(ge(c,"content",h)),marks:Fe(ge(c,"marks",h)),group:Fe(ge(c,"group",h)),inline:Fe(ge(c,"inline",h)),atom:Fe(ge(c,"atom",h)),selectable:Fe(ge(c,"selectable",h)),draggable:Fe(ge(c,"draggable",h)),code:Fe(ge(c,"code",h)),whitespace:Fe(ge(c,"whitespace",h)),linebreakReplacement:Fe(ge(c,"linebreakReplacement",h)),defining:Fe(ge(c,"defining",h)),isolating:Fe(ge(c,"isolating",h)),attrs:Object.fromEntries(u.map(I=>{var O;return[I.name,{default:(O=I==null?void 0:I.attribute)===null||O===void 0?void 0:O.default}]}))}),m=Fe(ge(c,"parseHTML",h));m&&(p.parseDOM=m.map(I=>SS(I,u)));const _=ge(c,"renderHTML",h);_&&(p.toDOM=I=>_({node:I,HTMLAttributes:o_(I,u)}));const v=ge(c,"renderText",h);return v&&(p.toText=v),[c.name,p]})),l=Object.fromEntries(i.map(c=>{const u=s.filter(v=>v.type===c.name),h={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((v,I)=>{const O=ge(I,"extendMarkSchema",h);return{...v,...O?O(c):{}}},{}),p=IS({...f,inclusive:Fe(ge(c,"inclusive",h)),excludes:Fe(ge(c,"excludes",h)),group:Fe(ge(c,"group",h)),spanning:Fe(ge(c,"spanning",h)),code:Fe(ge(c,"code",h)),attrs:Object.fromEntries(u.map(v=>{var I;return[v.name,{default:(I=v==null?void 0:v.attribute)===null||I===void 0?void 0:I.default}]}))}),m=Fe(ge(c,"parseHTML",h));m&&(p.parseDOM=m.map(v=>SS(v,u)));const _=ge(c,"renderHTML",h);return _&&(p.toDOM=v=>_({mark:v,HTMLAttributes:o_(v,u)})),[c.name,p]}));return new kP({topNode:o,nodes:a,marks:l})}function Rm(n,e){return e.nodes[n]||e.marks[n]||null}function CS(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function Wv(n,e){const t=Wo.fromSchema(e).serializeFragment(n),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(t),r.innerHTML}const VJ=(n,e=500)=>{let t="";const s=n.parentOffset;return n.parent.nodesBetween(Math.max(0,s-e),s,(r,i,o,a)=>{var l,c;const u=((c=(l=r.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:r,pos:i,parent:o,index:a}))||r.textContent||"%leaf%";t+=r.isAtom&&!r.isText?u:u.slice(0,Math.max(0,s-i))}),t};function qv(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class hp{constructor(e){this.find=e.find,this.handler=e.handler}}const FJ=(n,e)=>{if(qv(e))return e.exec(n);const t=e(n);if(!t)return null;const s=[t.text];return s.index=t.index,s.input=n,s.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),s.push(t.replaceWith)),s};function dh(n){var e;const{editor:t,from:s,to:r,text:i,rules:o,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(s);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(f=>f.type.spec.code))return!1;let u=!1;const h=VJ(c)+i;return o.forEach(f=>{if(u)return;const p=FJ(h,f.find);if(!p)return;const m=l.state.tr,_=lp({state:l.state,transaction:m}),v={from:s-(p[0].length-i.length),to:r},{commands:I,chain:O,can:P}=new cp({editor:t,state:_});f.handler({state:_,range:v,match:p,commands:I,chain:O,can:P})===null||!m.steps.length||(m.setMeta(a,{transform:m,from:s,to:r,text:i}),l.dispatch(m),u=!0)}),u}function BJ(n){const{editor:e,rules:t}=n,s=new Wn({state:{init(){return null},apply(r,i,o){const a=r.getMeta(s);if(a)return a;const l=r.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=Wv(X.from(u),o.schema);const{from:h}=l,f=h+u.length;dh({editor:e,from:h,to:f,text:u,rules:t,plugin:s})}),r.selectionSet||r.docChanged?null:i}},props:{handleTextInput(r,i,o,a){return dh({editor:e,from:i,to:o,text:a,rules:t,plugin:s})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{const{$cursor:i}=r.state.selection;i&&dh({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:s})}),!1)},handleKeyDown(r,i){if(i.key!=="Enter")return!1;const{$cursor:o}=r.state.selection;return o?dh({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:s}):!1}},isInputRules:!0});return s}function $J(n){return Object.prototype.toString.call(n).slice(8,-1)}function fh(n){return $J(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function dp(n,e){const t={...n};return fh(n)&&fh(e)&&Object.keys(e).forEach(s=>{fh(e[s])&&fh(n[s])?t[s]=dp(n[s],e[s]):t[s]=e[s]}),t}class xi{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Fe(ge(this,"addOptions",{name:this.name}))),this.storage=Fe(ge(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new xi(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>dp(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new xi(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=Fe(ge(t,"addOptions",{name:t.name})),t.storage=Fe(ge(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:s}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){const o=r.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&s.removeStoredMark(l),s.insertText(" ",r.pos),e.view.dispatch(s),!0}return!1}}function UJ(n){return typeof n=="number"}class jJ{constructor(e){this.find=e.find,this.handler=e.handler}}const zJ=(n,e,t)=>{if(qv(e))return[...n.matchAll(e)];const s=e(n,t);return s?s.map(r=>{const i=[r.text];return i.index=r.index,i.input=n,i.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(r.replaceWith)),i}):[]};function HJ(n){const{editor:e,state:t,from:s,to:r,rule:i,pasteEvent:o,dropEvent:a}=n,{commands:l,chain:c,can:u}=new cp({editor:e,state:t}),h=[];return t.doc.nodesBetween(s,r,(p,m)=>{if(!p.isTextblock||p.type.spec.code)return;const _=Math.max(s,m),v=Math.min(r,m+p.content.size),I=p.textBetween(_-m,v-m,void 0,"￼");zJ(I,i.find,o).forEach(P=>{if(P.index===void 0)return;const D=_+P.index+1,B=D+P[0].length,M={from:t.tr.mapping.map(D),to:t.tr.mapping.map(B)},A=i.handler({state:t,range:M,match:P,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});h.push(A)})}),h.every(p=>p!==null)}let ph=null;const WJ=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function qJ(n){const{editor:e,rules:t}=n;let s=null,r=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:h,to:f,rule:p,pasteEvt:m})=>{const _=u.tr,v=lp({state:u,transaction:_});if(!(!HJ({editor:e,state:v,from:Math.max(h-1,0),to:f.b-1,rule:p,pasteEvent:m,dropEvent:a})||!_.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,_}};return t.map(u=>new Wn({view(h){const f=m=>{var _;s=!((_=h.dom.parentElement)===null||_===void 0)&&_.contains(m.target)?h.dom.parentElement:null,s&&(ph=e)},p=()=>{ph&&(ph=null)};return window.addEventListener("dragstart",f),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",f),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(h,f)=>{if(i=s===h.dom.parentElement,a=f,!i){const p=ph;p&&setTimeout(()=>{const m=p.state.selection;m&&p.commands.deleteRange({from:m.from,to:m.to})},10)}return!1},paste:(h,f)=>{var p;const m=(p=f.clipboardData)===null||p===void 0?void 0:p.getData("text/html");return o=f,r=!!(m!=null&&m.includes("data-pm-slice")),!1}}},appendTransaction:(h,f,p)=>{const m=h[0],_=m.getMeta("uiEvent")==="paste"&&!r,v=m.getMeta("uiEvent")==="drop"&&!i,I=m.getMeta("applyPasteRules"),O=!!I;if(!_&&!v&&!O)return;if(O){let{text:B}=I;typeof B=="string"?B=B:B=Wv(X.from(B),p.schema);const{from:M}=I,A=M+B.length,T=WJ(B);return l({rule:u,state:p,from:M,to:{b:A},pasteEvt:T})}const P=f.doc.content.findDiffStart(p.doc.content),D=f.doc.content.findDiffEnd(p.doc.content);if(!(!UJ(P)||!D||P===D.b))return l({rule:u,state:p,from:P,to:D,pasteEvt:o})}}))}function KJ(n){const e=n.filter((t,s)=>n.indexOf(t)!==s);return Array.from(new Set(e))}class fa{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=fa.resolve(e),this.schema=LJ(this.extensions,t),this.setupExtensions()}static resolve(e){const t=fa.sort(fa.flatten(e)),s=KJ(t.map(r=>r.name));return s.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${s.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const s={name:t.name,options:t.options,storage:t.storage},r=ge(t,"addExtensions",s);return r?[t,...this.flatten(r())]:t}).flat(10)}static sort(e){return e.sort((s,r)=>{const i=ge(s,"priority")||100,o=ge(r,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const s={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Rm(t.name,this.schema)},r=ge(t,"addCommands",s);return r?{...e,...r()}:e},{})}get plugins(){const{editor:e}=this,t=fa.sort([...this.extensions].reverse()),s=[],r=[],i=t.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:Rm(o.name,this.schema)},l=[],c=ge(o,"addKeyboardShortcuts",a);let u={};if(o.type==="mark"&&ge(o,"exitable",a)&&(u.ArrowRight=()=>xi.handleExit({editor:e,mark:o})),c){const _=Object.fromEntries(Object.entries(c()).map(([v,I])=>[v,()=>I({editor:e})]));u={...u,..._}}const h=dJ(u);l.push(h);const f=ge(o,"addInputRules",a);CS(o,e.options.enableInputRules)&&f&&s.push(...f());const p=ge(o,"addPasteRules",a);CS(o,e.options.enablePasteRules)&&p&&r.push(...p());const m=ge(o,"addProseMirrorPlugins",a);if(m){const _=m();l.push(..._)}return l}).flat();return[BJ({editor:e,rules:s}),...qJ({editor:e,rules:r}),...i]}get attributes(){return Vx(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=up(this.extensions);return Object.fromEntries(t.filter(s=>!!ge(s,"addNodeView")).map(s=>{const r=this.attributes.filter(l=>l.type===s.name),i={name:s.name,options:s.options,storage:s.storage,editor:e,type:Kt(s.name,this.schema)},o=ge(s,"addNodeView",i);if(!o)return[];const a=(l,c,u,h,f)=>{const p=o_(l,r);return o()({node:l,view:c,getPos:u,decorations:h,innerDecorations:f,editor:e,extension:s,HTMLAttributes:p})};return[s.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const s={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Rm(e.name,this.schema)};e.type==="mark"&&(!((t=Fe(ge(e,"keepOnSplit",s)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const r=ge(e,"onBeforeCreate",s),i=ge(e,"onCreate",s),o=ge(e,"onUpdate",s),a=ge(e,"onSelectionUpdate",s),l=ge(e,"onTransaction",s),c=ge(e,"onFocus",s),u=ge(e,"onBlur",s),h=ge(e,"onDestroy",s);r&&this.editor.on("beforeCreate",r),i&&this.editor.on("create",i),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),h&&this.editor.on("destroy",h)})}}class Ln{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Fe(ge(this,"addOptions",{name:this.name}))),this.storage=Fe(ge(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ln(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>dp(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Ln({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=Fe(ge(t,"addOptions",{name:t.name})),t.storage=Fe(ge(t,"addStorage",{name:t.name,options:t.options})),t}}function Bx(n,e,t){const{from:s,to:r}=e,{blockSeparator:i=`

`,textSerializers:o={}}=t||{};let a="";return n.nodesBetween(s,r,(l,c,u,h)=>{var f;l.isBlock&&c>s&&(a+=i);const p=o==null?void 0:o[l.type.name];if(p)return u&&(a+=p({node:l,pos:c,parent:u,index:h,range:e})),!1;l.isText&&(a+=(f=l==null?void 0:l.text)===null||f===void 0?void 0:f.slice(Math.max(s,c)-c,r-c))}),a}function $x(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const GJ=Ln.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Wn({key:new sr("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:s,selection:r}=e,{ranges:i}=r,o=Math.min(...i.map(u=>u.$from.pos)),a=Math.max(...i.map(u=>u.$to.pos)),l=$x(t);return Bx(s,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),QJ=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),JJ=(n=!1)=>({commands:e})=>e.setContent("",n),YJ=()=>({state:n,tr:e,dispatch:t})=>{const{selection:s}=e,{ranges:r}=s;return t&&r.forEach(({$from:i,$to:o})=>{n.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,h=c.resolve(u.map(l)),f=c.resolve(u.map(l+a.nodeSize)),p=h.blockRange(f);if(!p)return;const m=cl(p);if(a.type.isTextblock){const{defaultType:_}=h.parent.contentMatchAt(h.index());e.setNodeMarkup(p.start,_)}(m||m===0)&&e.lift(p,m)})}),!0},XJ=n=>e=>n(e),ZJ=()=>({state:n,dispatch:e})=>Ox(n,e),eY=(n,e)=>({editor:t,tr:s})=>{const{state:r}=t,i=r.doc.slice(n.from,n.to);s.deleteRange(n.from,n.to);const o=s.mapping.map(e);return s.insert(o,i.content),s.setSelection(new Ne(s.doc.resolve(o-1))),!0},tY=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,s=t.$anchor.node();if(s.content.size>0)return!1;const r=n.selection.$anchor;for(let i=r.depth;i>0;i-=1)if(r.node(i).type===s.type){if(e){const a=r.before(i),l=r.after(i);n.delete(a,l).scrollIntoView()}return!0}return!1},nY=n=>({tr:e,state:t,dispatch:s})=>{const r=Kt(n,t.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r){if(s){const l=i.before(o),c=i.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},sY=n=>({tr:e,dispatch:t})=>{const{from:s,to:r}=n;return t&&e.delete(s,r),!0},rY=()=>({state:n,dispatch:e})=>$v(n,e),iY=()=>({commands:n})=>n.keyboardShortcut("Enter"),oY=()=>({state:n,dispatch:e})=>yJ(n,e);function jd(n,e,t={strict:!0}){const s=Object.keys(e);return s.length?s.every(r=>t.strict?e[r]===n[r]:qv(e[r])?e[r].test(n[r]):e[r]===n[r]):!0}function Ux(n,e,t={}){return n.find(s=>s.type===e&&jd(Object.fromEntries(Object.keys(t).map(r=>[r,s.attrs[r]])),t))}function kS(n,e,t={}){return!!Ux(n,e,t)}function Kv(n,e,t){var s;if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if((!r.node||!r.node.marks.some(u=>u.type===e))&&(r=n.parent.childBefore(n.parentOffset)),!r.node||!r.node.marks.some(u=>u.type===e)||(t=t||((s=r.node.marks[0])===null||s===void 0?void 0:s.attrs),!Ux([...r.node.marks],e,t)))return;let o=r.index,a=n.start()+r.offset,l=o+1,c=a+r.node.nodeSize;for(;o>0&&kS([...n.parent.child(o-1).marks],e,t);)o-=1,a-=n.parent.child(o).nodeSize;for(;l<n.parent.childCount&&kS([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function Wi(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const aY=(n,e={})=>({tr:t,state:s,dispatch:r})=>{const i=Wi(n,s.schema),{doc:o,selection:a}=t,{$from:l,from:c,to:u}=a;if(r){const h=Kv(l,i,e);if(h&&h.from<=c&&h.to>=u){const f=Ne.create(o,h.from,h.to);t.setSelection(f)}}return!0},lY=n=>e=>{const t=typeof n=="function"?n(e):n;for(let s=0;s<t.length;s+=1)if(t[s](e))return!0;return!1};function jx(n){return n instanceof Ne}function po(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function zx(n,e=null){if(!e)return null;const t=Le.atStart(n),s=Le.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return s;const r=t.from,i=s.to;return e==="all"?Ne.create(n,po(0,r,i),po(n.content.size,r,i)):Ne.create(n,po(e,r,i),po(e,r,i))}function cY(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Gv(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const uY=(n=null,e={})=>({editor:t,view:s,tr:r,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{(Gv()||cY())&&s.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(s.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(s.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!jx(t.state.selection))return o(),!0;const a=zx(r.doc,n)||t.state.selection,l=t.state.selection.eq(a);return i&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),o()),!0},hY=(n,e)=>t=>n.every((s,r)=>e(s,{...t,index:r})),dY=(n,e)=>({tr:t,commands:s})=>s.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),Hx=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const s=e[t];s.nodeType===3&&s.nodeValue&&/^(\n\s\s|\n)$/.test(s.nodeValue)?n.removeChild(s):s.nodeType===1&&Hx(s)}return n};function mh(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return Hx(t)}function zd(n,e,t){if(n instanceof di||n instanceof X)return n;t={slice:!0,parseOptions:{},...t};const s=typeof n=="object"&&n!==null,r=typeof n=="string";if(s)try{if(Array.isArray(n)&&n.length>0)return X.fromArray(n.map(a=>e.nodeFromJSON(a)));const o=e.nodeFromJSON(n);return t.errorOnInvalidContent&&o.check(),o}catch(i){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",i),zd("",e,t)}if(r){if(t.errorOnInvalidContent){let o=!1,a="";const l=new kP({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?fi.fromSchema(l).parseSlice(mh(n),t.parseOptions):fi.fromSchema(l).parse(mh(n),t.parseOptions),t.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const i=fi.fromSchema(e);return t.slice?i.parseSlice(mh(n),t.parseOptions).content:i.parse(mh(n),t.parseOptions)}return zd("",e,t)}function fY(n,e,t){const s=n.steps.length-1;if(s<e)return;const r=n.steps[s];if(!(r instanceof jt||r instanceof Ht))return;const i=n.mapping.maps[s];let o=0;i.forEach((a,l,c,u)=>{o===0&&(o=u)}),n.setSelection(Le.near(n.doc.resolve(o),t))}const pY=n=>!("type"in n),mY=(n,e,t)=>({tr:s,dispatch:r,editor:i})=>{var o;if(r){t={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;try{a=zd(e,i.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions},errorOnInvalidContent:(o=t.errorOnInvalidContent)!==null&&o!==void 0?o:i.options.enableContentCheck})}catch(m){return i.emit("contentError",{editor:i,error:m,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:c}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},u=!0,h=!0;if((pY(a)?a:[a]).forEach(m=>{m.check(),u=u?m.isText&&m.marks.length===0:!1,h=h?m.isBlock:!1}),l===c&&h){const{parent:m}=s.doc.resolve(l);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(l-=1,c+=1)}let p;if(u){if(Array.isArray(e))p=e.map(m=>m.text||"").join("");else if(e instanceof X){let m="";e.forEach(_=>{_.text&&(m+=_.text)}),p=m}else typeof e=="object"&&e&&e.text?p=e.text:p=e;s.insertText(p,l,c)}else p=a,s.replaceWith(l,c,p);t.updateSelection&&fY(s,s.steps.length-1,-1),t.applyInputRules&&s.setMeta("applyInputRules",{from:l,text:p}),t.applyPasteRules&&s.setMeta("applyPasteRules",{from:l,text:p})}return!0},gY=()=>({state:n,dispatch:e})=>mJ(n,e),_Y=()=>({state:n,dispatch:e})=>gJ(n,e),yY=()=>({state:n,dispatch:e})=>Cx(n,e),vY=()=>({state:n,dispatch:e})=>Px(n,e),bY=()=>({state:n,dispatch:e,tr:t})=>{try{const s=np(n.doc,n.selection.$from.pos,-1);return s==null?!1:(t.join(s,2),e&&e(t),!0)}catch{return!1}},wY=()=>({state:n,dispatch:e,tr:t})=>{try{const s=np(n.doc,n.selection.$from.pos,1);return s==null?!1:(t.join(s,2),e&&e(t),!0)}catch{return!1}},EY=()=>({state:n,dispatch:e})=>fJ(n,e),TY=()=>({state:n,dispatch:e})=>pJ(n,e);function Wx(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function SY(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let s,r,i,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))s=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))Gv()||Wx()?o=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return s&&(t=`Alt-${t}`),r&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}const IY=n=>({editor:e,view:t,tr:s,dispatch:r})=>{const i=SY(n).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const u=c.map(s.mapping);u&&r&&s.maybeStep(u)}),!0};function Zc(n,e,t={}){const{from:s,to:r,empty:i}=n.selection,o=e?Kt(e,n.schema):null,a=[];n.doc.nodesBetween(s,r,(h,f)=>{if(h.isText)return;const p=Math.max(s,f),m=Math.min(r,f+h.nodeSize);a.push({node:h,from:p,to:m})});const l=r-s,c=a.filter(h=>o?o.name===h.node.type.name:!0).filter(h=>jd(h.node.attrs,t,{strict:!1}));return i?!!c.length:c.reduce((h,f)=>h+f.to-f.from,0)>=l}const CY=(n,e={})=>({state:t,dispatch:s})=>{const r=Kt(n,t.schema);return Zc(t,r,e)?_J(t,s):!1},kY=()=>({state:n,dispatch:e})=>Mx(n,e),AY=n=>({state:e,dispatch:t})=>{const s=Kt(n,e.schema);return RJ(s)(e,t)},RY=()=>({state:n,dispatch:e})=>Nx(n,e);function fp(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function AS(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((s,r)=>(t.includes(r)||(s[r]=n[r]),s),{})}const PY=(n,e)=>({tr:t,state:s,dispatch:r})=>{let i=null,o=null;const a=fp(typeof n=="string"?n:n.name,s.schema);return a?(a==="node"&&(i=Kt(n,s.schema)),a==="mark"&&(o=Wi(n,s.schema)),r&&t.selection.ranges.forEach(l=>{s.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{i&&i===c.type&&t.setNodeMarkup(u,void 0,AS(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(h=>{o===h.type&&t.addMark(u,u+c.nodeSize,o.create(AS(h.attrs,e)))})})}),!0):!1},xY=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),NY=()=>({tr:n,dispatch:e})=>{if(e){const t=new es(n.doc);n.setSelection(t)}return!0},OY=()=>({state:n,dispatch:e})=>Ax(n,e),MY=()=>({state:n,dispatch:e})=>xx(n,e),DY=()=>({state:n,dispatch:e})=>wJ(n,e),LY=()=>({state:n,dispatch:e})=>SJ(n,e),VY=()=>({state:n,dispatch:e})=>TJ(n,e);function a_(n,e,t={},s={}){return zd(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:s.errorOnInvalidContent})}const FY=(n,e=!1,t={},s={})=>({editor:r,tr:i,dispatch:o,commands:a})=>{var l,c;const{doc:u}=i;if(t.preserveWhitespace!=="full"){const h=a_(n,r.schema,t,{errorOnInvalidContent:(l=s.errorOnInvalidContent)!==null&&l!==void 0?l:r.options.enableContentCheck});return o&&i.replaceWith(0,u.content.size,h).setMeta("preventUpdate",!e),!0}return o&&i.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},n,{parseOptions:t,errorOnInvalidContent:(c=s.errorOnInvalidContent)!==null&&c!==void 0?c:r.options.enableContentCheck})};function qx(n,e){const t=Wi(e,n.schema),{from:s,to:r,empty:i}=n.selection,o=[];i?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(s,r,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function BY(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function $Y(n,e){for(let t=n.depth;t>0;t-=1){const s=n.node(t);if(e(s))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:s}}}function Qv(n){return e=>$Y(e.$from,n)}function UY(n,e){const t={from:0,to:n.content.size};return Bx(n,t,e)}function jY(n,e){const t=Kt(e,n.schema),{from:s,to:r}=n.selection,i=[];n.doc.nodesBetween(s,r,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===t.name);return o?{...o.attrs}:{}}function zY(n,e){const t=fp(typeof e=="string"?e:e.name,n.schema);return t==="node"?jY(n,e):t==="mark"?qx(n,e):{}}function Kx(n,e,t){const s=[];return n===e?t.resolve(n).marks().forEach(r=>{const i=t.resolve(n),o=Kv(i,r.type);o&&s.push({mark:r,...o})}):t.nodesBetween(n,e,(r,i)=>{!r||(r==null?void 0:r.nodeSize)===void 0||s.push(...r.marks.map(o=>({from:i,to:i+r.nodeSize,mark:o})))}),s}function Vh(n,e,t){return Object.fromEntries(Object.entries(t).filter(([s])=>{const r=n.find(i=>i.type===e&&i.name===s);return r?r.attribute.keepOnSplit:!1}))}function l_(n,e,t={}){const{empty:s,ranges:r}=n.selection,i=e?Wi(e,n.schema):null;if(s)return!!(n.storedMarks||n.selection.$from.marks()).filter(h=>i?i.name===h.type.name:!0).find(h=>jd(h.attrs,t,{strict:!1}));let o=0;const a=[];if(r.forEach(({$from:h,$to:f})=>{const p=h.pos,m=f.pos;n.doc.nodesBetween(p,m,(_,v)=>{if(!_.isText&&!_.marks.length)return;const I=Math.max(p,v),O=Math.min(m,v+_.nodeSize),P=O-I;o+=P,a.push(..._.marks.map(D=>({mark:D,from:I,to:O})))})}),o===0)return!1;const l=a.filter(h=>i?i.name===h.mark.type.name:!0).filter(h=>jd(h.mark.attrs,t,{strict:!1})).reduce((h,f)=>h+f.to-f.from,0),c=a.filter(h=>i?h.mark.type!==i&&h.mark.type.excludes(i):!0).reduce((h,f)=>h+f.to-f.from,0);return(l>0?l+c:l)>=o}function HY(n,e,t={}){if(!e)return Zc(n,null,t)||l_(n,null,t);const s=fp(e,n.schema);return s==="node"?Zc(n,e,t):s==="mark"?l_(n,e,t):!1}function RS(n,e){const{nodeExtensions:t}=up(e),s=t.find(o=>o.name===n);if(!s)return!1;const r={name:s.name,options:s.options,storage:s.storage},i=Fe(ge(s,"group",r));return typeof i!="string"?!1:i.split(" ").includes("list")}function Jv(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var s;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((s=n.text)!==null&&s!==void 0?s:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let r=!0;return n.content.forEach(i=>{r!==!1&&(Jv(i,{ignoreWhitespace:t,checkChildren:e})||(r=!1))}),r}return!1}function WY(n){return n instanceof Ee}function qY(n,e,t){var s;const{selection:r}=e;let i=null;if(jx(r)&&(i=r.$cursor),i){const a=(s=n.storedMarks)!==null&&s!==void 0?s:i.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:o}=r;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,h,f)=>{if(c)return!1;if(u.isInline){const p=!f||f.type.allowsMarkType(t),m=!!t.isInSet(u.marks)||!u.marks.some(_=>_.type.excludes(t));c=p&&m}return!c}),c})}const KY=(n,e={})=>({tr:t,state:s,dispatch:r})=>{const{selection:i}=t,{empty:o,ranges:a}=i,l=Wi(n,s.schema);if(r)if(o){const c=qx(s,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,h=c.$to.pos;s.doc.nodesBetween(u,h,(f,p)=>{const m=Math.max(p,u),_=Math.min(p+f.nodeSize,h);f.marks.find(I=>I.type===l)?f.marks.forEach(I=>{l===I.type&&t.addMark(m,_,l.create({...I.attrs,...e}))}):t.addMark(m,_,l.create(e))})});return qY(s,t,l)},GY=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),QY=(n,e={})=>({state:t,dispatch:s,chain:r})=>{const i=Kt(n,t.schema);let o;return t.selection.$anchor.sameParent(t.selection.$head)&&(o=t.selection.$anchor.parent.attrs),i.isTextblock?r().command(({commands:a})=>TS(i,{...o,...e})(t)?!0:a.clearNodes()).command(({state:a})=>TS(i,{...o,...e})(a,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},JY=n=>({tr:e,dispatch:t})=>{if(t){const{doc:s}=e,r=po(n,0,s.content.size),i=Ee.create(s,r);e.setSelection(i)}return!0},YY=n=>({tr:e,dispatch:t})=>{if(t){const{doc:s}=e,{from:r,to:i}=typeof n=="number"?{from:n,to:n}:n,o=Ne.atStart(s).from,a=Ne.atEnd(s).to,l=po(r,o,a),c=po(i,o,a),u=Ne.create(s,l,c);e.setSelection(u)}return!0},XY=n=>({state:e,dispatch:t})=>{const s=Kt(n,e.schema);return NJ(s)(e,t)};function PS(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const s=t.filter(r=>e==null?void 0:e.includes(r.type.name));n.tr.ensureMarks(s)}}const ZY=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:s,editor:r})=>{const{selection:i,doc:o}=e,{$from:a,$to:l}=i,c=r.extensionManager.attributes,u=Vh(c,a.node().type.name,a.node().attrs);if(i instanceof Ee&&i.node.isBlock)return!a.parentOffset||!Er(o,a.pos)?!1:(s&&(n&&PS(t,r.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const h=l.parentOffset===l.parent.content.size,f=a.depth===0?void 0:BY(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=h&&f?[{type:f,attrs:u}]:void 0,m=Er(e.doc,e.mapping.map(a.pos),1,p);if(!p&&!m&&Er(e.doc,e.mapping.map(a.pos),1,f?[{type:f}]:void 0)&&(m=!0,p=f?[{type:f,attrs:u}]:void 0),s){if(m&&(i instanceof Ne&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,p),f&&!h&&!a.parentOffset&&a.parent.type!==f)){const _=e.mapping.map(a.before()),v=e.doc.resolve(_);a.node(-1).canReplaceWith(v.index(),v.index()+1,f)&&e.setNodeMarkup(e.mapping.map(a.before()),f)}n&&PS(t,r.extensionManager.splittableMarks),e.scrollIntoView()}return m},eX=(n,e={})=>({tr:t,state:s,dispatch:r,editor:i})=>{var o;const a=Kt(n,s.schema),{$from:l,$to:c}=s.selection,u=s.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const h=l.node(-1);if(h.type!==a)return!1;const f=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(r){let I=X.empty;const O=l.index(-1)?1:l.index(-2)?2:3;for(let T=l.depth-O;T>=l.depth-3;T-=1)I=X.from(l.node(T).copy(I));const P=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,D={...Vh(f,l.node().type.name,l.node().attrs),...e},B=((o=a.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(D))||void 0;I=I.append(X.from(a.createAndFill(null,B)||void 0));const M=l.before(l.depth-(O-1));t.replace(M,l.after(-P),new he(I,4-O,0));let A=-1;t.doc.nodesBetween(M,t.doc.content.size,(T,E)=>{if(A>-1)return!1;T.isTextblock&&T.content.size===0&&(A=E+1)}),A>-1&&t.setSelection(Ne.near(t.doc.resolve(A))),t.scrollIntoView()}return!0}const p=c.pos===l.end()?h.contentMatchAt(0).defaultType:null,m={...Vh(f,h.type.name,h.attrs),...e},_={...Vh(f,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,c.pos);const v=p?[{type:a,attrs:m},{type:p,attrs:_}]:[{type:a,attrs:m}];if(!Er(t.doc,l.pos,2))return!1;if(r){const{selection:I,storedMarks:O}=s,{splittableMarks:P}=i.extensionManager,D=O||I.$to.parentOffset&&I.$from.marks();if(t.split(l.pos,2,v).scrollIntoView(),!D||!r)return!0;const B=D.filter(M=>P.includes(M.type.name));t.ensureMarks(B)}return!0},Pm=(n,e)=>{const t=Qv(o=>o.type===e)(n.selection);if(!t)return!0;const s=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(s===void 0)return!0;const r=n.doc.nodeAt(s);return t.node.type===(r==null?void 0:r.type)&&zi(n.doc,t.pos)&&n.join(t.pos),!0},xm=(n,e)=>{const t=Qv(o=>o.type===e)(n.selection);if(!t)return!0;const s=n.doc.resolve(t.start).after(t.depth);if(s===void 0)return!0;const r=n.doc.nodeAt(s);return t.node.type===(r==null?void 0:r.type)&&zi(n.doc,s)&&n.join(s),!0},tX=(n,e,t,s={})=>({editor:r,tr:i,state:o,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:h,splittableMarks:f}=r.extensionManager,p=Kt(n,o.schema),m=Kt(e,o.schema),{selection:_,storedMarks:v}=o,{$from:I,$to:O}=_,P=I.blockRange(O),D=v||_.$to.parentOffset&&_.$from.marks();if(!P)return!1;const B=Qv(M=>RS(M.type.name,h))(_);if(P.depth>=1&&B&&P.depth-B.depth<=1){if(B.node.type===p)return c.liftListItem(m);if(RS(B.node.type.name,h)&&p.validContent(B.node.content)&&a)return l().command(()=>(i.setNodeMarkup(B.pos,p),!0)).command(()=>Pm(i,p)).command(()=>xm(i,p)).run()}return!t||!D||!a?l().command(()=>u().wrapInList(p,s)?!0:c.clearNodes()).wrapInList(p,s).command(()=>Pm(i,p)).command(()=>xm(i,p)).run():l().command(()=>{const M=u().wrapInList(p,s),A=D.filter(T=>f.includes(T.type.name));return i.ensureMarks(A),M?!0:c.clearNodes()}).wrapInList(p,s).command(()=>Pm(i,p)).command(()=>xm(i,p)).run()},nX=(n,e={},t={})=>({state:s,commands:r})=>{const{extendEmptyMarkRange:i=!1}=t,o=Wi(n,s.schema);return l_(s,o,e)?r.unsetMark(o,{extendEmptyMarkRange:i}):r.setMark(o,e)},sX=(n,e,t={})=>({state:s,commands:r})=>{const i=Kt(n,s.schema),o=Kt(e,s.schema),a=Zc(s,i,t);let l;return s.selection.$anchor.sameParent(s.selection.$head)&&(l=s.selection.$anchor.parent.attrs),a?r.setNode(o,l):r.setNode(i,{...l,...t})},rX=(n,e={})=>({state:t,commands:s})=>{const r=Kt(n,t.schema);return Zc(t,r,e)?s.lift(r):s.wrapIn(r,e)},iX=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let s=0;s<t.length;s+=1){const r=t[s];let i;if(r.spec.isInputRules&&(i=r.getState(n))){if(e){const o=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},oX=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:s,ranges:r}=t;return s||e&&r.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},aX=(n,e={})=>({tr:t,state:s,dispatch:r})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=t,l=Wi(n,s.schema),{$from:c,empty:u,ranges:h}=a;if(!r)return!0;if(u&&o){let{from:f,to:p}=a;const m=(i=c.marks().find(v=>v.type===l))===null||i===void 0?void 0:i.attrs,_=Kv(c,l,m);_&&(f=_.from,p=_.to),t.removeMark(f,p,l)}else h.forEach(f=>{t.removeMark(f.$from.pos,f.$to.pos,l)});return t.removeStoredMark(l),!0},lX=(n,e={})=>({tr:t,state:s,dispatch:r})=>{let i=null,o=null;const a=fp(typeof n=="string"?n:n.name,s.schema);return a?(a==="node"&&(i=Kt(n,s.schema)),a==="mark"&&(o=Wi(n,s.schema)),r&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let h,f,p,m;t.selection.empty?s.doc.nodesBetween(c,u,(_,v)=>{i&&i===_.type&&(p=Math.max(v,c),m=Math.min(v+_.nodeSize,u),h=v,f=_)}):s.doc.nodesBetween(c,u,(_,v)=>{v<c&&i&&i===_.type&&(p=Math.max(v,c),m=Math.min(v+_.nodeSize,u),h=v,f=_),v>=c&&v<=u&&(i&&i===_.type&&t.setNodeMarkup(v,void 0,{..._.attrs,...e}),o&&_.marks.length&&_.marks.forEach(I=>{if(o===I.type){const O=Math.max(v,c),P=Math.min(v+_.nodeSize,u);t.addMark(O,P,o.create({...I.attrs,...e}))}}))}),f&&(h!==void 0&&t.setNodeMarkup(h,void 0,{...f.attrs,...e}),o&&f.marks.length&&f.marks.forEach(_=>{o===_.type&&t.addMark(p,m,o.create({..._.attrs,...e}))}))}),!0):!1},cX=(n,e={})=>({state:t,dispatch:s})=>{const r=Kt(n,t.schema);return IJ(r,e)(t,s)},uX=(n,e={})=>({state:t,dispatch:s})=>{const r=Kt(n,t.schema);return CJ(r,e)(t,s)};var hX=Object.freeze({__proto__:null,blur:QJ,clearContent:JJ,clearNodes:YJ,command:XJ,createParagraphNear:ZJ,cut:eY,deleteCurrentNode:tY,deleteNode:nY,deleteRange:sY,deleteSelection:rY,enter:iY,exitCode:oY,extendMarkRange:aY,first:lY,focus:uY,forEach:hY,insertContent:dY,insertContentAt:mY,joinBackward:yY,joinDown:_Y,joinForward:vY,joinItemBackward:bY,joinItemForward:wY,joinTextblockBackward:EY,joinTextblockForward:TY,joinUp:gY,keyboardShortcut:IY,lift:CY,liftEmptyBlock:kY,liftListItem:AY,newlineInCode:RY,resetAttributes:PY,scrollIntoView:xY,selectAll:NY,selectNodeBackward:OY,selectNodeForward:MY,selectParentNode:DY,selectTextblockEnd:LY,selectTextblockStart:VY,setContent:FY,setMark:KY,setMeta:GY,setNode:QY,setNodeSelection:JY,setTextSelection:YY,sinkListItem:XY,splitBlock:ZY,splitListItem:eX,toggleList:tX,toggleMark:nX,toggleNode:sX,toggleWrap:rX,undoInputRule:iX,unsetAllMarks:oX,unsetMark:aX,updateAttributes:lX,wrapIn:cX,wrapInList:uX});const dX=Ln.create({name:"commands",addCommands(){return{...hX}}}),fX=Ln.create({name:"drop",addProseMirrorPlugins(){return[new Wn({key:new sr("tiptapDrop"),props:{handleDrop:(n,e,t,s)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:s})}}})]}}),pX=Ln.create({name:"editable",addProseMirrorPlugins(){return[new Wn({key:new sr("editable"),props:{editable:()=>this.editor.options.editable}})]}}),mX=new sr("focusEvents"),gX=Ln.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new Wn({key:mX,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const s=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(s),!1},blur:(e,t)=>{n.isFocused=!1;const s=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(s),!1}}}})]}}),_X=Ln.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:h}=l,{pos:f,parent:p}=h,m=h.parent.isTextblock&&f>0?a.doc.resolve(f-1):h,_=m.parent.type.spec.isolating,v=h.pos-h.parentOffset,I=_&&m.parent.childCount===1?v===h.pos:Le.atStart(c).from===f;return!u||!p.type.isTextblock||p.textContent.length||!I||I&&h.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},r={...s},i={...s,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Gv()||Wx()?i:r},addProseMirrorPlugins(){return[new Wn({key:new sr("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(_=>_.getMeta("composition")))return;const s=n.some(_=>_.docChanged)&&!e.doc.eq(t.doc),r=n.some(_=>_.getMeta("preventClearDocument"));if(!s||r)return;const{empty:i,from:o,to:a}=e.selection,l=Le.atStart(e.doc).from,c=Le.atEnd(e.doc).to;if(i||!(o===l&&a===c)||!Jv(t.doc))return;const f=t.tr,p=lp({state:t,transaction:f}),{commands:m}=new cp({editor:this.editor,state:p});if(m.clearNodes(),!!f.steps.length)return f}})]}}),yX=Ln.create({name:"paste",addProseMirrorPlugins(){return[new Wn({key:new sr("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),vX=Ln.create({name:"tabindex",addProseMirrorPlugins(){return[new Wn({key:new sr("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class ao{get name(){return this.node.type.name}constructor(e,t,s=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=s,this.resolvedPos=e,this.editor=t,this.currentNode=r}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,s=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,s=this.to-1}this.editor.commands.insertContentAt({from:t,to:s},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new ao(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new ao(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new ao(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,s)=>{const r=t.isBlock&&!t.isTextblock,i=t.isAtom&&!t.isText,o=this.pos+s+(i?0:1),a=this.resolvedPos.doc.resolve(o);if(!r&&a.depth<=this.depth)return;const l=new ao(a,this.editor,r,r?t:null);r&&(l.actualDepth=this.depth+1),e.push(new ao(a,this.editor,r,r?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let s=null,r=this.parent;for(;r&&!s;){if(r.node.type.name===e)if(Object.keys(t).length>0){const i=r.node.attrs,o=Object.keys(t);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==t[l])break}}else s=r;r=r.parent}return s}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},s=!1){let r=[];if(!this.children||this.children.length===0)return r;const i=Object.keys(t);return this.children.forEach(o=>{s&&r.length>0||(o.node.type.name===e&&i.every(l=>t[l]===o.node.attrs[l])&&r.push(o),!(s&&r.length>0)&&(r=r.concat(o.querySelectorAll(e,t,s))))}),r}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const bX=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function wX(n,e,t){const s=document.querySelector("style[data-tiptap-style]");if(s!==null)return s;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(r),r}let EX=class extends OJ{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:s,moved:r})=>this.options.onDrop(t,s,r)),this.on("paste",({event:t,slice:s})=>this.options.onPaste(t,s)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=wX(bX,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const s=Fx(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:s});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let s=t;if([].concat(e).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;s=s.filter(a=>!a.key.startsWith(o))}),t.length===s.length)return;const r=this.state.reconfigure({plugins:s});return this.view.updateState(r),r}createExtensionManager(){var e,t;const r=[...this.options.enableCoreExtensions?[pX,GJ.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),dX,gX,_X,vX,fX,yX].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new fa(r,this)}createCommandManager(){this.commandManager=new cp({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=a_(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),t=a_(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const s=zx(t,this.options.autofocus);this.view=new nJ(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:da.create({doc:t,selection:s||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const t=this.state.apply(e),s=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),s&&this.emit("selectionUpdate",{editor:this,transaction:e});const r=e.getMeta("focus"),i=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return zY(this.state,e)}isActive(e,t){const s=typeof e=="string"?e:null,r=typeof e=="string"?t:e;return HY(this.state,s,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Wv(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:s={}}=e||{};return UY(this.state.doc,{blockSeparator:t,textSerializers:{...$x(this.schema),...s}})}get isEmpty(){return Jv(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var s;return((s=this.$doc)===null||s===void 0?void 0:s.querySelector(e,t))||null}$nodes(e,t){var s;return((s=this.$doc)===null||s===void 0?void 0:s.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new ao(t,this)}get $doc(){return this.$pos(0)}};function Wa(n){return new hp({find:n.find,handler:({state:e,range:t,match:s})=>{const r=Fe(n.getAttributes,void 0,s);if(r===!1||r===null)return null;const{tr:i}=e,o=s[s.length-1],a=s[0];if(o){const l=a.search(/\S/),c=t.from+a.indexOf(o),u=c+o.length;if(Kx(t.from,t.to,e.doc).filter(p=>p.mark.type.excluded.find(_=>_===n.type&&_!==p.mark.type)).filter(p=>p.to>c).length)return null;u<t.to&&i.delete(u,t.to),c>t.from&&i.delete(t.from+l,c);const f=t.from+l+o.length;i.addMark(t.from+l,f,n.type.create(r||{})),i.removeStoredMark(n.type)}}})}function Gx(n){return new hp({find:n.find,handler:({state:e,range:t,match:s})=>{const r=Fe(n.getAttributes,void 0,s)||{},{tr:i}=e,o=t.from;let a=t.to;const l=n.type.create(r);if(s[1]){const c=s[0].lastIndexOf(s[1]);let u=o+c;u>a?u=a:a=u+s[1].length;const h=s[0][s[0].length-1];i.insertText(h,o+s[0].length-1),i.replaceWith(u,a,l)}else if(s[0]){const c=n.type.isInline?o:o-1;i.insert(c,n.type.create(r)).delete(i.mapping.map(o),i.mapping.map(a))}i.scrollIntoView()}})}function c_(n){return new hp({find:n.find,handler:({state:e,range:t,match:s})=>{const r=e.doc.resolve(t.from),i=Fe(n.getAttributes,void 0,s)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)}})}function eu(n){return new hp({find:n.find,handler:({state:e,range:t,match:s,chain:r})=>{const i=Fe(n.getAttributes,void 0,s)||{},o=e.tr.delete(t.from,t.to),l=o.doc.resolve(t.from).blockRange(),c=l&&Rv(l,n.type,i);if(!c)return null;if(o.wrap(l,c),n.keepMarks&&n.editor){const{selection:h,storedMarks:f}=e,{splittableMarks:p}=n.editor.extensionManager,m=f||h.$to.parentOffset&&h.$from.marks();if(m){const _=m.filter(v=>p.includes(v.type.name));o.ensureMarks(_)}}if(n.keepAttributes){const h=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(h,i).run()}const u=o.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&zi(o.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(s,u))&&o.join(t.from-1)}})}class Vn{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Fe(ge(this,"addOptions",{name:this.name}))),this.storage=Fe(ge(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Vn(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>dp(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Vn(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=Fe(ge(t,"addOptions",{name:t.name})),t.storage=Fe(ge(t,"addStorage",{name:t.name,options:t.options})),t}}function qa(n){return new jJ({find:n.find,handler:({state:e,range:t,match:s,pasteEvent:r})=>{const i=Fe(n.getAttributes,void 0,s,r);if(i===!1||i===null)return null;const{tr:o}=e,a=s[s.length-1],l=s[0];let c=t.to;if(a){const u=l.search(/\S/),h=t.from+l.indexOf(a),f=h+a.length;if(Kx(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(v=>v===n.type&&v!==m.mark.type)).filter(m=>m.to>h).length)return null;f<t.to&&o.delete(f,t.to),h>t.from&&o.delete(t.from+u,h),c=t.from+u+a.length,o.addMark(t.from+u,c,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function xS(n){return rO((e,t)=>({get(){return e(),n},set(s){n=s,requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}}))}class TX extends EX{constructor(e={}){return super(e),this.contentComponent=null,this.appContext=null,this.reactiveState=xS(this.view.state),this.reactiveExtensionStorage=xS(this.extensionStorage),this.on("beforeTransaction",({nextState:t})=>{this.reactiveState.value=t,this.reactiveExtensionStorage.value=this.extensionStorage}),tf(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(e,t){const s=super.registerPlugin(e,t);return this.reactiveState&&(this.reactiveState.value=s),s}unregisterPlugin(e){const t=super.unregisterPlugin(e);return this.reactiveState&&t&&(this.reactiveState.value=t),t}}const SX=T_({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(n){const e=G(),t=su();return ZO(()=>{const s=n.editor;s&&s.options.element&&e.value&&Mi(()=>{if(!e.value||!s.options.element.firstChild)return;const r=Y(e.value);e.value.append(...s.options.element.childNodes),s.contentComponent=t.ctx._,t&&(s.appContext={...t.appContext,provides:t.provides}),s.setOptions({element:r}),s.createNodeViews()})}),af(()=>{const s=n.editor;s&&(s.contentComponent=null,s.appContext=null)}),{rootEl:e}},render(){return hf("div",{ref:n=>{this.rootEl=n}})}}),IX=(n={})=>{const e=nf();return Xs(()=>{e.value=new TX(n)}),af(()=>{var t,s,r;const i=(t=e.value)===null||t===void 0?void 0:t.options.element,o=i==null?void 0:i.cloneNode(!0);(s=i==null?void 0:i.parentNode)===null||s===void 0||s.replaceChild(o,i),(r=e.value)===null||r===void 0||r.destroy()}),e},CX=/^\s*>\s$/,kX=Vn.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",bn(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[eu({find:CX,type:this.type})]}}),AX=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,RX=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,PX=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,xX=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,NX=xi.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",bn(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Wa({find:AX,type:this.type}),Wa({find:PX,type:this.type})]},addPasteRules(){return[qa({find:RX,type:this.type}),qa({find:xX,type:this.type})]}}),OX="listItem",NS="textStyle",OS=/^\s*([-+*])\s$/,MX=Vn.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",bn(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(OX,this.editor.getAttributes(NS)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=eu({find:OS,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=eu({find:OS,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(NS),editor:this.editor})),[n]}}),DX=/(^|[^`])`([^`]+)`(?!`)/,LX=/(^|[^`])`([^`]+)`(?!`)/g,VX=xi.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",bn(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Wa({find:DX,type:this.type})]},addPasteRules(){return[qa({find:LX,type:this.type})]}}),FX=/^```([a-z]+)?[\s\n]$/,BX=/^~~~([a-z]+)?[\s\n]$/,$X=Vn.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,i=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",bn(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:s,empty:r}=t;if(!r||s.parent.type!==this.type)return!1;const i=s.parentOffset===s.parent.nodeSize-2,o=s.parent.textContent.endsWith(`

`);return!i||!o?!1:n.chain().command(({tr:a})=>(a.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:s}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const a=r.after();return a===void 0?!1:s.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(Le.near(s.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[c_({find:FX,type:this.type,getAttributes:n=>({language:n[1]})}),c_({find:BX,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new Wn({key:new sr("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),s=e.clipboardData.getData("vscode-editor-data"),r=s?JSON.parse(s):void 0,i=r==null?void 0:r.mode;if(!t||!i)return!1;const{tr:o,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(Ne.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),UX=Vn.create({name:"doc",topNode:!0,content:"block+"});function jX(n={}){return new Wn({view(e){return new zX(e,n)}})}class zX{constructor(e,t){var s;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(s=t.width)!==null&&s!==void 0?s:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let i=o=>{this[r](o)};return e.dom.addEventListener(r,i),{name:r,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,s,r=this.editorView.dom,i=r.getBoundingClientRect(),o=i.width/r.offsetWidth,a=i.height/r.offsetHeight;if(t){let h=e.nodeBefore,f=e.nodeAfter;if(h||f){let p=this.editorView.nodeDOM(this.cursorPos-(h?h.nodeSize:0));if(p){let m=p.getBoundingClientRect(),_=h?m.bottom:m.top;h&&f&&(_=(_+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let v=this.width/2*a;s={left:m.left,right:m.right,top:_-v,bottom:_+v}}}}if(!s){let h=this.editorView.coordsAtPos(this.cursorPos),f=this.width/2*o;s={left:h.left-f,right:h.left+f,top:h.top,bottom:h.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let h=l.getBoundingClientRect(),f=h.width/l.offsetWidth,p=h.height/l.offsetHeight;c=h.left-l.scrollLeft*f,u=h.top-l.scrollTop*p}this.element.style.left=(s.left-c)/o+"px",this.element.style.top=(s.top-u)/a+"px",this.element.style.width=(s.right-s.left)/o+"px",this.element.style.height=(s.bottom-s.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),s=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=s&&s.type.spec.disableDropCursor,i=typeof r=="function"?r(this.editorView,t,e):r;if(t&&!i){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=FP(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const HX=Ln.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[jX(this.options)]}});class St extends Le{constructor(e){super(e,e)}map(e,t){let s=e.resolve(t.map(this.head));return St.valid(s)?new St(s):Le.near(s)}content(){return he.empty}eq(e){return e instanceof St&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new St(e.resolve(t.pos))}getBookmark(){return new Yv(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!WX(e)||!qX(e))return!1;let s=t.type.spec.allowGapCursor;if(s!=null)return s;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,s=!1){e:for(;;){if(!s&&St.valid(e))return e;let r=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(t>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;r+=t;let l=e.doc.resolve(r);if(St.valid(l))return l}for(;;){let o=t>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!Ee.isSelectable(i)){e=e.doc.resolve(r+i.nodeSize*t),s=!1;continue e}break}i=o,r+=t;let a=e.doc.resolve(r);if(St.valid(a))return a}return null}}}St.prototype.visible=!1;St.findFrom=St.findGapCursorFrom;Le.jsonID("gapcursor",St);class Yv{constructor(e){this.pos=e}map(e){return new Yv(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return St.valid(t)?new St(t):Le.near(t)}}function WX(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),s=n.node(e);if(t==0){if(s.type.spec.isolating)return!0;continue}for(let r=s.child(t-1);;r=r.lastChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function qX(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),s=n.node(e);if(t==s.childCount){if(s.type.spec.isolating)return!0;continue}for(let r=s.child(t);;r=r.firstChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function KX(){return new Wn({props:{decorations:YX,createSelectionBetween(n,e,t){return e.pos==t.pos&&St.valid(t)?new St(t):null},handleClick:QX,handleKeyDown:GX,handleDOMEvents:{beforeinput:JX}}})}const GX=Sx({ArrowLeft:gh("horiz",-1),ArrowRight:gh("horiz",1),ArrowUp:gh("vert",-1),ArrowDown:gh("vert",1)});function gh(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(s,r,i){let o=s.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof Ne){if(!i.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=s.doc.resolve(e>0?a.after():a.before())}let c=St.findGapCursorFrom(a,e,l);return c?(r&&r(s.tr.setSelection(new St(c))),!0):!1}}function QX(n,e,t){if(!n||!n.editable)return!1;let s=n.state.doc.resolve(e);if(!St.valid(s))return!1;let r=n.posAtCoords({left:t.clientX,top:t.clientY});return r&&r.inside>-1&&Ee.isSelectable(n.state.doc.nodeAt(r.inside))?!1:(n.dispatch(n.state.tr.setSelection(new St(s))),!0)}function JX(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof St))return!1;let{$from:t}=n.state.selection,s=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!s)return!1;let r=X.empty;for(let o=s.length-1;o>=0;o--)r=X.from(s[o].createAndFill(null,r));let i=n.state.tr.replace(t.pos,t.pos,new he(r,0,0));return i.setSelection(Ne.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function YX(n){if(!(n.selection instanceof St))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Mt.create(n.doc,[ls.widget(n.selection.head,e,{key:"gapcursor"})])}const XX=Ln.create({name:"gapCursor",addProseMirrorPlugins(){return[KX()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=Fe(ge(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),ZX=Vn.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",bn(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:s})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:r,storedMarks:i}=t;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=s.extensionManager,l=i||r.$to.parentOffset&&r.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const h=l.filter(f=>a.includes(f.type.name));c.ensureMarks(h)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),eZ=Vn.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,bn(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>c_({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Hd=200,Wt=function(){};Wt.prototype.append=function(e){return e.length?(e=Wt.from(e),!this.length&&e||e.length<Hd&&this.leafAppend(e)||this.length<Hd&&e.leafPrepend(this)||this.appendInner(e)):this};Wt.prototype.prepend=function(e){return e.length?Wt.from(e).append(this):this};Wt.prototype.appendInner=function(e){return new tZ(this,e)};Wt.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Wt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Wt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Wt.prototype.forEach=function(e,t,s){t===void 0&&(t=0),s===void 0&&(s=this.length),t<=s?this.forEachInner(e,t,s,0):this.forEachInvertedInner(e,t,s,0)};Wt.prototype.map=function(e,t,s){t===void 0&&(t=0),s===void 0&&(s=this.length);var r=[];return this.forEach(function(i,o){return r.push(e(i,o))},t,s),r};Wt.from=function(e){return e instanceof Wt?e:e&&e.length?new Qx(e):Wt.empty};var Qx=function(n){function e(s){n.call(this),this.values=s}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(r,i){return r==0&&i==this.length?this:new e(this.values.slice(r,i))},e.prototype.getInner=function(r){return this.values[r]},e.prototype.forEachInner=function(r,i,o,a){for(var l=i;l<o;l++)if(r(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,a){for(var l=i-1;l>=o;l--)if(r(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(r){if(this.length+r.length<=Hd)return new e(this.values.concat(r.flatten()))},e.prototype.leafPrepend=function(r){if(this.length+r.length<=Hd)return new e(r.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(Wt);Wt.empty=new Qx([]);var tZ=function(n){function e(t,s){n.call(this),this.left=t,this.right=s,this.length=t.length+s.length,this.depth=Math.max(t.depth,s.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(s){return s<this.left.length?this.left.get(s):this.right.get(s-this.left.length)},e.prototype.forEachInner=function(s,r,i,o){var a=this.left.length;if(r<a&&this.left.forEachInner(s,r,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(s,Math.max(r-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(s,r,i,o){var a=this.left.length;if(r>a&&this.right.forEachInvertedInner(s,r-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(s,Math.min(r,a),i,o)===!1)return!1},e.prototype.sliceInner=function(s,r){if(s==0&&r==this.length)return this;var i=this.left.length;return r<=i?this.left.slice(s,r):s>=i?this.right.slice(s-i,r-i):this.left.slice(s,i).append(this.right.slice(0,r-i))},e.prototype.leafAppend=function(s){var r=this.right.leafAppend(s);if(r)return new e(this.left,r)},e.prototype.leafPrepend=function(s){var r=this.left.leafPrepend(s);if(r)return new e(r,this.right)},e.prototype.appendInner=function(s){return this.left.depth>=Math.max(this.right.depth,s.depth)+1?new e(this.left,new e(this.right,s)):new e(this,s)},e}(Wt);const nZ=500;class _s{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let s=this.items.length;for(;;s--)if(this.items.get(s-1).selection){--s;break}let r,i;t&&(r=this.remapping(s,this.items.length),i=r.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((h,f)=>{if(!h.step){r||(r=this.remapping(s,f+1),i=r.maps.length),i--,u.push(h);return}if(r){u.push(new Ds(h.map));let p=h.step.map(r.slice(i)),m;p&&o.maybeStep(p).doc&&(m=o.mapping.maps[o.mapping.maps.length-1],c.push(new Ds(m,void 0,void 0,c.length+u.length))),i--,m&&r.appendMap(m,i)}else o.maybeStep(h.step);if(h.selection)return a=r?h.selection.map(r.slice(i)):h.selection,l=new _s(this.items.slice(0,s).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,s,r){let i=[],o=this.eventCount,a=this.items,l=!r&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let h=e.steps[u].invert(e.docs[u]),f=new Ds(e.mapping.maps[u],h,t),p;(p=l&&l.merge(f))&&(f=p,u?i.pop():a=a.slice(0,a.length-1)),i.push(f),t&&(o++,t=void 0),r||(l=f)}let c=o-s.depth;return c>rZ&&(a=sZ(a,c),o-=c),new _s(a.append(i),o)}remapping(e,t){let s=new Gc;return this.items.forEach((r,i)=>{let o=r.mirrorOffset!=null&&i-r.mirrorOffset>=e?s.maps.length-r.mirrorOffset:void 0;s.appendMap(r.map,o)},e,t),s}addMaps(e){return this.eventCount==0?this:new _s(this.items.append(e.map(t=>new Ds(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let s=[],r=Math.max(0,this.items.length-t),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},r);let l=t;this.items.forEach(f=>{let p=i.getMirror(--l);if(p==null)return;o=Math.min(o,p);let m=i.maps[p];if(f.step){let _=e.steps[p].invert(e.docs[p]),v=f.selection&&f.selection.map(i.slice(l+1,p));v&&a++,s.push(new Ds(m,_,v))}else s.push(new Ds(m))},r);let c=[];for(let f=t;f<o;f++)c.push(new Ds(i.maps[f]));let u=this.items.slice(0,r).append(c).append(s),h=new _s(u,a);return h.emptyItemCount()>nZ&&(h=h.compress(this.items.length-s.length)),h}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),s=t.maps.length,r=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)r.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(t.slice(s)),c=l&&l.getMap();if(s--,c&&t.appendMap(c,s),l){let u=o.selection&&o.selection.map(t.slice(s));u&&i++;let h=new Ds(c.invert(),l,u),f,p=r.length-1;(f=r.length&&r[p].merge(h))?r[p]=f:r.push(h)}}else o.map&&s--},this.items.length,0),new _s(Wt.from(r.reverse()),i)}}_s.empty=new _s(Wt.empty,0);function sZ(n,e){let t;return n.forEach((s,r)=>{if(s.selection&&e--==0)return t=r,!1}),n.slice(t)}class Ds{constructor(e,t,s,r){this.map=e,this.step=t,this.selection=s,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Ds(t.getMap().invert(),t,this.selection)}}}class Gr{constructor(e,t,s,r,i){this.done=e,this.undone=t,this.prevRanges=s,this.prevTime=r,this.prevComposition=i}}const rZ=20;function iZ(n,e,t,s){let r=t.getMeta(To),i;if(r)return r.historyState;t.getMeta(lZ)&&(n=new Gr(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(To))return o.getMeta(To).redo?new Gr(n.done.addTransform(t,void 0,s,Fh(e)),n.undone,MS(t.mapping.maps),n.prevTime,n.prevComposition):new Gr(n.done,n.undone.addTransform(t,void 0,s,Fh(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-s.newGroupDelay||!oZ(t,n.prevRanges)),c=o?Nm(n.prevRanges,t.mapping):MS(t.mapping.maps);return new Gr(n.done.addTransform(t,l?e.selection.getBookmark():void 0,s,Fh(e)),_s.empty,c,t.time,a??n.prevComposition)}else return(i=t.getMeta("rebased"))?new Gr(n.done.rebased(t,i),n.undone.rebased(t,i),Nm(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Gr(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Nm(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function oZ(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((s,r)=>{for(let i=0;i<e.length;i+=2)s<=e[i+1]&&r>=e[i]&&(t=!0)}),t}function MS(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((s,r,i,o)=>e.push(i,o));return e}function Nm(n,e){if(!n)return null;let t=[];for(let s=0;s<n.length;s+=2){let r=e.map(n[s],1),i=e.map(n[s+1],-1);r<=i&&t.push(r,i)}return t}function aZ(n,e,t){let s=Fh(e),r=To.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,s);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),r,s),l=new Gr(t?a:i.remaining,t?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(To,{redo:t,historyState:l})}let Om=!1,DS=null;function Fh(n){let e=n.plugins;if(DS!=e){Om=!1,DS=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Om=!0;break}}return Om}const To=new sr("history"),lZ=new sr("closeHistory");function cZ(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new Wn({key:To,state:{init(){return new Gr(_s.empty,_s.empty,null,0,-1)},apply(e,t,s){return iZ(t,s,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let s=t.inputType,r=s=="historyUndo"?Yx:s=="historyRedo"?Xx:null;return r?(t.preventDefault(),r(e.state,e.dispatch)):!1}}}})}function Jx(n,e){return(t,s)=>{let r=To.getState(t);if(!r||(n?r.undone:r.done).eventCount==0)return!1;if(s){let i=aZ(r,t,n);i&&s(e?i.scrollIntoView():i)}return!0}}const Yx=Jx(!1,!0),Xx=Jx(!0,!0),uZ=Ln.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>Yx(n,e),redo:()=>({state:n,dispatch:e})=>Xx(n,e)}},addProseMirrorPlugins(){return[cZ(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),hZ=Vn.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",bn(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{selection:t}=e,{$from:s,$to:r}=t,i=n();return s.parentOffset===0?i.insertContentAt({from:Math.max(s.pos-1,0),to:r.pos},{type:this.name}):WY(t)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:o,dispatch:a})=>{var l;if(a){const{$to:c}=o.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?o.setSelection(Ne.create(o.doc,c.pos+1)):c.nodeAfter.isBlock?o.setSelection(Ee.create(o.doc,c.pos)):o.setSelection(Ne.create(o.doc,c.pos));else{const h=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();h&&(o.insert(u,h),o.setSelection(Ne.create(o.doc,u+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Gx({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),dZ=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,fZ=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,pZ=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,mZ=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,gZ=xi.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",bn(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Wa({find:dZ,type:this.type}),Wa({find:pZ,type:this.type})]},addPasteRules(){return[qa({find:fZ,type:this.type}),qa({find:mZ,type:this.type})]}}),_Z=Vn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",bn(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),yZ="listItem",LS="textStyle",VS=/^(\d+)\.\s$/,vZ=Vn.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",bn(this.options.HTMLAttributes,t),0]:["ol",bn(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(yZ,this.editor.getAttributes(LS)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=eu({find:VS,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=eu({find:VS,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(LS)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),bZ=Vn.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",bn(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),wZ=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,EZ=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,TZ=xi.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",bn(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Wa({find:wZ,type:this.type})]},addPasteRules(){return[qa({find:EZ,type:this.type})]}}),SZ=Vn.create({name:"text",group:"inline"}),IZ=Ln.create({name:"starterKit",addExtensions(){const n=[];return this.options.bold!==!1&&n.push(NX.configure(this.options.bold)),this.options.blockquote!==!1&&n.push(kX.configure(this.options.blockquote)),this.options.bulletList!==!1&&n.push(MX.configure(this.options.bulletList)),this.options.code!==!1&&n.push(VX.configure(this.options.code)),this.options.codeBlock!==!1&&n.push($X.configure(this.options.codeBlock)),this.options.document!==!1&&n.push(UX.configure(this.options.document)),this.options.dropcursor!==!1&&n.push(HX.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&n.push(XX.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&n.push(ZX.configure(this.options.hardBreak)),this.options.heading!==!1&&n.push(eZ.configure(this.options.heading)),this.options.history!==!1&&n.push(uZ.configure(this.options.history)),this.options.horizontalRule!==!1&&n.push(hZ.configure(this.options.horizontalRule)),this.options.italic!==!1&&n.push(gZ.configure(this.options.italic)),this.options.listItem!==!1&&n.push(_Z.configure(this.options.listItem)),this.options.orderedList!==!1&&n.push(vZ.configure(this.options.orderedList)),this.options.paragraph!==!1&&n.push(bZ.configure(this.options.paragraph)),this.options.strike!==!1&&n.push(TZ.configure(this.options.strike)),this.options.text!==!1&&n.push(SZ.configure(this.options.text)),n}}),CZ=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Zx=Vn.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:n}){return["img",bn(this.options.HTMLAttributes,n)]},addCommands(){return{setImage:n=>({commands:e})=>e.insertContent({type:this.name,attrs:n})}},addInputRules(){return[Gx({find:CZ,type:this.type,getAttributes:n=>{const[,,e,t,s]=n;return{src:t,alt:e,title:s}}})]}}),kZ=Zx.extend({addAttributes(){return{src:{default:null},alt:{default:null},style:{default:"width: 100%; height: auto; cursor: pointer;",parseHTML:n=>{const e=n.getAttribute("width");return e?`width: ${e}px; height: auto; cursor: pointer;`:`${n.style.cssText}`}},title:{default:null},loading:{default:null},srcset:{default:null},sizes:{default:null},crossorigin:{default:null},usemap:{default:null},ismap:{default:null},width:{default:null},height:{default:null},referrerpolicy:{default:null},longdesc:{default:null},decoding:{default:null},class:{default:null},id:{default:null},name:{default:null},draggable:{default:!0},tabindex:{default:null},"aria-label":{default:null},"aria-labelledby":{default:null},"aria-describedby":{default:null}}},addNodeView(){return({node:n,editor:e,getPos:t})=>{const{view:s,options:{editable:r}}=e,{style:i}=n.attrs,o=document.createElement("div"),a=document.createElement("div"),l=document.createElement("img"),c="width: 24px; height: 24px; cursor: pointer;",u=()=>{if(typeof t=="function"){const v=Object.assign(Object.assign({},n.attrs),{style:`${l.style.cssText}`});s.dispatch(s.state.tr.setNodeMarkup(t(),null,v))}},h=()=>{const v=document.createElement("div"),I=document.createElement("img"),O=document.createElement("img"),P=document.createElement("img"),D=M=>{M.target.style.opacity=.3},B=M=>{M.target.style.opacity=1};v.setAttribute("style","position: absolute; top: 0%; left: 50%; width: 100px; height: 25px; z-index: 999; background-color: rgba(255, 255, 255, 0.7); border-radius: 4px; border: 2px solid #6C6C6C; cursor: pointer; transform: translate(-50%, -50%); display: flex; justify-content: space-between; align-items: center; padding: 0 10px;"),I.setAttribute("src","https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_left/default/20px.svg"),I.setAttribute("style",c),I.addEventListener("mouseover",D),I.addEventListener("mouseout",B),O.setAttribute("src","https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_center/default/20px.svg"),O.setAttribute("style",c),O.addEventListener("mouseover",D),O.addEventListener("mouseout",B),P.setAttribute("src","https://fonts.gstatic.com/s/i/short-term/release/materialsymbolsoutlined/format_align_right/default/20px.svg"),P.setAttribute("style",c),P.addEventListener("mouseover",D),P.addEventListener("mouseout",B),I.addEventListener("click",()=>{l.setAttribute("style",`${l.style.cssText} margin: 0 auto 0 0;`),u()}),O.addEventListener("click",()=>{l.setAttribute("style",`${l.style.cssText} margin: 0 auto;`),u()}),P.addEventListener("click",()=>{l.setAttribute("style",`${l.style.cssText} margin: 0 0 0 auto;`),u()}),v.appendChild(I),v.appendChild(O),v.appendChild(P),a.appendChild(v)};if(o.setAttribute("style","display: flex;"),o.appendChild(a),a.setAttribute("style",`${i}`),a.appendChild(l),Object.entries(n.attrs).forEach(([v,I])=>{I!=null&&l.setAttribute(v,I)}),!r)return{dom:l};const f=["top: -4px; left: -4px; cursor: nwse-resize;","top: -4px; right: -4px; cursor: nesw-resize;","bottom: -4px; left: -4px; cursor: nesw-resize;","bottom: -4px; right: -4px; cursor: nwse-resize;"];let p=!1,m,_;return a.addEventListener("click",()=>{if(a.childElementCount>3)for(let v=0;v<5;v++)a.removeChild(a.lastChild);h(),a.setAttribute("style",`position: relative; border: 1px dashed #6C6C6C; ${i} cursor: pointer;`),Array.from({length:4},(v,I)=>{const O=document.createElement("div");O.setAttribute("style",`position: absolute; width: 9px; height: 9px; border: 1.5px solid #6C6C6C; border-radius: 50%; ${f[I]}`),O.addEventListener("mousedown",P=>{P.preventDefault(),p=!0,m=P.clientX,_=a.offsetWidth;const D=M=>{if(!p)return;const A=I%2===0?-(M.clientX-m):M.clientX-m,T=_+A;a.style.width=T+"px",l.style.width=T+"px"},B=()=>{p&&(p=!1),u(),document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",B)};document.addEventListener("mousemove",D),document.addEventListener("mouseup",B)}),a.appendChild(O)})}),document.addEventListener("click",v=>{const I=v.target;if(!(a.contains(I)||I.style.cssText===c)){const P=a.getAttribute("style"),D=P==null?void 0:P.replace("border: 1px dashed #6C6C6C;","");if(a.setAttribute("style",D),a.childElementCount>3)for(let B=0;B<5;B++)a.removeChild(a.lastChild)}}),{dom:o}}}}),FS="http://127.0.0.1:5001/shadowbanshee-79c70/us-central1/api",AZ=ou("admin",()=>{const n=DR(),e=V9(n),t=OR(),s=G(0),r=G(null),i=G(null);async function o(c,u){s.value=0,r.value=null,i.value=null;try{const h=m9(e,u);return await f9(h,c),i.value=await p9(h),console.log("Image uploaded successfully. URL:",i.value),i.value}catch(h){return r.value=h.message,console.error("Error during image upload:",h),null}}function a(c,u){return console.log(FS),fetch(`${FS}/save-post`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:c,text:u})}).then(h=>{if(!h.ok)throw new Error("Network response was not ok");return h.json()})}async function l(){try{const c=await ij(ev(fs,"items"),{name:"tsbp1",type:"zine",price:"7"});console.log("Document written with ID: ",c.id)}catch(c){console.error("Error adding document: ",c)}}return{firebaseStorage:n,firestore:t,storage:e,uploadProgress:s,uploadError:r,uploadedImageUrl:i,uploadImage:o,SavePost:a,AddItem:l}}),RZ={key:0},PZ={key:1},xZ={__name:"Tiptap",setup(n){const e=AZ(),t=G(""),s=G(!1),r=IX({immediatelyRender:!1,content:"<p>Example Content</p>",onUpdate:({editor:l})=>{l.getJSON()},props:{editorProps:{attributes:{class:"prose dark:prose-invert max-w-none"}}},extensions:[IZ,Zx,kZ]});Xs(()=>{r.value&&(t.value=r.value.getHTML(),console.log("Tiptap editor is ready:",r.value),r.value.on("update",({editor:l})=>{t.value=l.getHTML()}))});function i(){s.value=!s.value}const o=async l=>{const c=l.target.files[0];if(c){const u=`admin-uploads/images/${c}`,h=await e.uploadImage(c,u);h?(r.value.commands.setImage({src:h}),console.log("Uploaded Image URL in Component:",h)):e.uploadError&&console.error("Upload failed in Component:",e.uploadError)}else alert("Please select an image file.")};async function a(){const l=t.value;console.log("Saving post with subject:",subject.value),console.log("Post content:",l),await e.SavePost(subject.value,l).then(()=>{alert("Saved post to weekly.")}).catch(c=>{console.error("Error saving:",c),alert("Error saving.")})}return(l,c)=>($(),W(rt,null,[w("div",null,[Y(r)?($(),W("div",RZ,[nn(w("input",{type:"text",placeholder:"Subject",id:"subject","onUpdate:modelValue":c[0]||(c[0]=u=>l.subject=u)},null,512),[[Un,l.subject]]),w("button",{onClick:c[1]||(c[1]=u=>Y(r).chain().focus().toggleBold().run())}," Bold "),w("button",{onClick:c[2]||(c[2]=u=>Y(r).chain().focus().toggleItalic().run())}," Italic "),w("button",{onClick:i}," Add Image "),F(Y(SX),{editor:Y(r)},null,8,["editor"])])):($(),W("div",PZ," Loading editor... ")),w("p",null,[c[3]||(c[3]=ne("Current content: ")),w("pre",null,De(t.value),1)])]),w("div",{id:"email-buttons"},[c[4]||(c[4]=w("button",{id:"email",class:"nav-button",type:"submit"},"Send Email",-1)),w("button",{id:"weekly",onClick:a},"Save Weekly Post"),c[5]||(c[5]=w("button",{id:"admins",class:"nav-button",type:"submit"},"Send to Admins only",-1))]),s.value?($(),W("input",{key:0,type:"file",onChange:o},null,32)):de("",!0)],64))}},NZ={id:"pageContent"},OZ={id:"bottom"},MZ={id:"posts"},DZ={__name:"Admin",setup(n){const e=Nr(),t=Zf();return G({}),Xs(async()=>{if(!e){t.push("/");return}(await e.getAdmin()).success||t.push("/")}),(s,r)=>($(),W("div",NZ,[F(xZ),w("div",OZ,[w("div",MZ,[F(hP)]),r[0]||(r[0]=w("div",{id:"users"},null,-1))])]))}},LZ=yt(DZ,[["__scopeId","data-v-2e21eb3c"]]),VZ={__name:"AdminView",setup(n){return(e,t)=>($(),W("main",null,[F(LZ)]))}},FZ=Yz({history:kz("/"),routes:[{path:"/",name:"home",component:kH},{path:"/explore",name:"explore",component:XH},{path:"/periodical",name:"periodical",component:mq},{path:"/gallery",name:"gallery",component:Eq},{path:"/FAQ",name:"FAQ",component:Pq},{path:"/shop",name:"shop",component:wK},{path:"/locations",name:"locations",component:IK},{path:"/weekly",name:"weekly",component:DK},{path:"/questions",name:"questions",component:qK},{path:"/account",name:"account",component:_8},{path:"/verify",name:"verify",component:k8},{path:"/admin",name:"admin",component:VZ}]}),BZ=tD(),pp=XM(t5);pp.use(BZ);pp.use(FZ);pp.use(F9,{firebaseApp:ll,modules:[O9()]});pp.mount("#app");
